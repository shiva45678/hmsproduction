var WA=Object.defineProperty;var QA=(e,n,t)=>n in e?WA(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var Hn=(e,n,t)=>QA(e,typeof n!="symbol"?n+"":n,t);function JA(e,n){for(var t=0;t<n.length;t++){const i=n[t];if(typeof i!="string"&&!Array.isArray(i)){for(const a in i)if(a!=="default"&&!(a in e)){const o=Object.getOwnPropertyDescriptor(i,a);o&&Object.defineProperty(e,a,o.get?o:{enumerable:!0,get:()=>i[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();var ru=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ud(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Lv={exports:{}},vm={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oS;function KA(){if(oS)return vm;oS=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function t(i,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var d in a)d!=="key"&&(o[d]=a[d])}else o=a;return a=o.ref,{$$typeof:e,type:i,key:l,ref:a!==void 0?a:null,props:o}}return vm.Fragment=n,vm.jsx=t,vm.jsxs=t,vm}var lS;function XA(){return lS||(lS=1,Lv.exports=KA()),Lv.exports}var r=XA(),Fv={exports:{}},Jt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cS;function ZA(){if(cS)return Jt;cS=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.iterator;function b(A){return A===null||typeof A!="object"?null:(A=g&&A[g]||A["@@iterator"],typeof A=="function"?A:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,k={};function T(A,ce,se){this.props=A,this.context=ce,this.refs=k,this.updater=se||v}T.prototype.isReactComponent={},T.prototype.setState=function(A,ce){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,ce,"setState")},T.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function P(){}P.prototype=T.prototype;function M(A,ce,se){this.props=A,this.context=ce,this.refs=k,this.updater=se||v}var I=M.prototype=new P;I.constructor=M,S(I,T.prototype),I.isPureReactComponent=!0;var U=Array.isArray,L={H:null,A:null,T:null,S:null,V:null},$=Object.prototype.hasOwnProperty;function z(A,ce,se,D,oe,xe){return se=xe.ref,{$$typeof:e,type:A,key:ce,ref:se!==void 0?se:null,props:xe}}function F(A,ce){return z(A.type,ce,void 0,void 0,void 0,A.props)}function Q(A){return typeof A=="object"&&A!==null&&A.$$typeof===e}function R(A){var ce={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(se){return ce[se]})}var B=/\/+/g;function Y(A,ce){return typeof A=="object"&&A!==null&&A.key!=null?R(""+A.key):ce.toString(36)}function re(){}function ne(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(re,re):(A.status="pending",A.then(function(ce){A.status==="pending"&&(A.status="fulfilled",A.value=ce)},function(ce){A.status==="pending"&&(A.status="rejected",A.reason=ce)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function G(A,ce,se,D,oe){var xe=typeof A;(xe==="undefined"||xe==="boolean")&&(A=null);var Z=!1;if(A===null)Z=!0;else switch(xe){case"bigint":case"string":case"number":Z=!0;break;case"object":switch(A.$$typeof){case e:case n:Z=!0;break;case p:return Z=A._init,G(Z(A._payload),ce,se,D,oe)}}if(Z)return oe=oe(A),Z=D===""?"."+Y(A,0):D,U(oe)?(se="",Z!=null&&(se=Z.replace(B,"$&/")+"/"),G(oe,ce,se,"",function(Re){return Re})):oe!=null&&(Q(oe)&&(oe=F(oe,se+(oe.key==null||A&&A.key===oe.key?"":(""+oe.key).replace(B,"$&/")+"/")+Z)),ce.push(oe)),1;Z=0;var ue=D===""?".":D+":";if(U(A))for(var ae=0;ae<A.length;ae++)D=A[ae],xe=ue+Y(D,ae),Z+=G(D,ce,se,xe,oe);else if(ae=b(A),typeof ae=="function")for(A=ae.call(A),ae=0;!(D=A.next()).done;)D=D.value,xe=ue+Y(D,ae++),Z+=G(D,ce,se,xe,oe);else if(xe==="object"){if(typeof A.then=="function")return G(ne(A),ce,se,D,oe);throw ce=String(A),Error("Objects are not valid as a React child (found: "+(ce==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":ce)+"). If you meant to render a collection of children, use an array instead.")}return Z}function V(A,ce,se){if(A==null)return A;var D=[],oe=0;return G(A,D,"","",function(xe){return ce.call(se,xe,oe++)}),D}function W(A){if(A._status===-1){var ce=A._result;ce=ce(),ce.then(function(se){(A._status===0||A._status===-1)&&(A._status=1,A._result=se)},function(se){(A._status===0||A._status===-1)&&(A._status=2,A._result=se)}),A._status===-1&&(A._status=0,A._result=ce)}if(A._status===1)return A._result.default;throw A._result}var J=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ce=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(ce))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)};function he(){}return Jt.Children={map:V,forEach:function(A,ce,se){V(A,function(){ce.apply(this,arguments)},se)},count:function(A){var ce=0;return V(A,function(){ce++}),ce},toArray:function(A){return V(A,function(ce){return ce})||[]},only:function(A){if(!Q(A))throw Error("React.Children.only expected to receive a single React element child.");return A}},Jt.Component=T,Jt.Fragment=t,Jt.Profiler=a,Jt.PureComponent=M,Jt.StrictMode=i,Jt.Suspense=f,Jt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,Jt.__COMPILER_RUNTIME={__proto__:null,c:function(A){return L.H.useMemoCache(A)}},Jt.cache=function(A){return function(){return A.apply(null,arguments)}},Jt.cloneElement=function(A,ce,se){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var D=S({},A.props),oe=A.key,xe=void 0;if(ce!=null)for(Z in ce.ref!==void 0&&(xe=void 0),ce.key!==void 0&&(oe=""+ce.key),ce)!$.call(ce,Z)||Z==="key"||Z==="__self"||Z==="__source"||Z==="ref"&&ce.ref===void 0||(D[Z]=ce[Z]);var Z=arguments.length-2;if(Z===1)D.children=se;else if(1<Z){for(var ue=Array(Z),ae=0;ae<Z;ae++)ue[ae]=arguments[ae+2];D.children=ue}return z(A.type,oe,void 0,void 0,xe,D)},Jt.createContext=function(A){return A={$$typeof:l,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:o,_context:A},A},Jt.createElement=function(A,ce,se){var D,oe={},xe=null;if(ce!=null)for(D in ce.key!==void 0&&(xe=""+ce.key),ce)$.call(ce,D)&&D!=="key"&&D!=="__self"&&D!=="__source"&&(oe[D]=ce[D]);var Z=arguments.length-2;if(Z===1)oe.children=se;else if(1<Z){for(var ue=Array(Z),ae=0;ae<Z;ae++)ue[ae]=arguments[ae+2];oe.children=ue}if(A&&A.defaultProps)for(D in Z=A.defaultProps,Z)oe[D]===void 0&&(oe[D]=Z[D]);return z(A,xe,void 0,void 0,null,oe)},Jt.createRef=function(){return{current:null}},Jt.forwardRef=function(A){return{$$typeof:d,render:A}},Jt.isValidElement=Q,Jt.lazy=function(A){return{$$typeof:p,_payload:{_status:-1,_result:A},_init:W}},Jt.memo=function(A,ce){return{$$typeof:u,type:A,compare:ce===void 0?null:ce}},Jt.startTransition=function(A){var ce=L.T,se={};L.T=se;try{var D=A(),oe=L.S;oe!==null&&oe(se,D),typeof D=="object"&&D!==null&&typeof D.then=="function"&&D.then(he,J)}catch(xe){J(xe)}finally{L.T=ce}},Jt.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},Jt.use=function(A){return L.H.use(A)},Jt.useActionState=function(A,ce,se){return L.H.useActionState(A,ce,se)},Jt.useCallback=function(A,ce){return L.H.useCallback(A,ce)},Jt.useContext=function(A){return L.H.useContext(A)},Jt.useDebugValue=function(){},Jt.useDeferredValue=function(A,ce){return L.H.useDeferredValue(A,ce)},Jt.useEffect=function(A,ce,se){var D=L.H;if(typeof se=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return D.useEffect(A,ce)},Jt.useId=function(){return L.H.useId()},Jt.useImperativeHandle=function(A,ce,se){return L.H.useImperativeHandle(A,ce,se)},Jt.useInsertionEffect=function(A,ce){return L.H.useInsertionEffect(A,ce)},Jt.useLayoutEffect=function(A,ce){return L.H.useLayoutEffect(A,ce)},Jt.useMemo=function(A,ce){return L.H.useMemo(A,ce)},Jt.useOptimistic=function(A,ce){return L.H.useOptimistic(A,ce)},Jt.useReducer=function(A,ce,se){return L.H.useReducer(A,ce,se)},Jt.useRef=function(A){return L.H.useRef(A)},Jt.useState=function(A){return L.H.useState(A)},Jt.useSyncExternalStore=function(A,ce,se){return L.H.useSyncExternalStore(A,ce,se)},Jt.useTransition=function(){return L.H.useTransition()},Jt.version="19.1.0",Jt}var uS;function X1(){return uS||(uS=1,Fv.exports=ZA()),Fv.exports}var w=X1();const vn=Ud(w),dS=JA({__proto__:null,default:vn},[w]);var $v={exports:{}},wm={},zv={exports:{}},Uv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fS;function eP(){return fS||(fS=1,function(e){function n(V,W){var J=V.length;V.push(W);e:for(;0<J;){var he=J-1>>>1,A=V[he];if(0<a(A,W))V[he]=W,V[J]=A,J=he;else break e}}function t(V){return V.length===0?null:V[0]}function i(V){if(V.length===0)return null;var W=V[0],J=V.pop();if(J!==W){V[0]=J;e:for(var he=0,A=V.length,ce=A>>>1;he<ce;){var se=2*(he+1)-1,D=V[se],oe=se+1,xe=V[oe];if(0>a(D,J))oe<A&&0>a(xe,D)?(V[he]=xe,V[oe]=J,he=oe):(V[he]=D,V[se]=J,he=se);else if(oe<A&&0>a(xe,J))V[he]=xe,V[oe]=J,he=oe;else break e}}return W}function a(V,W){var J=V.sortIndex-W.sortIndex;return J!==0?J:V.id-W.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,d=l.now();e.unstable_now=function(){return l.now()-d}}var f=[],u=[],p=1,g=null,b=3,v=!1,S=!1,k=!1,T=!1,P=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function U(V){for(var W=t(u);W!==null;){if(W.callback===null)i(u);else if(W.startTime<=V)i(u),W.sortIndex=W.expirationTime,n(f,W);else break;W=t(u)}}function L(V){if(k=!1,U(V),!S)if(t(f)!==null)S=!0,$||($=!0,Y());else{var W=t(u);W!==null&&G(L,W.startTime-V)}}var $=!1,z=-1,F=5,Q=-1;function R(){return T?!0:!(e.unstable_now()-Q<F)}function B(){if(T=!1,$){var V=e.unstable_now();Q=V;var W=!0;try{e:{S=!1,k&&(k=!1,M(z),z=-1),v=!0;var J=b;try{t:{for(U(V),g=t(f);g!==null&&!(g.expirationTime>V&&R());){var he=g.callback;if(typeof he=="function"){g.callback=null,b=g.priorityLevel;var A=he(g.expirationTime<=V);if(V=e.unstable_now(),typeof A=="function"){g.callback=A,U(V),W=!0;break t}g===t(f)&&i(f),U(V)}else i(f);g=t(f)}if(g!==null)W=!0;else{var ce=t(u);ce!==null&&G(L,ce.startTime-V),W=!1}}break e}finally{g=null,b=J,v=!1}W=void 0}}finally{W?Y():$=!1}}}var Y;if(typeof I=="function")Y=function(){I(B)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,ne=re.port2;re.port1.onmessage=B,Y=function(){ne.postMessage(null)}}else Y=function(){P(B,0)};function G(V,W){z=P(function(){V(e.unstable_now())},W)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(V){switch(b){case 1:case 2:case 3:var W=3;break;default:W=b}var J=b;b=W;try{return V()}finally{b=J}},e.unstable_requestPaint=function(){T=!0},e.unstable_runWithPriority=function(V,W){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var J=b;b=V;try{return W()}finally{b=J}},e.unstable_scheduleCallback=function(V,W,J){var he=e.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?he+J:he):J=he,V){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=J+A,V={id:p++,callback:W,priorityLevel:V,startTime:J,expirationTime:A,sortIndex:-1},J>he?(V.sortIndex=J,n(u,V),t(f)===null&&V===t(u)&&(k?(M(z),z=-1):k=!0,G(L,J-he))):(V.sortIndex=A,n(f,V),S||v||(S=!0,$||($=!0,Y()))),V},e.unstable_shouldYield=R,e.unstable_wrapCallback=function(V){var W=b;return function(){var J=b;b=W;try{return V.apply(this,arguments)}finally{b=J}}}}(Uv)),Uv}var hS;function tP(){return hS||(hS=1,zv.exports=eP()),zv.exports}var Bv={exports:{}},vr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pS;function nP(){if(pS)return vr;pS=1;var e=X1();function n(f){var u="https://react.dev/errors/"+f;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+f+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(n(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(f,u,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:g==null?null:""+g,children:f,containerInfo:u,implementation:p}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,u){if(f==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return vr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,vr.createPortal=function(f,u){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(n(299));return o(f,u,null,p)},vr.flushSync=function(f){var u=l.T,p=i.p;try{if(l.T=null,i.p=2,f)return f()}finally{l.T=u,i.p=p,i.d.f()}},vr.preconnect=function(f,u){typeof f=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,i.d.C(f,u))},vr.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},vr.preinit=function(f,u){if(typeof f=="string"&&u&&typeof u.as=="string"){var p=u.as,g=d(p,u.crossOrigin),b=typeof u.integrity=="string"?u.integrity:void 0,v=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;p==="style"?i.d.S(f,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:g,integrity:b,fetchPriority:v}):p==="script"&&i.d.X(f,{crossOrigin:g,integrity:b,fetchPriority:v,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},vr.preinitModule=function(f,u){if(typeof f=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var p=d(u.as,u.crossOrigin);i.d.M(f,{crossOrigin:p,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&i.d.M(f)},vr.preload=function(f,u){if(typeof f=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var p=u.as,g=d(p,u.crossOrigin);i.d.L(f,p,{crossOrigin:g,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},vr.preloadModule=function(f,u){if(typeof f=="string")if(u){var p=d(u.as,u.crossOrigin);i.d.m(f,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:p,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else i.d.m(f)},vr.requestFormReset=function(f){i.d.r(f)},vr.unstable_batchedUpdates=function(f,u){return f(u)},vr.useFormState=function(f,u,p){return l.H.useFormState(f,u,p)},vr.useFormStatus=function(){return l.H.useHostTransitionStatus()},vr.version="19.1.0",vr}var mS;function R_(){if(mS)return Bv.exports;mS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),Bv.exports=nP(),Bv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gS;function iP(){if(gS)return wm;gS=1;var e=tP(),n=X1(),t=R_();function i(s){var c="https://react.dev/errors/"+s;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+s+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var c=s,h=s;if(s.alternate)for(;c.return;)c=c.return;else{s=c;do c=s,(c.flags&4098)!==0&&(h=c.return),s=c.return;while(s)}return c.tag===3?h:null}function l(s){if(s.tag===13){var c=s.memoizedState;if(c===null&&(s=s.alternate,s!==null&&(c=s.memoizedState)),c!==null)return c.dehydrated}return null}function d(s){if(o(s)!==s)throw Error(i(188))}function f(s){var c=s.alternate;if(!c){if(c=o(s),c===null)throw Error(i(188));return c!==s?null:s}for(var h=s,x=c;;){var N=h.return;if(N===null)break;var E=N.alternate;if(E===null){if(x=N.return,x!==null){h=x;continue}break}if(N.child===E.child){for(E=N.child;E;){if(E===h)return d(N),s;if(E===x)return d(N),c;E=E.sibling}throw Error(i(188))}if(h.return!==x.return)h=N,x=E;else{for(var q=!1,X=N.child;X;){if(X===h){q=!0,h=N,x=E;break}if(X===x){q=!0,x=N,h=E;break}X=X.sibling}if(!q){for(X=E.child;X;){if(X===h){q=!0,h=E,x=N;break}if(X===x){q=!0,x=E,h=N;break}X=X.sibling}if(!q)throw Error(i(189))}}if(h.alternate!==x)throw Error(i(190))}if(h.tag!==3)throw Error(i(188));return h.stateNode.current===h?s:c}function u(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s;for(s=s.child;s!==null;){if(c=u(s),c!==null)return c;s=s.sibling}return null}var p=Object.assign,g=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),M=Symbol.for("react.consumer"),I=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),$=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),Q=Symbol.for("react.activity"),R=Symbol.for("react.memo_cache_sentinel"),B=Symbol.iterator;function Y(s){return s===null||typeof s!="object"?null:(s=B&&s[B]||s["@@iterator"],typeof s=="function"?s:null)}var re=Symbol.for("react.client.reference");function ne(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===re?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case S:return"Fragment";case T:return"Profiler";case k:return"StrictMode";case L:return"Suspense";case $:return"SuspenseList";case Q:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case v:return"Portal";case I:return(s.displayName||"Context")+".Provider";case M:return(s._context.displayName||"Context")+".Consumer";case U:var c=s.render;return s=s.displayName,s||(s=c.displayName||c.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case z:return c=s.displayName||null,c!==null?c:ne(s.type)||"Memo";case F:c=s._payload,s=s._init;try{return ne(s(c))}catch{}}return null}var G=Array.isArray,V=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J={pending:!1,data:null,method:null,action:null},he=[],A=-1;function ce(s){return{current:s}}function se(s){0>A||(s.current=he[A],he[A]=null,A--)}function D(s,c){A++,he[A]=s.current,s.current=c}var oe=ce(null),xe=ce(null),Z=ce(null),ue=ce(null);function ae(s,c){switch(D(Z,c),D(xe,s),D(oe,null),c.nodeType){case 9:case 11:s=(s=c.documentElement)&&(s=s.namespaceURI)?ti(s):0;break;default:if(s=c.tagName,c=c.namespaceURI)c=ti(c),s=ai(c,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}se(oe),D(oe,s)}function Re(){se(oe),se(xe),se(Z)}function Ae(s){s.memoizedState!==null&&D(ue,s);var c=oe.current,h=ai(c,s.type);c!==h&&(D(xe,s),D(oe,h))}function Ce(s){xe.current===s&&(se(oe),se(xe)),ue.current===s&&(se(ue),Kc._currentValue=J)}var Se=Object.prototype.hasOwnProperty,De=e.unstable_scheduleCallback,Me=e.unstable_cancelCallback,et=e.unstable_shouldYield,ct=e.unstable_requestPaint,ut=e.unstable_now,at=e.unstable_getCurrentPriorityLevel,qt=e.unstable_ImmediatePriority,jt=e.unstable_UserBlockingPriority,_e=e.unstable_NormalPriority,Fe=e.unstable_LowPriority,Pe=e.unstable_IdlePriority,Ue=e.log,ve=e.unstable_setDisableYieldValue,ee=null,fe=null;function qe(s){if(typeof Ue=="function"&&ve(s),fe&&typeof fe.setStrictMode=="function")try{fe.setStrictMode(ee,s)}catch{}}var nt=Math.clz32?Math.clz32:Ve,lt=Math.log,wt=Math.LN2;function Ve(s){return s>>>=0,s===0?32:31-(lt(s)/wt|0)|0}var be=256,ye=4194304;function Oe(s){var c=s&42;if(c!==0)return c;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function He(s,c,h){var x=s.pendingLanes;if(x===0)return 0;var N=0,E=s.suspendedLanes,q=s.pingedLanes;s=s.warmLanes;var X=x&134217727;return X!==0?(x=X&~E,x!==0?N=Oe(x):(q&=X,q!==0?N=Oe(q):h||(h=X&~s,h!==0&&(N=Oe(h))))):(X=x&~E,X!==0?N=Oe(X):q!==0?N=Oe(q):h||(h=x&~s,h!==0&&(N=Oe(h)))),N===0?0:c!==0&&c!==N&&(c&E)===0&&(E=N&-N,h=c&-c,E>=h||E===32&&(h&4194048)!==0)?c:N}function tt(s,c){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&c)===0}function rt(s,c){switch(s){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ft(){var s=be;return be<<=1,(be&4194048)===0&&(be=256),s}function Kn(){var s=ye;return ye<<=1,(ye&62914560)===0&&(ye=4194304),s}function Pn(s){for(var c=[],h=0;31>h;h++)c.push(s);return c}function Et(s,c){s.pendingLanes|=c,c!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Vt(s,c,h,x,N,E){var q=s.pendingLanes;s.pendingLanes=h,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=h,s.entangledLanes&=h,s.errorRecoveryDisabledLanes&=h,s.shellSuspendCounter=0;var X=s.entanglements,ge=s.expirationTimes,Le=s.hiddenUpdates;for(h=q&~h;0<h;){var Qe=31-nt(h),Xe=1<<Qe;X[Qe]=0,ge[Qe]=-1;var ze=Le[Qe];if(ze!==null)for(Le[Qe]=null,Qe=0;Qe<ze.length;Qe++){var $e=ze[Qe];$e!==null&&($e.lane&=-536870913)}h&=~Xe}x!==0&&hi(s,x,0),E!==0&&N===0&&s.tag!==0&&(s.suspendedLanes|=E&~(q&~c))}function hi(s,c,h){s.pendingLanes|=c,s.suspendedLanes&=~c;var x=31-nt(c);s.entangledLanes|=c,s.entanglements[x]=s.entanglements[x]|1073741824|h&4194090}function gn(s,c){var h=s.entangledLanes|=c;for(s=s.entanglements;h;){var x=31-nt(h),N=1<<x;N&c|s[x]&c&&(s[x]|=c),h&=~N}}function Dn(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Bt(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ys(){var s=W.p;return s!==0?s:(s=window.event,s===void 0?32:ex(s.type))}function Ws(s,c){var h=W.p;try{return W.p=s,c()}finally{W.p=h}}var Fi=Math.random().toString(36).slice(2),zn="__reactFiber$"+Fi,Ri="__reactProps$"+Fi,ha="__reactContainer$"+Fi,xu="__reactEvents$"+Fi,bu="__reactListeners$"+Fi,Qh="__reactHandles$"+Fi,Zo="__reactResources$"+Fi,Qs="__reactMarker$"+Fi;function Kl(s){delete s[zn],delete s[Ri],delete s[xu],delete s[bu],delete s[Qh]}function ds(s){var c=s[zn];if(c)return c;for(var h=s.parentNode;h;){if(c=h[ha]||h[zn]){if(h=c.alternate,c.child!==null||h!==null&&h.child!==null)for(s=By(s);s!==null;){if(h=s[zn])return h;s=By(s)}return c}s=h,h=s.parentNode}return null}function Js(s){if(s=s[zn]||s[ha]){var c=s.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return s}return null}function Ks(s){var c=s.tag;if(c===5||c===26||c===27||c===6)return s.stateNode;throw Error(i(33))}function Xs(s){var c=s[Zo];return c||(c=s[Zo]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function pi(s){s[Qs]=!0}var Vd=new Set,Hd={};function fs(s,c){Zs(s,c),Zs(s+"Capture",c)}function Zs(s,c){for(Hd[s]=c,s=0;s<c.length;s++)Vd.add(c[s])}var Xl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Gd={},hs={};function qr(s){return Se.call(hs,s)?!0:Se.call(Gd,s)?!1:Xl.test(s)?hs[s]=!0:(Gd[s]=!0,!1)}function Ra(s,c,h){if(qr(c))if(h===null)s.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":s.removeAttribute(c);return;case"boolean":var x=c.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){s.removeAttribute(c);return}}s.setAttribute(c,""+h)}}function el(s,c,h){if(h===null)s.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttribute(c,""+h)}}function kr(s,c,h,x){if(x===null)s.removeAttribute(h);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(h);return}s.setAttributeNS(c,h,""+x)}}var tl,nl;function Ma(s){if(tl===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);tl=c&&c[1]||"",nl=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+tl+s+nl}var Zl=!1;function ec(s,c){if(!s||Zl)return"";Zl=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(c){var Xe=function(){throw Error()};if(Object.defineProperty(Xe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Xe,[])}catch($e){var ze=$e}Reflect.construct(s,[],Xe)}else{try{Xe.call()}catch($e){ze=$e}s.call(Xe.prototype)}}else{try{throw Error()}catch($e){ze=$e}(Xe=s())&&typeof Xe.catch=="function"&&Xe.catch(function(){})}}catch($e){if($e&&ze&&typeof $e.stack=="string")return[$e.stack,ze.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=x.DetermineComponentFrameRoot(),q=E[0],X=E[1];if(q&&X){var ge=q.split(`
`),Le=X.split(`
`);for(N=x=0;x<ge.length&&!ge[x].includes("DetermineComponentFrameRoot");)x++;for(;N<Le.length&&!Le[N].includes("DetermineComponentFrameRoot");)N++;if(x===ge.length||N===Le.length)for(x=ge.length-1,N=Le.length-1;1<=x&&0<=N&&ge[x]!==Le[N];)N--;for(;1<=x&&0<=N;x--,N--)if(ge[x]!==Le[N]){if(x!==1||N!==1)do if(x--,N--,0>N||ge[x]!==Le[N]){var Qe=`
`+ge[x].replace(" at new "," at ");return s.displayName&&Qe.includes("<anonymous>")&&(Qe=Qe.replace("<anonymous>",s.displayName)),Qe}while(1<=x&&0<=N);break}}}finally{Zl=!1,Error.prepareStackTrace=h}return(h=s?s.displayName||s.name:"")?Ma(h):""}function tc(s){switch(s.tag){case 26:case 27:case 5:return Ma(s.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 15:return ec(s.type,!1);case 11:return ec(s.type.render,!1);case 1:return ec(s.type,!0);case 31:return Ma("Activity");default:return""}}function vu(s){try{var c="";do c+=tc(s),s=s.return;while(s);return c}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}function Yi(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function nc(s){var c=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function ic(s){var c=nc(s)?"checked":"value",h=Object.getOwnPropertyDescriptor(s.constructor.prototype,c),x=""+s[c];if(!s.hasOwnProperty(c)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var N=h.get,E=h.set;return Object.defineProperty(s,c,{configurable:!0,get:function(){return N.call(this)},set:function(q){x=""+q,E.call(this,q)}}),Object.defineProperty(s,c,{enumerable:h.enumerable}),{getValue:function(){return x},setValue:function(q){x=""+q},stopTracking:function(){s._valueTracker=null,delete s[c]}}}}function il(s){s._valueTracker||(s._valueTracker=ic(s))}function eo(s){if(!s)return!1;var c=s._valueTracker;if(!c)return!0;var h=c.getValue(),x="";return s&&(x=nc(s)?s.checked?"true":"false":s.value),s=x,s!==h?(c.setValue(s),!0):!1}function Oa(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var rc=/[\n"\\]/g;function Wi(s){return s.replace(rc,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function to(s,c,h,x,N,E,q,X){s.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?s.type=q:s.removeAttribute("type"),c!=null?q==="number"?(c===0&&s.value===""||s.value!=c)&&(s.value=""+Yi(c)):s.value!==""+Yi(c)&&(s.value=""+Yi(c)):q!=="submit"&&q!=="reset"||s.removeAttribute("value"),c!=null?ps(s,q,Yi(c)):h!=null?ps(s,q,Yi(h)):x!=null&&s.removeAttribute("value"),N==null&&E!=null&&(s.defaultChecked=!!E),N!=null&&(s.checked=N&&typeof N!="function"&&typeof N!="symbol"),X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"?s.name=""+Yi(X):s.removeAttribute("name")}function ac(s,c,h,x,N,E,q,X){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(s.type=E),c!=null||h!=null){if(!(E!=="submit"&&E!=="reset"||c!=null))return;h=h!=null?""+Yi(h):"",c=c!=null?""+Yi(c):h,X||c===s.value||(s.value=c),s.defaultValue=c}x=x??N,x=typeof x!="function"&&typeof x!="symbol"&&!!x,s.checked=X?s.checked:!!x,s.defaultChecked=!!x,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(s.name=q)}function ps(s,c,h){c==="number"&&Oa(s.ownerDocument)===s||s.defaultValue===""+h||(s.defaultValue=""+h)}function ms(s,c,h,x){if(s=s.options,c){c={};for(var N=0;N<h.length;N++)c["$"+h[N]]=!0;for(h=0;h<s.length;h++)N=c.hasOwnProperty("$"+s[h].value),s[h].selected!==N&&(s[h].selected=N),N&&x&&(s[h].defaultSelected=!0)}else{for(h=""+Yi(h),c=null,N=0;N<s.length;N++){if(s[N].value===h){s[N].selected=!0,x&&(s[N].defaultSelected=!0);return}c!==null||s[N].disabled||(c=s[N])}c!==null&&(c.selected=!0)}}function rl(s,c,h){if(c!=null&&(c=""+Yi(c),c!==s.value&&(s.value=c),h==null)){s.defaultValue!==c&&(s.defaultValue=c);return}s.defaultValue=h!=null?""+Yi(h):""}function al(s,c,h,x){if(c==null){if(x!=null){if(h!=null)throw Error(i(92));if(G(x)){if(1<x.length)throw Error(i(93));x=x[0]}h=x}h==null&&(h=""),c=h}h=Yi(c),s.defaultValue=h,x=s.textContent,x===h&&x!==""&&x!==null&&(s.value=x)}function Tr(s,c){if(c){var h=s.firstChild;if(h&&h===s.lastChild&&h.nodeType===3){h.nodeValue=c;return}}s.textContent=c}var Vr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function no(s,c,h){var x=c.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?x?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="":x?s.setProperty(c,h):typeof h!="number"||h===0||Vr.has(c)?c==="float"?s.cssFloat=h:s[c]=(""+h).trim():s[c]=h+"px"}function sc(s,c,h){if(c!=null&&typeof c!="object")throw Error(i(62));if(s=s.style,h!=null){for(var x in h)!h.hasOwnProperty(x)||c!=null&&c.hasOwnProperty(x)||(x.indexOf("--")===0?s.setProperty(x,""):x==="float"?s.cssFloat="":s[x]="");for(var N in c)x=c[N],c.hasOwnProperty(N)&&h[N]!==x&&no(s,N,x)}else for(var E in c)c.hasOwnProperty(E)&&no(s,E,c[E])}function io(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),oc=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function gs(s){return oc.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var ro=null;function sl(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var La=null,Fa=null;function ol(s){var c=Js(s);if(c&&(s=c.stateNode)){var h=s[Ri]||null;e:switch(s=c.stateNode,c.type){case"input":if(to(s,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),c=h.name,h.type==="radio"&&c!=null){for(h=s;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+Wi(""+c)+'"][type="radio"]'),c=0;c<h.length;c++){var x=h[c];if(x!==s&&x.form===s.form){var N=x[Ri]||null;if(!N)throw Error(i(90));to(x,N.value,N.defaultValue,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name)}}for(c=0;c<h.length;c++)x=h[c],x.form===s.form&&eo(x)}break e;case"textarea":rl(s,h.value,h.defaultValue);break e;case"select":c=h.value,c!=null&&ms(s,!!h.multiple,c,!1)}}}var ll=!1;function lc(s,c,h){if(ll)return s(c,h);ll=!0;try{var x=s(c);return x}finally{if(ll=!1,(La!==null||Fa!==null)&&(Uf(),La&&(c=La,s=Fa,Fa=La=null,ol(c),s)))for(c=0;c<s.length;c++)ol(s[c])}}function Qi(s,c){var h=s.stateNode;if(h===null)return null;var x=h[Ri]||null;if(x===null)return null;h=x[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(s=s.type,x=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!x;break e;default:s=!1}if(s)return null;if(h&&typeof h!="function")throw Error(i(231,c,typeof h));return h}var Er=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ao=!1;if(Er)try{var Ar={};Object.defineProperty(Ar,"passive",{get:function(){ao=!0}}),window.addEventListener("test",Ar,Ar),window.removeEventListener("test",Ar,Ar)}catch{ao=!1}var $a=null,cl=null,cc=null;function uc(){if(cc)return cc;var s,c=cl,h=c.length,x,N="value"in $a?$a.value:$a.textContent,E=N.length;for(s=0;s<h&&c[s]===N[s];s++);var q=h-s;for(x=1;x<=q&&c[h-x]===N[E-x];x++);return cc=N.slice(s,1<x?1-x:void 0)}function hn(s){var c=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&c===13&&(s=13)):s=c,s===10&&(s=13),32<=s||s===13?s:0}function Sn(){return!0}function ul(){return!1}function Mi(s){function c(h,x,N,E,q){this._reactName=h,this._targetInst=N,this.type=x,this.nativeEvent=E,this.target=q,this.currentTarget=null;for(var X in s)s.hasOwnProperty(X)&&(h=s[X],this[X]=h?h(E):E[X]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?Sn:ul,this.isPropagationStopped=ul,this}return p(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Sn)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Sn)},persist:function(){},isPersistent:Sn}),c}var pa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dl=Mi(pa),so=p({},pa,{view:0,detail:0}),Wd=Mi(so),oo,dc,Un,ma=p({},so,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ki,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Un&&(Un&&s.type==="mousemove"?(oo=s.screenX-Un.screenX,dc=s.screenY-Un.screenY):dc=oo=0,Un=s),oo)},movementY:function(s){return"movementY"in s?s.movementY:dc}}),za=Mi(ma),fc=p({},ma,{dataTransfer:0}),fl=Mi(fc),Ji=p({},so,{relatedTarget:0}),yn=Mi(Ji),hc=p({},pa,{animationName:0,elapsedTime:0,pseudoElement:0}),hl=Mi(hc),pc=p({},pa,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),lo=Mi(pc),co=p({},pa,{data:0}),$i=Mi(co),Qd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mc(s){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(s):(s=Jd[s])?!!c[s]:!1}function Ki(){return mc}var ga=p({},so,{key:function(s){if(s.key){var c=Qd[s.key]||s.key;if(c!=="Unidentified")return c}return s.type==="keypress"?(s=hn(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?xi[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ki,charCode:function(s){return s.type==="keypress"?hn(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?hn(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),gc=Mi(ga),Bn=p({},ma,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Hr=Mi(Bn),ys=p({},so,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ki}),Jh=Mi(ys),Ua=p({},pa,{propertyName:0,elapsedTime:0,pseudoElement:0}),Kh=Mi(Ua),Kd=p({},ma,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),uo=Mi(Kd),xs=p({},pa,{newState:0,oldState:0}),Ba=Mi(xs),fo=[9,13,27,32],pl=Er&&"CompositionEvent"in window,bs=null;Er&&"documentMode"in document&&(bs=document.documentMode);var ml=Er&&"TextEvent"in window&&!bs,gl=Er&&(!pl||bs&&8<bs&&11>=bs),yc=" ",wu=!1;function Xd(s,c){switch(s){case"keyup":return fo.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xc(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var qa=!1;function Xh(s,c){switch(s){case"compositionend":return xc(c);case"keypress":return c.which!==32?null:(wu=!0,yc);case"textInput":return s=c.data,s===yc&&wu?null:s;default:return null}}function Zd(s,c){if(qa)return s==="compositionend"||!pl&&Xd(s,c)?(s=uc(),cc=cl=$a=null,qa=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return gl&&c.locale!=="ko"?null:c.data;default:return null}}var Xi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yl(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c==="input"?!!Xi[s.type]:c==="textarea"}function ho(s,c,h,x){La?Fa?Fa.push(x):Fa=[x]:La=x,c=Wf(c,"onChange"),0<c.length&&(h=new dl("onChange","change",null,h,x),s.push({event:h,listeners:c}))}var ya=null,po=null;function Va(s){Ry(s,0)}function Pr(s){var c=Ks(s);if(eo(c))return s}function Gr(s,c){if(s==="change")return c}var Su=!1;if(Er){var bc;if(Er){var xa="oninput"in document;if(!xa){var Nu=document.createElement("div");Nu.setAttribute("oninput","return;"),xa=typeof Nu.oninput=="function"}bc=xa}else bc=!1;Su=bc&&(!document.documentMode||9<document.documentMode)}function mo(){ya&&(ya.detachEvent("onpropertychange",xl),po=ya=null)}function xl(s){if(s.propertyName==="value"&&Pr(po)){var c=[];ho(c,po,s,sl(s)),lc(Va,c)}}function Cu(s,c,h){s==="focusin"?(mo(),ya=c,po=h,ya.attachEvent("onpropertychange",xl)):s==="focusout"&&mo()}function Ha(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Pr(po)}function bl(s,c){if(s==="click")return Pr(c)}function Zh(s,c){if(s==="input"||s==="change")return Pr(c)}function ep(s,c){return s===c&&(s!==0||1/s===1/c)||s!==s&&c!==c}var Zi=typeof Object.is=="function"?Object.is:ep;function Yr(s,c){if(Zi(s,c))return!0;if(typeof s!="object"||s===null||typeof c!="object"||c===null)return!1;var h=Object.keys(s),x=Object.keys(c);if(h.length!==x.length)return!1;for(x=0;x<h.length;x++){var N=h[x];if(!Se.call(c,N)||!Zi(s[N],c[N]))return!1}return!0}function lr(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function ju(s,c){var h=lr(s);s=0;for(var x;h;){if(h.nodeType===3){if(x=s+h.textContent.length,s<=c&&x>=c)return{node:h,offset:c-s};s=x}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=lr(h)}}function vs(s,c){return s&&c?s===c?!0:s&&s.nodeType===3?!1:c&&c.nodeType===3?vs(s,c.parentNode):"contains"in s?s.contains(c):s.compareDocumentPosition?!!(s.compareDocumentPosition(c)&16):!1:!1}function ef(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var c=Oa(s.document);c instanceof s.HTMLIFrameElement;){try{var h=typeof c.contentWindow.location.href=="string"}catch{h=!1}if(h)s=c.contentWindow;else break;c=Oa(s.document)}return c}function vl(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c&&(c==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||c==="textarea"||s.contentEditable==="true")}var tp=Er&&"documentMode"in document&&11>=document.documentMode,Ga=null,Ya=null,ke=null,Ye=!1;function Be(s,c,h){var x=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Ye||Ga==null||Ga!==Oa(x)||(x=Ga,"selectionStart"in x&&vl(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),ke&&Yr(ke,x)||(ke=x,x=Wf(Ya,"onSelect"),0<x.length&&(c=new dl("onSelect","select",null,c,h),s.push({event:c,listeners:x}),c.target=Ga)))}function ft(s,c){var h={};return h[s.toLowerCase()]=c.toLowerCase(),h["Webkit"+s]="webkit"+c,h["Moz"+s]="moz"+c,h}var kt={animationend:ft("Animation","AnimationEnd"),animationiteration:ft("Animation","AnimationIteration"),animationstart:ft("Animation","AnimationStart"),transitionrun:ft("Transition","TransitionRun"),transitionstart:ft("Transition","TransitionStart"),transitioncancel:ft("Transition","TransitionCancel"),transitionend:ft("Transition","TransitionEnd")},on={},si={};Er&&(si=document.createElement("div").style,"AnimationEvent"in window||(delete kt.animationend.animation,delete kt.animationiteration.animation,delete kt.animationstart.animation),"TransitionEvent"in window||delete kt.transitionend.transition);function ln(s){if(on[s])return on[s];if(!kt[s])return s;var c=kt[s],h;for(h in c)if(c.hasOwnProperty(h)&&h in si)return on[s]=c[h];return s}var vc=ln("animationend"),tf=ln("animationiteration"),er=ln("animationstart"),wc=ln("transitionrun"),np=ln("transitionstart"),ws=ln("transitioncancel"),go=ln("transitionend"),yo=new Map,te="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");te.push("scrollEnd");function de(s,c){yo.set(s,c),fs(c,[s])}var le=new WeakMap;function we(s,c){if(typeof s=="object"&&s!==null){var h=le.get(s);return h!==void 0?h:(c={value:s,source:c,stack:vu(c)},le.set(s,c),c)}return{value:s,source:c,stack:vu(c)}}var We=[],dt=0,vt=0;function bt(){for(var s=dt,c=vt=dt=0;c<s;){var h=We[c];We[c++]=null;var x=We[c];We[c++]=null;var N=We[c];We[c++]=null;var E=We[c];if(We[c++]=null,x!==null&&N!==null){var q=x.pending;q===null?N.next=N:(N.next=q.next,q.next=N),x.pending=N}E!==0&&_u(h,N,E)}}function qn(s,c,h,x){We[dt++]=s,We[dt++]=c,We[dt++]=h,We[dt++]=x,vt|=x,s.lanes|=x,s=s.alternate,s!==null&&(s.lanes|=x)}function zi(s,c,h,x){return qn(s,c,h,x),ku(s)}function Ss(s,c){return qn(s,null,null,c),ku(s)}function _u(s,c,h){s.lanes|=h;var x=s.alternate;x!==null&&(x.lanes|=h);for(var N=!1,E=s.return;E!==null;)E.childLanes|=h,x=E.alternate,x!==null&&(x.childLanes|=h),E.tag===22&&(s=E.stateNode,s===null||s._visibility&1||(N=!0)),s=E,E=E.return;return s.tag===3?(E=s.stateNode,N&&c!==null&&(N=31-nt(h),s=E.hiddenUpdates,x=s[N],x===null?s[N]=[c]:x.push(c),c.lane=h|536870912),E):null}function ku(s){if(50<qc)throw qc=0,Jp=null,Error(i(185));for(var c=s.return;c!==null;)s=c,c=s.return;return s.tag===3?s.stateNode:null}var wl={};function nf(s,c,h,x){this.tag=s,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cr(s,c,h,x){return new nf(s,c,h,x)}function Sl(s){return s=s.prototype,!(!s||!s.isReactComponent)}function tr(s,c){var h=s.alternate;return h===null?(h=cr(s.tag,c,s.key,s.mode),h.elementType=s.elementType,h.type=s.type,h.stateNode=s.stateNode,h.alternate=s,s.alternate=h):(h.pendingProps=c,h.type=s.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=s.flags&65011712,h.childLanes=s.childLanes,h.lanes=s.lanes,h.child=s.child,h.memoizedProps=s.memoizedProps,h.memoizedState=s.memoizedState,h.updateQueue=s.updateQueue,c=s.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=s.sibling,h.index=s.index,h.ref=s.ref,h.refCleanup=s.refCleanup,h}function Tu(s,c){s.flags&=65011714;var h=s.alternate;return h===null?(s.childLanes=0,s.lanes=c,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=h.childLanes,s.lanes=h.lanes,s.child=h.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=h.memoizedProps,s.memoizedState=h.memoizedState,s.updateQueue=h.updateQueue,s.type=h.type,c=h.dependencies,s.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),s}function rf(s,c,h,x,N,E){var q=0;if(x=s,typeof s=="function")Sl(s)&&(q=1);else if(typeof s=="string")q=Nv(s,h,oe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case Q:return s=cr(31,h,c,N),s.elementType=Q,s.lanes=E,s;case S:return Nl(h.children,N,E,c);case k:q=8,N|=24;break;case T:return s=cr(12,h,c,N|2),s.elementType=T,s.lanes=E,s;case L:return s=cr(13,h,c,N),s.elementType=L,s.lanes=E,s;case $:return s=cr(19,h,c,N),s.elementType=$,s.lanes=E,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case P:case I:q=10;break e;case M:q=9;break e;case U:q=11;break e;case z:q=14;break e;case F:q=16,x=null;break e}q=29,h=Error(i(130,s===null?"null":typeof s,"")),x=null}return c=cr(q,h,c,N),c.elementType=s,c.type=x,c.lanes=E,c}function Nl(s,c,h,x){return s=cr(7,s,x,c),s.lanes=h,s}function ip(s,c,h){return s=cr(6,s,null,c),s.lanes=h,s}function Sc(s,c,h){return c=cr(4,s.children!==null?s.children:[],s.key,c),c.lanes=h,c.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},c}var Ns=[],xo=0,af=null,Eu=0,Wr=[],Qr=0,Gn=null,Xn=1,Cs="";function Cl(s,c){Ns[xo++]=Eu,Ns[xo++]=af,af=s,Eu=c}function rp(s,c,h){Wr[Qr++]=Xn,Wr[Qr++]=Cs,Wr[Qr++]=Gn,Gn=s;var x=Xn;s=Cs;var N=32-nt(x)-1;x&=~(1<<N),h+=1;var E=32-nt(c)+N;if(30<E){var q=N-N%5;E=(x&(1<<q)-1).toString(32),x>>=q,N-=q,Xn=1<<32-nt(c)+N|h<<N|x,Cs=E+s}else Xn=1<<E|h<<N|x,Cs=s}function ap(s){s.return!==null&&(Cl(s,1),rp(s,1,0))}function Au(s){for(;s===af;)af=Ns[--xo],Ns[xo]=null,Eu=Ns[--xo],Ns[xo]=null;for(;s===Gn;)Gn=Wr[--Qr],Wr[Qr]=null,Cs=Wr[--Qr],Wr[Qr]=null,Xn=Wr[--Qr],Wr[Qr]=null}var bi=null,Zn=null,an=!1,ba=null,ur=!1,Nc=Error(i(519));function Jr(s){var c=Error(i(418,""));throw bo(we(c,s)),Nc}function pg(s){var c=s.stateNode,h=s.type,x=s.memoizedProps;switch(c[zn]=s,c[Ri]=x,h){case"dialog":nn("cancel",c),nn("close",c);break;case"iframe":case"object":case"embed":nn("load",c);break;case"video":case"audio":for(h=0;h<xd.length;h++)nn(xd[h],c);break;case"source":nn("error",c);break;case"img":case"image":case"link":nn("error",c),nn("load",c);break;case"details":nn("toggle",c);break;case"input":nn("invalid",c),ac(c,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),il(c);break;case"select":nn("invalid",c);break;case"textarea":nn("invalid",c),al(c,x.value,x.defaultValue,x.children),il(c)}h=x.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||c.textContent===""+h||x.suppressHydrationWarning===!0||Ly(c.textContent,h)?(x.popover!=null&&(nn("beforetoggle",c),nn("toggle",c)),x.onScroll!=null&&nn("scroll",c),x.onScrollEnd!=null&&nn("scrollend",c),x.onClick!=null&&(c.onclick=Qf),c=!0):c=!1,c||Jr(s)}function mg(s){for(bi=s.return;bi;)switch(bi.tag){case 5:case 13:ur=!1;return;case 27:case 3:ur=!0;return;default:bi=bi.return}}function Pu(s){if(s!==bi)return!1;if(!an)return mg(s),an=!0,!1;var c=s.tag,h;if((h=c!==3&&c!==27)&&((h=c===5)&&(h=s.type,h=!(h!=="form"&&h!=="button")||Kf(s.type,s.memoizedProps)),h=!h),h&&Zn&&Jr(s),mg(s),c===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));e:{for(s=s.nextSibling,c=0;s;){if(s.nodeType===8)if(h=s.data,h==="/$"){if(c===0){Zn=ja(s.nextSibling);break e}c--}else h!=="$"&&h!=="$!"&&h!=="$?"||c++;s=s.nextSibling}Zn=null}}else c===27?(c=Zn,na(s.type)?(s=um,um=null,Zn=s):Zn=c):Zn=bi?ja(s.stateNode.nextSibling):null;return!0}function Du(){Zn=bi=null,an=!1}function gg(){var s=ba;return s!==null&&(xr===null?xr=s:xr.push.apply(xr,s),ba=null),s}function bo(s){ba===null?ba=[s]:ba.push(s)}var jl=ce(null),vo=null,K=null;function Dr(s,c,h){D(jl,c._currentValue),c._currentValue=h}function Kr(s){s._currentValue=jl.current,se(jl)}function dr(s,c,h){for(;s!==null;){var x=s.alternate;if((s.childLanes&c)!==c?(s.childLanes|=c,x!==null&&(x.childLanes|=c)):x!==null&&(x.childLanes&c)!==c&&(x.childLanes|=c),s===h)break;s=s.return}}function Xt(s,c,h,x){var N=s.child;for(N!==null&&(N.return=s);N!==null;){var E=N.dependencies;if(E!==null){var q=N.child;E=E.firstContext;e:for(;E!==null;){var X=E;E=N;for(var ge=0;ge<c.length;ge++)if(X.context===c[ge]){E.lanes|=h,X=E.alternate,X!==null&&(X.lanes|=h),dr(E.return,h,s),x||(q=null);break e}E=X.next}}else if(N.tag===18){if(q=N.return,q===null)throw Error(i(341));q.lanes|=h,E=q.alternate,E!==null&&(E.lanes|=h),dr(q,h,s),q=null}else q=N.child;if(q!==null)q.return=N;else for(q=N;q!==null;){if(q===s){q=null;break}if(N=q.sibling,N!==null){N.return=q.return,q=N;break}q=q.return}N=q}}function Iu(s,c,h,x){s=null;for(var N=c,E=!1;N!==null;){if(!E){if((N.flags&524288)!==0)E=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var q=N.alternate;if(q===null)throw Error(i(387));if(q=q.memoizedProps,q!==null){var X=N.type;Zi(N.pendingProps.value,q.value)||(s!==null?s.push(X):s=[X])}}else if(N===ue.current){if(q=N.alternate,q===null)throw Error(i(387));q.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(s!==null?s.push(Kc):s=[Kc])}N=N.return}s!==null&&Xt(c,s,h,x),c.flags|=262144}function sf(s){for(s=s.firstContext;s!==null;){if(!Zi(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function _l(s){vo=s,K=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function oi(s){return yg(vo,s)}function of(s,c){return vo===null&&_l(s),yg(s,c)}function yg(s,c){var h=c._currentValue;if(c={context:c,memoizedValue:h,next:null},K===null){if(s===null)throw Error(i(308));K=c,s.dependencies={lanes:0,firstContext:c},s.flags|=524288}else K=K.next=c;return h}var Yb=typeof AbortController<"u"?AbortController:function(){var s=[],c=this.signal={aborted:!1,addEventListener:function(h,x){s.push(x)}};this.abort=function(){c.aborted=!0,s.forEach(function(h){return h()})}},Wb=e.unstable_scheduleCallback,Qb=e.unstable_NormalPriority,On={$$typeof:I,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function sp(){return{controller:new Yb,data:new Map,refCount:0}}function Ru(s){s.refCount--,s.refCount===0&&Wb(Qb,function(){s.controller.abort()})}var Mu=null,op=0,Cc=0,fr=null;function Jb(s,c){if(Mu===null){var h=Mu=[];op=0,Cc=Yf(),fr={status:"pending",value:void 0,then:function(x){h.push(x)}}}return op++,c.then(xg,xg),c}function xg(){if(--op===0&&Mu!==null){fr!==null&&(fr.status="fulfilled");var s=Mu;Mu=null,Cc=0,fr=null;for(var c=0;c<s.length;c++)(0,s[c])()}}function Kb(s,c){var h=[],x={status:"pending",value:null,reason:null,then:function(N){h.push(N)}};return s.then(function(){x.status="fulfilled",x.value=c;for(var N=0;N<h.length;N++)(0,h[N])(c)},function(N){for(x.status="rejected",x.reason=N,N=0;N<h.length;N++)(0,h[N])(void 0)}),x}var bg=V.S;V.S=function(s,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&Jb(s,c),bg!==null&&bg(s,c)};var kl=ce(null);function js(){var s=kl.current;return s!==null?s:Vn.pooledCache}function lf(s,c){c===null?D(kl,kl.current):D(kl,c.pool)}function vg(){var s=js();return s===null?null:{parent:On._currentValue,pool:s}}var nr=Error(i(460)),wg=Error(i(474)),cf=Error(i(542)),lp={then:function(){}};function Sg(s){return s=s.status,s==="fulfilled"||s==="rejected"}function uf(){}function cp(s,c,h){switch(h=s[h],h===void 0?s.push(c):h!==c&&(c.then(uf,uf),c=h),c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,Cg(s),s;default:if(typeof c.status=="string")c.then(uf,uf);else{if(s=Vn,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=c,s.status="pending",s.then(function(x){if(c.status==="pending"){var N=c;N.status="fulfilled",N.value=x}},function(x){if(c.status==="pending"){var N=c;N.status="rejected",N.reason=x}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw s=c.reason,Cg(s),s}throw jc=c,nr}}var jc=null;function Ng(){if(jc===null)throw Error(i(459));var s=jc;return jc=null,s}function Cg(s){if(s===nr||s===cf)throw Error(i(483))}var Wa=!1;function Tl(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function _c(s,c){s=s.updateQueue,c.updateQueue===s&&(c.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function wo(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function _s(s,c,h){var x=s.updateQueue;if(x===null)return null;if(x=x.shared,(_n&2)!==0){var N=x.pending;return N===null?c.next=c:(c.next=N.next,N.next=c),x.pending=c,c=ku(s),_u(s,null,h),c}return qn(s,x,c,h),ku(s)}function Ou(s,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194048)!==0)){var x=c.lanes;x&=s.pendingLanes,h|=x,c.lanes=h,gn(s,h)}}function va(s,c){var h=s.updateQueue,x=s.alternate;if(x!==null&&(x=x.updateQueue,h===x)){var N=null,E=null;if(h=h.firstBaseUpdate,h!==null){do{var q={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};E===null?N=E=q:E=E.next=q,h=h.next}while(h!==null);E===null?N=E=c:E=E.next=c}else N=E=c;h={baseState:x.baseState,firstBaseUpdate:N,lastBaseUpdate:E,shared:x.shared,callbacks:x.callbacks},s.updateQueue=h;return}s=h.lastBaseUpdate,s===null?h.firstBaseUpdate=c:s.next=c,h.lastBaseUpdate=c}var Lu=!1;function wa(){if(Lu){var s=fr;if(s!==null)throw s}}function Ui(s,c,h,x){Lu=!1;var N=s.updateQueue;Wa=!1;var E=N.firstBaseUpdate,q=N.lastBaseUpdate,X=N.shared.pending;if(X!==null){N.shared.pending=null;var ge=X,Le=ge.next;ge.next=null,q===null?E=Le:q.next=Le,q=ge;var Qe=s.alternate;Qe!==null&&(Qe=Qe.updateQueue,X=Qe.lastBaseUpdate,X!==q&&(X===null?Qe.firstBaseUpdate=Le:X.next=Le,Qe.lastBaseUpdate=ge))}if(E!==null){var Xe=N.baseState;q=0,Qe=Le=ge=null,X=E;do{var ze=X.lane&-536870913,$e=ze!==X.lane;if($e?(pn&ze)===ze:(x&ze)===ze){ze!==0&&ze===Cc&&(Lu=!0),Qe!==null&&(Qe=Qe.next={lane:0,tag:X.tag,payload:X.payload,callback:null,next:null});e:{var At=s,Tt=X;ze=c;var Rn=h;switch(Tt.tag){case 1:if(At=Tt.payload,typeof At=="function"){Xe=At.call(Rn,Xe,ze);break e}Xe=At;break e;case 3:At.flags=At.flags&-65537|128;case 0:if(At=Tt.payload,ze=typeof At=="function"?At.call(Rn,Xe,ze):At,ze==null)break e;Xe=p({},Xe,ze);break e;case 2:Wa=!0}}ze=X.callback,ze!==null&&(s.flags|=64,$e&&(s.flags|=8192),$e=N.callbacks,$e===null?N.callbacks=[ze]:$e.push(ze))}else $e={lane:ze,tag:X.tag,payload:X.payload,callback:X.callback,next:null},Qe===null?(Le=Qe=$e,ge=Xe):Qe=Qe.next=$e,q|=ze;if(X=X.next,X===null){if(X=N.shared.pending,X===null)break;$e=X,X=$e.next,$e.next=null,N.lastBaseUpdate=$e,N.shared.pending=null}}while(!0);Qe===null&&(ge=Xe),N.baseState=ge,N.firstBaseUpdate=Le,N.lastBaseUpdate=Qe,E===null&&(N.shared.lanes=0),Ao|=q,s.lanes=q,s.memoizedState=Xe}}function jg(s,c){if(typeof s!="function")throw Error(i(191,s));s.call(c)}function up(s,c){var h=s.callbacks;if(h!==null)for(s.callbacks=null,s=0;s<h.length;s++)jg(h[s],c)}var El=ce(null),So=ce(0);function ks(s,c){s=Os,D(So,s),D(El,c),Os=s|c.baseLanes}function df(){D(So,Os),D(El,El.current)}function dp(){Os=So.current,se(El),se(So)}var Sa=0,Qt=null,jn=null,sn=null,kc=!1,Al=!1,Bi=!1,Tc=0,No=0,Xr=null,_g=0;function cn(){throw Error(i(321))}function Fu(s,c){if(c===null)return!1;for(var h=0;h<c.length&&h<s.length;h++)if(!Zi(s[h],c[h]))return!1;return!0}function fp(s,c,h,x,N,E){return Sa=E,Qt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,V.H=s===null||s.memoizedState===null?$g:Ap,Bi=!1,E=h(x,N),Bi=!1,Al&&(E=Tg(c,h,x,N)),kg(s),E}function kg(s){V.H=Qu;var c=jn!==null&&jn.next!==null;if(Sa=0,sn=jn=Qt=null,kc=!1,No=0,Xr=null,c)throw Error(i(300));s===null||ki||(s=s.dependencies,s!==null&&sf(s)&&(ki=!0))}function Tg(s,c,h,x){Qt=s;var N=0;do{if(Al&&(Xr=null),No=0,Al=!1,25<=N)throw Error(i(301));if(N+=1,sn=jn=null,s.updateQueue!=null){var E=s.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}V.H=zg,E=c(h,x)}while(Al);return E}function hp(){var s=V.H,c=s.useState()[0];return c=typeof c.then=="function"?$u(c):c,s=s.useState()[0],(jn!==null?jn.memoizedState:null)!==s&&(Qt.flags|=1024),c}function pp(){var s=Tc!==0;return Tc=0,s}function Pl(s,c,h){c.updateQueue=s.updateQueue,c.flags&=-2053,s.lanes&=~h}function ff(s){if(kc){for(s=s.memoizedState;s!==null;){var c=s.queue;c!==null&&(c.pending=null),s=s.next}kc=!1}Sa=0,sn=jn=Qt=null,Al=!1,No=Tc=0,Xr=null}function hr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sn===null?Qt.memoizedState=sn=s:sn=sn.next=s,sn}function mi(){if(jn===null){var s=Qt.alternate;s=s!==null?s.memoizedState:null}else s=jn.next;var c=sn===null?Qt.memoizedState:sn.next;if(c!==null)sn=c,jn=s;else{if(s===null)throw Qt.alternate===null?Error(i(467)):Error(i(310));jn=s,s={memoizedState:jn.memoizedState,baseState:jn.baseState,baseQueue:jn.baseQueue,queue:jn.queue,next:null},sn===null?Qt.memoizedState=sn=s:sn=sn.next=s}return sn}function Dl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $u(s){var c=No;return No+=1,Xr===null&&(Xr=[]),s=cp(Xr,s,c),c=Qt,(sn===null?c.memoizedState:sn.next)===null&&(c=c.alternate,V.H=c===null||c.memoizedState===null?$g:Ap),s}function hf(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return $u(s);if(s.$$typeof===I)return oi(s)}throw Error(i(438,String(s)))}function zu(s){var c=null,h=Qt.updateQueue;if(h!==null&&(c=h.memoCache),c==null){var x=Qt.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(c={data:x.data.map(function(N){return N.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),h===null&&(h=Dl(),Qt.updateQueue=h),h.memoCache=c,h=c.data[c.index],h===void 0)for(h=c.data[c.index]=Array(s),x=0;x<s;x++)h[x]=R;return c.index++,h}function Qa(s,c){return typeof c=="function"?c(s):c}function pf(s){var c=mi();return mp(c,jn,s)}function mp(s,c,h){var x=s.queue;if(x===null)throw Error(i(311));x.lastRenderedReducer=h;var N=s.baseQueue,E=x.pending;if(E!==null){if(N!==null){var q=N.next;N.next=E.next,E.next=q}c.baseQueue=N=E,x.pending=null}if(E=s.baseState,N===null)s.memoizedState=E;else{c=N.next;var X=q=null,ge=null,Le=c,Qe=!1;do{var Xe=Le.lane&-536870913;if(Xe!==Le.lane?(pn&Xe)===Xe:(Sa&Xe)===Xe){var ze=Le.revertLane;if(ze===0)ge!==null&&(ge=ge.next={lane:0,revertLane:0,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null}),Xe===Cc&&(Qe=!0);else if((Sa&ze)===ze){Le=Le.next,ze===Cc&&(Qe=!0);continue}else Xe={lane:0,revertLane:Le.revertLane,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null},ge===null?(X=ge=Xe,q=E):ge=ge.next=Xe,Qt.lanes|=ze,Ao|=ze;Xe=Le.action,Bi&&h(E,Xe),E=Le.hasEagerState?Le.eagerState:h(E,Xe)}else ze={lane:Xe,revertLane:Le.revertLane,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null},ge===null?(X=ge=ze,q=E):ge=ge.next=ze,Qt.lanes|=Xe,Ao|=Xe;Le=Le.next}while(Le!==null&&Le!==c);if(ge===null?q=E:ge.next=X,!Zi(E,s.memoizedState)&&(ki=!0,Qe&&(h=fr,h!==null)))throw h;s.memoizedState=E,s.baseState=q,s.baseQueue=ge,x.lastRenderedState=E}return N===null&&(x.lanes=0),[s.memoizedState,x.dispatch]}function gp(s){var c=mi(),h=c.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=s;var x=h.dispatch,N=h.pending,E=c.memoizedState;if(N!==null){h.pending=null;var q=N=N.next;do E=s(E,q.action),q=q.next;while(q!==N);Zi(E,c.memoizedState)||(ki=!0),c.memoizedState=E,c.baseQueue===null&&(c.baseState=E),h.lastRenderedState=E}return[E,x]}function yp(s,c,h){var x=Qt,N=mi(),E=an;if(E){if(h===void 0)throw Error(i(407));h=h()}else h=c();var q=!Zi((jn||N).memoizedState,h);q&&(N.memoizedState=h,ki=!0),N=N.queue;var X=gf.bind(null,x,N,s);if(qu(2048,8,X,[s]),N.getSnapshot!==c||q||sn!==null&&sn.memoizedState.tag&1){if(x.flags|=2048,Ec(9,wf(),Eg.bind(null,x,N,h,c),null),Vn===null)throw Error(i(349));E||(Sa&124)!==0||mf(x,c,h)}return h}function mf(s,c,h){s.flags|=16384,s={getSnapshot:c,value:h},c=Qt.updateQueue,c===null?(c=Dl(),Qt.updateQueue=c,c.stores=[s]):(h=c.stores,h===null?c.stores=[s]:h.push(s))}function Eg(s,c,h,x){c.value=h,c.getSnapshot=x,xp(c)&&bp(s)}function gf(s,c,h){return h(function(){xp(c)&&bp(s)})}function xp(s){var c=s.getSnapshot;s=s.value;try{var h=c();return!Zi(s,h)}catch{return!0}}function bp(s){var c=Ss(s,2);c!==null&&Lr(c,s,2)}function yf(s){var c=hr();if(typeof s=="function"){var h=s;if(s=h(),Bi){qe(!0);try{h()}finally{qe(!1)}}}return c.memoizedState=c.baseState=s,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qa,lastRenderedState:s},c}function Uu(s,c,h,x){return s.baseState=h,mp(s,jn,typeof x=="function"?x:Qa)}function Xb(s,c,h,x,N){if(jf(s))throw Error(i(485));if(s=c.action,s!==null){var E={payload:N,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){E.listeners.push(q)}};V.T!==null?h(!0):E.isTransition=!1,x(E),h=c.pending,h===null?(E.next=c.pending=E,vp(c,E)):(E.next=h.next,c.pending=h.next=E)}}function vp(s,c){var h=c.action,x=c.payload,N=s.state;if(c.isTransition){var E=V.T,q={};V.T=q;try{var X=h(N,x),ge=V.S;ge!==null&&ge(q,X),wp(s,c,X)}catch(Le){xf(s,c,Le)}finally{V.T=E}}else try{E=h(N,x),wp(s,c,E)}catch(Le){xf(s,c,Le)}}function wp(s,c,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(x){Ag(s,c,x)},function(x){return xf(s,c,x)}):Ag(s,c,h)}function Ag(s,c,h){c.status="fulfilled",c.value=h,Pg(c),s.state=h,c=s.pending,c!==null&&(h=c.next,h===c?s.pending=null:(h=h.next,c.next=h,vp(s,h)))}function xf(s,c,h){var x=s.pending;if(s.pending=null,x!==null){x=x.next;do c.status="rejected",c.reason=h,Pg(c),c=c.next;while(c!==x)}s.action=null}function Pg(s){s=s.listeners;for(var c=0;c<s.length;c++)(0,s[c])()}function bf(s,c){return c}function Sp(s,c){if(an){var h=Vn.formState;if(h!==null){e:{var x=Qt;if(an){if(Zn){t:{for(var N=Zn,E=ur;N.nodeType!==8;){if(!E){N=null;break t}if(N=ja(N.nextSibling),N===null){N=null;break t}}E=N.data,N=E==="F!"||E==="F"?N:null}if(N){Zn=ja(N.nextSibling),x=N.data==="F!";break e}}Jr(x)}x=!1}x&&(c=h[0])}}return h=hr(),h.memoizedState=h.baseState=c,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:bf,lastRenderedState:c},h.queue=x,h=kp.bind(null,Qt,x),x.dispatch=h,x=yf(!1),E=Tp.bind(null,Qt,!1,x.queue),x=hr(),N={state:c,dispatch:null,action:s,pending:null},x.queue=N,h=Xb.bind(null,Qt,N,E,h),N.dispatch=h,x.memoizedState=s,[c,h,!1]}function vf(s){var c=mi();return Dg(c,jn,s)}function Dg(s,c,h){if(c=mp(s,c,bf)[0],s=pf(Qa)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var x=$u(c)}catch(q){throw q===nr?cf:q}else x=c;c=mi();var N=c.queue,E=N.dispatch;return h!==c.memoizedState&&(Qt.flags|=2048,Ec(9,wf(),Np.bind(null,N,h),null)),[x,E,s]}function Np(s,c){s.action=c}function Ht(s){var c=mi(),h=jn;if(h!==null)return Dg(c,h,s);mi(),c=c.memoizedState,h=mi();var x=h.queue.dispatch;return h.memoizedState=s,[c,x,!1]}function Ec(s,c,h,x){return s={tag:s,create:h,deps:x,inst:c,next:null},c=Qt.updateQueue,c===null&&(c=Dl(),Qt.updateQueue=c),h=c.lastEffect,h===null?c.lastEffect=s.next=s:(x=h.next,h.next=s,s.next=x,c.lastEffect=s),s}function wf(){return{destroy:void 0,resource:void 0}}function Ac(){return mi().memoizedState}function Bu(s,c,h,x){var N=hr();x=x===void 0?null:x,Qt.flags|=s,N.memoizedState=Ec(1|c,wf(),h,x)}function qu(s,c,h,x){var N=mi();x=x===void 0?null:x;var E=N.memoizedState.inst;jn!==null&&x!==null&&Fu(x,jn.memoizedState.deps)?N.memoizedState=Ec(c,E,h,x):(Qt.flags|=s,N.memoizedState=Ec(1|c,E,h,x))}function Ig(s,c){Bu(8390656,8,s,c)}function Ir(s,c){qu(2048,8,s,c)}function Rg(s,c){return qu(4,2,s,c)}function Vu(s,c){return qu(4,4,s,c)}function Sf(s,c){if(typeof c=="function"){s=s();var h=c(s);return function(){typeof h=="function"?h():c(null)}}if(c!=null)return s=s(),c.current=s,function(){c.current=null}}function Cp(s,c,h){h=h!=null?h.concat([s]):null,qu(4,4,Sf.bind(null,c,s),h)}function Nf(){}function pr(s,c){var h=mi();c=c===void 0?null:c;var x=h.memoizedState;return c!==null&&Fu(c,x[1])?x[0]:(h.memoizedState=[s,c],s)}function Ts(s,c){var h=mi();c=c===void 0?null:c;var x=h.memoizedState;if(c!==null&&Fu(c,x[1]))return x[0];if(x=s(),Bi){qe(!0);try{s()}finally{qe(!1)}}return h.memoizedState=[x,c],x}function Hu(s,c,h){return h===void 0||(Sa&1073741824)!==0?s.memoizedState=c:(s.memoizedState=h,s=hy(),Qt.lanes|=s,Ao|=s,h)}function jp(s,c,h,x){return Zi(h,c)?h:El.current!==null?(s=Hu(s,h,x),Zi(s,c)||(ki=!0),s):(Sa&42)===0?(ki=!0,s.memoizedState=h):(s=hy(),Qt.lanes|=s,Ao|=s,c)}function Gu(s,c,h,x,N){var E=W.p;W.p=E!==0&&8>E?E:8;var q=V.T,X={};V.T=X,Tp(s,!1,c,h);try{var ge=N(),Le=V.S;if(Le!==null&&Le(X,ge),ge!==null&&typeof ge=="object"&&typeof ge.then=="function"){var Qe=Kb(ge,x);Il(s,c,Qe,Vi(s))}else Il(s,c,x,Vi(s))}catch(Xe){Il(s,c,{then:function(){},status:"rejected",reason:Xe},Vi())}finally{W.p=E,V.T=q}}function Mg(){}function Yu(s,c,h,x){if(s.tag!==5)throw Error(i(476));var N=_p(s).queue;Gu(s,N,c,J,h===null?Mg:function(){return Cf(s),h(x)})}function _p(s){var c=s.memoizedState;if(c!==null)return c;c={memoizedState:J,baseState:J,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qa,lastRenderedState:J},next:null};var h={};return c.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qa,lastRenderedState:h},next:null},s.memoizedState=c,s=s.alternate,s!==null&&(s.memoizedState=c),c}function Cf(s){var c=_p(s).next.queue;Il(s,c,{},Vi())}function Wu(){return oi(Kc)}function Es(){return mi().memoizedState}function Og(){return mi().memoizedState}function Co(s){for(var c=s.return;c!==null;){switch(c.tag){case 24:case 3:var h=Vi();s=wo(h);var x=_s(c,s,h);x!==null&&(Lr(x,c,h),Ou(x,c,h)),c={cache:sp()},s.payload=c;return}c=c.return}}function Lg(s,c,h){var x=Vi();h={lane:x,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null},jf(s)?Fg(c,h):(h=zi(s,c,h,x),h!==null&&(Lr(h,s,x),Ep(h,c,x)))}function kp(s,c,h){var x=Vi();Il(s,c,h,x)}function Il(s,c,h,x){var N={lane:x,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null};if(jf(s))Fg(c,N);else{var E=s.alternate;if(s.lanes===0&&(E===null||E.lanes===0)&&(E=c.lastRenderedReducer,E!==null))try{var q=c.lastRenderedState,X=E(q,h);if(N.hasEagerState=!0,N.eagerState=X,Zi(X,q))return qn(s,c,N,0),Vn===null&&bt(),!1}catch{}finally{}if(h=zi(s,c,N,x),h!==null)return Lr(h,s,x),Ep(h,c,x),!0}return!1}function Tp(s,c,h,x){if(x={lane:2,revertLane:Yf(),action:x,hasEagerState:!1,eagerState:null,next:null},jf(s)){if(c)throw Error(i(479))}else c=zi(s,h,x,2),c!==null&&Lr(c,s,2)}function jf(s){var c=s.alternate;return s===Qt||c!==null&&c===Qt}function Fg(s,c){Al=kc=!0;var h=s.pending;h===null?c.next=c:(c.next=h.next,h.next=c),s.pending=c}function Ep(s,c,h){if((h&4194048)!==0){var x=c.lanes;x&=s.pendingLanes,h|=x,c.lanes=h,gn(s,h)}}var Qu={readContext:oi,use:hf,useCallback:cn,useContext:cn,useEffect:cn,useImperativeHandle:cn,useLayoutEffect:cn,useInsertionEffect:cn,useMemo:cn,useReducer:cn,useRef:cn,useState:cn,useDebugValue:cn,useDeferredValue:cn,useTransition:cn,useSyncExternalStore:cn,useId:cn,useHostTransitionStatus:cn,useFormState:cn,useActionState:cn,useOptimistic:cn,useMemoCache:cn,useCacheRefresh:cn},$g={readContext:oi,use:hf,useCallback:function(s,c){return hr().memoizedState=[s,c===void 0?null:c],s},useContext:oi,useEffect:Ig,useImperativeHandle:function(s,c,h){h=h!=null?h.concat([s]):null,Bu(4194308,4,Sf.bind(null,c,s),h)},useLayoutEffect:function(s,c){return Bu(4194308,4,s,c)},useInsertionEffect:function(s,c){Bu(4,2,s,c)},useMemo:function(s,c){var h=hr();c=c===void 0?null:c;var x=s();if(Bi){qe(!0);try{s()}finally{qe(!1)}}return h.memoizedState=[x,c],x},useReducer:function(s,c,h){var x=hr();if(h!==void 0){var N=h(c);if(Bi){qe(!0);try{h(c)}finally{qe(!1)}}}else N=c;return x.memoizedState=x.baseState=N,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:N},x.queue=s,s=s.dispatch=Lg.bind(null,Qt,s),[x.memoizedState,s]},useRef:function(s){var c=hr();return s={current:s},c.memoizedState=s},useState:function(s){s=yf(s);var c=s.queue,h=kp.bind(null,Qt,c);return c.dispatch=h,[s.memoizedState,h]},useDebugValue:Nf,useDeferredValue:function(s,c){var h=hr();return Hu(h,s,c)},useTransition:function(){var s=yf(!1);return s=Gu.bind(null,Qt,s.queue,!0,!1),hr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,c,h){var x=Qt,N=hr();if(an){if(h===void 0)throw Error(i(407));h=h()}else{if(h=c(),Vn===null)throw Error(i(349));(pn&124)!==0||mf(x,c,h)}N.memoizedState=h;var E={value:h,getSnapshot:c};return N.queue=E,Ig(gf.bind(null,x,E,s),[s]),x.flags|=2048,Ec(9,wf(),Eg.bind(null,x,E,h,c),null),h},useId:function(){var s=hr(),c=Vn.identifierPrefix;if(an){var h=Cs,x=Xn;h=(x&~(1<<32-nt(x)-1)).toString(32)+h,c=""+c+"R"+h,h=Tc++,0<h&&(c+="H"+h.toString(32)),c+=""}else h=_g++,c=""+c+"r"+h.toString(32)+"";return s.memoizedState=c},useHostTransitionStatus:Wu,useFormState:Sp,useActionState:Sp,useOptimistic:function(s){var c=hr();c.memoizedState=c.baseState=s;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=h,c=Tp.bind(null,Qt,!0,h),h.dispatch=c,[s,c]},useMemoCache:zu,useCacheRefresh:function(){return hr().memoizedState=Co.bind(null,Qt)}},Ap={readContext:oi,use:hf,useCallback:pr,useContext:oi,useEffect:Ir,useImperativeHandle:Cp,useInsertionEffect:Rg,useLayoutEffect:Vu,useMemo:Ts,useReducer:pf,useRef:Ac,useState:function(){return pf(Qa)},useDebugValue:Nf,useDeferredValue:function(s,c){var h=mi();return jp(h,jn.memoizedState,s,c)},useTransition:function(){var s=pf(Qa)[0],c=mi().memoizedState;return[typeof s=="boolean"?s:$u(s),c]},useSyncExternalStore:yp,useId:Es,useHostTransitionStatus:Wu,useFormState:vf,useActionState:vf,useOptimistic:function(s,c){var h=mi();return Uu(h,jn,s,c)},useMemoCache:zu,useCacheRefresh:Og},zg={readContext:oi,use:hf,useCallback:pr,useContext:oi,useEffect:Ir,useImperativeHandle:Cp,useInsertionEffect:Rg,useLayoutEffect:Vu,useMemo:Ts,useReducer:gp,useRef:Ac,useState:function(){return gp(Qa)},useDebugValue:Nf,useDeferredValue:function(s,c){var h=mi();return jn===null?Hu(h,s,c):jp(h,jn.memoizedState,s,c)},useTransition:function(){var s=gp(Qa)[0],c=mi().memoizedState;return[typeof s=="boolean"?s:$u(s),c]},useSyncExternalStore:yp,useId:Es,useHostTransitionStatus:Wu,useFormState:Ht,useActionState:Ht,useOptimistic:function(s,c){var h=mi();return jn!==null?Uu(h,jn,s,c):(h.baseState=s,[s,h.queue.dispatch])},useMemoCache:zu,useCacheRefresh:Og},vi=null,mr=0;function _f(s){var c=mr;return mr+=1,vi===null&&(vi=[]),cp(vi,s,c)}function Ju(s,c){c=c.props.ref,s.ref=c!==void 0?c:null}function Rl(s,c){throw c.$$typeof===g?Error(i(525)):(s=Object.prototype.toString.call(c),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":s)))}function Ml(s){var c=s._init;return c(s._payload)}function Pp(s){function c(Te,je){if(s){var Ie=Te.deletions;Ie===null?(Te.deletions=[je],Te.flags|=16):Ie.push(je)}}function h(Te,je){if(!s)return null;for(;je!==null;)c(Te,je),je=je.sibling;return null}function x(Te){for(var je=new Map;Te!==null;)Te.key!==null?je.set(Te.key,Te):je.set(Te.index,Te),Te=Te.sibling;return je}function N(Te,je){return Te=tr(Te,je),Te.index=0,Te.sibling=null,Te}function E(Te,je,Ie){return Te.index=Ie,s?(Ie=Te.alternate,Ie!==null?(Ie=Ie.index,Ie<je?(Te.flags|=67108866,je):Ie):(Te.flags|=67108866,je)):(Te.flags|=1048576,je)}function q(Te){return s&&Te.alternate===null&&(Te.flags|=67108866),Te}function X(Te,je,Ie,Je){return je===null||je.tag!==6?(je=ip(Ie,Te.mode,Je),je.return=Te,je):(je=N(je,Ie),je.return=Te,je)}function ge(Te,je,Ie,Je){var gt=Ie.type;return gt===S?Qe(Te,je,Ie.props.children,Je,Ie.key):je!==null&&(je.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===F&&Ml(gt)===je.type)?(je=N(je,Ie.props),Ju(je,Ie),je.return=Te,je):(je=rf(Ie.type,Ie.key,Ie.props,null,Te.mode,Je),Ju(je,Ie),je.return=Te,je)}function Le(Te,je,Ie,Je){return je===null||je.tag!==4||je.stateNode.containerInfo!==Ie.containerInfo||je.stateNode.implementation!==Ie.implementation?(je=Sc(Ie,Te.mode,Je),je.return=Te,je):(je=N(je,Ie.children||[]),je.return=Te,je)}function Qe(Te,je,Ie,Je,gt){return je===null||je.tag!==7?(je=Nl(Ie,Te.mode,Je,gt),je.return=Te,je):(je=N(je,Ie),je.return=Te,je)}function Xe(Te,je,Ie){if(typeof je=="string"&&je!==""||typeof je=="number"||typeof je=="bigint")return je=ip(""+je,Te.mode,Ie),je.return=Te,je;if(typeof je=="object"&&je!==null){switch(je.$$typeof){case b:return Ie=rf(je.type,je.key,je.props,null,Te.mode,Ie),Ju(Ie,je),Ie.return=Te,Ie;case v:return je=Sc(je,Te.mode,Ie),je.return=Te,je;case F:var Je=je._init;return je=Je(je._payload),Xe(Te,je,Ie)}if(G(je)||Y(je))return je=Nl(je,Te.mode,Ie,null),je.return=Te,je;if(typeof je.then=="function")return Xe(Te,_f(je),Ie);if(je.$$typeof===I)return Xe(Te,of(Te,je),Ie);Rl(Te,je)}return null}function ze(Te,je,Ie,Je){var gt=je!==null?je.key:null;if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number"||typeof Ie=="bigint")return gt!==null?null:X(Te,je,""+Ie,Je);if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case b:return Ie.key===gt?ge(Te,je,Ie,Je):null;case v:return Ie.key===gt?Le(Te,je,Ie,Je):null;case F:return gt=Ie._init,Ie=gt(Ie._payload),ze(Te,je,Ie,Je)}if(G(Ie)||Y(Ie))return gt!==null?null:Qe(Te,je,Ie,Je,null);if(typeof Ie.then=="function")return ze(Te,je,_f(Ie),Je);if(Ie.$$typeof===I)return ze(Te,je,of(Te,Ie),Je);Rl(Te,Ie)}return null}function $e(Te,je,Ie,Je,gt){if(typeof Je=="string"&&Je!==""||typeof Je=="number"||typeof Je=="bigint")return Te=Te.get(Ie)||null,X(je,Te,""+Je,gt);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case b:return Te=Te.get(Je.key===null?Ie:Je.key)||null,ge(je,Te,Je,gt);case v:return Te=Te.get(Je.key===null?Ie:Je.key)||null,Le(je,Te,Je,gt);case F:var Zt=Je._init;return Je=Zt(Je._payload),$e(Te,je,Ie,Je,gt)}if(G(Je)||Y(Je))return Te=Te.get(Ie)||null,Qe(je,Te,Je,gt,null);if(typeof Je.then=="function")return $e(Te,je,Ie,_f(Je),gt);if(Je.$$typeof===I)return $e(Te,je,Ie,of(je,Je),gt);Rl(je,Je)}return null}function At(Te,je,Ie,Je){for(var gt=null,Zt=null,xt=je,Pt=je=0,Ai=null;xt!==null&&Pt<Ie.length;Pt++){xt.index>Pt?(Ai=xt,xt=null):Ai=xt.sibling;var xn=ze(Te,xt,Ie[Pt],Je);if(xn===null){xt===null&&(xt=Ai);break}s&&xt&&xn.alternate===null&&c(Te,xt),je=E(xn,je,Pt),Zt===null?gt=xn:Zt.sibling=xn,Zt=xn,xt=Ai}if(Pt===Ie.length)return h(Te,xt),an&&Cl(Te,Pt),gt;if(xt===null){for(;Pt<Ie.length;Pt++)xt=Xe(Te,Ie[Pt],Je),xt!==null&&(je=E(xt,je,Pt),Zt===null?gt=xt:Zt.sibling=xt,Zt=xt);return an&&Cl(Te,Pt),gt}for(xt=x(xt);Pt<Ie.length;Pt++)Ai=$e(xt,Te,Pt,Ie[Pt],Je),Ai!==null&&(s&&Ai.alternate!==null&&xt.delete(Ai.key===null?Pt:Ai.key),je=E(Ai,je,Pt),Zt===null?gt=Ai:Zt.sibling=Ai,Zt=Ai);return s&&xt.forEach(function(zo){return c(Te,zo)}),an&&Cl(Te,Pt),gt}function Tt(Te,je,Ie,Je){if(Ie==null)throw Error(i(151));for(var gt=null,Zt=null,xt=je,Pt=je=0,Ai=null,xn=Ie.next();xt!==null&&!xn.done;Pt++,xn=Ie.next()){xt.index>Pt?(Ai=xt,xt=null):Ai=xt.sibling;var zo=ze(Te,xt,xn.value,Je);if(zo===null){xt===null&&(xt=Ai);break}s&&xt&&zo.alternate===null&&c(Te,xt),je=E(zo,je,Pt),Zt===null?gt=zo:Zt.sibling=zo,Zt=zo,xt=Ai}if(xn.done)return h(Te,xt),an&&Cl(Te,Pt),gt;if(xt===null){for(;!xn.done;Pt++,xn=Ie.next())xn=Xe(Te,xn.value,Je),xn!==null&&(je=E(xn,je,Pt),Zt===null?gt=xn:Zt.sibling=xn,Zt=xn);return an&&Cl(Te,Pt),gt}for(xt=x(xt);!xn.done;Pt++,xn=Ie.next())xn=$e(xt,Te,Pt,xn.value,Je),xn!==null&&(s&&xn.alternate!==null&&xt.delete(xn.key===null?Pt:xn.key),je=E(xn,je,Pt),Zt===null?gt=xn:Zt.sibling=xn,Zt=xn);return s&&xt.forEach(function(Rv){return c(Te,Rv)}),an&&Cl(Te,Pt),gt}function Rn(Te,je,Ie,Je){if(typeof Ie=="object"&&Ie!==null&&Ie.type===S&&Ie.key===null&&(Ie=Ie.props.children),typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case b:e:{for(var gt=Ie.key;je!==null;){if(je.key===gt){if(gt=Ie.type,gt===S){if(je.tag===7){h(Te,je.sibling),Je=N(je,Ie.props.children),Je.return=Te,Te=Je;break e}}else if(je.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===F&&Ml(gt)===je.type){h(Te,je.sibling),Je=N(je,Ie.props),Ju(Je,Ie),Je.return=Te,Te=Je;break e}h(Te,je);break}else c(Te,je);je=je.sibling}Ie.type===S?(Je=Nl(Ie.props.children,Te.mode,Je,Ie.key),Je.return=Te,Te=Je):(Je=rf(Ie.type,Ie.key,Ie.props,null,Te.mode,Je),Ju(Je,Ie),Je.return=Te,Te=Je)}return q(Te);case v:e:{for(gt=Ie.key;je!==null;){if(je.key===gt)if(je.tag===4&&je.stateNode.containerInfo===Ie.containerInfo&&je.stateNode.implementation===Ie.implementation){h(Te,je.sibling),Je=N(je,Ie.children||[]),Je.return=Te,Te=Je;break e}else{h(Te,je);break}else c(Te,je);je=je.sibling}Je=Sc(Ie,Te.mode,Je),Je.return=Te,Te=Je}return q(Te);case F:return gt=Ie._init,Ie=gt(Ie._payload),Rn(Te,je,Ie,Je)}if(G(Ie))return At(Te,je,Ie,Je);if(Y(Ie)){if(gt=Y(Ie),typeof gt!="function")throw Error(i(150));return Ie=gt.call(Ie),Tt(Te,je,Ie,Je)}if(typeof Ie.then=="function")return Rn(Te,je,_f(Ie),Je);if(Ie.$$typeof===I)return Rn(Te,je,of(Te,Ie),Je);Rl(Te,Ie)}return typeof Ie=="string"&&Ie!==""||typeof Ie=="number"||typeof Ie=="bigint"?(Ie=""+Ie,je!==null&&je.tag===6?(h(Te,je.sibling),Je=N(je,Ie),Je.return=Te,Te=Je):(h(Te,je),Je=ip(Ie,Te.mode,Je),Je.return=Te,Te=Je),q(Te)):h(Te,je)}return function(Te,je,Ie,Je){try{mr=0;var gt=Rn(Te,je,Ie,Je);return vi=null,gt}catch(xt){if(xt===nr||xt===cf)throw xt;var Zt=cr(29,xt,null,Te.mode);return Zt.lanes=Je,Zt.return=Te,Zt}finally{}}}var Ol=Pp(!0),Ug=Pp(!1),Rr=ce(null),ir=null;function Zr(s){var c=s.alternate;D(li,li.current&1),D(Rr,s),ir===null&&(c===null||El.current!==null||c.memoizedState!==null)&&(ir=s)}function Bg(s){if(s.tag===22){if(D(li,li.current),D(Rr,s),ir===null){var c=s.alternate;c!==null&&c.memoizedState!==null&&(ir=s)}}else As()}function As(){D(li,li.current),D(Rr,Rr.current)}function Ja(s){se(Rr),ir===s&&(ir=null),se(li)}var li=ce(0);function Ku(s){for(var c=s;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||ar(h)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function Pc(s,c,h,x){c=s.memoizedState,h=h(x,c),h=h==null?c:p({},c,h),s.memoizedState=h,s.lanes===0&&(s.updateQueue.baseState=h)}var Xu={enqueueSetState:function(s,c,h){s=s._reactInternals;var x=Vi(),N=wo(x);N.payload=c,h!=null&&(N.callback=h),c=_s(s,N,x),c!==null&&(Lr(c,s,x),Ou(c,s,x))},enqueueReplaceState:function(s,c,h){s=s._reactInternals;var x=Vi(),N=wo(x);N.tag=1,N.payload=c,h!=null&&(N.callback=h),c=_s(s,N,x),c!==null&&(Lr(c,s,x),Ou(c,s,x))},enqueueForceUpdate:function(s,c){s=s._reactInternals;var h=Vi(),x=wo(h);x.tag=2,c!=null&&(x.callback=c),c=_s(s,x,h),c!==null&&(Lr(c,s,h),Ou(c,s,h))}};function Zu(s,c,h,x,N,E,q){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(x,E,q):c.prototype&&c.prototype.isPureReactComponent?!Yr(h,x)||!Yr(N,E):!0}function qg(s,c,h,x){s=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,x),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,x),c.state!==s&&Xu.enqueueReplaceState(c,c.state,null)}function jo(s,c){var h=c;if("ref"in c){h={};for(var x in c)x!=="ref"&&(h[x]=c[x])}if(s=s.defaultProps){h===c&&(h=p({},h));for(var N in s)h[N]===void 0&&(h[N]=s[N])}return h}var Ll=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Dp(s){Ll(s)}function kf(s){console.error(s)}function Vg(s){Ll(s)}function ed(s,c){try{var h=s.onUncaughtError;h(c.value,{componentStack:c.stack})}catch(x){setTimeout(function(){throw x})}}function Ka(s,c,h){try{var x=s.onCaughtError;x(h.value,{componentStack:h.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function Tf(s,c,h){return h=wo(h),h.tag=3,h.payload={element:null},h.callback=function(){ed(s,c)},h}function Ip(s){return s=wo(s),s.tag=3,s}function Hg(s,c,h,x){var N=h.type.getDerivedStateFromError;if(typeof N=="function"){var E=x.value;s.payload=function(){return N(E)},s.callback=function(){Ka(c,h,x)}}var q=h.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(s.callback=function(){Ka(c,h,x),typeof N!="function"&&(Po===null?Po=new Set([this]):Po.add(this));var X=x.stack;this.componentDidCatch(x.value,{componentStack:X!==null?X:""})})}function Gg(s,c,h,x,N){if(h.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(c=h.alternate,c!==null&&Iu(c,h,N,!0),h=Rr.current,h!==null){switch(h.tag){case 13:return ir===null?Xp():h.alternate===null&&ci===0&&(ci=3),h.flags&=-257,h.flags|=65536,h.lanes=N,x===lp?h.flags|=16384:(c=h.updateQueue,c===null?h.updateQueue=new Set([x]):c.add(x),tm(s,x,N)),!1;case 22:return h.flags|=65536,x===lp?h.flags|=16384:(c=h.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([x])},h.updateQueue=c):(h=c.retryQueue,h===null?c.retryQueue=new Set([x]):h.add(x)),tm(s,x,N)),!1}throw Error(i(435,h.tag))}return tm(s,x,N),Xp(),!1}if(an)return c=Rr.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=N,x!==Nc&&(s=Error(i(422),{cause:x}),bo(we(s,h)))):(x!==Nc&&(c=Error(i(423),{cause:x}),bo(we(c,h))),s=s.current.alternate,s.flags|=65536,N&=-N,s.lanes|=N,x=we(x,h),N=Tf(s.stateNode,x,N),va(s,N),ci!==4&&(ci=2)),!1;var E=Error(i(520),{cause:x});if(E=we(E,h),ud===null?ud=[E]:ud.push(E),ci!==4&&(ci=2),c===null)return!0;x=we(x,h),h=c;do{switch(h.tag){case 3:return h.flags|=65536,s=N&-N,h.lanes|=s,s=Tf(h.stateNode,x,s),va(h,s),!1;case 1:if(c=h.type,E=h.stateNode,(h.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Po===null||!Po.has(E))))return h.flags|=65536,N&=-N,h.lanes|=N,N=Ip(N),Hg(N,s,h,x),va(h,N),!1}h=h.return}while(h!==null);return!1}var Yg=Error(i(461)),ki=!1;function Yn(s,c,h,x){c.child=s===null?Ug(c,null,h,x):Ol(c,s.child,h,x)}function Ef(s,c,h,x,N){h=h.render;var E=c.ref;if("ref"in x){var q={};for(var X in x)X!=="ref"&&(q[X]=x[X])}else q=x;return _l(c),x=fp(s,c,h,q,E,N),X=pp(),s!==null&&!ki?(Pl(s,c,N),Ps(s,c,N)):(an&&X&&ap(c),c.flags|=1,Yn(s,c,x,N),c.child)}function Af(s,c,h,x,N){if(s===null){var E=h.type;return typeof E=="function"&&!Sl(E)&&E.defaultProps===void 0&&h.compare===null?(c.tag=15,c.type=E,Pf(s,c,E,x,N)):(s=rf(h.type,null,x,c,c.mode,N),s.ref=c.ref,s.return=c,c.child=s)}if(E=s.child,!Na(s,N)){var q=E.memoizedProps;if(h=h.compare,h=h!==null?h:Yr,h(q,x)&&s.ref===c.ref)return Ps(s,c,N)}return c.flags|=1,s=tr(E,x),s.ref=c.ref,s.return=c,c.child=s}function Pf(s,c,h,x,N){if(s!==null){var E=s.memoizedProps;if(Yr(E,x)&&s.ref===c.ref)if(ki=!1,c.pendingProps=x=E,Na(s,N))(s.flags&131072)!==0&&(ki=!0);else return c.lanes=s.lanes,Ps(s,c,N)}return Dc(s,c,h,x,N)}function td(s,c,h){var x=c.pendingProps,N=x.children,E=s!==null?s.memoizedState:null;if(x.mode==="hidden"){if((c.flags&128)!==0){if(x=E!==null?E.baseLanes|h:h,s!==null){for(N=c.child=s.child,E=0;N!==null;)E=E|N.lanes|N.childLanes,N=N.sibling;c.childLanes=E&~x}else c.childLanes=0,c.child=null;return Fl(s,c,x,h)}if((h&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},s!==null&&lf(c,E!==null?E.cachePool:null),E!==null?ks(c,E):df(),Bg(c);else return c.lanes=c.childLanes=536870912,Fl(s,c,E!==null?E.baseLanes|h:h,h)}else E!==null?(lf(c,E.cachePool),ks(c,E),As(),c.memoizedState=null):(s!==null&&lf(c,null),df(),As());return Yn(s,c,N,h),c.child}function Fl(s,c,h,x){var N=js();return N=N===null?null:{parent:On._currentValue,pool:N},c.memoizedState={baseLanes:h,cachePool:N},s!==null&&lf(c,null),df(),Bg(c),s!==null&&Iu(s,c,x,!0),null}function St(s,c){var h=c.ref;if(h===null)s!==null&&s.ref!==null&&(c.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(i(284));(s===null||s.ref!==h)&&(c.flags|=4194816)}}function Dc(s,c,h,x,N){return _l(c),h=fp(s,c,h,x,void 0,N),x=pp(),s!==null&&!ki?(Pl(s,c,N),Ps(s,c,N)):(an&&x&&ap(c),c.flags|=1,Yn(s,c,h,N),c.child)}function Df(s,c,h,x,N,E){return _l(c),c.updateQueue=null,h=Tg(c,x,h,N),kg(s),x=pp(),s!==null&&!ki?(Pl(s,c,E),Ps(s,c,E)):(an&&x&&ap(c),c.flags|=1,Yn(s,c,h,E),c.child)}function _o(s,c,h,x,N){if(_l(c),c.stateNode===null){var E=wl,q=h.contextType;typeof q=="object"&&q!==null&&(E=oi(q)),E=new h(x,E),c.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=Xu,c.stateNode=E,E._reactInternals=c,E=c.stateNode,E.props=x,E.state=c.memoizedState,E.refs={},Tl(c),q=h.contextType,E.context=typeof q=="object"&&q!==null?oi(q):wl,E.state=c.memoizedState,q=h.getDerivedStateFromProps,typeof q=="function"&&(Pc(c,h,q,x),E.state=c.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(q=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),q!==E.state&&Xu.enqueueReplaceState(E,E.state,null),Ui(c,x,E,N),wa(),E.state=c.memoizedState),typeof E.componentDidMount=="function"&&(c.flags|=4194308),x=!0}else if(s===null){E=c.stateNode;var X=c.memoizedProps,ge=jo(h,X);E.props=ge;var Le=E.context,Qe=h.contextType;q=wl,typeof Qe=="object"&&Qe!==null&&(q=oi(Qe));var Xe=h.getDerivedStateFromProps;Qe=typeof Xe=="function"||typeof E.getSnapshotBeforeUpdate=="function",X=c.pendingProps!==X,Qe||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(X||Le!==q)&&qg(c,E,x,q),Wa=!1;var ze=c.memoizedState;E.state=ze,Ui(c,x,E,N),wa(),Le=c.memoizedState,X||ze!==Le||Wa?(typeof Xe=="function"&&(Pc(c,h,Xe,x),Le=c.memoizedState),(ge=Wa||Zu(c,h,ge,x,ze,Le,q))?(Qe||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(c.flags|=4194308)):(typeof E.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=x,c.memoizedState=Le),E.props=x,E.state=Le,E.context=q,x=ge):(typeof E.componentDidMount=="function"&&(c.flags|=4194308),x=!1)}else{E=c.stateNode,_c(s,c),q=c.memoizedProps,Qe=jo(h,q),E.props=Qe,Xe=c.pendingProps,ze=E.context,Le=h.contextType,ge=wl,typeof Le=="object"&&Le!==null&&(ge=oi(Le)),X=h.getDerivedStateFromProps,(Le=typeof X=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(q!==Xe||ze!==ge)&&qg(c,E,x,ge),Wa=!1,ze=c.memoizedState,E.state=ze,Ui(c,x,E,N),wa();var $e=c.memoizedState;q!==Xe||ze!==$e||Wa||s!==null&&s.dependencies!==null&&sf(s.dependencies)?(typeof X=="function"&&(Pc(c,h,X,x),$e=c.memoizedState),(Qe=Wa||Zu(c,h,Qe,x,ze,$e,ge)||s!==null&&s.dependencies!==null&&sf(s.dependencies))?(Le||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(x,$e,ge),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(x,$e,ge)),typeof E.componentDidUpdate=="function"&&(c.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof E.componentDidUpdate!="function"||q===s.memoizedProps&&ze===s.memoizedState||(c.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||q===s.memoizedProps&&ze===s.memoizedState||(c.flags|=1024),c.memoizedProps=x,c.memoizedState=$e),E.props=x,E.state=$e,E.context=ge,x=Qe):(typeof E.componentDidUpdate!="function"||q===s.memoizedProps&&ze===s.memoizedState||(c.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||q===s.memoizedProps&&ze===s.memoizedState||(c.flags|=1024),x=!1)}return E=x,St(s,c),x=(c.flags&128)!==0,E||x?(E=c.stateNode,h=x&&typeof h.getDerivedStateFromError!="function"?null:E.render(),c.flags|=1,s!==null&&x?(c.child=Ol(c,s.child,null,N),c.child=Ol(c,null,h,N)):Yn(s,c,h,N),c.memoizedState=E.state,s=c.child):s=Ps(s,c,N),s}function Wg(s,c,h,x){return Du(),c.flags|=256,Yn(s,c,h,x),c.child}var nd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function If(s){return{baseLanes:s,cachePool:vg()}}function Ti(s,c,h){return s=s!==null?s.childLanes&~h:0,c&&(s|=ta),s}function Qg(s,c,h){var x=c.pendingProps,N=!1,E=(c.flags&128)!==0,q;if((q=E)||(q=s!==null&&s.memoizedState===null?!1:(li.current&2)!==0),q&&(N=!0,c.flags&=-129),q=(c.flags&32)!==0,c.flags&=-33,s===null){if(an){if(N?Zr(c):As(),an){var X=Zn,ge;if(ge=X){e:{for(ge=X,X=ur;ge.nodeType!==8;){if(!X){X=null;break e}if(ge=ja(ge.nextSibling),ge===null){X=null;break e}}X=ge}X!==null?(c.memoizedState={dehydrated:X,treeContext:Gn!==null?{id:Xn,overflow:Cs}:null,retryLane:536870912,hydrationErrors:null},ge=cr(18,null,null,0),ge.stateNode=X,ge.return=c,c.child=ge,bi=c,Zn=null,ge=!0):ge=!1}ge||Jr(c)}if(X=c.memoizedState,X!==null&&(X=X.dehydrated,X!==null))return ar(X)?c.lanes=32:c.lanes=536870912,null;Ja(c)}return X=x.children,x=x.fallback,N?(As(),N=c.mode,X=id({mode:"hidden",children:X},N),x=Nl(x,N,h,null),X.return=c,x.return=c,X.sibling=x,c.child=X,N=c.child,N.memoizedState=If(h),N.childLanes=Ti(s,q,h),c.memoizedState=nd,x):(Zr(c),Rp(c,X))}if(ge=s.memoizedState,ge!==null&&(X=ge.dehydrated,X!==null)){if(E)c.flags&256?(Zr(c),c.flags&=-257,c=Mp(s,c,h)):c.memoizedState!==null?(As(),c.child=s.child,c.flags|=128,c=null):(As(),N=x.fallback,X=c.mode,x=id({mode:"visible",children:x.children},X),N=Nl(N,X,h,null),N.flags|=2,x.return=c,N.return=c,x.sibling=N,c.child=x,Ol(c,s.child,null,h),x=c.child,x.memoizedState=If(h),x.childLanes=Ti(s,q,h),c.memoizedState=nd,c=N);else if(Zr(c),ar(X)){if(q=X.nextSibling&&X.nextSibling.dataset,q)var Le=q.dgst;q=Le,x=Error(i(419)),x.stack="",x.digest=q,bo({value:x,source:null,stack:null}),c=Mp(s,c,h)}else if(ki||Iu(s,c,h,!1),q=(h&s.childLanes)!==0,ki||q){if(q=Vn,q!==null&&(x=h&-h,x=(x&42)!==0?1:Dn(x),x=(x&(q.suspendedLanes|h))!==0?0:x,x!==0&&x!==ge.retryLane))throw ge.retryLane=x,Ss(s,x),Lr(q,s,x),Yg;X.data==="$?"||Xp(),c=Mp(s,c,h)}else X.data==="$?"?(c.flags|=192,c.child=s.child,c=null):(s=ge.treeContext,Zn=ja(X.nextSibling),bi=c,an=!0,ba=null,ur=!1,s!==null&&(Wr[Qr++]=Xn,Wr[Qr++]=Cs,Wr[Qr++]=Gn,Xn=s.id,Cs=s.overflow,Gn=c),c=Rp(c,x.children),c.flags|=4096);return c}return N?(As(),N=x.fallback,X=c.mode,ge=s.child,Le=ge.sibling,x=tr(ge,{mode:"hidden",children:x.children}),x.subtreeFlags=ge.subtreeFlags&65011712,Le!==null?N=tr(Le,N):(N=Nl(N,X,h,null),N.flags|=2),N.return=c,x.return=c,x.sibling=N,c.child=x,x=N,N=c.child,X=s.child.memoizedState,X===null?X=If(h):(ge=X.cachePool,ge!==null?(Le=On._currentValue,ge=ge.parent!==Le?{parent:Le,pool:Le}:ge):ge=vg(),X={baseLanes:X.baseLanes|h,cachePool:ge}),N.memoizedState=X,N.childLanes=Ti(s,q,h),c.memoizedState=nd,x):(Zr(c),h=s.child,s=h.sibling,h=tr(h,{mode:"visible",children:x.children}),h.return=c,h.sibling=null,s!==null&&(q=c.deletions,q===null?(c.deletions=[s],c.flags|=16):q.push(s)),c.child=h,c.memoizedState=null,h)}function Rp(s,c){return c=id({mode:"visible",children:c},s.mode),c.return=s,s.child=c}function id(s,c){return s=cr(22,s,null,c),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Mp(s,c,h){return Ol(c,s.child,null,h),s=Rp(c,c.pendingProps.children),s.flags|=2,c.memoizedState=null,s}function Op(s,c,h){s.lanes|=c;var x=s.alternate;x!==null&&(x.lanes|=c),dr(s.return,c,h)}function Lp(s,c,h,x,N){var E=s.memoizedState;E===null?s.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:x,tail:h,tailMode:N}:(E.isBackwards=c,E.rendering=null,E.renderingStartTime=0,E.last=x,E.tail=h,E.tailMode=N)}function Jg(s,c,h){var x=c.pendingProps,N=x.revealOrder,E=x.tail;if(Yn(s,c,x.children,h),x=li.current,(x&2)!==0)x=x&1|2,c.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=c.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Op(s,h,c);else if(s.tag===19)Op(s,h,c);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===c)break e;for(;s.sibling===null;){if(s.return===null||s.return===c)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}x&=1}switch(D(li,x),N){case"forwards":for(h=c.child,N=null;h!==null;)s=h.alternate,s!==null&&Ku(s)===null&&(N=h),h=h.sibling;h=N,h===null?(N=c.child,c.child=null):(N=h.sibling,h.sibling=null),Lp(c,!1,N,h,E);break;case"backwards":for(h=null,N=c.child,c.child=null;N!==null;){if(s=N.alternate,s!==null&&Ku(s)===null){c.child=N;break}s=N.sibling,N.sibling=h,h=N,N=s}Lp(c,!0,h,null,E);break;case"together":Lp(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Ps(s,c,h){if(s!==null&&(c.dependencies=s.dependencies),Ao|=c.lanes,(h&c.childLanes)===0)if(s!==null){if(Iu(s,c,h,!1),(h&c.childLanes)===0)return null}else return null;if(s!==null&&c.child!==s.child)throw Error(i(153));if(c.child!==null){for(s=c.child,h=tr(s,s.pendingProps),c.child=h,h.return=c;s.sibling!==null;)s=s.sibling,h=h.sibling=tr(s,s.pendingProps),h.return=c;h.sibling=null}return c.child}function Na(s,c){return(s.lanes&c)!==0?!0:(s=s.dependencies,!!(s!==null&&sf(s)))}function rr(s,c,h){switch(c.tag){case 3:ae(c,c.stateNode.containerInfo),Dr(c,On,s.memoizedState.cache),Du();break;case 27:case 5:Ae(c);break;case 4:ae(c,c.stateNode.containerInfo);break;case 10:Dr(c,c.type,c.memoizedProps.value);break;case 13:var x=c.memoizedState;if(x!==null)return x.dehydrated!==null?(Zr(c),c.flags|=128,null):(h&c.child.childLanes)!==0?Qg(s,c,h):(Zr(c),s=Ps(s,c,h),s!==null?s.sibling:null);Zr(c);break;case 19:var N=(s.flags&128)!==0;if(x=(h&c.childLanes)!==0,x||(Iu(s,c,h,!1),x=(h&c.childLanes)!==0),N){if(x)return Jg(s,c,h);c.flags|=128}if(N=c.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),D(li,li.current),x)break;return null;case 22:case 23:return c.lanes=0,td(s,c,h);case 24:Dr(c,On,s.memoizedState.cache)}return Ps(s,c,h)}function Rf(s,c,h){if(s!==null)if(s.memoizedProps!==c.pendingProps)ki=!0;else{if(!Na(s,h)&&(c.flags&128)===0)return ki=!1,rr(s,c,h);ki=(s.flags&131072)!==0}else ki=!1,an&&(c.flags&1048576)!==0&&rp(c,Eu,c.index);switch(c.lanes=0,c.tag){case 16:e:{s=c.pendingProps;var x=c.elementType,N=x._init;if(x=N(x._payload),c.type=x,typeof x=="function")Sl(x)?(s=jo(x,s),c.tag=1,c=_o(null,c,x,s,h)):(c.tag=0,c=Dc(null,c,x,s,h));else{if(x!=null){if(N=x.$$typeof,N===U){c.tag=11,c=Ef(null,c,x,s,h);break e}else if(N===z){c.tag=14,c=Af(null,c,x,s,h);break e}}throw c=ne(x)||x,Error(i(306,c,""))}}return c;case 0:return Dc(s,c,c.type,c.pendingProps,h);case 1:return x=c.type,N=jo(x,c.pendingProps),_o(s,c,x,N,h);case 3:e:{if(ae(c,c.stateNode.containerInfo),s===null)throw Error(i(387));x=c.pendingProps;var E=c.memoizedState;N=E.element,_c(s,c),Ui(c,x,null,h);var q=c.memoizedState;if(x=q.cache,Dr(c,On,x),x!==E.cache&&Xt(c,[On],h,!0),wa(),x=q.element,E.isDehydrated)if(E={element:x,isDehydrated:!1,cache:q.cache},c.updateQueue.baseState=E,c.memoizedState=E,c.flags&256){c=Wg(s,c,x,h);break e}else if(x!==N){N=we(Error(i(424)),c),bo(N),c=Wg(s,c,x,h);break e}else{switch(s=c.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Zn=ja(s.firstChild),bi=c,an=!0,ba=null,ur=!0,h=Ug(c,null,x,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(Du(),x===N){c=Ps(s,c,h);break e}Yn(s,c,x,h)}c=c.child}return c;case 26:return St(s,c),s===null?(h=Gy(c.type,null,c.pendingProps,null))?c.memoizedState=h:an||(h=c.type,s=c.pendingProps,x=Ul(Z.current).createElement(h),x[zn]=c,x[Ri]=s,Ni(x,h,s),pi(x),c.stateNode=x):c.memoizedState=Gy(c.type,s.memoizedProps,c.pendingProps,s.memoizedState),null;case 27:return Ae(c),s===null&&an&&(x=c.stateNode=qy(c.type,c.pendingProps,Z.current),bi=c,ur=!0,N=Zn,na(c.type)?(um=N,Zn=ja(x.firstChild)):Zn=N),Yn(s,c,c.pendingProps.children,h),St(s,c),s===null&&(c.flags|=4194304),c.child;case 5:return s===null&&an&&((N=x=Zn)&&(x=Uy(x,c.type,c.pendingProps,ur),x!==null?(c.stateNode=x,bi=c,Zn=ja(x.firstChild),ur=!1,N=!0):N=!1),N||Jr(c)),Ae(c),N=c.type,E=c.pendingProps,q=s!==null?s.memoizedProps:null,x=E.children,Kf(N,E)?x=null:q!==null&&Kf(N,q)&&(c.flags|=32),c.memoizedState!==null&&(N=fp(s,c,hp,null,null,h),Kc._currentValue=N),St(s,c),Yn(s,c,x,h),c.child;case 6:return s===null&&an&&((s=h=Zn)&&(h=Zf(h,c.pendingProps,ur),h!==null?(c.stateNode=h,bi=c,Zn=null,s=!0):s=!1),s||Jr(c)),null;case 13:return Qg(s,c,h);case 4:return ae(c,c.stateNode.containerInfo),x=c.pendingProps,s===null?c.child=Ol(c,null,x,h):Yn(s,c,x,h),c.child;case 11:return Ef(s,c,c.type,c.pendingProps,h);case 7:return Yn(s,c,c.pendingProps,h),c.child;case 8:return Yn(s,c,c.pendingProps.children,h),c.child;case 12:return Yn(s,c,c.pendingProps.children,h),c.child;case 10:return x=c.pendingProps,Dr(c,c.type,x.value),Yn(s,c,x.children,h),c.child;case 9:return N=c.type._context,x=c.pendingProps.children,_l(c),N=oi(N),x=x(N),c.flags|=1,Yn(s,c,x,h),c.child;case 14:return Af(s,c,c.type,c.pendingProps,h);case 15:return Pf(s,c,c.type,c.pendingProps,h);case 19:return Jg(s,c,h);case 31:return x=c.pendingProps,h=c.mode,x={mode:x.mode,children:x.children},s===null?(h=id(x,h),h.ref=c.ref,c.child=h,h.return=c,c=h):(h=tr(s.child,x),h.ref=c.ref,c.child=h,h.return=c,c=h),c;case 22:return td(s,c,h);case 24:return _l(c),x=oi(On),s===null?(N=js(),N===null&&(N=Vn,E=sp(),N.pooledCache=E,E.refCount++,E!==null&&(N.pooledCacheLanes|=h),N=E),c.memoizedState={parent:x,cache:N},Tl(c),Dr(c,On,N)):((s.lanes&h)!==0&&(_c(s,c),Ui(c,null,null,h),wa()),N=s.memoizedState,E=c.memoizedState,N.parent!==x?(N={parent:x,cache:x},c.memoizedState=N,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=N),Dr(c,On,x)):(x=E.cache,Dr(c,On,x),x!==N.cache&&Xt(c,[On],h,!0))),Yn(s,c,c.pendingProps.children,h),c.child;case 29:throw c.pendingProps}throw Error(i(156,c.tag))}function Ds(s){s.flags|=4}function Mf(s,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Ci(c)){if(c=Rr.current,c!==null&&((pn&4194048)===pn?ir!==null:(pn&62914560)!==pn&&(pn&536870912)===0||c!==ir))throw jc=lp,wg;s.flags|=8192}}function Of(s,c){c!==null&&(s.flags|=4),s.flags&16384&&(c=s.tag!==22?Kn():536870912,s.lanes|=c,$c|=c)}function rd(s,c){if(!an)switch(s.tailMode){case"hidden":c=s.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?s.tail=null:h.sibling=null;break;case"collapsed":h=s.tail;for(var x=null;h!==null;)h.alternate!==null&&(x=h),h=h.sibling;x===null?c||s.tail===null?s.tail=null:s.tail.sibling=null:x.sibling=null}}function Ln(s){var c=s.alternate!==null&&s.alternate.child===s.child,h=0,x=0;if(c)for(var N=s.child;N!==null;)h|=N.lanes|N.childLanes,x|=N.subtreeFlags&65011712,x|=N.flags&65011712,N.return=s,N=N.sibling;else for(N=s.child;N!==null;)h|=N.lanes|N.childLanes,x|=N.subtreeFlags,x|=N.flags,N.return=s,N=N.sibling;return s.subtreeFlags|=x,s.childLanes=h,c}function Kg(s,c,h){var x=c.pendingProps;switch(Au(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ln(c),null;case 1:return Ln(c),null;case 3:return h=c.stateNode,x=null,s!==null&&(x=s.memoizedState.cache),c.memoizedState.cache!==x&&(c.flags|=2048),Kr(On),Re(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(s===null||s.child===null)&&(Pu(c)?Ds(c):s===null||s.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,gg())),Ln(c),null;case 26:return h=c.memoizedState,s===null?(Ds(c),h!==null?(Ln(c),Mf(c,h)):(Ln(c),c.flags&=-16777217)):h?h!==s.memoizedState?(Ds(c),Ln(c),Mf(c,h)):(Ln(c),c.flags&=-16777217):(s.memoizedProps!==x&&Ds(c),Ln(c),c.flags&=-16777217),null;case 27:Ce(c),h=Z.current;var N=c.type;if(s!==null&&c.stateNode!=null)s.memoizedProps!==x&&Ds(c);else{if(!x){if(c.stateNode===null)throw Error(i(166));return Ln(c),null}s=oe.current,Pu(c)?pg(c):(s=qy(N,x,h),c.stateNode=s,Ds(c))}return Ln(c),null;case 5:if(Ce(c),h=c.type,s!==null&&c.stateNode!=null)s.memoizedProps!==x&&Ds(c);else{if(!x){if(c.stateNode===null)throw Error(i(166));return Ln(c),null}if(s=oe.current,Pu(c))pg(c);else{switch(N=Ul(Z.current),s){case 1:s=N.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:s=N.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":s=N.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":s=N.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":s=N.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof x.is=="string"?N.createElement("select",{is:x.is}):N.createElement("select"),x.multiple?s.multiple=!0:x.size&&(s.size=x.size);break;default:s=typeof x.is=="string"?N.createElement(h,{is:x.is}):N.createElement(h)}}s[zn]=c,s[Ri]=x;e:for(N=c.child;N!==null;){if(N.tag===5||N.tag===6)s.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===c)break e;for(;N.sibling===null;){if(N.return===null||N.return===c)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}c.stateNode=s;e:switch(Ni(s,h,x),h){case"button":case"input":case"select":case"textarea":s=!!x.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Ds(c)}}return Ln(c),c.flags&=-16777217,null;case 6:if(s&&c.stateNode!=null)s.memoizedProps!==x&&Ds(c);else{if(typeof x!="string"&&c.stateNode===null)throw Error(i(166));if(s=Z.current,Pu(c)){if(s=c.stateNode,h=c.memoizedProps,x=null,N=bi,N!==null)switch(N.tag){case 27:case 5:x=N.memoizedProps}s[zn]=c,s=!!(s.nodeValue===h||x!==null&&x.suppressHydrationWarning===!0||Ly(s.nodeValue,h)),s||Jr(c)}else s=Ul(s).createTextNode(x),s[zn]=c,c.stateNode=s}return Ln(c),null;case 13:if(x=c.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(N=Pu(c),x!==null&&x.dehydrated!==null){if(s===null){if(!N)throw Error(i(318));if(N=c.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(i(317));N[zn]=c}else Du(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Ln(c),N=!1}else N=gg(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=N),N=!0;if(!N)return c.flags&256?(Ja(c),c):(Ja(c),null)}if(Ja(c),(c.flags&128)!==0)return c.lanes=h,c;if(h=x!==null,s=s!==null&&s.memoizedState!==null,h){x=c.child,N=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(N=x.alternate.memoizedState.cachePool.pool);var E=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(E=x.memoizedState.cachePool.pool),E!==N&&(x.flags|=2048)}return h!==s&&h&&(c.child.flags|=8192),Of(c,c.updateQueue),Ln(c),null;case 4:return Re(),s===null&&sm(c.stateNode.containerInfo),Ln(c),null;case 10:return Kr(c.type),Ln(c),null;case 19:if(se(li),N=c.memoizedState,N===null)return Ln(c),null;if(x=(c.flags&128)!==0,E=N.rendering,E===null)if(x)rd(N,!1);else{if(ci!==0||s!==null&&(s.flags&128)!==0)for(s=c.child;s!==null;){if(E=Ku(s),E!==null){for(c.flags|=128,rd(N,!1),s=E.updateQueue,c.updateQueue=s,Of(c,s),c.subtreeFlags=0,s=h,h=c.child;h!==null;)Tu(h,s),h=h.sibling;return D(li,li.current&1|2),c.child}s=s.sibling}N.tail!==null&&ut()>zc&&(c.flags|=128,x=!0,rd(N,!1),c.lanes=4194304)}else{if(!x)if(s=Ku(E),s!==null){if(c.flags|=128,x=!0,s=s.updateQueue,c.updateQueue=s,Of(c,s),rd(N,!0),N.tail===null&&N.tailMode==="hidden"&&!E.alternate&&!an)return Ln(c),null}else 2*ut()-N.renderingStartTime>zc&&h!==536870912&&(c.flags|=128,x=!0,rd(N,!1),c.lanes=4194304);N.isBackwards?(E.sibling=c.child,c.child=E):(s=N.last,s!==null?s.sibling=E:c.child=E,N.last=E)}return N.tail!==null?(c=N.tail,N.rendering=c,N.tail=c.sibling,N.renderingStartTime=ut(),c.sibling=null,s=li.current,D(li,x?s&1|2:s&1),c):(Ln(c),null);case 22:case 23:return Ja(c),dp(),x=c.memoizedState!==null,s!==null?s.memoizedState!==null!==x&&(c.flags|=8192):x&&(c.flags|=8192),x?(h&536870912)!==0&&(c.flags&128)===0&&(Ln(c),c.subtreeFlags&6&&(c.flags|=8192)):Ln(c),h=c.updateQueue,h!==null&&Of(c,h.retryQueue),h=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),x=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(x=c.memoizedState.cachePool.pool),x!==h&&(c.flags|=2048),s!==null&&se(kl),null;case 24:return h=null,s!==null&&(h=s.memoizedState.cache),c.memoizedState.cache!==h&&(c.flags|=2048),Kr(On),Ln(c),null;case 25:return null;case 30:return null}throw Error(i(156,c.tag))}function Xg(s,c){switch(Au(c),c.tag){case 1:return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 3:return Kr(On),Re(),s=c.flags,(s&65536)!==0&&(s&128)===0?(c.flags=s&-65537|128,c):null;case 26:case 27:case 5:return Ce(c),null;case 13:if(Ja(c),s=c.memoizedState,s!==null&&s.dehydrated!==null){if(c.alternate===null)throw Error(i(340));Du()}return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 19:return se(li),null;case 4:return Re(),null;case 10:return Kr(c.type),null;case 22:case 23:return Ja(c),dp(),s!==null&&se(kl),s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 24:return Kr(On),null;case 25:return null;default:return null}}function Zg(s,c){switch(Au(c),c.tag){case 3:Kr(On),Re();break;case 26:case 27:case 5:Ce(c);break;case 4:Re();break;case 13:Ja(c);break;case 19:se(li);break;case 10:Kr(c.type);break;case 22:case 23:Ja(c),dp(),s!==null&&se(kl);break;case 24:Kr(On)}}function ad(s,c){try{var h=c.updateQueue,x=h!==null?h.lastEffect:null;if(x!==null){var N=x.next;h=N;do{if((h.tag&s)===s){x=void 0;var E=h.create,q=h.inst;x=E(),q.destroy=x}h=h.next}while(h!==N)}}catch(X){Fn(c,c.return,X)}}function ko(s,c,h){try{var x=c.updateQueue,N=x!==null?x.lastEffect:null;if(N!==null){var E=N.next;x=E;do{if((x.tag&s)===s){var q=x.inst,X=q.destroy;if(X!==void 0){q.destroy=void 0,N=c;var ge=h,Le=X;try{Le()}catch(Qe){Fn(N,ge,Qe)}}}x=x.next}while(x!==E)}}catch(Qe){Fn(c,c.return,Qe)}}function ey(s){var c=s.updateQueue;if(c!==null){var h=s.stateNode;try{up(c,h)}catch(x){Fn(s,s.return,x)}}}function Fp(s,c,h){h.props=jo(s.type,s.memoizedProps),h.state=s.memoizedState;try{h.componentWillUnmount()}catch(x){Fn(s,c,x)}}function Ic(s,c){try{var h=s.ref;if(h!==null){switch(s.tag){case 26:case 27:case 5:var x=s.stateNode;break;case 30:x=s.stateNode;break;default:x=s.stateNode}typeof h=="function"?s.refCleanup=h(x):h.current=x}}catch(N){Fn(s,c,N)}}function Xa(s,c){var h=s.ref,x=s.refCleanup;if(h!==null)if(typeof x=="function")try{x()}catch(N){Fn(s,c,N)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(N){Fn(s,c,N)}else h.current=null}function Lf(s){var c=s.type,h=s.memoizedProps,x=s.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":h.autoFocus&&x.focus();break e;case"img":h.src?x.src=h.src:h.srcSet&&(x.srcset=h.srcSet)}}catch(N){Fn(s,s.return,N)}}function Ff(s,c,h){try{var x=s.stateNode;hv(x,s.type,h,c),x[Ri]=c}catch(N){Fn(s,s.return,N)}}function Rc(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&na(s.type)||s.tag===4}function sd(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Rc(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&na(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function $f(s,c,h){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(s,c):(c=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,c.appendChild(s),h=h._reactRootContainer,h!=null||c.onclick!==null||(c.onclick=Qf));else if(x!==4&&(x===27&&na(s.type)&&(h=s.stateNode,c=null),s=s.child,s!==null))for($f(s,c,h),s=s.sibling;s!==null;)$f(s,c,h),s=s.sibling}function od(s,c,h){var x=s.tag;if(x===5||x===6)s=s.stateNode,c?h.insertBefore(s,c):h.appendChild(s);else if(x!==4&&(x===27&&na(s.type)&&(h=s.stateNode),s=s.child,s!==null))for(od(s,c,h),s=s.sibling;s!==null;)od(s,c,h),s=s.sibling}function ld(s){var c=s.stateNode,h=s.memoizedProps;try{for(var x=s.type,N=c.attributes;N.length;)c.removeAttributeNode(N[0]);Ni(c,x,h),c[zn]=s,c[Ri]=h}catch(E){Fn(s,s.return,E)}}var Za=!1,Cn=!1,Is=!1,ty=typeof WeakSet=="function"?WeakSet:Set,wi=null;function Zb(s,c){if(s=s.containerInfo,Ca=ih,s=ef(s),vl(s)){if("selectionStart"in s)var h={start:s.selectionStart,end:s.selectionEnd};else e:{h=(h=s.ownerDocument)&&h.defaultView||window;var x=h.getSelection&&h.getSelection();if(x&&x.rangeCount!==0){h=x.anchorNode;var N=x.anchorOffset,E=x.focusNode;x=x.focusOffset;try{h.nodeType,E.nodeType}catch{h=null;break e}var q=0,X=-1,ge=-1,Le=0,Qe=0,Xe=s,ze=null;t:for(;;){for(var $e;Xe!==h||N!==0&&Xe.nodeType!==3||(X=q+N),Xe!==E||x!==0&&Xe.nodeType!==3||(ge=q+x),Xe.nodeType===3&&(q+=Xe.nodeValue.length),($e=Xe.firstChild)!==null;)ze=Xe,Xe=$e;for(;;){if(Xe===s)break t;if(ze===h&&++Le===N&&(X=q),ze===E&&++Qe===x&&(ge=q),($e=Xe.nextSibling)!==null)break;Xe=ze,ze=Xe.parentNode}Xe=$e}h=X===-1||ge===-1?null:{start:X,end:ge}}else h=null}h=h||{start:0,end:0}}else h=null;for(Jf={focusedElem:s,selectionRange:h},ih=!1,wi=c;wi!==null;)if(c=wi,s=c.child,(c.subtreeFlags&1024)!==0&&s!==null)s.return=c,wi=s;else for(;wi!==null;){switch(c=wi,E=c.alternate,s=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&E!==null){s=void 0,h=c,N=E.memoizedProps,E=E.memoizedState,x=h.stateNode;try{var At=jo(h.type,N,h.elementType===h.type);s=x.getSnapshotBeforeUpdate(At,E),x.__reactInternalSnapshotBeforeUpdate=s}catch(Tt){Fn(h,h.return,Tt)}}break;case 3:if((s&1024)!==0){if(s=c.stateNode.containerInfo,h=s.nodeType,h===9)cm(s);else if(h===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":cm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=c.sibling,s!==null){s.return=c.return,wi=s;break}wi=c.return}}function ny(s,c,h){var x=h.flags;switch(h.tag){case 0:case 11:case 15:To(s,h),x&4&&ad(5,h);break;case 1:if(To(s,h),x&4)if(s=h.stateNode,c===null)try{s.componentDidMount()}catch(q){Fn(h,h.return,q)}else{var N=jo(h.type,c.memoizedProps);c=c.memoizedState;try{s.componentDidUpdate(N,c,s.__reactInternalSnapshotBeforeUpdate)}catch(q){Fn(h,h.return,q)}}x&64&&ey(h),x&512&&Ic(h,h.return);break;case 3:if(To(s,h),x&64&&(s=h.updateQueue,s!==null)){if(c=null,h.child!==null)switch(h.child.tag){case 27:case 5:c=h.child.stateNode;break;case 1:c=h.child.stateNode}try{up(s,c)}catch(q){Fn(h,h.return,q)}}break;case 27:c===null&&x&4&&ld(h);case 26:case 5:To(s,h),c===null&&x&4&&Lf(h),x&512&&Ic(h,h.return);break;case 12:To(s,h);break;case 13:To(s,h),x&4&&ay(s,h),x&64&&(s=h.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(h=Vf.bind(null,h),Gc(s,h))));break;case 22:if(x=h.memoizedState!==null||Za,!x){c=c!==null&&c.memoizedState!==null||Cn,N=Za;var E=Cn;Za=x,(Cn=c)&&!E?Ms(s,h,(h.subtreeFlags&8772)!==0):To(s,h),Za=N,Cn=E}break;case 30:break;default:To(s,h)}}function iy(s){var c=s.alternate;c!==null&&(s.alternate=null,iy(c)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(c=s.stateNode,c!==null&&Kl(c)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var ei=null,gr=!1;function Rs(s,c,h){for(h=h.child;h!==null;)ry(s,c,h),h=h.sibling}function ry(s,c,h){if(fe&&typeof fe.onCommitFiberUnmount=="function")try{fe.onCommitFiberUnmount(ee,h)}catch{}switch(h.tag){case 26:Cn||Xa(h,c),Rs(s,c,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Cn||Xa(h,c);var x=ei,N=gr;na(h.type)&&(ei=h.stateNode,gr=!1),Rs(s,c,h),bd(h.stateNode),ei=x,gr=N;break;case 5:Cn||Xa(h,c);case 6:if(x=ei,N=gr,ei=null,Rs(s,c,h),ei=x,gr=N,ei!==null)if(gr)try{(ei.nodeType===9?ei.body:ei.nodeName==="HTML"?ei.ownerDocument.body:ei).removeChild(h.stateNode)}catch(E){Fn(h,c,E)}else try{ei.removeChild(h.stateNode)}catch(E){Fn(h,c,E)}break;case 18:ei!==null&&(gr?(s=ei,Xf(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,h.stateNode),kd(s)):Xf(ei,h.stateNode));break;case 4:x=ei,N=gr,ei=h.stateNode.containerInfo,gr=!0,Rs(s,c,h),ei=x,gr=N;break;case 0:case 11:case 14:case 15:Cn||ko(2,h,c),Cn||ko(4,h,c),Rs(s,c,h);break;case 1:Cn||(Xa(h,c),x=h.stateNode,typeof x.componentWillUnmount=="function"&&Fp(h,c,x)),Rs(s,c,h);break;case 21:Rs(s,c,h);break;case 22:Cn=(x=Cn)||h.memoizedState!==null,Rs(s,c,h),Cn=x;break;default:Rs(s,c,h)}}function ay(s,c){if(c.memoizedState===null&&(s=c.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{kd(s)}catch(h){Fn(c,c.return,h)}}function ev(s){switch(s.tag){case 13:case 19:var c=s.stateNode;return c===null&&(c=s.stateNode=new ty),c;case 22:return s=s.stateNode,c=s._retryCache,c===null&&(c=s._retryCache=new ty),c;default:throw Error(i(435,s.tag))}}function $p(s,c){var h=ev(s);c.forEach(function(x){var N=sv.bind(null,s,x);h.has(x)||(h.add(x),x.then(N,N))})}function Mr(s,c){var h=c.deletions;if(h!==null)for(var x=0;x<h.length;x++){var N=h[x],E=s,q=c,X=q;e:for(;X!==null;){switch(X.tag){case 27:if(na(X.type)){ei=X.stateNode,gr=!1;break e}break;case 5:ei=X.stateNode,gr=!1;break e;case 3:case 4:ei=X.stateNode.containerInfo,gr=!0;break e}X=X.return}if(ei===null)throw Error(i(160));ry(E,q,N),ei=null,gr=!1,E=N.alternate,E!==null&&(E.return=null),N.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)zp(c,s),c=c.sibling}var ea=null;function zp(s,c){var h=s.alternate,x=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Mr(c,s),yr(s),x&4&&(ko(3,s,s.return),ad(3,s),ko(5,s,s.return));break;case 1:Mr(c,s),yr(s),x&512&&(Cn||h===null||Xa(h,h.return)),x&64&&Za&&(s=s.updateQueue,s!==null&&(x=s.callbacks,x!==null&&(h=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=h===null?x:h.concat(x))));break;case 26:var N=ea;if(Mr(c,s),yr(s),x&512&&(Cn||h===null||Xa(h,h.return)),x&4){var E=h!==null?h.memoizedState:null;if(x=s.memoizedState,h===null)if(x===null)if(s.stateNode===null){e:{x=s.type,h=s.memoizedProps,N=N.ownerDocument||N;t:switch(x){case"title":E=N.getElementsByTagName("title")[0],(!E||E[Qs]||E[zn]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=N.createElement(x),N.head.insertBefore(E,N.querySelector("head > title"))),Ni(E,x,h),E[zn]=s,pi(E),x=E;break e;case"link":var q=Qy("link","href",N).get(x+(h.href||""));if(q){for(var X=0;X<q.length;X++)if(E=q[X],E.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&E.getAttribute("rel")===(h.rel==null?null:h.rel)&&E.getAttribute("title")===(h.title==null?null:h.title)&&E.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){q.splice(X,1);break t}}E=N.createElement(x),Ni(E,x,h),N.head.appendChild(E);break;case"meta":if(q=Qy("meta","content",N).get(x+(h.content||""))){for(X=0;X<q.length;X++)if(E=q[X],E.getAttribute("content")===(h.content==null?null:""+h.content)&&E.getAttribute("name")===(h.name==null?null:h.name)&&E.getAttribute("property")===(h.property==null?null:h.property)&&E.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&E.getAttribute("charset")===(h.charSet==null?null:h.charSet)){q.splice(X,1);break t}}E=N.createElement(x),Ni(E,x,h),N.head.appendChild(E);break;default:throw Error(i(468,x))}E[zn]=s,pi(E),x=E}s.stateNode=x}else Jy(N,s.type,s.stateNode);else s.stateNode=Wy(N,x,s.memoizedProps);else E!==x?(E===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):E.count--,x===null?Jy(N,s.type,s.stateNode):Wy(N,x,s.memoizedProps)):x===null&&s.stateNode!==null&&Ff(s,s.memoizedProps,h.memoizedProps)}break;case 27:Mr(c,s),yr(s),x&512&&(Cn||h===null||Xa(h,h.return)),h!==null&&x&4&&Ff(s,s.memoizedProps,h.memoizedProps);break;case 5:if(Mr(c,s),yr(s),x&512&&(Cn||h===null||Xa(h,h.return)),s.flags&32){N=s.stateNode;try{Tr(N,"")}catch($e){Fn(s,s.return,$e)}}x&4&&s.stateNode!=null&&(N=s.memoizedProps,Ff(s,N,h!==null?h.memoizedProps:N)),x&1024&&(Is=!0);break;case 6:if(Mr(c,s),yr(s),x&4){if(s.stateNode===null)throw Error(i(162));x=s.memoizedProps,h=s.stateNode;try{h.nodeValue=x}catch($e){Fn(s,s.return,$e)}}break;case 3:if(Jc=null,N=ea,ea=Ut(c.containerInfo),Mr(c,s),ea=N,yr(s),x&4&&h!==null&&h.memoizedState.isDehydrated)try{kd(c.containerInfo)}catch($e){Fn(s,s.return,$e)}Is&&(Is=!1,sy(s));break;case 4:x=ea,ea=Ut(s.stateNode.containerInfo),Mr(c,s),yr(s),ea=x;break;case 12:Mr(c,s),yr(s);break;case 13:Mr(c,s),yr(s),s.child.flags&8192&&s.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(Yp=ut()),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,$p(s,x)));break;case 22:N=s.memoizedState!==null;var ge=h!==null&&h.memoizedState!==null,Le=Za,Qe=Cn;if(Za=Le||N,Cn=Qe||ge,Mr(c,s),Cn=Qe,Za=Le,yr(s),x&8192)e:for(c=s.stateNode,c._visibility=N?c._visibility&-2:c._visibility|1,N&&(h===null||ge||Za||Cn||$l(s)),h=null,c=s;;){if(c.tag===5||c.tag===26){if(h===null){ge=h=c;try{if(E=ge.stateNode,N)q=E.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{X=ge.stateNode;var Xe=ge.memoizedProps.style,ze=Xe!=null&&Xe.hasOwnProperty("display")?Xe.display:null;X.style.display=ze==null||typeof ze=="boolean"?"":(""+ze).trim()}}catch($e){Fn(ge,ge.return,$e)}}}else if(c.tag===6){if(h===null){ge=c;try{ge.stateNode.nodeValue=N?"":ge.memoizedProps}catch($e){Fn(ge,ge.return,$e)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===s)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break e;for(;c.sibling===null;){if(c.return===null||c.return===s)break e;h===c&&(h=null),c=c.return}h===c&&(h=null),c.sibling.return=c.return,c=c.sibling}x&4&&(x=s.updateQueue,x!==null&&(h=x.retryQueue,h!==null&&(x.retryQueue=null,$p(s,h))));break;case 19:Mr(c,s),yr(s),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,$p(s,x)));break;case 30:break;case 21:break;default:Mr(c,s),yr(s)}}function yr(s){var c=s.flags;if(c&2){try{for(var h,x=s.return;x!==null;){if(Rc(x)){h=x;break}x=x.return}if(h==null)throw Error(i(160));switch(h.tag){case 27:var N=h.stateNode,E=sd(s);od(s,E,N);break;case 5:var q=h.stateNode;h.flags&32&&(Tr(q,""),h.flags&=-33);var X=sd(s);od(s,X,q);break;case 3:case 4:var ge=h.stateNode.containerInfo,Le=sd(s);$f(s,Le,ge);break;default:throw Error(i(161))}}catch(Qe){Fn(s,s.return,Qe)}s.flags&=-3}c&4096&&(s.flags&=-4097)}function sy(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var c=s;sy(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),s=s.sibling}}function To(s,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)ny(s,c.alternate,c),c=c.sibling}function $l(s){for(s=s.child;s!==null;){var c=s;switch(c.tag){case 0:case 11:case 14:case 15:ko(4,c,c.return),$l(c);break;case 1:Xa(c,c.return);var h=c.stateNode;typeof h.componentWillUnmount=="function"&&Fp(c,c.return,h),$l(c);break;case 27:bd(c.stateNode);case 26:case 5:Xa(c,c.return),$l(c);break;case 22:c.memoizedState===null&&$l(c);break;case 30:$l(c);break;default:$l(c)}s=s.sibling}}function Ms(s,c,h){for(h=h&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var x=c.alternate,N=s,E=c,q=E.flags;switch(E.tag){case 0:case 11:case 15:Ms(N,E,h),ad(4,E);break;case 1:if(Ms(N,E,h),x=E,N=x.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(Le){Fn(x,x.return,Le)}if(x=E,N=x.updateQueue,N!==null){var X=x.stateNode;try{var ge=N.shared.hiddenCallbacks;if(ge!==null)for(N.shared.hiddenCallbacks=null,N=0;N<ge.length;N++)jg(ge[N],X)}catch(Le){Fn(x,x.return,Le)}}h&&q&64&&ey(E),Ic(E,E.return);break;case 27:ld(E);case 26:case 5:Ms(N,E,h),h&&x===null&&q&4&&Lf(E),Ic(E,E.return);break;case 12:Ms(N,E,h);break;case 13:Ms(N,E,h),h&&q&4&&ay(N,E);break;case 22:E.memoizedState===null&&Ms(N,E,h),Ic(E,E.return);break;case 30:break;default:Ms(N,E,h)}c=c.sibling}}function Up(s,c){var h=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),s=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(s=c.memoizedState.cachePool.pool),s!==h&&(s!=null&&s.refCount++,h!=null&&Ru(h))}function Bp(s,c){s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&Ru(s))}function es(s,c,h,x){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)oy(s,c,h,x),c=c.sibling}function oy(s,c,h,x){var N=c.flags;switch(c.tag){case 0:case 11:case 15:es(s,c,h,x),N&2048&&ad(9,c);break;case 1:es(s,c,h,x);break;case 3:es(s,c,h,x),N&2048&&(s=null,c.alternate!==null&&(s=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==s&&(c.refCount++,s!=null&&Ru(s)));break;case 12:if(N&2048){es(s,c,h,x),s=c.stateNode;try{var E=c.memoizedProps,q=E.id,X=E.onPostCommit;typeof X=="function"&&X(q,c.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(ge){Fn(c,c.return,ge)}}else es(s,c,h,x);break;case 13:es(s,c,h,x);break;case 23:break;case 22:E=c.stateNode,q=c.alternate,c.memoizedState!==null?E._visibility&2?es(s,c,h,x):cd(s,c):E._visibility&2?es(s,c,h,x):(E._visibility|=2,Mc(s,c,h,x,(c.subtreeFlags&10256)!==0)),N&2048&&Up(q,c);break;case 24:es(s,c,h,x),N&2048&&Bp(c.alternate,c);break;default:es(s,c,h,x)}}function Mc(s,c,h,x,N){for(N=N&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var E=s,q=c,X=h,ge=x,Le=q.flags;switch(q.tag){case 0:case 11:case 15:Mc(E,q,X,ge,N),ad(8,q);break;case 23:break;case 22:var Qe=q.stateNode;q.memoizedState!==null?Qe._visibility&2?Mc(E,q,X,ge,N):cd(E,q):(Qe._visibility|=2,Mc(E,q,X,ge,N)),N&&Le&2048&&Up(q.alternate,q);break;case 24:Mc(E,q,X,ge,N),N&&Le&2048&&Bp(q.alternate,q);break;default:Mc(E,q,X,ge,N)}c=c.sibling}}function cd(s,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var h=s,x=c,N=x.flags;switch(x.tag){case 22:cd(h,x),N&2048&&Up(x.alternate,x);break;case 24:cd(h,x),N&2048&&Bp(x.alternate,x);break;default:cd(h,x)}c=c.sibling}}var qi=8192;function Oc(s){if(s.subtreeFlags&qi)for(s=s.child;s!==null;)ly(s),s=s.sibling}function ly(s){switch(s.tag){case 26:Oc(s),s.flags&qi&&s.memoizedState!==null&&jv(ea,s.memoizedState,s.memoizedProps);break;case 5:Oc(s);break;case 3:case 4:var c=ea;ea=Ut(s.stateNode.containerInfo),Oc(s),ea=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=qi,qi=16777216,Oc(s),qi=c):Oc(s));break;default:Oc(s)}}function cy(s){var c=s.alternate;if(c!==null&&(s=c.child,s!==null)){c.child=null;do c=s.sibling,s.sibling=null,s=c;while(s!==null)}}function Lc(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var h=0;h<c.length;h++){var x=c[h];wi=x,dy(x,s)}cy(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)uy(s),s=s.sibling}function uy(s){switch(s.tag){case 0:case 11:case 15:Lc(s),s.flags&2048&&ko(9,s,s.return);break;case 3:Lc(s);break;case 12:Lc(s);break;case 22:var c=s.stateNode;s.memoizedState!==null&&c._visibility&2&&(s.return===null||s.return.tag!==13)?(c._visibility&=-3,zf(s)):Lc(s);break;default:Lc(s)}}function zf(s){var c=s.deletions;if((s.flags&16)!==0){if(c!==null)for(var h=0;h<c.length;h++){var x=c[h];wi=x,dy(x,s)}cy(s)}for(s=s.child;s!==null;){switch(c=s,c.tag){case 0:case 11:case 15:ko(8,c,c.return),zf(c);break;case 22:h=c.stateNode,h._visibility&2&&(h._visibility&=-3,zf(c));break;default:zf(c)}s=s.sibling}}function dy(s,c){for(;wi!==null;){var h=wi;switch(h.tag){case 0:case 11:case 15:ko(8,h,c);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var x=h.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Ru(h.memoizedState.cache)}if(x=h.child,x!==null)x.return=h,wi=x;else e:for(h=s;wi!==null;){x=wi;var N=x.sibling,E=x.return;if(iy(x),x===h){wi=null;break e}if(N!==null){N.return=E,wi=N;break e}wi=E}}}var tv={getCacheForType:function(s){var c=oi(On),h=c.data.get(s);return h===void 0&&(h=s(),c.data.set(s,h)),h}},qp=typeof WeakMap=="function"?WeakMap:Map,_n=0,Vn=null,tn=null,pn=0,kn=0,Or=null,Eo=!1,Fc=!1,Vp=!1,Os=0,ci=0,Ao=0,zl=0,Hp=0,ta=0,$c=0,ud=null,xr=null,Gp=!1,Yp=0,zc=1/0,dd=null,Po=null,Oi=0,Do=null,Uc=null,Bc=0,Wp=0,Qp=null,fy=null,qc=0,Jp=null;function Vi(){if((_n&2)!==0&&pn!==0)return pn&-pn;if(V.T!==null){var s=Cc;return s!==0?s:Yf()}return Ys()}function hy(){ta===0&&(ta=(pn&536870912)===0||an?Ft():536870912);var s=Rr.current;return s!==null&&(s.flags|=32),ta}function Lr(s,c,h){(s===Vn&&(kn===2||kn===9)||s.cancelPendingCommit!==null)&&(Vc(s,0),Io(s,pn,ta,!1)),Et(s,h),((_n&2)===0||s!==Vn)&&(s===Vn&&((_n&2)===0&&(zl|=h),ci===4&&Io(s,pn,ta,!1)),ts(s))}function py(s,c,h){if((_n&6)!==0)throw Error(i(327));var x=!h&&(c&124)===0&&(c&s.expiredLanes)===0||tt(s,c),N=x?rv(s,c):Zp(s,c,!0),E=x;do{if(N===0){Fc&&!x&&Io(s,c,0,!1);break}else{if(h=s.current.alternate,E&&!nv(h)){N=Zp(s,c,!1),E=!1;continue}if(N===2){if(E=c,s.errorRecoveryDisabledLanes&E)var q=0;else q=s.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){c=q;e:{var X=s;N=ud;var ge=X.current.memoizedState.isDehydrated;if(ge&&(Vc(X,q).flags|=256),q=Zp(X,q,!1),q!==2){if(Vp&&!ge){X.errorRecoveryDisabledLanes|=E,zl|=E,N=4;break e}E=xr,xr=N,E!==null&&(xr===null?xr=E:xr.push.apply(xr,E))}N=q}if(E=!1,N!==2)continue}}if(N===1){Vc(s,0),Io(s,c,0,!0);break}e:{switch(x=s,E=N,E){case 0:case 1:throw Error(i(345));case 4:if((c&4194048)!==c)break;case 6:Io(x,c,ta,!Eo);break e;case 2:xr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((c&62914560)===c&&(N=Yp+300-ut(),10<N)){if(Io(x,c,ta,!Eo),He(x,0,!0)!==0)break e;x.timeoutHandle=Fy(my.bind(null,x,h,xr,dd,Gp,c,ta,zl,$c,Eo,E,2,-0,0),N);break e}my(x,h,xr,dd,Gp,c,ta,zl,$c,Eo,E,0,-0,0)}}break}while(!0);ts(s)}function my(s,c,h,x,N,E,q,X,ge,Le,Qe,Xe,ze,$e){if(s.timeoutHandle=-1,Xe=c.subtreeFlags,(Xe&8192||(Xe&16785408)===16785408)&&(Ei={stylesheets:null,count:0,unsuspend:Cv},ly(c),Xe=_v(),Xe!==null)){s.cancelPendingCommit=Xe(fd.bind(null,s,c,E,h,x,N,q,X,ge,Qe,1,ze,$e)),Io(s,E,q,!Le);return}fd(s,c,E,h,x,N,q,X,ge)}function nv(s){for(var c=s;;){var h=c.tag;if((h===0||h===11||h===15)&&c.flags&16384&&(h=c.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var x=0;x<h.length;x++){var N=h[x],E=N.getSnapshot;N=N.value;try{if(!Zi(E(),N))return!1}catch{return!1}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Io(s,c,h,x){c&=~Hp,c&=~zl,s.suspendedLanes|=c,s.pingedLanes&=~c,x&&(s.warmLanes|=c),x=s.expirationTimes;for(var N=c;0<N;){var E=31-nt(N),q=1<<E;x[E]=-1,N&=~q}h!==0&&hi(s,h,c)}function Uf(){return(_n&6)===0?(md(0),!1):!0}function Kp(){if(tn!==null){if(kn===0)var s=tn.return;else s=tn,K=vo=null,ff(s),vi=null,mr=0,s=tn;for(;s!==null;)Zg(s.alternate,s),s=s.return;tn=null}}function Vc(s,c){var h=s.timeoutHandle;h!==-1&&(s.timeoutHandle=-1,mv(h)),h=s.cancelPendingCommit,h!==null&&(s.cancelPendingCommit=null,h()),Kp(),Vn=s,tn=h=tr(s.current,null),pn=c,kn=0,Or=null,Eo=!1,Fc=tt(s,c),Vp=!1,$c=ta=Hp=zl=Ao=ci=0,xr=ud=null,Gp=!1,(c&8)!==0&&(c|=c&32);var x=s.entangledLanes;if(x!==0)for(s=s.entanglements,x&=c;0<x;){var N=31-nt(x),E=1<<N;c|=s[N],x&=~E}return Os=c,bt(),h}function gy(s,c){Qt=null,V.H=Qu,c===nr||c===cf?(c=Ng(),kn=3):c===wg?(c=Ng(),kn=4):kn=c===Yg?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,Or=c,tn===null&&(ci=1,ed(s,we(c,s.current)))}function yy(){var s=V.H;return V.H=Qu,s===null?Qu:s}function xy(){var s=V.A;return V.A=tv,s}function Xp(){ci=4,Eo||(pn&4194048)!==pn&&Rr.current!==null||(Fc=!0),(Ao&134217727)===0&&(zl&134217727)===0||Vn===null||Io(Vn,pn,ta,!1)}function Zp(s,c,h){var x=_n;_n|=2;var N=yy(),E=xy();(Vn!==s||pn!==c)&&(dd=null,Vc(s,c)),c=!1;var q=ci;e:do try{if(kn!==0&&tn!==null){var X=tn,ge=Or;switch(kn){case 8:Kp(),q=6;break e;case 3:case 2:case 9:case 6:Rr.current===null&&(c=!0);var Le=kn;if(kn=0,Or=null,Hc(s,X,ge,Le),h&&Fc){q=0;break e}break;default:Le=kn,kn=0,Or=null,Hc(s,X,ge,Le)}}iv(),q=ci;break}catch(Qe){gy(s,Qe)}while(!0);return c&&s.shellSuspendCounter++,K=vo=null,_n=x,V.H=N,V.A=E,tn===null&&(Vn=null,pn=0,bt()),q}function iv(){for(;tn!==null;)em(tn)}function rv(s,c){var h=_n;_n|=2;var x=yy(),N=xy();Vn!==s||pn!==c?(dd=null,zc=ut()+500,Vc(s,c)):Fc=tt(s,c);e:do try{if(kn!==0&&tn!==null){c=tn;var E=Or;t:switch(kn){case 1:kn=0,Or=null,Hc(s,c,E,1);break;case 2:case 9:if(Sg(E)){kn=0,Or=null,vy(c);break}c=function(){kn!==2&&kn!==9||Vn!==s||(kn=7),ts(s)},E.then(c,c);break e;case 3:kn=7;break e;case 4:kn=5;break e;case 7:Sg(E)?(kn=0,Or=null,vy(c)):(kn=0,Or=null,Hc(s,c,E,7));break;case 5:var q=null;switch(tn.tag){case 26:q=tn.memoizedState;case 5:case 27:var X=tn;if(!q||Ci(q)){kn=0,Or=null;var ge=X.sibling;if(ge!==null)tn=ge;else{var Le=X.return;Le!==null?(tn=Le,Bf(Le)):tn=null}break t}}kn=0,Or=null,Hc(s,c,E,5);break;case 6:kn=0,Or=null,Hc(s,c,E,6);break;case 8:Kp(),ci=6;break e;default:throw Error(i(462))}}by();break}catch(Qe){gy(s,Qe)}while(!0);return K=vo=null,V.H=x,V.A=N,_n=h,tn!==null?0:(Vn=null,pn=0,bt(),ci)}function by(){for(;tn!==null&&!et();)em(tn)}function em(s){var c=Rf(s.alternate,s,Os);s.memoizedProps=s.pendingProps,c===null?Bf(s):tn=c}function vy(s){var c=s,h=c.alternate;switch(c.tag){case 15:case 0:c=Df(h,c,c.pendingProps,c.type,void 0,pn);break;case 11:c=Df(h,c,c.pendingProps,c.type.render,c.ref,pn);break;case 5:ff(c);default:Zg(h,c),c=tn=Tu(c,Os),c=Rf(h,c,Os)}s.memoizedProps=s.pendingProps,c===null?Bf(s):tn=c}function Hc(s,c,h,x){K=vo=null,ff(c),vi=null,mr=0;var N=c.return;try{if(Gg(s,N,c,h,pn)){ci=1,ed(s,we(h,s.current)),tn=null;return}}catch(E){if(N!==null)throw tn=N,E;ci=1,ed(s,we(h,s.current)),tn=null;return}c.flags&32768?(an||x===1?s=!0:Fc||(pn&536870912)!==0?s=!1:(Eo=s=!0,(x===2||x===9||x===3||x===6)&&(x=Rr.current,x!==null&&x.tag===13&&(x.flags|=16384))),wy(c,s)):Bf(c)}function Bf(s){var c=s;do{if((c.flags&32768)!==0){wy(c,Eo);return}s=c.return;var h=Kg(c.alternate,c,Os);if(h!==null){tn=h;return}if(c=c.sibling,c!==null){tn=c;return}tn=c=s}while(c!==null);ci===0&&(ci=5)}function wy(s,c){do{var h=Xg(s.alternate,s);if(h!==null){h.flags&=32767,tn=h;return}if(h=s.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!c&&(s=s.sibling,s!==null)){tn=s;return}tn=s=h}while(s!==null);ci=6,tn=null}function fd(s,c,h,x,N,E,q,X,ge){s.cancelPendingCommit=null;do qf();while(Oi!==0);if((_n&6)!==0)throw Error(i(327));if(c!==null){if(c===s.current)throw Error(i(177));if(E=c.lanes|c.childLanes,E|=vt,Vt(s,h,E,q,X,ge),s===Vn&&(tn=Vn=null,pn=0),Uc=c,Do=s,Bc=h,Wp=E,Qp=N,fy=x,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Ey(_e,function(){return _y(),null})):(s.callbackNode=null,s.callbackPriority=0),x=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||x){x=V.T,V.T=null,N=W.p,W.p=2,q=_n,_n|=4;try{Zb(s,c,h)}finally{_n=q,W.p=N,V.T=x}}Oi=1,Sy(),Ny(),Cy()}}function Sy(){if(Oi===1){Oi=0;var s=Do,c=Uc,h=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||h){h=V.T,V.T=null;var x=W.p;W.p=2;var N=_n;_n|=4;try{zp(c,s);var E=Jf,q=ef(s.containerInfo),X=E.focusedElem,ge=E.selectionRange;if(q!==X&&X&&X.ownerDocument&&vs(X.ownerDocument.documentElement,X)){if(ge!==null&&vl(X)){var Le=ge.start,Qe=ge.end;if(Qe===void 0&&(Qe=Le),"selectionStart"in X)X.selectionStart=Le,X.selectionEnd=Math.min(Qe,X.value.length);else{var Xe=X.ownerDocument||document,ze=Xe&&Xe.defaultView||window;if(ze.getSelection){var $e=ze.getSelection(),At=X.textContent.length,Tt=Math.min(ge.start,At),Rn=ge.end===void 0?Tt:Math.min(ge.end,At);!$e.extend&&Tt>Rn&&(q=Rn,Rn=Tt,Tt=q);var Te=ju(X,Tt),je=ju(X,Rn);if(Te&&je&&($e.rangeCount!==1||$e.anchorNode!==Te.node||$e.anchorOffset!==Te.offset||$e.focusNode!==je.node||$e.focusOffset!==je.offset)){var Ie=Xe.createRange();Ie.setStart(Te.node,Te.offset),$e.removeAllRanges(),Tt>Rn?($e.addRange(Ie),$e.extend(je.node,je.offset)):(Ie.setEnd(je.node,je.offset),$e.addRange(Ie))}}}}for(Xe=[],$e=X;$e=$e.parentNode;)$e.nodeType===1&&Xe.push({element:$e,left:$e.scrollLeft,top:$e.scrollTop});for(typeof X.focus=="function"&&X.focus(),X=0;X<Xe.length;X++){var Je=Xe[X];Je.element.scrollLeft=Je.left,Je.element.scrollTop=Je.top}}ih=!!Ca,Jf=Ca=null}finally{_n=N,W.p=x,V.T=h}}s.current=c,Oi=2}}function Ny(){if(Oi===2){Oi=0;var s=Do,c=Uc,h=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||h){h=V.T,V.T=null;var x=W.p;W.p=2;var N=_n;_n|=4;try{ny(s,c.alternate,c)}finally{_n=N,W.p=x,V.T=h}}Oi=3}}function Cy(){if(Oi===4||Oi===3){Oi=0,ct();var s=Do,c=Uc,h=Bc,x=fy;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Oi=5:(Oi=0,Uc=Do=null,jy(s,s.pendingLanes));var N=s.pendingLanes;if(N===0&&(Po=null),Bt(h),c=c.stateNode,fe&&typeof fe.onCommitFiberRoot=="function")try{fe.onCommitFiberRoot(ee,c,void 0,(c.current.flags&128)===128)}catch{}if(x!==null){c=V.T,N=W.p,W.p=2,V.T=null;try{for(var E=s.onRecoverableError,q=0;q<x.length;q++){var X=x[q];E(X.value,{componentStack:X.stack})}}finally{V.T=c,W.p=N}}(Bc&3)!==0&&qf(),ts(s),N=s.pendingLanes,(h&4194090)!==0&&(N&42)!==0?s===Jp?qc++:(qc=0,Jp=s):qc=0,md(0)}}function jy(s,c){(s.pooledCacheLanes&=c)===0&&(c=s.pooledCache,c!=null&&(s.pooledCache=null,Ru(c)))}function qf(s){return Sy(),Ny(),Cy(),_y()}function _y(){if(Oi!==5)return!1;var s=Do,c=Wp;Wp=0;var h=Bt(Bc),x=V.T,N=W.p;try{W.p=32>h?32:h,V.T=null,h=Qp,Qp=null;var E=Do,q=Bc;if(Oi=0,Uc=Do=null,Bc=0,(_n&6)!==0)throw Error(i(331));var X=_n;if(_n|=4,uy(E.current),oy(E,E.current,q,h),_n=X,md(0,!1),fe&&typeof fe.onPostCommitFiberRoot=="function")try{fe.onPostCommitFiberRoot(ee,E)}catch{}return!0}finally{W.p=N,V.T=x,jy(s,c)}}function ky(s,c,h){c=we(h,c),c=Tf(s.stateNode,c,2),s=_s(s,c,2),s!==null&&(Et(s,2),ts(s))}function Fn(s,c,h){if(s.tag===3)ky(s,s,h);else for(;c!==null;){if(c.tag===3){ky(c,s,h);break}else if(c.tag===1){var x=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Po===null||!Po.has(x))){s=we(h,s),h=Ip(2),x=_s(c,h,2),x!==null&&(Hg(h,x,c,s),Et(x,2),ts(x));break}}c=c.return}}function tm(s,c,h){var x=s.pingCache;if(x===null){x=s.pingCache=new qp;var N=new Set;x.set(c,N)}else N=x.get(c),N===void 0&&(N=new Set,x.set(c,N));N.has(h)||(Vp=!0,N.add(h),s=av.bind(null,s,c,h),c.then(s,s))}function av(s,c,h){var x=s.pingCache;x!==null&&x.delete(c),s.pingedLanes|=s.suspendedLanes&h,s.warmLanes&=~h,Vn===s&&(pn&h)===h&&(ci===4||ci===3&&(pn&62914560)===pn&&300>ut()-Yp?(_n&2)===0&&Vc(s,0):Hp|=h,$c===pn&&($c=0)),ts(s)}function Ty(s,c){c===0&&(c=Kn()),s=Ss(s,c),s!==null&&(Et(s,c),ts(s))}function Vf(s){var c=s.memoizedState,h=0;c!==null&&(h=c.retryLane),Ty(s,h)}function sv(s,c){var h=0;switch(s.tag){case 13:var x=s.stateNode,N=s.memoizedState;N!==null&&(h=N.retryLane);break;case 19:x=s.stateNode;break;case 22:x=s.stateNode._retryCache;break;default:throw Error(i(314))}x!==null&&x.delete(c),Ty(s,h)}function Ey(s,c){return De(s,c)}var hd=null,Ro=null,Hf=!1,pd=!1,Gf=!1,Mo=0;function ts(s){s!==Ro&&s.next===null&&(Ro===null?hd=Ro=s:Ro=Ro.next=s),pd=!0,Hf||(Hf=!0,nm())}function md(s,c){if(!Gf&&pd){Gf=!0;do for(var h=!1,x=hd;x!==null;){if(s!==0){var N=x.pendingLanes;if(N===0)var E=0;else{var q=x.suspendedLanes,X=x.pingedLanes;E=(1<<31-nt(42|s)+1)-1,E&=N&~(q&~X),E=E&201326741?E&201326741|1:E?E|2:0}E!==0&&(h=!0,Py(x,E))}else E=pn,E=He(x,x===Vn?E:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(E&3)===0||tt(x,E)||(h=!0,Py(x,E));x=x.next}while(h);Gf=!1}}function ov(){gd()}function gd(){pd=Hf=!1;var s=0;Mo!==0&&(pv()&&(s=Mo),Mo=0);for(var c=ut(),h=null,x=hd;x!==null;){var N=x.next,E=yd(x,c);E===0?(x.next=null,h===null?hd=N:h.next=N,N===null&&(Ro=h)):(h=x,(s!==0||(E&3)!==0)&&(pd=!0)),x=N}md(s)}function yd(s,c){for(var h=s.suspendedLanes,x=s.pingedLanes,N=s.expirationTimes,E=s.pendingLanes&-62914561;0<E;){var q=31-nt(E),X=1<<q,ge=N[q];ge===-1?((X&h)===0||(X&x)!==0)&&(N[q]=rt(X,c)):ge<=c&&(s.expiredLanes|=X),E&=~X}if(c=Vn,h=pn,h=He(s,s===c?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x=s.callbackNode,h===0||s===c&&(kn===2||kn===9)||s.cancelPendingCommit!==null)return x!==null&&x!==null&&Me(x),s.callbackNode=null,s.callbackPriority=0;if((h&3)===0||tt(s,h)){if(c=h&-h,c===s.callbackPriority)return c;switch(x!==null&&Me(x),Bt(h)){case 2:case 8:h=jt;break;case 32:h=_e;break;case 268435456:h=Pe;break;default:h=_e}return x=Ay.bind(null,s),h=De(h,x),s.callbackPriority=c,s.callbackNode=h,c}return x!==null&&x!==null&&Me(x),s.callbackPriority=2,s.callbackNode=null,2}function Ay(s,c){if(Oi!==0&&Oi!==5)return s.callbackNode=null,s.callbackPriority=0,null;var h=s.callbackNode;if(qf()&&s.callbackNode!==h)return null;var x=pn;return x=He(s,s===Vn?x:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x===0?null:(py(s,x,c),yd(s,ut()),s.callbackNode!=null&&s.callbackNode===h?Ay.bind(null,s):null)}function Py(s,c){if(qf())return null;py(s,c,!0)}function nm(){gv(function(){(_n&6)!==0?De(qt,ov):gd()})}function Yf(){return Mo===0&&(Mo=Ft()),Mo}function Dy(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:gs(""+s)}function Iy(s,c){var h=c.ownerDocument.createElement("input");return h.name=c.name,h.value=c.value,s.id&&h.setAttribute("form",s.id),c.parentNode.insertBefore(h,c),s=new FormData(s),h.parentNode.removeChild(h),s}function lv(s,c,h,x,N){if(c==="submit"&&h&&h.stateNode===N){var E=Dy((N[Ri]||null).action),q=x.submitter;q&&(c=(c=q[Ri]||null)?Dy(c.formAction):q.getAttribute("formAction"),c!==null&&(E=c,q=null));var X=new dl("action","action",null,x,N);s.push({event:X,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Mo!==0){var ge=q?Iy(N,q):new FormData(N);Yu(h,{pending:!0,data:ge,method:N.method,action:E},null,ge)}}else typeof E=="function"&&(X.preventDefault(),ge=q?Iy(N,q):new FormData(N),Yu(h,{pending:!0,data:ge,method:N.method,action:E},E,ge))},currentTarget:N}]})}}for(var im=0;im<te.length;im++){var rm=te[im],cv=rm.toLowerCase(),uv=rm[0].toUpperCase()+rm.slice(1);de(cv,"on"+uv)}de(vc,"onAnimationEnd"),de(tf,"onAnimationIteration"),de(er,"onAnimationStart"),de("dblclick","onDoubleClick"),de("focusin","onFocus"),de("focusout","onBlur"),de(wc,"onTransitionRun"),de(np,"onTransitionStart"),de(ws,"onTransitionCancel"),de(go,"onTransitionEnd"),Zs("onMouseEnter",["mouseout","mouseover"]),Zs("onMouseLeave",["mouseout","mouseover"]),Zs("onPointerEnter",["pointerout","pointerover"]),Zs("onPointerLeave",["pointerout","pointerover"]),fs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),fs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),fs("onBeforeInput",["compositionend","keypress","textInput","paste"]),fs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),fs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),fs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(xd));function Ry(s,c){c=(c&4)!==0;for(var h=0;h<s.length;h++){var x=s[h],N=x.event;x=x.listeners;e:{var E=void 0;if(c)for(var q=x.length-1;0<=q;q--){var X=x[q],ge=X.instance,Le=X.currentTarget;if(X=X.listener,ge!==E&&N.isPropagationStopped())break e;E=X,N.currentTarget=Le;try{E(N)}catch(Qe){Ll(Qe)}N.currentTarget=null,E=ge}else for(q=0;q<x.length;q++){if(X=x[q],ge=X.instance,Le=X.currentTarget,X=X.listener,ge!==E&&N.isPropagationStopped())break e;E=X,N.currentTarget=Le;try{E(N)}catch(Qe){Ll(Qe)}N.currentTarget=null,E=ge}}}}function nn(s,c){var h=c[xu];h===void 0&&(h=c[xu]=new Set);var x=s+"__bubble";h.has(x)||(My(c,s,2,!1),h.add(x))}function am(s,c,h){var x=0;c&&(x|=4),My(h,s,x,c)}var br="_reactListening"+Math.random().toString(36).slice(2);function sm(s){if(!s[br]){s[br]=!0,Vd.forEach(function(h){h!=="selectionchange"&&(dv.has(h)||am(h,!1,s),am(h,!0,s))});var c=s.nodeType===9?s:s.ownerDocument;c===null||c[br]||(c[br]=!0,am("selectionchange",!1,c))}}function My(s,c,h,x){switch(ex(c)){case 2:var N=Ev;break;case 8:N=Xc;break;default:N=gm}h=N.bind(null,c,h,s),N=void 0,!ao||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(N=!0),x?N!==void 0?s.addEventListener(c,h,{capture:!0,passive:N}):s.addEventListener(c,h,!0):N!==void 0?s.addEventListener(c,h,{passive:N}):s.addEventListener(c,h,!1)}function Ls(s,c,h,x,N){var E=x;if((c&1)===0&&(c&2)===0&&x!==null)e:for(;;){if(x===null)return;var q=x.tag;if(q===3||q===4){var X=x.stateNode.containerInfo;if(X===N)break;if(q===4)for(q=x.return;q!==null;){var ge=q.tag;if((ge===3||ge===4)&&q.stateNode.containerInfo===N)return;q=q.return}for(;X!==null;){if(q=ds(X),q===null)return;if(ge=q.tag,ge===5||ge===6||ge===26||ge===27){x=E=q;continue e}X=X.parentNode}}x=x.return}lc(function(){var Le=E,Qe=sl(h),Xe=[];e:{var ze=yo.get(s);if(ze!==void 0){var $e=dl,At=s;switch(s){case"keypress":if(hn(h)===0)break e;case"keydown":case"keyup":$e=gc;break;case"focusin":At="focus",$e=yn;break;case"focusout":At="blur",$e=yn;break;case"beforeblur":case"afterblur":$e=yn;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$e=za;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$e=fl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$e=Jh;break;case vc:case tf:case er:$e=hl;break;case go:$e=Kh;break;case"scroll":case"scrollend":$e=Wd;break;case"wheel":$e=uo;break;case"copy":case"cut":case"paste":$e=lo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$e=Hr;break;case"toggle":case"beforetoggle":$e=Ba}var Tt=(c&4)!==0,Rn=!Tt&&(s==="scroll"||s==="scrollend"),Te=Tt?ze!==null?ze+"Capture":null:ze;Tt=[];for(var je=Le,Ie;je!==null;){var Je=je;if(Ie=Je.stateNode,Je=Je.tag,Je!==5&&Je!==26&&Je!==27||Ie===null||Te===null||(Je=Qi(je,Te),Je!=null&&Tt.push(Lt(je,Je,Ie))),Rn)break;je=je.return}0<Tt.length&&(ze=new $e(ze,At,null,h,Qe),Xe.push({event:ze,listeners:Tt}))}}if((c&7)===0){e:{if(ze=s==="mouseover"||s==="pointerover",$e=s==="mouseout"||s==="pointerout",ze&&h!==ro&&(At=h.relatedTarget||h.fromElement)&&(ds(At)||At[ha]))break e;if(($e||ze)&&(ze=Qe.window===Qe?Qe:(ze=Qe.ownerDocument)?ze.defaultView||ze.parentWindow:window,$e?(At=h.relatedTarget||h.toElement,$e=Le,At=At?ds(At):null,At!==null&&(Rn=o(At),Tt=At.tag,At!==Rn||Tt!==5&&Tt!==27&&Tt!==6)&&(At=null)):($e=null,At=Le),$e!==At)){if(Tt=za,Je="onMouseLeave",Te="onMouseEnter",je="mouse",(s==="pointerout"||s==="pointerover")&&(Tt=Hr,Je="onPointerLeave",Te="onPointerEnter",je="pointer"),Rn=$e==null?ze:Ks($e),Ie=At==null?ze:Ks(At),ze=new Tt(Je,je+"leave",$e,h,Qe),ze.target=Rn,ze.relatedTarget=Ie,Je=null,ds(Qe)===Le&&(Tt=new Tt(Te,je+"enter",At,h,Qe),Tt.target=Ie,Tt.relatedTarget=Rn,Je=Tt),Rn=Je,$e&&At)t:{for(Tt=$e,Te=At,je=0,Ie=Tt;Ie;Ie=Si(Ie))je++;for(Ie=0,Je=Te;Je;Je=Si(Je))Ie++;for(;0<je-Ie;)Tt=Si(Tt),je--;for(;0<Ie-je;)Te=Si(Te),Ie--;for(;je--;){if(Tt===Te||Te!==null&&Tt===Te.alternate)break t;Tt=Si(Tt),Te=Si(Te)}Tt=null}else Tt=null;$e!==null&&ui(Xe,ze,$e,Tt,!1),At!==null&&Rn!==null&&ui(Xe,Rn,At,Tt,!0)}}e:{if(ze=Le?Ks(Le):window,$e=ze.nodeName&&ze.nodeName.toLowerCase(),$e==="select"||$e==="input"&&ze.type==="file")var gt=Gr;else if(yl(ze))if(Su)gt=Zh;else{gt=Ha;var Zt=Cu}else $e=ze.nodeName,!$e||$e.toLowerCase()!=="input"||ze.type!=="checkbox"&&ze.type!=="radio"?Le&&io(Le.elementType)&&(gt=Gr):gt=bl;if(gt&&(gt=gt(s,Le))){ho(Xe,gt,h,Qe);break e}Zt&&Zt(s,ze,Le),s==="focusout"&&Le&&ze.type==="number"&&Le.memoizedProps.value!=null&&ps(ze,"number",ze.value)}switch(Zt=Le?Ks(Le):window,s){case"focusin":(yl(Zt)||Zt.contentEditable==="true")&&(Ga=Zt,Ya=Le,ke=null);break;case"focusout":ke=Ya=Ga=null;break;case"mousedown":Ye=!0;break;case"contextmenu":case"mouseup":case"dragend":Ye=!1,Be(Xe,h,Qe);break;case"selectionchange":if(tp)break;case"keydown":case"keyup":Be(Xe,h,Qe)}var xt;if(pl)e:{switch(s){case"compositionstart":var Pt="onCompositionStart";break e;case"compositionend":Pt="onCompositionEnd";break e;case"compositionupdate":Pt="onCompositionUpdate";break e}Pt=void 0}else qa?Xd(s,h)&&(Pt="onCompositionEnd"):s==="keydown"&&h.keyCode===229&&(Pt="onCompositionStart");Pt&&(gl&&h.locale!=="ko"&&(qa||Pt!=="onCompositionStart"?Pt==="onCompositionEnd"&&qa&&(xt=uc()):($a=Qe,cl="value"in $a?$a.value:$a.textContent,qa=!0)),Zt=Wf(Le,Pt),0<Zt.length&&(Pt=new $i(Pt,s,null,h,Qe),Xe.push({event:Pt,listeners:Zt}),xt?Pt.data=xt:(xt=xc(h),xt!==null&&(Pt.data=xt)))),(xt=ml?Xh(s,h):Zd(s,h))&&(Pt=Wf(Le,"onBeforeInput"),0<Pt.length&&(Zt=new $i("onBeforeInput","beforeinput",null,h,Qe),Xe.push({event:Zt,listeners:Pt}),Zt.data=xt)),lv(Xe,s,Le,h,Qe)}Ry(Xe,c)})}function Lt(s,c,h){return{instance:s,listener:c,currentTarget:h}}function Wf(s,c){for(var h=c+"Capture",x=[];s!==null;){var N=s,E=N.stateNode;if(N=N.tag,N!==5&&N!==26&&N!==27||E===null||(N=Qi(s,h),N!=null&&x.unshift(Lt(s,N,E)),N=Qi(s,c),N!=null&&x.push(Lt(s,N,E))),s.tag===3)return x;s=s.return}return[]}function Si(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function ui(s,c,h,x,N){for(var E=c._reactName,q=[];h!==null&&h!==x;){var X=h,ge=X.alternate,Le=X.stateNode;if(X=X.tag,ge!==null&&ge===x)break;X!==5&&X!==26&&X!==27||Le===null||(ge=Le,N?(Le=Qi(h,E),Le!=null&&q.unshift(Lt(h,Le,ge))):N||(Le=Qi(h,E),Le!=null&&q.push(Lt(h,Le,ge)))),h=h.return}q.length!==0&&s.push({event:c,listeners:q})}var fv=/\r\n?/g,Oo=/\u0000|\uFFFD/g;function Oy(s){return(typeof s=="string"?s:""+s).replace(fv,`
`).replace(Oo,"")}function Ly(s,c){return c=Oy(c),Oy(s)===c}function Qf(){}function In(s,c,h,x,N,E){switch(h){case"children":typeof x=="string"?c==="body"||c==="textarea"&&x===""||Tr(s,x):(typeof x=="number"||typeof x=="bigint")&&c!=="body"&&Tr(s,""+x);break;case"className":el(s,"class",x);break;case"tabIndex":el(s,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":el(s,h,x);break;case"style":sc(s,x,E);break;case"data":if(c!=="object"){el(s,"data",x);break}case"src":case"href":if(x===""&&(c!=="a"||h!=="href")){s.removeAttribute(h);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(h);break}x=gs(""+x),s.setAttribute(h,x);break;case"action":case"formAction":if(typeof x=="function"){s.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(h==="formAction"?(c!=="input"&&In(s,c,"name",N.name,N,null),In(s,c,"formEncType",N.formEncType,N,null),In(s,c,"formMethod",N.formMethod,N,null),In(s,c,"formTarget",N.formTarget,N,null)):(In(s,c,"encType",N.encType,N,null),In(s,c,"method",N.method,N,null),In(s,c,"target",N.target,N,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(h);break}x=gs(""+x),s.setAttribute(h,x);break;case"onClick":x!=null&&(s.onclick=Qf);break;case"onScroll":x!=null&&nn("scroll",s);break;case"onScrollEnd":x!=null&&nn("scrollend",s);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(i(61));if(h=x.__html,h!=null){if(N.children!=null)throw Error(i(60));s.innerHTML=h}}break;case"multiple":s.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":s.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){s.removeAttribute("xlink:href");break}h=gs(""+x),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(h,""+x):s.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(h,""):s.removeAttribute(h);break;case"capture":case"download":x===!0?s.setAttribute(h,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(h,x):s.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?s.setAttribute(h,x):s.removeAttribute(h);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?s.removeAttribute(h):s.setAttribute(h,x);break;case"popover":nn("beforetoggle",s),nn("toggle",s),Ra(s,"popover",x);break;case"xlinkActuate":kr(s,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":kr(s,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":kr(s,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":kr(s,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":kr(s,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":kr(s,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":kr(s,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":kr(s,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":kr(s,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":Ra(s,"is",x);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=Yd.get(h)||h,Ra(s,h,x))}}function om(s,c,h,x,N,E){switch(h){case"style":sc(s,x,E);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(i(61));if(h=x.__html,h!=null){if(N.children!=null)throw Error(i(60));s.innerHTML=h}}break;case"children":typeof x=="string"?Tr(s,x):(typeof x=="number"||typeof x=="bigint")&&Tr(s,""+x);break;case"onScroll":x!=null&&nn("scroll",s);break;case"onScrollEnd":x!=null&&nn("scrollend",s);break;case"onClick":x!=null&&(s.onclick=Qf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Hd.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(N=h.endsWith("Capture"),c=h.slice(2,N?h.length-7:void 0),E=s[Ri]||null,E=E!=null?E[h]:null,typeof E=="function"&&s.removeEventListener(c,E,N),typeof x=="function")){typeof E!="function"&&E!==null&&(h in s?s[h]=null:s.hasAttribute(h)&&s.removeAttribute(h)),s.addEventListener(c,x,N);break e}h in s?s[h]=x:x===!0?s.setAttribute(h,""):Ra(s,h,x)}}}function Ni(s,c,h){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":nn("error",s),nn("load",s);var x=!1,N=!1,E;for(E in h)if(h.hasOwnProperty(E)){var q=h[E];if(q!=null)switch(E){case"src":x=!0;break;case"srcSet":N=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,c));default:In(s,c,E,q,h,null)}}N&&In(s,c,"srcSet",h.srcSet,h,null),x&&In(s,c,"src",h.src,h,null);return;case"input":nn("invalid",s);var X=E=q=N=null,ge=null,Le=null;for(x in h)if(h.hasOwnProperty(x)){var Qe=h[x];if(Qe!=null)switch(x){case"name":N=Qe;break;case"type":q=Qe;break;case"checked":ge=Qe;break;case"defaultChecked":Le=Qe;break;case"value":E=Qe;break;case"defaultValue":X=Qe;break;case"children":case"dangerouslySetInnerHTML":if(Qe!=null)throw Error(i(137,c));break;default:In(s,c,x,Qe,h,null)}}ac(s,E,X,ge,Le,q,N,!1),il(s);return;case"select":nn("invalid",s),x=q=E=null;for(N in h)if(h.hasOwnProperty(N)&&(X=h[N],X!=null))switch(N){case"value":E=X;break;case"defaultValue":q=X;break;case"multiple":x=X;default:In(s,c,N,X,h,null)}c=E,h=q,s.multiple=!!x,c!=null?ms(s,!!x,c,!1):h!=null&&ms(s,!!x,h,!0);return;case"textarea":nn("invalid",s),E=N=x=null;for(q in h)if(h.hasOwnProperty(q)&&(X=h[q],X!=null))switch(q){case"value":x=X;break;case"defaultValue":N=X;break;case"children":E=X;break;case"dangerouslySetInnerHTML":if(X!=null)throw Error(i(91));break;default:In(s,c,q,X,h,null)}al(s,x,N,E),il(s);return;case"option":for(ge in h)if(h.hasOwnProperty(ge)&&(x=h[ge],x!=null))switch(ge){case"selected":s.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:In(s,c,ge,x,h,null)}return;case"dialog":nn("beforetoggle",s),nn("toggle",s),nn("cancel",s),nn("close",s);break;case"iframe":case"object":nn("load",s);break;case"video":case"audio":for(x=0;x<xd.length;x++)nn(xd[x],s);break;case"image":nn("error",s),nn("load",s);break;case"details":nn("toggle",s);break;case"embed":case"source":case"link":nn("error",s),nn("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Le in h)if(h.hasOwnProperty(Le)&&(x=h[Le],x!=null))switch(Le){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,c));default:In(s,c,Le,x,h,null)}return;default:if(io(c)){for(Qe in h)h.hasOwnProperty(Qe)&&(x=h[Qe],x!==void 0&&om(s,c,Qe,x,h,void 0));return}}for(X in h)h.hasOwnProperty(X)&&(x=h[X],x!=null&&In(s,c,X,x,h,null))}function hv(s,c,h,x){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var N=null,E=null,q=null,X=null,ge=null,Le=null,Qe=null;for($e in h){var Xe=h[$e];if(h.hasOwnProperty($e)&&Xe!=null)switch($e){case"checked":break;case"value":break;case"defaultValue":ge=Xe;default:x.hasOwnProperty($e)||In(s,c,$e,null,x,Xe)}}for(var ze in x){var $e=x[ze];if(Xe=h[ze],x.hasOwnProperty(ze)&&($e!=null||Xe!=null))switch(ze){case"type":E=$e;break;case"name":N=$e;break;case"checked":Le=$e;break;case"defaultChecked":Qe=$e;break;case"value":q=$e;break;case"defaultValue":X=$e;break;case"children":case"dangerouslySetInnerHTML":if($e!=null)throw Error(i(137,c));break;default:$e!==Xe&&In(s,c,ze,$e,x,Xe)}}to(s,q,X,ge,Le,Qe,E,N);return;case"select":$e=q=X=ze=null;for(E in h)if(ge=h[E],h.hasOwnProperty(E)&&ge!=null)switch(E){case"value":break;case"multiple":$e=ge;default:x.hasOwnProperty(E)||In(s,c,E,null,x,ge)}for(N in x)if(E=x[N],ge=h[N],x.hasOwnProperty(N)&&(E!=null||ge!=null))switch(N){case"value":ze=E;break;case"defaultValue":X=E;break;case"multiple":q=E;default:E!==ge&&In(s,c,N,E,x,ge)}c=X,h=q,x=$e,ze!=null?ms(s,!!h,ze,!1):!!x!=!!h&&(c!=null?ms(s,!!h,c,!0):ms(s,!!h,h?[]:"",!1));return;case"textarea":$e=ze=null;for(X in h)if(N=h[X],h.hasOwnProperty(X)&&N!=null&&!x.hasOwnProperty(X))switch(X){case"value":break;case"children":break;default:In(s,c,X,null,x,N)}for(q in x)if(N=x[q],E=h[q],x.hasOwnProperty(q)&&(N!=null||E!=null))switch(q){case"value":ze=N;break;case"defaultValue":$e=N;break;case"children":break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(i(91));break;default:N!==E&&In(s,c,q,N,x,E)}rl(s,ze,$e);return;case"option":for(var At in h)if(ze=h[At],h.hasOwnProperty(At)&&ze!=null&&!x.hasOwnProperty(At))switch(At){case"selected":s.selected=!1;break;default:In(s,c,At,null,x,ze)}for(ge in x)if(ze=x[ge],$e=h[ge],x.hasOwnProperty(ge)&&ze!==$e&&(ze!=null||$e!=null))switch(ge){case"selected":s.selected=ze&&typeof ze!="function"&&typeof ze!="symbol";break;default:In(s,c,ge,ze,x,$e)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Tt in h)ze=h[Tt],h.hasOwnProperty(Tt)&&ze!=null&&!x.hasOwnProperty(Tt)&&In(s,c,Tt,null,x,ze);for(Le in x)if(ze=x[Le],$e=h[Le],x.hasOwnProperty(Le)&&ze!==$e&&(ze!=null||$e!=null))switch(Le){case"children":case"dangerouslySetInnerHTML":if(ze!=null)throw Error(i(137,c));break;default:In(s,c,Le,ze,x,$e)}return;default:if(io(c)){for(var Rn in h)ze=h[Rn],h.hasOwnProperty(Rn)&&ze!==void 0&&!x.hasOwnProperty(Rn)&&om(s,c,Rn,void 0,x,ze);for(Qe in x)ze=x[Qe],$e=h[Qe],!x.hasOwnProperty(Qe)||ze===$e||ze===void 0&&$e===void 0||om(s,c,Qe,ze,x,$e);return}}for(var Te in h)ze=h[Te],h.hasOwnProperty(Te)&&ze!=null&&!x.hasOwnProperty(Te)&&In(s,c,Te,null,x,ze);for(Xe in x)ze=x[Xe],$e=h[Xe],!x.hasOwnProperty(Xe)||ze===$e||ze==null&&$e==null||In(s,c,Xe,ze,x,$e)}var Ca=null,Jf=null;function Ul(s){return s.nodeType===9?s:s.ownerDocument}function ti(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ai(s,c){if(s===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&c==="foreignObject"?0:s}function Kf(s,c){return s==="textarea"||s==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var lm=null;function pv(){var s=window.event;return s&&s.type==="popstate"?s===lm?!1:(lm=s,!0):(lm=null,!1)}var Fy=typeof setTimeout=="function"?setTimeout:void 0,mv=typeof clearTimeout=="function"?clearTimeout:void 0,$y=typeof Promise=="function"?Promise:void 0,gv=typeof queueMicrotask=="function"?queueMicrotask:typeof $y<"u"?function(s){return $y.resolve(null).then(s).catch(zy)}:Fy;function zy(s){setTimeout(function(){throw s})}function na(s){return s==="head"}function Xf(s,c){var h=c,x=0,N=0;do{var E=h.nextSibling;if(s.removeChild(h),E&&E.nodeType===8)if(h=E.data,h==="/$"){if(0<x&&8>x){h=x;var q=s.ownerDocument;if(h&1&&bd(q.documentElement),h&2&&bd(q.body),h&4)for(h=q.head,bd(h),q=h.firstChild;q;){var X=q.nextSibling,ge=q.nodeName;q[Qs]||ge==="SCRIPT"||ge==="STYLE"||ge==="LINK"&&q.rel.toLowerCase()==="stylesheet"||h.removeChild(q),q=X}}if(N===0){s.removeChild(E),kd(c);return}N--}else h==="$"||h==="$?"||h==="$!"?N++:x=h.charCodeAt(0)-48;else x=0;h=E}while(h);kd(c)}function cm(s){var c=s.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var h=c;switch(c=c.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":cm(h),Kl(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}s.removeChild(h)}}function Uy(s,c,h,x){for(;s.nodeType===1;){var N=h;if(s.nodeName.toLowerCase()!==c.toLowerCase()){if(!x&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(x){if(!s[Qs])switch(c){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(E=s.getAttribute("rel"),E==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(E!==N.rel||s.getAttribute("href")!==(N.href==null||N.href===""?null:N.href)||s.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin)||s.getAttribute("title")!==(N.title==null?null:N.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(E=s.getAttribute("src"),(E!==(N.src==null?null:N.src)||s.getAttribute("type")!==(N.type==null?null:N.type)||s.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin))&&E&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(c==="input"&&s.type==="hidden"){var E=N.name==null?null:""+N.name;if(N.type==="hidden"&&s.getAttribute("name")===E)return s}else return s;if(s=ja(s.nextSibling),s===null)break}return null}function Zf(s,c,h){if(c==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!h||(s=ja(s.nextSibling),s===null))return null;return s}function ar(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function Gc(s,c){var h=s.ownerDocument;if(s.data!=="$?"||h.readyState==="complete")c();else{var x=function(){c(),h.removeEventListener("DOMContentLoaded",x)};h.addEventListener("DOMContentLoaded",x),s._reactRetry=x}}function ja(s){for(;s!=null;s=s.nextSibling){var c=s.nodeType;if(c===1||c===3)break;if(c===8){if(c=s.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return s}var um=null;function By(s){s=s.previousSibling;for(var c=0;s;){if(s.nodeType===8){var h=s.data;if(h==="$"||h==="$!"||h==="$?"){if(c===0)return s;c--}else h==="/$"&&c++}s=s.previousSibling}return null}function qy(s,c,h){switch(c=Ul(h),s){case"html":if(s=c.documentElement,!s)throw Error(i(452));return s;case"head":if(s=c.head,!s)throw Error(i(453));return s;case"body":if(s=c.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function bd(s){for(var c=s.attributes;c.length;)s.removeAttributeNode(c[0]);Kl(s)}var Fr=new Map,ns=new Set;function Ut(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var is=W.d;W.d={f:ia,r:Vy,D:yv,C:Hy,L:eh,m:xv,X:vv,S:bv,M:wv};function ia(){var s=is.f(),c=Uf();return s||c}function Vy(s){var c=Js(s);c!==null&&c.tag===5&&c.type==="form"?Cf(c):is.r(s)}var Yc=typeof document>"u"?null:document;function Nn(s,c,h){var x=Yc;if(x&&typeof c=="string"&&c){var N=Wi(c);N='link[rel="'+s+'"][href="'+N+'"]',typeof h=="string"&&(N+='[crossorigin="'+h+'"]'),ns.has(N)||(ns.add(N),s={rel:s,crossOrigin:h,href:c},x.querySelector(N)===null&&(c=x.createElement("link"),Ni(c,"link",s),pi(c),x.head.appendChild(c)))}}function yv(s){is.D(s),Nn("dns-prefetch",s,null)}function Hy(s,c){is.C(s,c),Nn("preconnect",s,c)}function eh(s,c,h){is.L(s,c,h);var x=Yc;if(x&&s&&c){var N='link[rel="preload"][as="'+Wi(c)+'"]';c==="image"&&h&&h.imageSrcSet?(N+='[imagesrcset="'+Wi(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(N+='[imagesizes="'+Wi(h.imageSizes)+'"]')):N+='[href="'+Wi(s)+'"]';var E=N;switch(c){case"style":E=Wc(s);break;case"script":E=Qc(s)}Fr.has(E)||(s=p({rel:"preload",href:c==="image"&&h&&h.imageSrcSet?void 0:s,as:c},h),Fr.set(E,s),x.querySelector(N)!==null||c==="style"&&x.querySelector(vd(E))||c==="script"&&x.querySelector(wd(E))||(c=x.createElement("link"),Ni(c,"link",s),pi(c),x.head.appendChild(c)))}}function xv(s,c){is.m(s,c);var h=Yc;if(h&&s){var x=c&&typeof c.as=="string"?c.as:"script",N='link[rel="modulepreload"][as="'+Wi(x)+'"][href="'+Wi(s)+'"]',E=N;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=Qc(s)}if(!Fr.has(E)&&(s=p({rel:"modulepreload",href:s},c),Fr.set(E,s),h.querySelector(N)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(wd(E)))return}x=h.createElement("link"),Ni(x,"link",s),pi(x),h.head.appendChild(x)}}}function bv(s,c,h){is.S(s,c,h);var x=Yc;if(x&&s){var N=Xs(x).hoistableStyles,E=Wc(s);c=c||"default";var q=N.get(E);if(!q){var X={loading:0,preload:null};if(q=x.querySelector(vd(E)))X.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":c},h),(h=Fr.get(E))&&Sd(s,h);var ge=q=x.createElement("link");pi(ge),Ni(ge,"link",s),ge._p=new Promise(function(Le,Qe){ge.onload=Le,ge.onerror=Qe}),ge.addEventListener("load",function(){X.loading|=1}),ge.addEventListener("error",function(){X.loading|=2}),X.loading|=4,th(q,c,x)}q={type:"stylesheet",instance:q,count:1,state:X},N.set(E,q)}}}function vv(s,c){is.X(s,c);var h=Yc;if(h&&s){var x=Xs(h).hoistableScripts,N=Qc(s),E=x.get(N);E||(E=h.querySelector(wd(N)),E||(s=p({src:s,async:!0},c),(c=Fr.get(N))&&dm(s,c),E=h.createElement("script"),pi(E),Ni(E,"link",s),h.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},x.set(N,E))}}function wv(s,c){is.M(s,c);var h=Yc;if(h&&s){var x=Xs(h).hoistableScripts,N=Qc(s),E=x.get(N);E||(E=h.querySelector(wd(N)),E||(s=p({src:s,async:!0,type:"module"},c),(c=Fr.get(N))&&dm(s,c),E=h.createElement("script"),pi(E),Ni(E,"link",s),h.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},x.set(N,E))}}function Gy(s,c,h,x){var N=(N=Z.current)?Ut(N):null;if(!N)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(c=Wc(h.href),h=Xs(N).hoistableStyles,x=h.get(c),x||(x={type:"style",instance:null,count:0,state:null},h.set(c,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){s=Wc(h.href);var E=Xs(N).hoistableStyles,q=E.get(s);if(q||(N=N.ownerDocument||N,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(s,q),(E=N.querySelector(vd(s)))&&!E._p&&(q.instance=E,q.state.loading=5),Fr.has(s)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Fr.set(s,h),E||Sv(N,s,h,q.state))),c&&x===null)throw Error(i(528,""));return q}if(c&&x!==null)throw Error(i(529,""));return null;case"script":return c=h.async,h=h.src,typeof h=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Qc(h),h=Xs(N).hoistableScripts,x=h.get(c),x||(x={type:"script",instance:null,count:0,state:null},h.set(c,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Wc(s){return'href="'+Wi(s)+'"'}function vd(s){return'link[rel="stylesheet"]['+s+"]"}function Yy(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function Sv(s,c,h,x){s.querySelector('link[rel="preload"][as="style"]['+c+"]")?x.loading=1:(c=s.createElement("link"),x.preload=c,c.addEventListener("load",function(){return x.loading|=1}),c.addEventListener("error",function(){return x.loading|=2}),Ni(c,"link",h),pi(c),s.head.appendChild(c))}function Qc(s){return'[src="'+Wi(s)+'"]'}function wd(s){return"script[async]"+s}function Wy(s,c,h){if(c.count++,c.instance===null)switch(c.type){case"style":var x=s.querySelector('style[data-href~="'+Wi(h.href)+'"]');if(x)return c.instance=x,pi(x),x;var N=p({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return x=(s.ownerDocument||s).createElement("style"),pi(x),Ni(x,"style",N),th(x,h.precedence,s),c.instance=x;case"stylesheet":N=Wc(h.href);var E=s.querySelector(vd(N));if(E)return c.state.loading|=4,c.instance=E,pi(E),E;x=Yy(h),(N=Fr.get(N))&&Sd(x,N),E=(s.ownerDocument||s).createElement("link"),pi(E);var q=E;return q._p=new Promise(function(X,ge){q.onload=X,q.onerror=ge}),Ni(E,"link",x),c.state.loading|=4,th(E,h.precedence,s),c.instance=E;case"script":return E=Qc(h.src),(N=s.querySelector(wd(E)))?(c.instance=N,pi(N),N):(x=h,(N=Fr.get(E))&&(x=p({},h),dm(x,N)),s=s.ownerDocument||s,N=s.createElement("script"),pi(N),Ni(N,"link",x),s.head.appendChild(N),c.instance=N);case"void":return null;default:throw Error(i(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(x=c.instance,c.state.loading|=4,th(x,h.precedence,s));return c.instance}function th(s,c,h){for(var x=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),N=x.length?x[x.length-1]:null,E=N,q=0;q<x.length;q++){var X=x[q];if(X.dataset.precedence===c)E=X;else if(E!==N)break}E?E.parentNode.insertBefore(s,E.nextSibling):(c=h.nodeType===9?h.head:h,c.insertBefore(s,c.firstChild))}function Sd(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.title==null&&(s.title=c.title)}function dm(s,c){s.crossOrigin==null&&(s.crossOrigin=c.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=c.referrerPolicy),s.integrity==null&&(s.integrity=c.integrity)}var Jc=null;function Qy(s,c,h){if(Jc===null){var x=new Map,N=Jc=new Map;N.set(h,x)}else N=Jc,x=N.get(h),x||(x=new Map,N.set(h,x));if(x.has(s))return x;for(x.set(s,null),h=h.getElementsByTagName(s),N=0;N<h.length;N++){var E=h[N];if(!(E[Qs]||E[zn]||s==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var q=E.getAttribute(c)||"";q=s+q;var X=x.get(q);X?X.push(E):x.set(q,[E])}}return x}function Jy(s,c,h){s=s.ownerDocument||s,s.head.insertBefore(h,c==="title"?s.querySelector("head > title"):null)}function Nv(s,c,h){if(h===1||c.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return s=c.disabled,typeof c.precedence=="string"&&s==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function Ci(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var Ei=null;function Cv(){}function jv(s,c,h){if(Ei===null)throw Error(i(475));var x=Ei;if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var N=Wc(h.href),E=s.querySelector(vd(N));if(E){s=E._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(x.count++,x=Nd.bind(x),s.then(x,x)),c.state.loading|=4,c.instance=E,pi(E);return}E=s.ownerDocument||s,h=Yy(h),(N=Fr.get(N))&&Sd(h,N),E=E.createElement("link"),pi(E);var q=E;q._p=new Promise(function(X,ge){q.onload=X,q.onerror=ge}),Ni(E,"link",h),c.instance=E}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(x.count++,c=Nd.bind(x),s.addEventListener("load",c),s.addEventListener("error",c))}}function _v(){if(Ei===null)throw Error(i(475));var s=Ei;return s.stylesheets&&s.count===0&&fm(s,s.stylesheets),0<s.count?function(c){var h=setTimeout(function(){if(s.stylesheets&&fm(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(h)}}:null}function Nd(){if(this.count--,this.count===0){if(this.stylesheets)fm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var nh=null;function fm(s,c){s.stylesheets=null,s.unsuspend!==null&&(s.count++,nh=new Map,c.forEach(kv,s),nh=null,Nd.call(s))}function kv(s,c){if(!(c.state.loading&4)){var h=nh.get(s);if(h)var x=h.get(null);else{h=new Map,nh.set(s,h);for(var N=s.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<N.length;E++){var q=N[E];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(h.set(q.dataset.precedence,q),x=q)}x&&h.set(null,x)}N=c.instance,q=N.getAttribute("data-precedence"),E=h.get(q)||x,E===x&&h.set(null,N),h.set(q,N),this.count++,x=Nd.bind(this),N.addEventListener("load",x),N.addEventListener("error",x),E?E.parentNode.insertBefore(N,E.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(N,s.firstChild)),c.state.loading|=4}}var Kc={$$typeof:I,Provider:null,Consumer:null,_currentValue:J,_currentValue2:J,_threadCount:0};function Tv(s,c,h,x,N,E,q,X){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Pn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pn(0),this.hiddenUpdates=Pn(null),this.identifierPrefix=x,this.onUncaughtError=N,this.onCaughtError=E,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=X,this.incompleteTransitions=new Map}function Ky(s,c,h,x,N,E,q,X,ge,Le,Qe,Xe){return s=new Tv(s,c,h,q,X,ge,Le,Xe),c=1,E===!0&&(c|=24),E=cr(3,null,null,c),s.current=E,E.stateNode=s,c=sp(),c.refCount++,s.pooledCache=c,c.refCount++,E.memoizedState={element:x,isDehydrated:h,cache:c},Tl(E),s}function Xy(s){return s?(s=wl,s):wl}function hm(s,c,h,x,N,E){N=Xy(N),x.context===null?x.context=N:x.pendingContext=N,x=wo(c),x.payload={element:h},E=E===void 0?null:E,E!==null&&(x.callback=E),h=_s(s,x,c),h!==null&&(Lr(h,s,c),Ou(h,s,c))}function pm(s,c){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var h=s.retryLane;s.retryLane=h!==0&&h<c?h:c}}function mm(s,c){pm(s,c),(s=s.alternate)&&pm(s,c)}function Zy(s){if(s.tag===13){var c=Ss(s,67108864);c!==null&&Lr(c,s,67108864),mm(s,67108864)}}var ih=!0;function Ev(s,c,h,x){var N=V.T;V.T=null;var E=W.p;try{W.p=2,gm(s,c,h,x)}finally{W.p=E,V.T=N}}function Xc(s,c,h,x){var N=V.T;V.T=null;var E=W.p;try{W.p=8,gm(s,c,h,x)}finally{W.p=E,V.T=N}}function gm(s,c,h,x){if(ih){var N=ym(x);if(N===null)Ls(s,c,x,rh,h),tx(s,x);else if(Pv(N,s,c,h,x))x.stopPropagation();else if(tx(s,x),c&4&&-1<Av.indexOf(s)){for(;N!==null;){var E=Js(N);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var q=Oe(E.pendingLanes);if(q!==0){var X=E;for(X.pendingLanes|=2,X.entangledLanes|=2;q;){var ge=1<<31-nt(q);X.entanglements[1]|=ge,q&=~ge}ts(E),(_n&6)===0&&(zc=ut()+500,md(0))}}break;case 13:X=Ss(E,2),X!==null&&Lr(X,E,2),Uf(),mm(E,2)}if(E=ym(x),E===null&&Ls(s,c,x,rh,h),E===N)break;N=E}N!==null&&x.stopPropagation()}else Ls(s,c,x,null,h)}}function ym(s){return s=sl(s),xm(s)}var rh=null;function xm(s){if(rh=null,s=ds(s),s!==null){var c=o(s);if(c===null)s=null;else{var h=c.tag;if(h===13){if(s=l(c),s!==null)return s;s=null}else if(h===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;s=null}else c!==s&&(s=null)}}return rh=s,null}function ex(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(at()){case qt:return 2;case jt:return 8;case _e:case Fe:return 32;case Pe:return 268435456;default:return 32}default:return 32}}var ah=!1,Fs=null,Lo=null,Fo=null,Cd=new Map,jd=new Map,$o=[],Av="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function tx(s,c){switch(s){case"focusin":case"focusout":Fs=null;break;case"dragenter":case"dragleave":Lo=null;break;case"mouseover":case"mouseout":Fo=null;break;case"pointerover":case"pointerout":Cd.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":jd.delete(c.pointerId)}}function _d(s,c,h,x,N,E){return s===null||s.nativeEvent!==E?(s={blockedOn:c,domEventName:h,eventSystemFlags:x,nativeEvent:E,targetContainers:[N]},c!==null&&(c=Js(c),c!==null&&Zy(c)),s):(s.eventSystemFlags|=x,c=s.targetContainers,N!==null&&c.indexOf(N)===-1&&c.push(N),s)}function Pv(s,c,h,x,N){switch(c){case"focusin":return Fs=_d(Fs,s,c,h,x,N),!0;case"dragenter":return Lo=_d(Lo,s,c,h,x,N),!0;case"mouseover":return Fo=_d(Fo,s,c,h,x,N),!0;case"pointerover":var E=N.pointerId;return Cd.set(E,_d(Cd.get(E)||null,s,c,h,x,N)),!0;case"gotpointercapture":return E=N.pointerId,jd.set(E,_d(jd.get(E)||null,s,c,h,x,N)),!0}return!1}function nx(s){var c=ds(s.target);if(c!==null){var h=o(c);if(h!==null){if(c=h.tag,c===13){if(c=l(h),c!==null){s.blockedOn=c,Ws(s.priority,function(){if(h.tag===13){var x=Vi();x=Dn(x);var N=Ss(h,x);N!==null&&Lr(N,h,x),mm(h,x)}});return}}else if(c===3&&h.stateNode.current.memoizedState.isDehydrated){s.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}s.blockedOn=null}function sh(s){if(s.blockedOn!==null)return!1;for(var c=s.targetContainers;0<c.length;){var h=ym(s.nativeEvent);if(h===null){h=s.nativeEvent;var x=new h.constructor(h.type,h);ro=x,h.target.dispatchEvent(x),ro=null}else return c=Js(h),c!==null&&Zy(c),s.blockedOn=h,!1;c.shift()}return!0}function ix(s,c,h){sh(s)&&h.delete(c)}function Dv(){ah=!1,Fs!==null&&sh(Fs)&&(Fs=null),Lo!==null&&sh(Lo)&&(Lo=null),Fo!==null&&sh(Fo)&&(Fo=null),Cd.forEach(ix),jd.forEach(ix)}function oh(s,c){s.blockedOn===c&&(s.blockedOn=null,ah||(ah=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Dv)))}var lh=null;function rx(s){lh!==s&&(lh=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){lh===s&&(lh=null);for(var c=0;c<s.length;c+=3){var h=s[c],x=s[c+1],N=s[c+2];if(typeof x!="function"){if(xm(x||h)===null)continue;break}var E=Js(h);E!==null&&(s.splice(c,3),c-=3,Yu(E,{pending:!0,data:N,method:h.method,action:x},x,N))}}))}function kd(s){function c(ge){return oh(ge,s)}Fs!==null&&oh(Fs,s),Lo!==null&&oh(Lo,s),Fo!==null&&oh(Fo,s),Cd.forEach(c),jd.forEach(c);for(var h=0;h<$o.length;h++){var x=$o[h];x.blockedOn===s&&(x.blockedOn=null)}for(;0<$o.length&&(h=$o[0],h.blockedOn===null);)nx(h),h.blockedOn===null&&$o.shift();if(h=(s.ownerDocument||s).$$reactFormReplay,h!=null)for(x=0;x<h.length;x+=3){var N=h[x],E=h[x+1],q=N[Ri]||null;if(typeof E=="function")q||rx(h);else if(q){var X=null;if(E&&E.hasAttribute("formAction")){if(N=E,q=E[Ri]||null)X=q.formAction;else if(xm(N)!==null)continue}else X=q.action;typeof X=="function"?h[x+1]=X:(h.splice(x,3),x-=3),rx(h)}}}function bm(s){this._internalRoot=s}ch.prototype.render=bm.prototype.render=function(s){var c=this._internalRoot;if(c===null)throw Error(i(409));var h=c.current,x=Vi();hm(h,x,s,c,null,null)},ch.prototype.unmount=bm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var c=s.containerInfo;hm(s.current,2,null,s,null,null),Uf(),c[ha]=null}};function ch(s){this._internalRoot=s}ch.prototype.unstable_scheduleHydration=function(s){if(s){var c=Ys();s={blockedOn:null,target:s,priority:c};for(var h=0;h<$o.length&&c!==0&&c<$o[h].priority;h++);$o.splice(h,0,s),h===0&&nx(s)}};var ax=n.version;if(ax!=="19.1.0")throw Error(i(527,ax,"19.1.0"));W.findDOMNode=function(s){var c=s._reactInternals;if(c===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=f(c),s=s!==null?u(s):null,s=s===null?null:s.stateNode,s};var Iv={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var uh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!uh.isDisabled&&uh.supportsFiber)try{ee=uh.inject(Iv),fe=uh}catch{}}return wm.createRoot=function(s,c){if(!a(s))throw Error(i(299));var h=!1,x="",N=Dp,E=kf,q=Vg,X=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(N=c.onUncaughtError),c.onCaughtError!==void 0&&(E=c.onCaughtError),c.onRecoverableError!==void 0&&(q=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(X=c.unstable_transitionCallbacks)),c=Ky(s,1,!1,null,null,h,x,N,E,q,X,null),s[ha]=c.current,sm(s),new bm(c)},wm.hydrateRoot=function(s,c,h){if(!a(s))throw Error(i(299));var x=!1,N="",E=Dp,q=kf,X=Vg,ge=null,Le=null;return h!=null&&(h.unstable_strictMode===!0&&(x=!0),h.identifierPrefix!==void 0&&(N=h.identifierPrefix),h.onUncaughtError!==void 0&&(E=h.onUncaughtError),h.onCaughtError!==void 0&&(q=h.onCaughtError),h.onRecoverableError!==void 0&&(X=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(ge=h.unstable_transitionCallbacks),h.formState!==void 0&&(Le=h.formState)),c=Ky(s,1,!0,c,h??null,x,N,E,q,X,ge,Le),c.context=Xy(null),h=c.current,x=Vi(),x=Dn(x),N=wo(x),N.callback=null,_s(h,N,x),h=x,c.current.lanes=h,Et(c,h),ts(c),s[ha]=c.current,sm(s),new ch(c)},wm.version="19.1.0",wm}var yS;function rP(){if(yS)return $v.exports;yS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),$v.exports=iP(),$v.exports}var aP=rP();function sP(e={}){const{nonce:n,locale:t,onScriptLoadSuccess:i,onScriptLoadError:a}=e,[o,l]=w.useState(!1),d=w.useRef(i);d.current=i;const f=w.useRef(a);return f.current=a,w.useEffect(()=>{const u=document.createElement("script");return u.src="https://accounts.google.com/gsi/client",t&&(u.src+=`?hl=${t}`),u.async=!0,u.defer=!0,u.nonce=n,u.onload=()=>{var p;l(!0),(p=d.current)===null||p===void 0||p.call(d)},u.onerror=()=>{var p;l(!1),(p=f.current)===null||p===void 0||p.call(f)},document.body.appendChild(u),()=>{document.body.removeChild(u)}},[n]),o}const M_=w.createContext(null);function oP({clientId:e,nonce:n,locale:t,onScriptLoadSuccess:i,onScriptLoadError:a,children:o}){const l=sP({nonce:n,onScriptLoadSuccess:i,onScriptLoadError:a,locale:t}),d=w.useMemo(()=>({locale:t,clientId:e,scriptLoadedSuccessfully:l}),[e,l]);return vn.createElement(M_.Provider,{value:d},o)}function lP(){const e=w.useContext(M_);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function cP(e){var n;return(n=e==null?void 0:e.clientId)!==null&&n!==void 0?n:e==null?void 0:e.client_id}const uP={large:40,medium:32,small:20};function dP({onSuccess:e,onError:n,useOneTap:t,promptMomentNotification:i,type:a="standard",theme:o="outline",size:l="large",text:d,shape:f,logo_alignment:u,width:p,click_listener:g,state:b,containerProps:v,...S}){const k=w.useRef(null),{clientId:T,locale:P,scriptLoadedSuccessfully:M}=lP(),I=w.useRef(e);I.current=e;const U=w.useRef(n);U.current=n;const L=w.useRef(i);return L.current=i,w.useEffect(()=>{var $,z,F,Q,R,B,Y,re,ne;if(M)return(F=(z=($=window==null?void 0:window.google)===null||$===void 0?void 0:$.accounts)===null||z===void 0?void 0:z.id)===null||F===void 0||F.initialize({client_id:T,callback:G=>{var V;if(!(G!=null&&G.credential))return(V=U.current)===null||V===void 0?void 0:V.call(U);const{credential:W,select_by:J}=G;I.current({credential:W,clientId:cP(G),select_by:J})},...S}),(B=(R=(Q=window==null?void 0:window.google)===null||Q===void 0?void 0:Q.accounts)===null||R===void 0?void 0:R.id)===null||B===void 0||B.renderButton(k.current,{type:a,theme:o,size:l,text:d,shape:f,logo_alignment:u,width:p,locale:P,click_listener:g,state:b}),t&&((ne=(re=(Y=window==null?void 0:window.google)===null||Y===void 0?void 0:Y.accounts)===null||re===void 0?void 0:re.id)===null||ne===void 0||ne.prompt(L.current)),()=>{var G,V,W;t&&((W=(V=(G=window==null?void 0:window.google)===null||G===void 0?void 0:G.accounts)===null||V===void 0?void 0:V.id)===null||W===void 0||W.cancel())}},[T,M,t,a,o,l,d,f,u,p,P]),vn.createElement("div",{...v,ref:k,style:{height:uP[l],...v==null?void 0:v.style}})}var Sm={},xS;function fP(){if(xS)return Sm;xS=1,Object.defineProperty(Sm,"__esModule",{value:!0}),Sm.parse=l,Sm.serialize=u;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,n=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,i=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const b=function(){};return b.prototype=Object.create(null),b})();function l(b,v){const S=new o,k=b.length;if(k<2)return S;const T=(v==null?void 0:v.decode)||p;let P=0;do{const M=b.indexOf("=",P);if(M===-1)break;const I=b.indexOf(";",P),U=I===-1?k:I;if(M>U){P=b.lastIndexOf(";",M-1)+1;continue}const L=d(b,P,M),$=f(b,M,L),z=b.slice(L,$);if(S[z]===void 0){let F=d(b,M+1,U),Q=f(b,U,F);const R=T(b.slice(F,Q));S[z]=R}P=U+1}while(P<k);return S}function d(b,v,S){do{const k=b.charCodeAt(v);if(k!==32&&k!==9)return v}while(++v<S);return S}function f(b,v,S){for(;v>S;){const k=b.charCodeAt(--v);if(k!==32&&k!==9)return v+1}return S}function u(b,v,S){const k=(S==null?void 0:S.encode)||encodeURIComponent;if(!e.test(b))throw new TypeError(`argument name is invalid: ${b}`);const T=k(v);if(!n.test(T))throw new TypeError(`argument val is invalid: ${v}`);let P=b+"="+T;if(!S)return P;if(S.maxAge!==void 0){if(!Number.isInteger(S.maxAge))throw new TypeError(`option maxAge is invalid: ${S.maxAge}`);P+="; Max-Age="+S.maxAge}if(S.domain){if(!t.test(S.domain))throw new TypeError(`option domain is invalid: ${S.domain}`);P+="; Domain="+S.domain}if(S.path){if(!i.test(S.path))throw new TypeError(`option path is invalid: ${S.path}`);P+="; Path="+S.path}if(S.expires){if(!g(S.expires)||!Number.isFinite(S.expires.valueOf()))throw new TypeError(`option expires is invalid: ${S.expires}`);P+="; Expires="+S.expires.toUTCString()}if(S.httpOnly&&(P+="; HttpOnly"),S.secure&&(P+="; Secure"),S.partitioned&&(P+="; Partitioned"),S.priority)switch(typeof S.priority=="string"?S.priority.toLowerCase():void 0){case"low":P+="; Priority=Low";break;case"medium":P+="; Priority=Medium";break;case"high":P+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${S.priority}`)}if(S.sameSite)switch(typeof S.sameSite=="string"?S.sameSite.toLowerCase():S.sameSite){case!0:case"strict":P+="; SameSite=Strict";break;case"lax":P+="; SameSite=Lax";break;case"none":P+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${S.sameSite}`)}return P}function p(b){if(b.indexOf("%")===-1)return b;try{return decodeURIComponent(b)}catch{return b}}function g(b){return a.call(b)==="[object Date]"}return Sm}fP();var bS="popstate";function hP(e={}){function n(i,a){let{pathname:o,search:l,hash:d}=i.location;return Q0("",{pathname:o,search:l,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(i,a){return typeof a=="string"?a:Hm(a)}return mP(n,t,null,e)}function di(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function Bs(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function pP(){return Math.random().toString(36).substring(2,10)}function vS(e,n){return{usr:e.state,key:e.key,idx:n}}function Q0(e,n,t=null,i){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof n=="string"?Oh(n):n,state:t,key:n&&n.key||i||pP()}}function Hm({pathname:e="/",search:n="",hash:t=""}){return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function Oh(e){let n={};if(e){let t=e.indexOf("#");t>=0&&(n.hash=e.substring(t),e=e.substring(0,t));let i=e.indexOf("?");i>=0&&(n.search=e.substring(i),e=e.substring(0,i)),e&&(n.pathname=e)}return n}function mP(e,n,t,i={}){let{window:a=document.defaultView,v5Compat:o=!1}=i,l=a.history,d="POP",f=null,u=p();u==null&&(u=0,l.replaceState({...l.state,idx:u},""));function p(){return(l.state||{idx:null}).idx}function g(){d="POP";let T=p(),P=T==null?null:T-u;u=T,f&&f({action:d,location:k.location,delta:P})}function b(T,P){d="PUSH";let M=Q0(k.location,T,P);u=p()+1;let I=vS(M,u),U=k.createHref(M);try{l.pushState(I,"",U)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;a.location.assign(U)}o&&f&&f({action:d,location:k.location,delta:1})}function v(T,P){d="REPLACE";let M=Q0(k.location,T,P);u=p();let I=vS(M,u),U=k.createHref(M);l.replaceState(I,"",U),o&&f&&f({action:d,location:k.location,delta:0})}function S(T){return gP(T)}let k={get action(){return d},get location(){return e(a,l)},listen(T){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(bS,g),f=T,()=>{a.removeEventListener(bS,g),f=null}},createHref(T){return n(a,T)},createURL:S,encodeLocation(T){let P=S(T);return{pathname:P.pathname,search:P.search,hash:P.hash}},push:b,replace:v,go(T){return l.go(T)}};return k}function gP(e,n=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),di(t,"No window.location.(origin|href) available to create URL");let i=typeof e=="string"?e:Hm(e);return i=i.replace(/ $/,"%20"),!n&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function O_(e,n,t="/"){return yP(e,n,t,!1)}function yP(e,n,t,i){let a=typeof n=="string"?Oh(n):n,o=Gl(a.pathname||"/",t);if(o==null)return null;let l=L_(e);xP(l);let d=null;for(let f=0;d==null&&f<l.length;++f){let u=EP(o);d=kP(l[f],u,i)}return d}function L_(e,n=[],t=[],i=""){let a=(o,l,d)=>{let f={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};f.relativePath.startsWith("/")&&(di(f.relativePath.startsWith(i),`Absolute route path "${f.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(i.length));let u=Vl([i,f.relativePath]),p=t.concat(f);o.children&&o.children.length>0&&(di(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),L_(o.children,n,p,u)),!(o.path==null&&!o.index)&&n.push({path:u,score:jP(u,o.index),routesMeta:p})};return e.forEach((o,l)=>{var d;if(o.path===""||!((d=o.path)!=null&&d.includes("?")))a(o,l);else for(let f of F_(o.path))a(o,l,f)}),n}function F_(e){let n=e.split("/");if(n.length===0)return[];let[t,...i]=n,a=t.endsWith("?"),o=t.replace(/\?$/,"");if(i.length===0)return a?[o,""]:[o];let l=F_(i.join("/")),d=[];return d.push(...l.map(f=>f===""?o:[o,f].join("/"))),a&&d.push(...l),d.map(f=>e.startsWith("/")&&f===""?"/":f)}function xP(e){e.sort((n,t)=>n.score!==t.score?t.score-n.score:_P(n.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var bP=/^:[\w-]+$/,vP=3,wP=2,SP=1,NP=10,CP=-2,wS=e=>e==="*";function jP(e,n){let t=e.split("/"),i=t.length;return t.some(wS)&&(i+=CP),n&&(i+=wP),t.filter(a=>!wS(a)).reduce((a,o)=>a+(bP.test(o)?vP:o===""?SP:NP),i)}function _P(e,n){return e.length===n.length&&e.slice(0,-1).every((i,a)=>i===n[a])?e[e.length-1]-n[n.length-1]:0}function kP(e,n,t=!1){let{routesMeta:i}=e,a={},o="/",l=[];for(let d=0;d<i.length;++d){let f=i[d],u=d===i.length-1,p=o==="/"?n:n.slice(o.length)||"/",g=Hx({path:f.relativePath,caseSensitive:f.caseSensitive,end:u},p),b=f.route;if(!g&&u&&t&&!i[i.length-1].route.index&&(g=Hx({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},p)),!g)return null;Object.assign(a,g.params),l.push({params:a,pathname:Vl([o,g.pathname]),pathnameBase:IP(Vl([o,g.pathnameBase])),route:b}),g.pathnameBase!=="/"&&(o=Vl([o,g.pathnameBase]))}return l}function Hx(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,i]=TP(e.path,e.caseSensitive,e.end),a=n.match(t);if(!a)return null;let o=a[0],l=o.replace(/(.)\/+$/,"$1"),d=a.slice(1);return{params:i.reduce((u,{paramName:p,isOptional:g},b)=>{if(p==="*"){let S=d[b]||"";l=o.slice(0,o.length-S.length).replace(/(.)\/+$/,"$1")}const v=d[b];return g&&!v?u[p]=void 0:u[p]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:l,pattern:e}}function TP(e,n=!1,t=!0){Bs(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let i=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,d,f)=>(i.push({paramName:d,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(i.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,n?void 0:"i"),i]}function EP(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return Bs(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),e}}function Gl(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let t=n.endsWith("/")?n.length-1:n.length,i=e.charAt(t);return i&&i!=="/"?null:e.slice(t)||"/"}function AP(e,n="/"){let{pathname:t,search:i="",hash:a=""}=typeof e=="string"?Oh(e):e;return{pathname:t?t.startsWith("/")?t:PP(t,n):n,search:RP(i),hash:MP(a)}}function PP(e,n){let t=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function qv(e,n,t,i){return`Cannot include a '${e}' character in a manually specified \`to.${n}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function DP(e){return e.filter((n,t)=>t===0||n.route.path&&n.route.path.length>0)}function Z1(e){let n=DP(e);return n.map((t,i)=>i===n.length-1?t.pathname:t.pathnameBase)}function ew(e,n,t,i=!1){let a;typeof e=="string"?a=Oh(e):(a={...e},di(!a.pathname||!a.pathname.includes("?"),qv("?","pathname","search",a)),di(!a.pathname||!a.pathname.includes("#"),qv("#","pathname","hash",a)),di(!a.search||!a.search.includes("#"),qv("#","search","hash",a)));let o=e===""||a.pathname==="",l=o?"/":a.pathname,d;if(l==null)d=t;else{let g=n.length-1;if(!i&&l.startsWith("..")){let b=l.split("/");for(;b[0]==="..";)b.shift(),g-=1;a.pathname=b.join("/")}d=g>=0?n[g]:"/"}let f=AP(a,d),u=l&&l!=="/"&&l.endsWith("/"),p=(o||l===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(u||p)&&(f.pathname+="/"),f}var Vl=e=>e.join("/").replace(/\/\/+/g,"/"),IP=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),RP=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,MP=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function OP(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var $_=["POST","PUT","PATCH","DELETE"];new Set($_);var LP=["GET",...$_];new Set(LP);var Lh=w.createContext(null);Lh.displayName="DataRouter";var bb=w.createContext(null);bb.displayName="DataRouterState";var z_=w.createContext({isTransitioning:!1});z_.displayName="ViewTransition";var FP=w.createContext(new Map);FP.displayName="Fetchers";var $P=w.createContext(null);$P.displayName="Await";var Vs=w.createContext(null);Vs.displayName="Navigation";var tg=w.createContext(null);tg.displayName="Location";var Hs=w.createContext({outlet:null,matches:[],isDataRoute:!1});Hs.displayName="Route";var tw=w.createContext(null);tw.displayName="RouteError";function zP(e,{relative:n}={}){di(Fh(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=w.useContext(Vs),{hash:a,pathname:o,search:l}=ng(e,{relative:n}),d=o;return t!=="/"&&(d=o==="/"?t:Vl([t,o])),i.createHref({pathname:d,search:l,hash:a})}function Fh(){return w.useContext(tg)!=null}function Gi(){return di(Fh(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(tg).location}var U_="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function B_(e){w.useContext(Vs).static||w.useLayoutEffect(e)}function _t(){let{isDataRoute:e}=w.useContext(Hs);return e?ZP():UP()}function UP(){di(Fh(),"useNavigate() may be used only in the context of a <Router> component.");let e=w.useContext(Lh),{basename:n,navigator:t}=w.useContext(Vs),{matches:i}=w.useContext(Hs),{pathname:a}=Gi(),o=JSON.stringify(Z1(i)),l=w.useRef(!1);return B_(()=>{l.current=!0}),w.useCallback((f,u={})=>{if(Bs(l.current,U_),!l.current)return;if(typeof f=="number"){t.go(f);return}let p=ew(f,JSON.parse(o),a,u.relative==="path");e==null&&n!=="/"&&(p.pathname=p.pathname==="/"?n:Vl([n,p.pathname])),(u.replace?t.replace:t.push)(p,u.state,u)},[n,t,o,a,e])}w.createContext(null);function Br(){let{matches:e}=w.useContext(Hs),n=e[e.length-1];return n?n.params:{}}function ng(e,{relative:n}={}){let{matches:t}=w.useContext(Hs),{pathname:i}=Gi(),a=JSON.stringify(Z1(t));return w.useMemo(()=>ew(e,JSON.parse(a),i,n==="path"),[e,a,i,n])}function BP(e,n){return q_(e,n)}function q_(e,n,t,i){var M;di(Fh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:o}=w.useContext(Vs),{matches:l}=w.useContext(Hs),d=l[l.length-1],f=d?d.params:{},u=d?d.pathname:"/",p=d?d.pathnameBase:"/",g=d&&d.route;{let I=g&&g.path||"";V_(u,!g||I.endsWith("*")||I.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${I}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${I}"> to <Route path="${I==="/"?"*":`${I}/*`}">.`)}let b=Gi(),v;if(n){let I=typeof n=="string"?Oh(n):n;di(p==="/"||((M=I.pathname)==null?void 0:M.startsWith(p)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${I.pathname}" was given in the \`location\` prop.`),v=I}else v=b;let S=v.pathname||"/",k=S;if(p!=="/"){let I=p.replace(/^\//,"").split("/");k="/"+S.replace(/^\//,"").split("/").slice(I.length).join("/")}let T=!o&&t&&t.matches&&t.matches.length>0?t.matches:O_(e,{pathname:k});Bs(g||T!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Bs(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let P=YP(T&&T.map(I=>Object.assign({},I,{params:Object.assign({},f,I.params),pathname:Vl([p,a.encodeLocation?a.encodeLocation(I.pathname).pathname:I.pathname]),pathnameBase:I.pathnameBase==="/"?p:Vl([p,a.encodeLocation?a.encodeLocation(I.pathnameBase).pathname:I.pathnameBase])})),l,t,i);return n&&P?w.createElement(tg.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},P):P}function qP(){let e=XP(),n=OP(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},o={padding:"2px 4px",backgroundColor:i},l=null;return console.error("Error handled by React Router default ErrorBoundary:",e),l=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:o},"ErrorBoundary")," or"," ",w.createElement("code",{style:o},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},n),t?w.createElement("pre",{style:a},t):null,l)}var VP=w.createElement(qP,null),HP=class extends w.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?w.createElement(Hs.Provider,{value:this.props.routeContext},w.createElement(tw.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function GP({routeContext:e,match:n,children:t}){let i=w.useContext(Lh);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),w.createElement(Hs.Provider,{value:e},t)}function YP(e,n=[],t=null,i=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(n.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let a=e,o=t==null?void 0:t.errors;if(o!=null){let f=a.findIndex(u=>u.route.id&&(o==null?void 0:o[u.route.id])!==void 0);di(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,f+1))}let l=!1,d=-1;if(t)for(let f=0;f<a.length;f++){let u=a[f];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(d=f),u.route.id){let{loaderData:p,errors:g}=t,b=u.route.loader&&!p.hasOwnProperty(u.route.id)&&(!g||g[u.route.id]===void 0);if(u.route.lazy||b){l=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((f,u,p)=>{let g,b=!1,v=null,S=null;t&&(g=o&&u.route.id?o[u.route.id]:void 0,v=u.route.errorElement||VP,l&&(d<0&&p===0?(V_("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,S=null):d===p&&(b=!0,S=u.route.hydrateFallbackElement||null)));let k=n.concat(a.slice(0,p+1)),T=()=>{let P;return g?P=v:b?P=S:u.route.Component?P=w.createElement(u.route.Component,null):u.route.element?P=u.route.element:P=f,w.createElement(GP,{match:u,routeContext:{outlet:f,matches:k,isDataRoute:t!=null},children:P})};return t&&(u.route.ErrorBoundary||u.route.errorElement||p===0)?w.createElement(HP,{location:t.location,revalidation:t.revalidation,component:v,error:g,children:T(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):T()},null)}function nw(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function WP(e){let n=w.useContext(Lh);return di(n,nw(e)),n}function QP(e){let n=w.useContext(bb);return di(n,nw(e)),n}function JP(e){let n=w.useContext(Hs);return di(n,nw(e)),n}function iw(e){let n=JP(e),t=n.matches[n.matches.length-1];return di(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function KP(){return iw("useRouteId")}function XP(){var i;let e=w.useContext(tw),n=QP("useRouteError"),t=iw("useRouteError");return e!==void 0?e:(i=n.errors)==null?void 0:i[t]}function ZP(){let{router:e}=WP("useNavigate"),n=iw("useNavigate"),t=w.useRef(!1);return B_(()=>{t.current=!0}),w.useCallback(async(a,o={})=>{Bs(t.current,U_),t.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:n,...o}))},[e,n])}var SS={};function V_(e,n,t){!n&&!SS[e]&&(SS[e]=!0,Bs(!1,t))}w.memo(eD);function eD({routes:e,future:n,state:t}){return q_(e,void 0,t,n)}function mn({to:e,replace:n,state:t,relative:i}){di(Fh(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=w.useContext(Vs);Bs(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=w.useContext(Hs),{pathname:l}=Gi(),d=_t(),f=ew(e,Z1(o),l,i==="path"),u=JSON.stringify(f);return w.useEffect(()=>{d(JSON.parse(u),{replace:n,state:t,relative:i})},[d,u,i,n,t]),null}function pt(e){di(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function tD({basename:e="/",children:n=null,location:t,navigationType:i="POP",navigator:a,static:o=!1}){di(!Fh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=e.replace(/^\/*/,"/"),d=w.useMemo(()=>({basename:l,navigator:a,static:o,future:{}}),[l,a,o]);typeof t=="string"&&(t=Oh(t));let{pathname:f="/",search:u="",hash:p="",state:g=null,key:b="default"}=t,v=w.useMemo(()=>{let S=Gl(f,l);return S==null?null:{location:{pathname:S,search:u,hash:p,state:g,key:b},navigationType:i}},[l,f,u,p,g,b,i]);return Bs(v!=null,`<Router basename="${l}"> is not able to match the URL "${f}${u}${p}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:w.createElement(Vs.Provider,{value:d},w.createElement(tg.Provider,{children:n,value:v}))}function xh({children:e,location:n}){return BP(J0(e),n)}function J0(e,n=[]){let t=[];return w.Children.forEach(e,(i,a)=>{if(!w.isValidElement(i))return;let o=[...n,a];if(i.type===w.Fragment){t.push.apply(t,J0(i.props.children,o));return}di(i.type===pt,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),di(!i.props.index||!i.props.children,"An index route cannot have child routes.");let l={id:i.props.id||o.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(l.children=J0(i.props.children,o)),t.push(l)}),t}var Px="get",Dx="application/x-www-form-urlencoded";function vb(e){return e!=null&&typeof e.tagName=="string"}function nD(e){return vb(e)&&e.tagName.toLowerCase()==="button"}function iD(e){return vb(e)&&e.tagName.toLowerCase()==="form"}function rD(e){return vb(e)&&e.tagName.toLowerCase()==="input"}function aD(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function sD(e,n){return e.button===0&&(!n||n==="_self")&&!aD(e)}var sx=null;function oD(){if(sx===null)try{new FormData(document.createElement("form"),0),sx=!1}catch{sx=!0}return sx}var lD=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Vv(e){return e!=null&&!lD.has(e)?(Bs(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Dx}"`),null):e}function cD(e,n){let t,i,a,o,l;if(iD(e)){let d=e.getAttribute("action");i=d?Gl(d,n):null,t=e.getAttribute("method")||Px,a=Vv(e.getAttribute("enctype"))||Dx,o=new FormData(e)}else if(nD(e)||rD(e)&&(e.type==="submit"||e.type==="image")){let d=e.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=e.getAttribute("formaction")||d.getAttribute("action");if(i=f?Gl(f,n):null,t=e.getAttribute("formmethod")||d.getAttribute("method")||Px,a=Vv(e.getAttribute("formenctype"))||Vv(d.getAttribute("enctype"))||Dx,o=new FormData(d,e),!oD()){let{name:u,type:p,value:g}=e;if(p==="image"){let b=u?`${u}.`:"";o.append(`${b}x`,"0"),o.append(`${b}y`,"0")}else u&&o.append(u,g)}}else{if(vb(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Px,i=null,a=Dx,l=e}return o&&a==="text/plain"&&(l=o,o=void 0),{action:i,method:t.toLowerCase(),encType:a,formData:o,body:l}}function rw(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}async function uD(e,n){if(e.id in n)return n[e.id];try{let t=await import(e.module);return n[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function dD(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function fD(e,n,t){let i=await Promise.all(e.map(async a=>{let o=n.routes[a.route.id];if(o){let l=await uD(o,t);return l.links?l.links():[]}return[]}));return gD(i.flat(1).filter(dD).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function NS(e,n,t,i,a,o){let l=(f,u)=>t[u]?f.route.id!==t[u].route.id:!0,d=(f,u)=>{var p;return t[u].pathname!==f.pathname||((p=t[u].route.path)==null?void 0:p.endsWith("*"))&&t[u].params["*"]!==f.params["*"]};return o==="assets"?n.filter((f,u)=>l(f,u)||d(f,u)):o==="data"?n.filter((f,u)=>{var g;let p=i.routes[f.route.id];if(!p||!p.hasLoader)return!1;if(l(f,u)||d(f,u))return!0;if(f.route.shouldRevalidate){let b=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((g=t[0])==null?void 0:g.params)||{},nextUrl:new URL(e,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function hD(e,n,{includeHydrateFallback:t}={}){return pD(e.map(i=>{let a=n.routes[i.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function pD(e){return[...new Set(e)]}function mD(e){let n={},t=Object.keys(e).sort();for(let i of t)n[i]=e[i];return n}function gD(e,n){let t=new Set;return new Set(n),e.reduce((i,a)=>{let o=JSON.stringify(mD(a));return t.has(o)||(t.add(o),i.push({key:o,link:a})),i},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var yD=new Set([100,101,204,205]);function xD(e,n){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":n&&Gl(t.pathname,n)==="/"?t.pathname=`${n.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function H_(){let e=w.useContext(Lh);return rw(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function bD(){let e=w.useContext(bb);return rw(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var aw=w.createContext(void 0);aw.displayName="FrameworkContext";function G_(){let e=w.useContext(aw);return rw(e,"You must render this element inside a <HydratedRouter> element"),e}function vD(e,n){let t=w.useContext(aw),[i,a]=w.useState(!1),[o,l]=w.useState(!1),{onFocus:d,onBlur:f,onMouseEnter:u,onMouseLeave:p,onTouchStart:g}=n,b=w.useRef(null);w.useEffect(()=>{if(e==="render"&&l(!0),e==="viewport"){let k=P=>{P.forEach(M=>{l(M.isIntersecting)})},T=new IntersectionObserver(k,{threshold:.5});return b.current&&T.observe(b.current),()=>{T.disconnect()}}},[e]),w.useEffect(()=>{if(i){let k=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(k)}}},[i]);let v=()=>{a(!0)},S=()=>{a(!1),l(!1)};return t?e!=="intent"?[o,b,{}]:[o,b,{onFocus:Nm(d,v),onBlur:Nm(f,S),onMouseEnter:Nm(u,v),onMouseLeave:Nm(p,S),onTouchStart:Nm(g,v)}]:[!1,b,{}]}function Nm(e,n){return t=>{e&&e(t),t.defaultPrevented||n(t)}}function wD({page:e,...n}){let{router:t}=H_(),i=w.useMemo(()=>O_(t.routes,e,t.basename),[t.routes,e,t.basename]);return i?w.createElement(ND,{page:e,matches:i,...n}):null}function SD(e){let{manifest:n,routeModules:t}=G_(),[i,a]=w.useState([]);return w.useEffect(()=>{let o=!1;return fD(e,n,t).then(l=>{o||a(l)}),()=>{o=!0}},[e,n,t]),i}function ND({page:e,matches:n,...t}){let i=Gi(),{manifest:a,routeModules:o}=G_(),{basename:l}=H_(),{loaderData:d,matches:f}=bD(),u=w.useMemo(()=>NS(e,n,f,a,i,"data"),[e,n,f,a,i]),p=w.useMemo(()=>NS(e,n,f,a,i,"assets"),[e,n,f,a,i]),g=w.useMemo(()=>{if(e===i.pathname+i.search+i.hash)return[];let S=new Set,k=!1;if(n.forEach(P=>{var I;let M=a.routes[P.route.id];!M||!M.hasLoader||(!u.some(U=>U.route.id===P.route.id)&&P.route.id in d&&((I=o[P.route.id])!=null&&I.shouldRevalidate)||M.hasClientLoader?k=!0:S.add(P.route.id))}),S.size===0)return[];let T=xD(e,l);return k&&S.size>0&&T.searchParams.set("_routes",n.filter(P=>S.has(P.route.id)).map(P=>P.route.id).join(",")),[T.pathname+T.search]},[l,d,i,a,u,n,e,o]),b=w.useMemo(()=>hD(p,a),[p,a]),v=SD(p);return w.createElement(w.Fragment,null,g.map(S=>w.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...t})),b.map(S=>w.createElement("link",{key:S,rel:"modulepreload",href:S,...t})),v.map(({key:S,link:k})=>w.createElement("link",{key:S,...k})))}function CD(...e){return n=>{e.forEach(t=>{typeof t=="function"?t(n):t!=null&&(t.current=n)})}}var Y_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Y_&&(window.__reactRouterVersion="7.6.0")}catch{}function jD({basename:e,children:n,window:t}){let i=w.useRef();i.current==null&&(i.current=hP({window:t,v5Compat:!0}));let a=i.current,[o,l]=w.useState({action:a.action,location:a.location}),d=w.useCallback(f=>{w.startTransition(()=>l(f))},[l]);return w.useLayoutEffect(()=>a.listen(d),[a,d]),w.createElement(tD,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:a})}var W_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ls=w.forwardRef(function({onClick:n,discover:t="render",prefetch:i="none",relative:a,reloadDocument:o,replace:l,state:d,target:f,to:u,preventScrollReset:p,viewTransition:g,...b},v){let{basename:S}=w.useContext(Vs),k=typeof u=="string"&&W_.test(u),T,P=!1;if(typeof u=="string"&&k&&(T=u,Y_))try{let Q=new URL(window.location.href),R=u.startsWith("//")?new URL(Q.protocol+u):new URL(u),B=Gl(R.pathname,S);R.origin===Q.origin&&B!=null?u=B+R.search+R.hash:P=!0}catch{Bs(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let M=zP(u,{relative:a}),[I,U,L]=vD(i,b),$=ED(u,{replace:l,state:d,target:f,preventScrollReset:p,relative:a,viewTransition:g});function z(Q){n&&n(Q),Q.defaultPrevented||$(Q)}let F=w.createElement("a",{...b,...L,href:T||M,onClick:P||o?n:z,ref:CD(v,U),target:f,"data-discover":!k&&t==="render"?"true":void 0});return I&&!k?w.createElement(w.Fragment,null,F,w.createElement(wD,{page:M})):F});ls.displayName="Link";var _D=w.forwardRef(function({"aria-current":n="page",caseSensitive:t=!1,className:i="",end:a=!1,style:o,to:l,viewTransition:d,children:f,...u},p){let g=ng(l,{relative:u.relative}),b=Gi(),v=w.useContext(bb),{navigator:S,basename:k}=w.useContext(Vs),T=v!=null&&RD(g)&&d===!0,P=S.encodeLocation?S.encodeLocation(g).pathname:g.pathname,M=b.pathname,I=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(M=M.toLowerCase(),I=I?I.toLowerCase():null,P=P.toLowerCase()),I&&k&&(I=Gl(I,k)||I);const U=P!=="/"&&P.endsWith("/")?P.length-1:P.length;let L=M===P||!a&&M.startsWith(P)&&M.charAt(U)==="/",$=I!=null&&(I===P||!a&&I.startsWith(P)&&I.charAt(P.length)==="/"),z={isActive:L,isPending:$,isTransitioning:T},F=L?n:void 0,Q;typeof i=="function"?Q=i(z):Q=[i,L?"active":null,$?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let R=typeof o=="function"?o(z):o;return w.createElement(ls,{...u,"aria-current":F,className:Q,ref:p,style:R,to:l,viewTransition:d},typeof f=="function"?f(z):f)});_D.displayName="NavLink";var kD=w.forwardRef(({discover:e="render",fetcherKey:n,navigate:t,reloadDocument:i,replace:a,state:o,method:l=Px,action:d,onSubmit:f,relative:u,preventScrollReset:p,viewTransition:g,...b},v)=>{let S=DD(),k=ID(d,{relative:u}),T=l.toLowerCase()==="get"?"get":"post",P=typeof d=="string"&&W_.test(d),M=I=>{if(f&&f(I),I.defaultPrevented)return;I.preventDefault();let U=I.nativeEvent.submitter,L=(U==null?void 0:U.getAttribute("formmethod"))||l;S(U||I.currentTarget,{fetcherKey:n,method:L,navigate:t,replace:a,state:o,relative:u,preventScrollReset:p,viewTransition:g})};return w.createElement("form",{ref:v,method:T,action:k,onSubmit:i?f:M,...b,"data-discover":!P&&e==="render"?"true":void 0})});kD.displayName="Form";function TD(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Q_(e){let n=w.useContext(Lh);return di(n,TD(e)),n}function ED(e,{target:n,replace:t,state:i,preventScrollReset:a,relative:o,viewTransition:l}={}){let d=_t(),f=Gi(),u=ng(e,{relative:o});return w.useCallback(p=>{if(sD(p,n)){p.preventDefault();let g=t!==void 0?t:Hm(f)===Hm(u);d(e,{replace:g,state:i,preventScrollReset:a,relative:o,viewTransition:l})}},[f,d,u,t,i,n,e,a,o,l])}var AD=0,PD=()=>`__${String(++AD)}__`;function DD(){let{router:e}=Q_("useSubmit"),{basename:n}=w.useContext(Vs),t=KP();return w.useCallback(async(i,a={})=>{let{action:o,method:l,encType:d,formData:f,body:u}=cD(i,n);if(a.navigate===!1){let p=a.fetcherKey||PD();await e.fetch(p,t,a.action||o,{preventScrollReset:a.preventScrollReset,formData:f,body:u,formMethod:a.method||l,formEncType:a.encType||d,flushSync:a.flushSync})}else await e.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:f,body:u,formMethod:a.method||l,formEncType:a.encType||d,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,n,t])}function ID(e,{relative:n}={}){let{basename:t}=w.useContext(Vs),i=w.useContext(Hs);di(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),o={...ng(e||".",{relative:n})},l=Gi();if(e==null){o.search=l.search;let d=new URLSearchParams(o.search),f=d.getAll("index");if(f.some(p=>p==="")){d.delete("index"),f.filter(g=>g).forEach(g=>d.append("index",g));let p=d.toString();o.search=p?`?${p}`:""}}return(!e||e===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:Vl([t,o.pathname])),Hm(o)}function RD(e,n={}){let t=w.useContext(z_);di(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Q_("useViewTransitionState"),a=ng(e,{relative:n.relative});if(!t.isTransitioning)return!1;let o=Gl(t.currentLocation.pathname,i)||t.currentLocation.pathname,l=Gl(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Hx(a.pathname,l)!=null||Hx(a.pathname,o)!=null}[...yD];var MD=R_();class OD extends w.Component{constructor(){super(...arguments);Hn(this,"state",{hasError:!1})}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,i){console.error("Uncaught error:",t,i)}render(){return this.state.hasError?r.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"red",border:"1px solid red",borderRadius:"5px"},children:[r.jsx("h1",{children:"Something went wrong."}),r.jsx("p",{children:"We are sorry for the inconvenience. Please try again later."})]}):this.props.children}}class LD{constructor(){Hn(this,"listeners",[]);Hn(this,"activeRequests",0)}subscribe(n){return this.listeners.push(n),n(this.activeRequests>0),()=>this.unsubscribe(n)}unsubscribe(n){this.listeners=this.listeners.filter(t=>t!==n)}notify(n){n?this.activeRequests++:this.activeRequests=Math.max(0,this.activeRequests-1);const t=this.activeRequests>0;this.listeners.forEach(i=>i(t))}}const K0=new LD,FD="https://backend.newtons.in",$D=()=>localStorage.getItem("authToken"),me=async(e,n={})=>{const t=$D(),i={...n.headers};t&&(i.Authorization=`Bearer ${t}`),!(n.body instanceof FormData)&&!i["Content-Type"]&&(i["Content-Type"]="application/json");const a=i;let o=e.startsWith("/")?e:`/${e}`;o.startsWith("/api/")||(o=`/api${o}`);const l=`${FD}${o}`;K0.notify(!0);try{console.log(`Making API call to: ${l}`);const d=await fetch(l,{...n,headers:a});if(d.status===401)throw console.error("Unauthorized access - Token might be invalid or expired. Logging out."),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser"),window.location.href="/login",new Error("Unauthorized");if(!d.ok){let f=`HTTP error! status: ${d.status}`;try{const u=await d.json();f=(u==null?void 0:u.message)||(u==null?void 0:u.error)||f}catch{}throw console.error(`API Error: ${d.status} ${d.statusText} - ${f}`),new Error(f)}return d}catch(d){throw d instanceof TypeError&&d.message==="Failed to fetch"?console.error("API Fetch Error: Network error or CORS issue. Check backend CORS configuration.",d):console.error("API Fetch Error:",d),d}finally{K0.notify(!1)}},zD=({onLoginSuccess:e})=>{const[n,t]=w.useState(""),[i,a]=w.useState(""),[o,l]=w.useState(null),[d,f]=w.useState(!1),u=_t(),p=async v=>{v.preventDefault(),f(!0),l(null);try{const S=await me("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:i})});if(!S.ok){let T=`Login failed with status: ${S.status}`;try{T=(await S.json()).message||T}catch{try{const M=await S.text();M&&(T=`${T} - ${M}`)}catch{}}throw new Error(T)}const k=await S.json();console.log("Login successful:",k),localStorage.setItem("authToken",k.token),localStorage.setItem("currentUser",JSON.stringify(k.user)),k.user.clinic_id&&localStorage.setItem("currentClinicId",k.user.clinic_id),e(k.user),k.user.role==="doctor"?u("/dashboard/queue"):u("/dashboard")}catch(S){console.error("Login failed:",S),l(S.message||"Login failed. Please check your credentials.")}finally{f(!1)}},g=async v=>{f(!0),l(null);try{const S=await me("/api/auth/google",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:v.credential})});if(!S.ok)throw new Error("Google Sign-In failed");const k=await S.json();localStorage.setItem("authToken",k.token),localStorage.setItem("currentUser",JSON.stringify(k.user)),k.user.clinic_id&&localStorage.setItem("currentClinicId",k.user.clinic_id),e(k.user),k.user.role==="doctor"?u("/dashboard/queue"):u("/dashboard")}catch(S){console.error("Google Login Error:",S),l("Google Sign-In failed. Please try again.")}finally{f(!1)}},b=()=>{console.error("Google Login Failed"),l("Google Sign-In was unsuccessful. Please try again.")};return r.jsx("div",{className:"auth-page-container",children:r.jsxs("div",{className:"auth-form-card",children:[r.jsx("h2",{className:"auth-title",children:"Sign in to Newtons OPD Zero"}),r.jsxs("form",{onSubmit:p,className:"auth-form",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email address"}),r.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:n,onChange:v=>t(v.target.value),className:"auth-text-input",placeholder:"you@example.com"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Password"}),r.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:i,onChange:v=>a(v.target.value),className:"auth-text-input",placeholder:"Password"})]}),o&&r.jsx("div",{className:"auth-error-message",children:r.jsx("p",{children:o})}),r.jsx("div",{className:"form-group",children:r.jsx("button",{type:"submit",disabled:d,className:"auth-submit-button",children:d?"Signing in...":"Sign In"})})]}),r.jsx("div",{className:"google-login-container",style:{marginTop:"1rem",display:"flex",justifyContent:"center",width:"100%"},children:r.jsx(dP,{onSuccess:g,onError:b,useOneTap:!0})}),r.jsxs("div",{className:"auth-navigation-link-container",children:["Don't have an account?"," ",r.jsx(ls,{to:"/register",className:"auth-navigation-link",children:"Register a new clinic"})]}),r.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})},UD=()=>{const[e,n]=w.useState(""),[t,i]=w.useState(""),[a,o]=w.useState(""),[l,d]=w.useState(""),[f,u]=w.useState(null),[p,g]=w.useState(!1),b=_t(),v=async S=>{S.preventDefault(),g(!0),u(null);try{const k=await me("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicName:e,userName:t,userEmail:a,userPassword:l})}),T=await k.json();if(!k.ok)throw new Error(T.message||`HTTP error! status: ${k.status}`);console.log("Registration successful:",T),alert("Registration successful! Please log in."),b("/login")}catch(k){console.error("Registration failed:",k),u(k.message||"Registration failed. Please try again.")}finally{g(!1)}};return r.jsx("div",{className:"auth-page-container",children:r.jsxs("div",{className:"auth-form-card",children:[r.jsx("h2",{className:"auth-title",children:"Register Clinic & Admin"}),r.jsxs("form",{onSubmit:v,className:"auth-form",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"clinicName",children:"Clinic Name"}),r.jsx("input",{id:"clinicName",name:"clinicName",type:"text",required:!0,value:e,onChange:S=>n(S.target.value),className:"auth-text-input",placeholder:"Your Clinic's Name"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"userName",children:"Your Name (Admin)"}),r.jsx("input",{id:"userName",name:"userName",type:"text",required:!0,value:t,onChange:S=>i(S.target.value),className:"auth-text-input",placeholder:"Your Full Name"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"userEmail",children:"Your Email (Admin Login)"}),r.jsx("input",{id:"userEmail",name:"userEmail",type:"email",autoComplete:"email",required:!0,value:a,onChange:S=>o(S.target.value),className:"auth-text-input",placeholder:"you@example.com"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"userPassword",children:"Password"}),r.jsx("input",{id:"userPassword",name:"userPassword",type:"password",required:!0,minLength:6,value:l,onChange:S=>d(S.target.value),className:"auth-text-input",placeholder:"Min. 6 characters"})]}),f&&r.jsx("div",{className:"auth-error-message",children:r.jsx("p",{children:f})}),r.jsx("div",{className:"form-group",children:r.jsx("button",{type:"submit",disabled:p,className:"auth-submit-button",children:p?"Registering...":"Register Clinic & Admin"})})]}),r.jsxs("div",{className:"auth-navigation-link-container",children:["Already have an account?"," ",r.jsx(ls,{to:"/login",className:"auth-navigation-link",children:"Sign in"})]}),r.jsx("p",{className:"auth-attribution",children:"from Newtons AI"})]})})};var J_={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},CS=vn.createContext&&vn.createContext(J_),BD=["attr","size","title"];function qD(e,n){if(e==null)return{};var t=VD(e,n),i,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)i=o[a],!(n.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(t[i]=e[i])}return t}function VD(e,n){if(e==null)return{};var t={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(n.indexOf(i)>=0)continue;t[i]=e[i]}return t}function Gx(){return Gx=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Gx.apply(this,arguments)}function jS(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,i)}return t}function Yx(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?jS(Object(t),!0).forEach(function(i){HD(e,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):jS(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})}return e}function HD(e,n,t){return n=GD(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function GD(e){var n=YD(e,"string");return typeof n=="symbol"?n:n+""}function YD(e,n){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var i=t.call(e,n);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function K_(e){return e&&e.map((n,t)=>vn.createElement(n.tag,Yx({key:t},n.attr),K_(n.child)))}function us(e){return n=>vn.createElement(WD,Gx({attr:Yx({},e.attr)},n),K_(e.child))}function WD(e){var n=t=>{var{attr:i,size:a,title:o}=e,l=qD(e,BD),d=a||t.size||"1em",f;return t.className&&(f=t.className),e.className&&(f=(f?f+" ":"")+e.className),vn.createElement("svg",Gx({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,i,l,{className:f,style:Yx(Yx({color:e.color||t.color},t.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),o&&vn.createElement("title",null,o),e.children)};return CS!==void 0?vn.createElement(CS.Consumer,null,t=>n(t)):n(J_)}function Hv(e){return us({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(e)}function _S(e){return us({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}function kS(e){return us({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M437.2 403.5L320 215V64h8c13.3 0 24-10.7 24-24V24c0-13.3-10.7-24-24-24H120c-13.3 0-24 10.7-24 24v16c0 13.3 10.7 24 24 24h8v151L10.8 403.5C-18.5 450.6 15.3 512 70.9 512h306.2c55.7 0 89.4-61.5 60.1-108.5zM137.9 320l48.2-77.6c3.7-5.2 5.8-11.6 5.8-18.4V64h64v160c0 6.9 2.2 13.2 5.8 18.4l48.2 77.6h-172z"},child:[]}]})(e)}function bh(e){return us({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function ox(e){return us({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M480 320a96 96 0 1 0-96-96 96 96 0 0 0 96 96zm48 32a22.88 22.88 0 0 0-7.06 1.09 124.76 124.76 0 0 1-81.89 0A22.82 22.82 0 0 0 432 352a112 112 0 0 0-112 112.62c.14 26.26 21.73 47.38 48 47.38h224c26.27 0 47.86-21.12 48-47.38A112 112 0 0 0 528 352zm-198.09 10.45A145.19 145.19 0 0 1 352 344.62V128a32 32 0 0 0-32-32h-32V32a32 32 0 0 0-32-32H96a32 32 0 0 0-32 32v64H32a32 32 0 0 0-32 32v368a16 16 0 0 0 16 16h288.31A78.62 78.62 0 0 1 288 464.79a143.06 143.06 0 0 1 41.91-102.34zM144 404a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12H92a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm48-122a6 6 0 0 1-6 6h-20a6 6 0 0 1-6-6v-26h-26a6 6 0 0 1-6-6v-20a6 6 0 0 1 6-6h26V70a6 6 0 0 1 6-6h20a6 6 0 0 1 6 6v26h26a6 6 0 0 1 6 6v20a6 6 0 0 1-6 6h-26zm80 250a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12zm0-128a12 12 0 0 1-12 12h-40a12 12 0 0 1-12-12v-40a12 12 0 0 1 12-12h40a12 12 0 0 1 12 12z"},child:[]}]})(e)}function lx(e){return us({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M352 288h-16v-88c0-4.42-3.58-8-8-8h-13.58c-4.74 0-9.37 1.4-13.31 4.03l-15.33 10.22a7.994 7.994 0 0 0-2.22 11.09l8.88 13.31a7.994 7.994 0 0 0 11.09 2.22l.47-.31V288h-16c-4.42 0-8 3.58-8 8v16c0 4.42 3.58 8 8 8h64c4.42 0 8-3.58 8-8v-16c0-4.42-3.58-8-8-8zM608 64H32C14.33 64 0 78.33 0 96v320c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V96c0-17.67-14.33-32-32-32zM48 400v-64c35.35 0 64 28.65 64 64H48zm0-224v-64h64c0 35.35-28.65 64-64 64zm272 192c-53.02 0-96-50.15-96-112 0-61.86 42.98-112 96-112s96 50.14 96 112c0 61.87-43 112-96 112zm272 32h-64c0-35.35 28.65-64 64-64v64zm0-224c-35.35 0-64-28.65-64-64h64v64z"},child:[]}]})(e)}function cx(e){return us({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M112 32C50.1 32 0 82.1 0 144v224c0 61.9 50.1 112 112 112s112-50.1 112-112V144c0-61.9-50.1-112-112-112zm48 224H64V144c0-26.5 21.5-48 48-48s48 21.5 48 48v112zm139.7-29.7c-3.5-3.5-9.4-3.1-12.3.8-45.3 62.5-40.4 150.1 15.9 206.4 56.3 56.3 143.9 61.2 206.4 15.9 4-2.9 4.3-8.8.8-12.3L299.7 226.3zm229.8-19c-56.3-56.3-143.9-61.2-206.4-15.9-4 2.9-4.3 8.8-.8 12.3l210.8 210.8c3.5 3.5 9.4 3.1 12.3-.8 45.3-62.6 40.5-150.1-15.9-206.4z"},child:[]}]})(e)}function vh(e){return us({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function X_(e){return us({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(e)}function TS(e){return us({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M447.1 112c-34.2.5-62.3 28.4-63 62.6-.5 24.3 12.5 45.6 32 56.8V344c0 57.3-50.2 104-112 104-60 0-109.2-44.1-111.9-99.2C265 333.8 320 269.2 320 192V36.6c0-11.4-8.1-21.3-19.3-23.5L237.8.5c-13-2.6-25.6 5.8-28.2 18.8L206.4 35c-2.6 13 5.8 25.6 18.8 28.2l30.7 6.1v121.4c0 52.9-42.2 96.7-95.1 97.2-53.4.5-96.9-42.7-96.9-96V69.4l30.7-6.1c13-2.6 21.4-15.2 18.8-28.2l-3.1-15.7C107.7 6.4 95.1-2 82.1.6L19.3 13C8.1 15.3 0 25.1 0 36.6V192c0 77.3 55.1 142 128.1 156.8C130.7 439.2 208.6 512 304 512c97 0 176-75.4 176-168V231.4c19.1-11.1 32-31.7 32-55.4 0-35.7-29.2-64.5-64.9-64zm.9 80c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16z"},child:[]}]})(e)}function ES(e){return us({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zM104 424c0 13.3 10.7 24 24 24s24-10.7 24-24-10.7-24-24-24-24 10.7-24 24zm216-135.4v49c36.5 7.4 64 39.8 64 78.4v41.7c0 7.6-5.4 14.2-12.9 15.7l-32.2 6.4c-4.3.9-8.5-1.9-9.4-6.3l-3.1-15.7c-.9-4.3 1.9-8.6 6.3-9.4l19.3-3.9V416c0-62.8-96-65.1-96 1.9v26.7l19.3 3.9c4.3.9 7.1 5.1 6.3 9.4l-3.1 15.7c-.9 4.3-5.1 7.1-9.4 6.3l-31.2-4.2c-7.9-1.1-13.8-7.8-13.8-15.9V416c0-38.6 27.5-70.9 64-78.4v-45.2c-2.2.7-4.4 1.1-6.6 1.9-18 6.3-37.3 9.8-57.4 9.8s-39.4-3.5-57.4-9.8c-7.4-2.6-14.9-4.2-22.6-5.2v81.6c23.1 6.9 40 28.1 40 53.4 0 30.9-25.1 56-56 56s-56-25.1-56-56c0-25.3 16.9-46.5 40-53.4v-80.4C48.5 301 0 355.8 0 422.4v44.8C0 491.9 20.1 512 44.8 512h358.4c24.7 0 44.8-20.1 44.8-44.8v-44.8c0-72-56.8-130.3-128-133.8z"},child:[]}]})(e)}function Cm(e){return us({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(e)}const Z_={superadmin:[{title:"Admin Pages",links:[{path:"/dashboard",name:"Super Admin Dashboard",icon:bh},{path:"/dashboard/clinic-subscriptions",name:"Clinic Subscriptions",icon:ox},{path:"/dashboard/users",name:"User Management",icon:Cm}]}],admin:[{title:"Dashboard",links:[{path:"/dashboard",name:"Admin Dashboard",icon:bh}]},{title:"Clinic Management",links:[{path:"/dashboard/clinic-hub",name:"Clinic Hub",icon:_S}]},{title:"Patient Management",links:[{path:"/dashboard/patients/add",name:"Add Patient",icon:ox},{path:"/dashboard/patients",name:"All Patients",icon:Cm},{path:"/dashboard/patients/search",name:"Search Patient",icon:vh}]},{title:"Inventory & Pharmacy",links:[{path:"/dashboard/analysis",name:"Analysis Dashboard",icon:Hv},{path:"/dashboard/inventory",name:"Inventory Management",icon:cx},{path:"/dashboard/inventory/add",name:"Add Drug",icon:cx},{path:"/dashboard/distributors",name:"Distributor Management",icon:Cm}]},{title:"Queue & Subscriptions",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:TS},{path:"/dashboard/subscriptions",name:"Manage Subscriptions",icon:lx},{path:"/dashboard/subscriptions/add",name:"Add Subscription Plan",icon:lx}]}],doctor:[{title:"Patient & Admissions",links:[{path:"/dashboard/search",name:"Patient Search",icon:vh},{path:"/dashboard/add-patient",name:"Add Patient",icon:ox},{path:"/manage-admission",name:"Manage Admission",icon:ES}]},{title:"Lab & Billing",links:[{path:"/create-lab-order",name:"Create Lab Order",icon:kS},{path:"/billing",name:"Billing",icon:lx}]},{title:"Queue",links:[{path:"/dashboard/queue",name:"Doctor Queue",icon:TS}]}],receptionist:[{title:"Reception",links:[{path:"/dashboard",name:"Reception Dashboard",icon:bh}]},{title:"Patient Management",links:[{path:"/dashboard/all-patients",name:"All Patients",icon:Cm},{path:"/dashboard/patients/add",name:"Add Patient",icon:ox},{path:"/dashboard/patients/search",name:"Search Patient",icon:vh}]},{title:"Billing & Admissions",links:[{path:"/billing",name:"Billing",icon:lx},{path:"/manage-admission",name:"Manage Admission",icon:ES}]}],lab:[{title:"Lab Operations",links:[{path:"/dashboard",name:"Lab Dashboard",icon:bh},{path:"/lab-inventory",name:"Lab Test Inventory",icon:kS},{path:"/lab/search-report",name:"Search Lab Report",icon:vh}]}],pharmacy:[{title:"Pharmacy Operations",links:[{path:"/dashboard",name:"Pharmacy Queue",icon:bh},{path:"/dashboard/inventory",name:"Pharmacy Inventory",icon:cx},{path:"/dashboard/inventory/add",name:"Add Drug",icon:cx},{path:"/dashboard/add-order",name:"Add Pharmacy Order",icon:Hv},{path:"/dashboard/distributors",name:"Distributor Management",icon:Cm}]},{title:"Analysis & Settings",links:[{path:"/dashboard/analysis",name:"Analysis Dashboard",icon:Hv},{path:"/dashboard/settings",name:"Pharmacy Settings",icon:_S},{path:"/dashboard/search-patient-records",name:"Search Patient Records",icon:vh}]}]},QD=({user:e,onLogout:n,userRole:t,isOpen:i,onClose:a})=>{const o=Gi(),[l,d]=w.useState(""),f=Z_[t]||[],[u,p]=w.useState(500),g=w.useRef(!1),b=w.useCallback(T=>{g.current=!0,T.preventDefault()},[]),v=w.useCallback(()=>{g.current=!1},[]),S=w.useCallback(T=>{if(g.current){const P=window.innerWidth-T.clientX;P>250&&P<window.innerWidth*.8&&p(P)}},[]);w.useEffect(()=>(window.addEventListener("mousemove",S),window.addEventListener("mouseup",v),()=>{window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",v)}),[S,v]);const k=f.map(T=>({...T,links:T.links.filter(P=>P.name.toLowerCase().includes(l.toLowerCase()))})).filter(T=>T.links.length>0);return r.jsxs("div",{className:`side-panel ${i?"open":""}`,style:{width:`${u}px`,right:i?"0":`-${u}px`},children:[r.jsx("div",{className:"resizer",onMouseDown:b}),r.jsxs("div",{className:"side-panel-header",children:[r.jsx(ls,{to:"/dashboard",className:"home-button",onClick:a,children:r.jsx(bh,{})}),r.jsxs("div",{style:{position:"relative"},children:[r.jsx(vh,{style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",color:"#94a3b8"}}),r.jsx("input",{type:"text",placeholder:"Search pages...",className:"search-bar",value:l,onChange:T=>d(T.target.value)})]}),r.jsx("button",{className:"close-button",onClick:a,children:""})]}),r.jsx("nav",{children:k.map((T,P)=>r.jsxs("div",{className:"page-section",children:[r.jsx("div",{className:"page-title",children:T.title}),r.jsx("ul",{className:"sub-page-list",children:T.links.map(M=>{const I=M.icon;return r.jsx("li",{children:r.jsxs(ls,{to:M.path,className:o.pathname===M.path?"active":"",onClick:a,children:[I&&r.jsx(I,{})," ",M.name]})},M.path)})})]},P))}),r.jsxs("div",{className:"user-info-section",children:[r.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),r.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[r.jsx(X_,{})," Logout"]})]})]})},JD=({user:e,onLogout:n,userRole:t,isOpen:i,onClose:a,roleNavigation:o})=>{const l=Gi(),d=o[t]||[];return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:`mobile-side-panel-overlay ${i?"open":""}`,onClick:a}),r.jsxs("div",{className:`mobile-side-panel ${i?"open":""}`,children:[r.jsxs("div",{className:"mobile-side-panel-header",children:[r.jsx("h3",{children:"Menu"}),r.jsx("button",{className:"close-button",onClick:a,children:""})]}),r.jsx("nav",{children:d.map((f,u)=>r.jsxs("div",{className:"page-section",children:[r.jsx("div",{className:"page-title",children:f.title}),r.jsx("ul",{className:"sub-page-list",children:f.links.map(p=>{const g=p.icon;return r.jsx("li",{children:r.jsxs(ls,{to:p.path,className:l.pathname===p.path?"active":"",onClick:a,children:[g&&r.jsx(g,{})," ",p.name]})},p.path)})})]},u))}),r.jsxs("div",{className:"user-info-section",children:[r.jsxs("span",{className:"user-name",children:["Welcome, ",e.name]}),r.jsxs("button",{onClick:n,className:"logout-button-sidebar",children:[r.jsx(X_,{})," Logout"]})]})]})]})};var Gv,AS;function KD(){if(AS)return Gv;AS=1;var e="Expected a function",n=NaN,t="[object Symbol]",i=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,l=/^0o[0-7]+$/i,d=parseInt,f=typeof ru=="object"&&ru&&ru.Object===Object&&ru,u=typeof self=="object"&&self&&self.Object===Object&&self,p=f||u||Function("return this")(),g=Object.prototype,b=g.toString,v=Math.max,S=Math.min,k=function(){return p.Date.now()};function T(L,$,z){var F,Q,R,B,Y,re,ne=0,G=!1,V=!1,W=!0;if(typeof L!="function")throw new TypeError(e);$=U($)||0,P(z)&&(G=!!z.leading,V="maxWait"in z,R=V?v(U(z.maxWait)||0,$):R,W="trailing"in z?!!z.trailing:W);function J(ue){var ae=F,Re=Q;return F=Q=void 0,ne=ue,B=L.apply(Re,ae),B}function he(ue){return ne=ue,Y=setTimeout(se,$),G?J(ue):B}function A(ue){var ae=ue-re,Re=ue-ne,Ae=$-ae;return V?S(Ae,R-Re):Ae}function ce(ue){var ae=ue-re,Re=ue-ne;return re===void 0||ae>=$||ae<0||V&&Re>=R}function se(){var ue=k();if(ce(ue))return D(ue);Y=setTimeout(se,A(ue))}function D(ue){return Y=void 0,W&&F?J(ue):(F=Q=void 0,B)}function oe(){Y!==void 0&&clearTimeout(Y),ne=0,F=re=Q=Y=void 0}function xe(){return Y===void 0?B:D(k())}function Z(){var ue=k(),ae=ce(ue);if(F=arguments,Q=this,re=ue,ae){if(Y===void 0)return he(re);if(V)return Y=setTimeout(se,$),J(re)}return Y===void 0&&(Y=setTimeout(se,$)),B}return Z.cancel=oe,Z.flush=xe,Z}function P(L){var $=typeof L;return!!L&&($=="object"||$=="function")}function M(L){return!!L&&typeof L=="object"}function I(L){return typeof L=="symbol"||M(L)&&b.call(L)==t}function U(L){if(typeof L=="number")return L;if(I(L))return n;if(P(L)){var $=typeof L.valueOf=="function"?L.valueOf():L;L=P($)?$+"":$}if(typeof L!="string")return L===0?L:+L;L=L.replace(i,"");var z=o.test(L);return z||l.test(L)?d(L.slice(2),z?2:8):a.test(L)?n:+L}return Gv=T,Gv}var XD=KD();const wb=Ud(XD);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZD=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),eI=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,t,i)=>i?i.toUpperCase():t.toLowerCase()),PS=e=>{const n=eI(e);return n.charAt(0).toUpperCase()+n.slice(1)},ek=(...e)=>e.filter((n,t,i)=>!!n&&n.trim()!==""&&i.indexOf(n)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var tI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=w.forwardRef(({color:e="currentColor",size:n=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:a="",children:o,iconNode:l,...d},f)=>w.createElement("svg",{ref:f,...tI,width:n,height:n,stroke:e,strokeWidth:i?Number(t)*24/Number(n):t,className:ek("lucide",a),...d},[...l.map(([u,p])=>w.createElement(u,p)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=(e,n)=>{const t=w.forwardRef(({className:i,...a},o)=>w.createElement(nI,{ref:o,iconNode:n,className:ek(`lucide-${ZD(PS(e))}`,`lucide-${e}`,i),...a}));return t.displayName=PS(e),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iI=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],DS=ht("arrow-down",iI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rI=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],rn=ht("arrow-left",rI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],X0=ht("arrow-up",aI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sI=[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]],oI=ht("beaker",sI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lI=[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]],cI=ht("bed-double",lI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uI=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],dI=ht("brain-circuit",uI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fI=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],tk=ht("brain",fI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hI=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],pI=ht("building",hI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]],IS=ht("calendar-check-2",mI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],yI=ht("calendar-days",gI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Wx=ht("calendar",xI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bI=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Qx=ht("check",bI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vI=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],RS=ht("chevron-down",vI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wI=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],sw=ht("chevron-left",wI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SI=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],$h=ht("chevron-right",SI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NI=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],MS=ht("chevron-up",NI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Hi=ht("circle-alert",CI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jI=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],cs=ht("circle-check-big",jI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _I=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]],kI=ht("circle-minus",_I);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],ss=ht("circle-plus",TI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],AI=ht("circle-user",EI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PI=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],Jx=ht("clipboard-list",PI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DI=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],Z0=ht("clipboard",DI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const II=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],RI=ht("copy",II);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MI=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],OI=ht("credit-card",MI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LI=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Eh=ht("dollar-sign",LI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FI=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],$I=ht("eye",FI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zI=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],OS=ht("file-check",zI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UI=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],su=ht("file-text",UI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BI=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],Yl=ht("flask-conical",BI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qI=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],VI=ht("funnel",qI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HI=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Gm=ht("hash",HI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GI=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],nk=ht("house",GI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Qo=ht("info",YI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WI=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],ik=ht("key",WI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QI=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],rk=ht("layout-grid",QI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JI=[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]],KI=ht("list-ordered",JI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XI=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],ZI=ht("list",XI);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Ah=ht("loader-circle",eR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tR=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],LS=ht("lock",tR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nR=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],iR=ht("map-pin",nR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rR=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],aR=ht("mic-off",rR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sR=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],ak=ht("mic",sR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oR=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],lR=ht("monitor",oR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cR=[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]],uR=ht("package-open",cR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dR=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Md=ht("package",dR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fR=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],hR=ht("paperclip",fR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pR=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],mR=ht("pause",pR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gR=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Yv=ht("pen",gR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yR=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],ql=ht("pencil",yR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xR=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],bR=ht("phone",xR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vR=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],ig=ht("pill",vR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wR=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],SR=ht("play",wR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NR=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ou=ht("plus",NR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CR=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Go=ht("printer",CR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jR=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Kx=ht("refresh-cw",jR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _R=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Od=ht("save",_R);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kR=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],os=ht("search",kR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TR=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],ER=ht("send",TR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AR=[["path",{d:"M6 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-2",key:"4b9dqc"}],["path",{d:"M6 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-2",key:"22nnkd"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m13 6-4 6h6l-4 6",key:"14hqih"}]],FS=ht("server-crash",AR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PR=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Sb=ht("settings",PR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DR=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],sk=ht("share-2",DR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IR=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],RR=ht("shield-check",IR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MR=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],OR=ht("sparkles",MR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LR=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],lu=ht("square-pen",LR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FR=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],ok=ht("stethoscope",FR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $R=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],zR=ht("table",$R);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UR=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],BR=ht("tag",UR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qR=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],or=ht("trash-2",qR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VR=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],HR=ht("triangle-alert",VR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GR=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],YR=ht("truck",GR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WR=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],$S=ht("upload",WR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],ow=ht("user-check",QR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],lk=ht("user-plus",JR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KR=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],cu=ht("user",KR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],zh=ht("users",XR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZR=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],eM=ht("video",ZR);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tM=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Qn=ht("x",tM);var Wv={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var zS;function nM(){return zS||(zS=1,function(e){(function(){var n={}.hasOwnProperty;function t(){for(var o="",l=0;l<arguments.length;l++){var d=arguments[l];d&&(o=a(o,i(d)))}return o}function i(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return t.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var l="";for(var d in o)n.call(o,d)&&o[d]&&(l=a(l,d));return l}function a(o,l){return l?o?o+" "+l:o+l:o}e.exports?(t.default=t,e.exports=t):window.classNames=t})()}(Wv)),Wv.exports}var iM=nM();const au=Ud(iM);function Ld(e){"@babel/helpers - typeof";return Ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Ld(e)}function rM(e,n){if(Ld(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var i=t.call(e,n);if(Ld(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function ck(e){var n=rM(e,"string");return Ld(n)=="symbol"?n:n+""}function Lm(e,n,t){return(n=ck(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function US(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,i)}return t}function Dt(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?US(Object(t),!0).forEach(function(i){Lm(e,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):US(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})}return e}function aM(e){if(Array.isArray(e))return e}function sM(e,n){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var i,a,o,l,d=[],f=!0,u=!1;try{if(o=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;f=!1}else for(;!(f=(i=o.call(t)).done)&&(d.push(i.value),d.length!==n);f=!0);}catch(p){u=!0,a=p}finally{try{if(!f&&t.return!=null&&(l=t.return(),Object(l)!==l))return}finally{if(u)throw a}}return d}}function e1(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,i=Array(n);t<n;t++)i[t]=e[t];return i}function uk(e,n){if(e){if(typeof e=="string")return e1(e,n);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?e1(e,n):void 0}}function oM(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hl(e,n){return aM(e)||sM(e,n)||uk(e,n)||oM()}function lM(e,n){if(e==null)return{};var t={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(n.indexOf(i)!==-1)continue;t[i]=e[i]}return t}function Ql(e,n){if(e==null)return{};var t,i,a=lM(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)t=o[i],n.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var cM=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function uM(e){var n=e.defaultInputValue,t=n===void 0?"":n,i=e.defaultMenuIsOpen,a=i===void 0?!1:i,o=e.defaultValue,l=o===void 0?null:o,d=e.inputValue,f=e.menuIsOpen,u=e.onChange,p=e.onInputChange,g=e.onMenuClose,b=e.onMenuOpen,v=e.value,S=Ql(e,cM),k=w.useState(d!==void 0?d:t),T=Hl(k,2),P=T[0],M=T[1],I=w.useState(f!==void 0?f:a),U=Hl(I,2),L=U[0],$=U[1],z=w.useState(v!==void 0?v:l),F=Hl(z,2),Q=F[0],R=F[1],B=w.useCallback(function(J,he){typeof u=="function"&&u(J,he),R(J)},[u]),Y=w.useCallback(function(J,he){var A;typeof p=="function"&&(A=p(J,he)),M(A!==void 0?A:J)},[p]),re=w.useCallback(function(){typeof b=="function"&&b(),$(!0)},[b]),ne=w.useCallback(function(){typeof g=="function"&&g(),$(!1)},[g]),G=d!==void 0?d:P,V=f!==void 0?f:L,W=v!==void 0?v:Q;return Dt(Dt({},S),{},{inputValue:G,menuIsOpen:V,onChange:B,onInputChange:Y,onMenuClose:ne,onMenuOpen:re,value:W})}function Ot(){return Ot=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Ot.apply(null,arguments)}function dM(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function BS(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,ck(i.key),i)}}function fM(e,n,t){return n&&BS(e.prototype,n),t&&BS(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function t1(e,n){return t1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},t1(e,n)}function hM(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&t1(e,n)}function Xx(e){return Xx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Xx(e)}function dk(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dk=function(){return!!e})()}function pM(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mM(e,n){if(n&&(Ld(n)=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pM(e)}function gM(e){var n=dk();return function(){var t,i=Xx(e);if(n){var a=Xx(this).constructor;t=Reflect.construct(i,arguments,a)}else t=i.apply(this,arguments);return mM(this,t)}}function yM(e){if(Array.isArray(e))return e1(e)}function xM(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bM(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lw(e){return yM(e)||xM(e)||uk(e)||bM()}function vM(e){if(e.sheet)return e.sheet;for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].ownerNode===e)return document.styleSheets[n]}function wM(e){var n=document.createElement("style");return n.setAttribute("data-emotion",e.key),e.nonce!==void 0&&n.setAttribute("nonce",e.nonce),n.appendChild(document.createTextNode("")),n.setAttribute("data-s",""),n}var SM=function(){function e(t){var i=this;this._insertTag=function(a){var o;i.tags.length===0?i.insertionPoint?o=i.insertionPoint.nextSibling:i.prepend?o=i.container.firstChild:o=i.before:o=i.tags[i.tags.length-1].nextSibling,i.container.insertBefore(a,o),i.tags.push(a)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var n=e.prototype;return n.hydrate=function(i){i.forEach(this._insertTag)},n.insert=function(i){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(wM(this));var a=this.tags[this.tags.length-1];if(this.isSpeedy){var o=vM(a);try{o.insertRule(i,o.cssRules.length)}catch{}}else a.appendChild(document.createTextNode(i));this.ctr++},n.flush=function(){this.tags.forEach(function(i){var a;return(a=i.parentNode)==null?void 0:a.removeChild(i)}),this.tags=[],this.ctr=0},e}(),wr="-ms-",Zx="-moz-",Tn="-webkit-",fk="comm",cw="rule",uw="decl",NM="@import",hk="@keyframes",CM="@layer",jM=Math.abs,Nb=String.fromCharCode,_M=Object.assign;function kM(e,n){return sr(e,0)^45?(((n<<2^sr(e,0))<<2^sr(e,1))<<2^sr(e,2))<<2^sr(e,3):0}function pk(e){return e.trim()}function TM(e,n){return(e=n.exec(e))?e[0]:e}function En(e,n,t){return e.replace(n,t)}function n1(e,n){return e.indexOf(n)}function sr(e,n){return e.charCodeAt(n)|0}function Ym(e,n,t){return e.slice(n,t)}function Vo(e){return e.length}function dw(e){return e.length}function ux(e,n){return n.push(e),e}function EM(e,n){return e.map(n).join("")}var Cb=1,Ph=1,mk=0,ca=0,Ii=0,Uh="";function jb(e,n,t,i,a,o,l){return{value:e,root:n,parent:t,type:i,props:a,children:o,line:Cb,column:Ph,length:l,return:""}}function jm(e,n){return _M(jb("",null,null,"",null,null,0),e,{length:-e.length},n)}function AM(){return Ii}function PM(){return Ii=ca>0?sr(Uh,--ca):0,Ph--,Ii===10&&(Ph=1,Cb--),Ii}function Pa(){return Ii=ca<mk?sr(Uh,ca++):0,Ph++,Ii===10&&(Ph=1,Cb++),Ii}function Jo(){return sr(Uh,ca)}function Ix(){return ca}function rg(e,n){return Ym(Uh,e,n)}function Wm(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function gk(e){return Cb=Ph=1,mk=Vo(Uh=e),ca=0,[]}function yk(e){return Uh="",e}function Rx(e){return pk(rg(ca-1,i1(e===91?e+2:e===40?e+1:e)))}function DM(e){for(;(Ii=Jo())&&Ii<33;)Pa();return Wm(e)>2||Wm(Ii)>3?"":" "}function IM(e,n){for(;--n&&Pa()&&!(Ii<48||Ii>102||Ii>57&&Ii<65||Ii>70&&Ii<97););return rg(e,Ix()+(n<6&&Jo()==32&&Pa()==32))}function i1(e){for(;Pa();)switch(Ii){case e:return ca;case 34:case 39:e!==34&&e!==39&&i1(Ii);break;case 40:e===41&&i1(e);break;case 92:Pa();break}return ca}function RM(e,n){for(;Pa()&&e+Ii!==57;)if(e+Ii===84&&Jo()===47)break;return"/*"+rg(n,ca-1)+"*"+Nb(e===47?e:Pa())}function MM(e){for(;!Wm(Jo());)Pa();return rg(e,ca)}function OM(e){return yk(Mx("",null,null,null,[""],e=gk(e),0,[0],e))}function Mx(e,n,t,i,a,o,l,d,f){for(var u=0,p=0,g=l,b=0,v=0,S=0,k=1,T=1,P=1,M=0,I="",U=a,L=o,$=i,z=I;T;)switch(S=M,M=Pa()){case 40:if(S!=108&&sr(z,g-1)==58){n1(z+=En(Rx(M),"&","&\f"),"&\f")!=-1&&(P=-1);break}case 34:case 39:case 91:z+=Rx(M);break;case 9:case 10:case 13:case 32:z+=DM(S);break;case 92:z+=IM(Ix()-1,7);continue;case 47:switch(Jo()){case 42:case 47:ux(LM(RM(Pa(),Ix()),n,t),f);break;default:z+="/"}break;case 123*k:d[u++]=Vo(z)*P;case 125*k:case 59:case 0:switch(M){case 0:case 125:T=0;case 59+p:P==-1&&(z=En(z,/\f/g,"")),v>0&&Vo(z)-g&&ux(v>32?VS(z+";",i,t,g-1):VS(En(z," ","")+";",i,t,g-2),f);break;case 59:z+=";";default:if(ux($=qS(z,n,t,u,p,a,d,I,U=[],L=[],g),o),M===123)if(p===0)Mx(z,n,$,$,U,o,g,d,L);else switch(b===99&&sr(z,3)===110?100:b){case 100:case 108:case 109:case 115:Mx(e,$,$,i&&ux(qS(e,$,$,0,0,a,d,I,a,U=[],g),L),a,L,g,d,i?U:L);break;default:Mx(z,$,$,$,[""],L,0,d,L)}}u=p=v=0,k=P=1,I=z="",g=l;break;case 58:g=1+Vo(z),v=S;default:if(k<1){if(M==123)--k;else if(M==125&&k++==0&&PM()==125)continue}switch(z+=Nb(M),M*k){case 38:P=p>0?1:(z+="\f",-1);break;case 44:d[u++]=(Vo(z)-1)*P,P=1;break;case 64:Jo()===45&&(z+=Rx(Pa())),b=Jo(),p=g=Vo(I=z+=MM(Ix())),M++;break;case 45:S===45&&Vo(z)==2&&(k=0)}}return o}function qS(e,n,t,i,a,o,l,d,f,u,p){for(var g=a-1,b=a===0?o:[""],v=dw(b),S=0,k=0,T=0;S<i;++S)for(var P=0,M=Ym(e,g+1,g=jM(k=l[S])),I=e;P<v;++P)(I=pk(k>0?b[P]+" "+M:En(M,/&\f/g,b[P])))&&(f[T++]=I);return jb(e,n,t,a===0?cw:d,f,u,p)}function LM(e,n,t){return jb(e,n,t,fk,Nb(AM()),Ym(e,2,-2),0)}function VS(e,n,t,i){return jb(e,n,t,uw,Ym(e,0,i),Ym(e,i+1,-1),i)}function Ch(e,n){for(var t="",i=dw(e),a=0;a<i;a++)t+=n(e[a],a,e,n)||"";return t}function FM(e,n,t,i){switch(e.type){case CM:if(e.children.length)break;case NM:case uw:return e.return=e.return||e.value;case fk:return"";case hk:return e.return=e.value+"{"+Ch(e.children,i)+"}";case cw:e.value=e.props.join(",")}return Vo(t=Ch(e.children,i))?e.return=e.value+"{"+t+"}":""}function $M(e){var n=dw(e);return function(t,i,a,o){for(var l="",d=0;d<n;d++)l+=e[d](t,i,a,o)||"";return l}}function zM(e){return function(n){n.root||(n=n.return)&&e(n)}}function UM(e){var n=Object.create(null);return function(t){return n[t]===void 0&&(n[t]=e(t)),n[t]}}var BM=function(n,t,i){for(var a=0,o=0;a=o,o=Jo(),a===38&&o===12&&(t[i]=1),!Wm(o);)Pa();return rg(n,ca)},qM=function(n,t){var i=-1,a=44;do switch(Wm(a)){case 0:a===38&&Jo()===12&&(t[i]=1),n[i]+=BM(ca-1,t,i);break;case 2:n[i]+=Rx(a);break;case 4:if(a===44){n[++i]=Jo()===58?"&\f":"",t[i]=n[i].length;break}default:n[i]+=Nb(a)}while(a=Pa());return n},VM=function(n,t){return yk(qM(gk(n),t))},HS=new WeakMap,HM=function(n){if(!(n.type!=="rule"||!n.parent||n.length<1)){for(var t=n.value,i=n.parent,a=n.column===i.column&&n.line===i.line;i.type!=="rule";)if(i=i.parent,!i)return;if(!(n.props.length===1&&t.charCodeAt(0)!==58&&!HS.get(i))&&!a){HS.set(n,!0);for(var o=[],l=VM(t,o),d=i.props,f=0,u=0;f<l.length;f++)for(var p=0;p<d.length;p++,u++)n.props[u]=o[f]?l[f].replace(/&\f/g,d[p]):d[p]+" "+l[f]}}},GM=function(n){if(n.type==="decl"){var t=n.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(n.return="",n.value="")}};function xk(e,n){switch(kM(e,n)){case 5103:return Tn+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Tn+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Tn+e+Zx+e+wr+e+e;case 6828:case 4268:return Tn+e+wr+e+e;case 6165:return Tn+e+wr+"flex-"+e+e;case 5187:return Tn+e+En(e,/(\w+).+(:[^]+)/,Tn+"box-$1$2"+wr+"flex-$1$2")+e;case 5443:return Tn+e+wr+"flex-item-"+En(e,/flex-|-self/,"")+e;case 4675:return Tn+e+wr+"flex-line-pack"+En(e,/align-content|flex-|-self/,"")+e;case 5548:return Tn+e+wr+En(e,"shrink","negative")+e;case 5292:return Tn+e+wr+En(e,"basis","preferred-size")+e;case 6060:return Tn+"box-"+En(e,"-grow","")+Tn+e+wr+En(e,"grow","positive")+e;case 4554:return Tn+En(e,/([^-])(transform)/g,"$1"+Tn+"$2")+e;case 6187:return En(En(En(e,/(zoom-|grab)/,Tn+"$1"),/(image-set)/,Tn+"$1"),e,"")+e;case 5495:case 3959:return En(e,/(image-set\([^]*)/,Tn+"$1$`$1");case 4968:return En(En(e,/(.+:)(flex-)?(.*)/,Tn+"box-pack:$3"+wr+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Tn+e+e;case 4095:case 3583:case 4068:case 2532:return En(e,/(.+)-inline(.+)/,Tn+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Vo(e)-1-n>6)switch(sr(e,n+1)){case 109:if(sr(e,n+4)!==45)break;case 102:return En(e,/(.+:)(.+)-([^]+)/,"$1"+Tn+"$2-$3$1"+Zx+(sr(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~n1(e,"stretch")?xk(En(e,"stretch","fill-available"),n)+e:e}break;case 4949:if(sr(e,n+1)!==115)break;case 6444:switch(sr(e,Vo(e)-3-(~n1(e,"!important")&&10))){case 107:return En(e,":",":"+Tn)+e;case 101:return En(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Tn+(sr(e,14)===45?"inline-":"")+"box$3$1"+Tn+"$2$3$1"+wr+"$2box$3")+e}break;case 5936:switch(sr(e,n+11)){case 114:return Tn+e+wr+En(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Tn+e+wr+En(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Tn+e+wr+En(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Tn+e+wr+e+e}return e}var YM=function(n,t,i,a){if(n.length>-1&&!n.return)switch(n.type){case uw:n.return=xk(n.value,n.length);break;case hk:return Ch([jm(n,{value:En(n.value,"@","@"+Tn)})],a);case cw:if(n.length)return EM(n.props,function(o){switch(TM(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Ch([jm(n,{props:[En(o,/:(read-\w+)/,":"+Zx+"$1")]})],a);case"::placeholder":return Ch([jm(n,{props:[En(o,/:(plac\w+)/,":"+Tn+"input-$1")]}),jm(n,{props:[En(o,/:(plac\w+)/,":"+Zx+"$1")]}),jm(n,{props:[En(o,/:(plac\w+)/,wr+"input-$1")]})],a)}return""})}},WM=[YM],QM=function(n){var t=n.key;if(t==="css"){var i=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(i,function(k){var T=k.getAttribute("data-emotion");T.indexOf(" ")!==-1&&(document.head.appendChild(k),k.setAttribute("data-s",""))})}var a=n.stylisPlugins||WM,o={},l,d=[];l=n.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(k){for(var T=k.getAttribute("data-emotion").split(" "),P=1;P<T.length;P++)o[T[P]]=!0;d.push(k)});var f,u=[HM,GM];{var p,g=[FM,zM(function(k){p.insert(k)})],b=$M(u.concat(a,g)),v=function(T){return Ch(OM(T),b)};f=function(T,P,M,I){p=M,v(T?T+"{"+P.styles+"}":P.styles),I&&(S.inserted[P.name]=!0)}}var S={key:t,sheet:new SM({key:t,container:l,nonce:n.nonce,speedy:n.speedy,prepend:n.prepend,insertionPoint:n.insertionPoint}),nonce:n.nonce,inserted:o,registered:{},insert:f};return S.sheet.hydrate(d),S},Qv={exports:{}},Mn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GS;function JM(){if(GS)return Mn;GS=1;var e=typeof Symbol=="function"&&Symbol.for,n=e?Symbol.for("react.element"):60103,t=e?Symbol.for("react.portal"):60106,i=e?Symbol.for("react.fragment"):60107,a=e?Symbol.for("react.strict_mode"):60108,o=e?Symbol.for("react.profiler"):60114,l=e?Symbol.for("react.provider"):60109,d=e?Symbol.for("react.context"):60110,f=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,p=e?Symbol.for("react.forward_ref"):60112,g=e?Symbol.for("react.suspense"):60113,b=e?Symbol.for("react.suspense_list"):60120,v=e?Symbol.for("react.memo"):60115,S=e?Symbol.for("react.lazy"):60116,k=e?Symbol.for("react.block"):60121,T=e?Symbol.for("react.fundamental"):60117,P=e?Symbol.for("react.responder"):60118,M=e?Symbol.for("react.scope"):60119;function I(L){if(typeof L=="object"&&L!==null){var $=L.$$typeof;switch($){case n:switch(L=L.type,L){case f:case u:case i:case o:case a:case g:return L;default:switch(L=L&&L.$$typeof,L){case d:case p:case S:case v:case l:return L;default:return $}}case t:return $}}}function U(L){return I(L)===u}return Mn.AsyncMode=f,Mn.ConcurrentMode=u,Mn.ContextConsumer=d,Mn.ContextProvider=l,Mn.Element=n,Mn.ForwardRef=p,Mn.Fragment=i,Mn.Lazy=S,Mn.Memo=v,Mn.Portal=t,Mn.Profiler=o,Mn.StrictMode=a,Mn.Suspense=g,Mn.isAsyncMode=function(L){return U(L)||I(L)===f},Mn.isConcurrentMode=U,Mn.isContextConsumer=function(L){return I(L)===d},Mn.isContextProvider=function(L){return I(L)===l},Mn.isElement=function(L){return typeof L=="object"&&L!==null&&L.$$typeof===n},Mn.isForwardRef=function(L){return I(L)===p},Mn.isFragment=function(L){return I(L)===i},Mn.isLazy=function(L){return I(L)===S},Mn.isMemo=function(L){return I(L)===v},Mn.isPortal=function(L){return I(L)===t},Mn.isProfiler=function(L){return I(L)===o},Mn.isStrictMode=function(L){return I(L)===a},Mn.isSuspense=function(L){return I(L)===g},Mn.isValidElementType=function(L){return typeof L=="string"||typeof L=="function"||L===i||L===u||L===o||L===a||L===g||L===b||typeof L=="object"&&L!==null&&(L.$$typeof===S||L.$$typeof===v||L.$$typeof===l||L.$$typeof===d||L.$$typeof===p||L.$$typeof===T||L.$$typeof===P||L.$$typeof===M||L.$$typeof===k)},Mn.typeOf=I,Mn}var YS;function KM(){return YS||(YS=1,Qv.exports=JM()),Qv.exports}var Jv,WS;function XM(){if(WS)return Jv;WS=1;var e=KM(),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},t={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};o[e.ForwardRef]=i,o[e.Memo]=a;function l(S){return e.isMemo(S)?a:o[S.$$typeof]||n}var d=Object.defineProperty,f=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,g=Object.getPrototypeOf,b=Object.prototype;function v(S,k,T){if(typeof k!="string"){if(b){var P=g(k);P&&P!==b&&v(S,P,T)}var M=f(k);u&&(M=M.concat(u(k)));for(var I=l(S),U=l(k),L=0;L<M.length;++L){var $=M[L];if(!t[$]&&!(T&&T[$])&&!(U&&U[$])&&!(I&&I[$])){var z=p(k,$);try{d(S,$,z)}catch{}}}}return S}return Jv=v,Jv}XM();var ZM=!0;function e4(e,n,t){var i="";return t.split(" ").forEach(function(a){e[a]!==void 0?n.push(e[a]+";"):a&&(i+=a+" ")}),i}var bk=function(n,t,i){var a=n.key+"-"+t.name;(i===!1||ZM===!1)&&n.registered[a]===void 0&&(n.registered[a]=t.styles)},t4=function(n,t,i){bk(n,t,i);var a=n.key+"-"+t.name;if(n.inserted[t.name]===void 0){var o=t;do n.insert(t===o?"."+a:"",o,n.sheet,!0),o=o.next;while(o!==void 0)}};function n4(e){for(var n=0,t,i=0,a=e.length;a>=4;++i,a-=4)t=e.charCodeAt(i)&255|(e.charCodeAt(++i)&255)<<8|(e.charCodeAt(++i)&255)<<16|(e.charCodeAt(++i)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,n=(t&65535)*1540483477+((t>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(a){case 3:n^=(e.charCodeAt(i+2)&255)<<16;case 2:n^=(e.charCodeAt(i+1)&255)<<8;case 1:n^=e.charCodeAt(i)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}var i4={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},r4=/[A-Z]|^ms/g,a4=/_EMO_([^_]+?)_([^]*?)_EMO_/g,vk=function(n){return n.charCodeAt(1)===45},QS=function(n){return n!=null&&typeof n!="boolean"},Kv=UM(function(e){return vk(e)?e:e.replace(r4,"-$&").toLowerCase()}),JS=function(n,t){switch(n){case"animation":case"animationName":if(typeof t=="string")return t.replace(a4,function(i,a,o){return Ho={name:a,styles:o,next:Ho},a})}return i4[n]!==1&&!vk(n)&&typeof t=="number"&&t!==0?t+"px":t};function Qm(e,n,t){if(t==null)return"";var i=t;if(i.__emotion_styles!==void 0)return i;switch(typeof t){case"boolean":return"";case"object":{var a=t;if(a.anim===1)return Ho={name:a.name,styles:a.styles,next:Ho},a.name;var o=t;if(o.styles!==void 0){var l=o.next;if(l!==void 0)for(;l!==void 0;)Ho={name:l.name,styles:l.styles,next:Ho},l=l.next;var d=o.styles+";";return d}return s4(e,n,t)}case"function":{if(e!==void 0){var f=Ho,u=t(e);return Ho=f,Qm(e,n,u)}break}}var p=t;return p}function s4(e,n,t){var i="";if(Array.isArray(t))for(var a=0;a<t.length;a++)i+=Qm(e,n,t[a])+";";else for(var o in t){var l=t[o];if(typeof l!="object"){var d=l;QS(d)&&(i+=Kv(o)+":"+JS(o,d)+";")}else if(Array.isArray(l)&&typeof l[0]=="string"&&n==null)for(var f=0;f<l.length;f++)QS(l[f])&&(i+=Kv(o)+":"+JS(o,l[f])+";");else{var u=Qm(e,n,l);switch(o){case"animation":case"animationName":{i+=Kv(o)+":"+u+";";break}default:i+=o+"{"+u+"}"}}}return i}var KS=/label:\s*([^\s;{]+)\s*(;|$)/g,Ho;function wk(e,n,t){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var i=!0,a="";Ho=void 0;var o=e[0];if(o==null||o.raw===void 0)i=!1,a+=Qm(t,n,o);else{var l=o;a+=l[0]}for(var d=1;d<e.length;d++)if(a+=Qm(t,n,e[d]),i){var f=o;a+=f[d]}KS.lastIndex=0;for(var u="",p;(p=KS.exec(a))!==null;)u+="-"+p[1];var g=n4(a)+u;return{name:g,styles:a,next:Ho}}var o4=function(n){return n()},l4=dS.useInsertionEffect?dS.useInsertionEffect:!1,c4=l4||o4,Sk=w.createContext(typeof HTMLElement<"u"?QM({key:"css"}):null);Sk.Provider;var u4=function(n){return w.forwardRef(function(t,i){var a=w.useContext(Sk);return n(t,a,i)})},d4=w.createContext({}),fw={}.hasOwnProperty,r1="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",f4=function(n,t){var i={};for(var a in t)fw.call(t,a)&&(i[a]=t[a]);return i[r1]=n,i},h4=function(n){var t=n.cache,i=n.serialized,a=n.isStringTag;return bk(t,i,a),c4(function(){return t4(t,i,a)}),null},p4=u4(function(e,n,t){var i=e.css;typeof i=="string"&&n.registered[i]!==void 0&&(i=n.registered[i]);var a=e[r1],o=[i],l="";typeof e.className=="string"?l=e4(n.registered,o,e.className):e.className!=null&&(l=e.className+" ");var d=wk(o,void 0,w.useContext(d4));l+=n.key+"-"+d.name;var f={};for(var u in e)fw.call(e,u)&&u!=="css"&&u!==r1&&(f[u]=e[u]);return f.className=l,t&&(f.ref=t),w.createElement(w.Fragment,null,w.createElement(h4,{cache:n,serialized:d,isStringTag:typeof a=="string"}),w.createElement(a,f))}),m4=p4,Ct=function(n,t){var i=arguments;if(t==null||!fw.call(t,"css"))return w.createElement.apply(void 0,i);var a=i.length,o=new Array(a);o[0]=m4,o[1]=f4(n,t);for(var l=2;l<a;l++)o[l]=i[l];return w.createElement.apply(null,o)};(function(e){var n;n||(n=e.JSX||(e.JSX={}))})(Ct||(Ct={}));function hw(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return wk(n)}function g4(){var e=hw.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function y4(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}const x4=Math.min,b4=Math.max,eb=Math.round,dx=Math.floor,tb=e=>({x:e,y:e});function v4(e){const{x:n,y:t,width:i,height:a}=e;return{width:i,height:a,top:t,left:n,right:n+i,bottom:t+a,x:n,y:t}}function _b(){return typeof window<"u"}function Nk(e){return jk(e)?(e.nodeName||"").toLowerCase():"#document"}function Wl(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function Ck(e){var n;return(n=(jk(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function jk(e){return _b()?e instanceof Node||e instanceof Wl(e).Node:!1}function w4(e){return _b()?e instanceof Element||e instanceof Wl(e).Element:!1}function pw(e){return _b()?e instanceof HTMLElement||e instanceof Wl(e).HTMLElement:!1}function XS(e){return!_b()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Wl(e).ShadowRoot}const S4=new Set(["inline","contents"]);function _k(e){const{overflow:n,overflowX:t,overflowY:i,display:a}=mw(e);return/auto|scroll|overlay|hidden|clip/.test(n+i+t)&&!S4.has(a)}function N4(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const C4=new Set(["html","body","#document"]);function j4(e){return C4.has(Nk(e))}function mw(e){return Wl(e).getComputedStyle(e)}function _4(e){if(Nk(e)==="html")return e;const n=e.assignedSlot||e.parentNode||XS(e)&&e.host||Ck(e);return XS(n)?n.host:n}function kk(e){const n=_4(e);return j4(n)?e.ownerDocument?e.ownerDocument.body:e.body:pw(n)&&_k(n)?n:kk(n)}function nb(e,n,t){var i;n===void 0&&(n=[]),t===void 0&&(t=!0);const a=kk(e),o=a===((i=e.ownerDocument)==null?void 0:i.body),l=Wl(a);if(o){const d=a1(l);return n.concat(l,l.visualViewport||[],_k(a)?a:[],d&&t?nb(d):[])}return n.concat(a,nb(a,[],t))}function a1(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function k4(e){const n=mw(e);let t=parseFloat(n.width)||0,i=parseFloat(n.height)||0;const a=pw(e),o=a?e.offsetWidth:t,l=a?e.offsetHeight:i,d=eb(t)!==o||eb(i)!==l;return d&&(t=o,i=l),{width:t,height:i,$:d}}function gw(e){return w4(e)?e:e.contextElement}function ZS(e){const n=gw(e);if(!pw(n))return tb(1);const t=n.getBoundingClientRect(),{width:i,height:a,$:o}=k4(n);let l=(o?eb(t.width):t.width)/i,d=(o?eb(t.height):t.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!d||!Number.isFinite(d))&&(d=1),{x:l,y:d}}const T4=tb(0);function E4(e){const n=Wl(e);return!N4()||!n.visualViewport?T4:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function A4(e,n,t){return!1}function eN(e,n,t,i){n===void 0&&(n=!1);const a=e.getBoundingClientRect(),o=gw(e);let l=tb(1);n&&(l=ZS(e));const d=A4()?E4(o):tb(0);let f=(a.left+d.x)/l.x,u=(a.top+d.y)/l.y,p=a.width/l.x,g=a.height/l.y;if(o){const b=Wl(o),v=i;let S=b,k=a1(S);for(;k&&i&&v!==S;){const T=ZS(k),P=k.getBoundingClientRect(),M=mw(k),I=P.left+(k.clientLeft+parseFloat(M.paddingLeft))*T.x,U=P.top+(k.clientTop+parseFloat(M.paddingTop))*T.y;f*=T.x,u*=T.y,p*=T.x,g*=T.y,f+=I,u+=U,S=Wl(k),k=a1(S)}}return v4({width:p,height:g,x:f,y:u})}function Tk(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function P4(e,n){let t=null,i;const a=Ck(e);function o(){var d;clearTimeout(i),(d=t)==null||d.disconnect(),t=null}function l(d,f){d===void 0&&(d=!1),f===void 0&&(f=1),o();const u=e.getBoundingClientRect(),{left:p,top:g,width:b,height:v}=u;if(d||n(),!b||!v)return;const S=dx(g),k=dx(a.clientWidth-(p+b)),T=dx(a.clientHeight-(g+v)),P=dx(p),I={rootMargin:-S+"px "+-k+"px "+-T+"px "+-P+"px",threshold:b4(0,x4(1,f))||1};let U=!0;function L($){const z=$[0].intersectionRatio;if(z!==f){if(!U)return l();z?l(!1,z):i=setTimeout(()=>{l(!1,1e-7)},1e3)}z===1&&!Tk(u,e.getBoundingClientRect())&&l(),U=!1}try{t=new IntersectionObserver(L,{...I,root:a.ownerDocument})}catch{t=new IntersectionObserver(L,I)}t.observe(e)}return l(!0),o}function D4(e,n,t,i){i===void 0&&(i={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:d=typeof IntersectionObserver=="function",animationFrame:f=!1}=i,u=gw(e),p=a||o?[...u?nb(u):[],...nb(n)]:[];p.forEach(P=>{a&&P.addEventListener("scroll",t,{passive:!0}),o&&P.addEventListener("resize",t)});const g=u&&d?P4(u,t):null;let b=-1,v=null;l&&(v=new ResizeObserver(P=>{let[M]=P;M&&M.target===u&&v&&(v.unobserve(n),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var I;(I=v)==null||I.observe(n)})),t()}),u&&!f&&v.observe(u),v.observe(n));let S,k=f?eN(e):null;f&&T();function T(){const P=eN(e);k&&!Tk(k,P)&&t(),k=P,S=requestAnimationFrame(T)}return t(),()=>{var P;p.forEach(M=>{a&&M.removeEventListener("scroll",t),o&&M.removeEventListener("resize",t)}),g==null||g(),(P=v)==null||P.disconnect(),v=null,f&&cancelAnimationFrame(S)}}var s1=w.useLayoutEffect,I4=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],ib=function(){};function R4(e,n){return n?n[0]==="-"?e+n:e+"__"+n:e}function M4(e,n){for(var t=arguments.length,i=new Array(t>2?t-2:0),a=2;a<t;a++)i[a-2]=arguments[a];var o=[].concat(i);if(n&&e)for(var l in n)n.hasOwnProperty(l)&&n[l]&&o.push("".concat(R4(e,l)));return o.filter(function(d){return d}).map(function(d){return String(d).trim()}).join(" ")}var tN=function(n){return V4(n)?n.filter(Boolean):Ld(n)==="object"&&n!==null?[n]:[]},Ek=function(n){n.className,n.clearValue,n.cx,n.getStyles,n.getClassNames,n.getValue,n.hasValue,n.isMulti,n.isRtl,n.options,n.selectOption,n.selectProps,n.setValue,n.theme;var t=Ql(n,I4);return Dt({},t)},yi=function(n,t,i){var a=n.cx,o=n.getStyles,l=n.getClassNames,d=n.className;return{css:o(t,n),className:a(i??{},l(t,n),d)}};function kb(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function O4(e){return kb(e)?window.innerHeight:e.clientHeight}function Ak(e){return kb(e)?window.pageYOffset:e.scrollTop}function rb(e,n){if(kb(e)){window.scrollTo(0,n);return}e.scrollTop=n}function L4(e){var n=getComputedStyle(e),t=n.position==="absolute",i=/(auto|scroll)/;if(n.position==="fixed")return document.documentElement;for(var a=e;a=a.parentElement;)if(n=getComputedStyle(a),!(t&&n.position==="static")&&i.test(n.overflow+n.overflowY+n.overflowX))return a;return document.documentElement}function F4(e,n,t,i){return t*((e=e/i-1)*e*e+1)+n}function fx(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ib,a=Ak(e),o=n-a,l=10,d=0;function f(){d+=l;var u=F4(d,a,o,t);rb(e,u),d<t?window.requestAnimationFrame(f):i(e)}f()}function nN(e,n){var t=e.getBoundingClientRect(),i=n.getBoundingClientRect(),a=n.offsetHeight/3;i.bottom+a>t.bottom?rb(e,Math.min(n.offsetTop+n.clientHeight-e.offsetHeight+a,e.scrollHeight)):i.top-a<t.top&&rb(e,Math.max(n.offsetTop-a,0))}function $4(e){var n=e.getBoundingClientRect();return{bottom:n.bottom,height:n.height,left:n.left,right:n.right,top:n.top,width:n.width}}function iN(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function z4(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var Pk=!1,U4={get passive(){return Pk=!0}},hx=typeof window<"u"?window:{};hx.addEventListener&&hx.removeEventListener&&(hx.addEventListener("p",ib,U4),hx.removeEventListener("p",ib,!1));var B4=Pk;function q4(e){return e!=null}function V4(e){return Array.isArray(e)}function px(e,n,t){return e?n:t}var H4=function(n){for(var t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];var o=Object.entries(n).filter(function(l){var d=Hl(l,1),f=d[0];return!i.includes(f)});return o.reduce(function(l,d){var f=Hl(d,2),u=f[0],p=f[1];return l[u]=p,l},{})},G4=["children","innerProps"],Y4=["children","innerProps"];function W4(e){var n=e.maxHeight,t=e.menuEl,i=e.minHeight,a=e.placement,o=e.shouldScroll,l=e.isFixedPosition,d=e.controlHeight,f=L4(t),u={placement:"bottom",maxHeight:n};if(!t||!t.offsetParent)return u;var p=f.getBoundingClientRect(),g=p.height,b=t.getBoundingClientRect(),v=b.bottom,S=b.height,k=b.top,T=t.offsetParent.getBoundingClientRect(),P=T.top,M=l?window.innerHeight:O4(f),I=Ak(f),U=parseInt(getComputedStyle(t).marginBottom,10),L=parseInt(getComputedStyle(t).marginTop,10),$=P-L,z=M-k,F=$+I,Q=g-I-k,R=v-M+I+U,B=I+k-L,Y=160;switch(a){case"auto":case"bottom":if(z>=S)return{placement:"bottom",maxHeight:n};if(Q>=S&&!l)return o&&fx(f,R,Y),{placement:"bottom",maxHeight:n};if(!l&&Q>=i||l&&z>=i){o&&fx(f,R,Y);var re=l?z-U:Q-U;return{placement:"bottom",maxHeight:re}}if(a==="auto"||l){var ne=n,G=l?$:F;return G>=i&&(ne=Math.min(G-U-d,n)),{placement:"top",maxHeight:ne}}if(a==="bottom")return o&&rb(f,R),{placement:"bottom",maxHeight:n};break;case"top":if($>=S)return{placement:"top",maxHeight:n};if(F>=S&&!l)return o&&fx(f,B,Y),{placement:"top",maxHeight:n};if(!l&&F>=i||l&&$>=i){var V=n;return(!l&&F>=i||l&&$>=i)&&(V=l?$-L:F-L),o&&fx(f,B,Y),{placement:"top",maxHeight:V}}return{placement:"bottom",maxHeight:n};default:throw new Error('Invalid placement provided "'.concat(a,'".'))}return u}function Q4(e){var n={bottom:"top",top:"bottom"};return e?n[e]:"bottom"}var Dk=function(n){return n==="auto"?"bottom":n},J4=function(n,t){var i,a=n.placement,o=n.theme,l=o.borderRadius,d=o.spacing,f=o.colors;return Dt((i={label:"menu"},Lm(i,Q4(a),"100%"),Lm(i,"position","absolute"),Lm(i,"width","100%"),Lm(i,"zIndex",1),i),t?{}:{backgroundColor:f.neutral0,borderRadius:l,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:d.menuGutter,marginTop:d.menuGutter})},Ik=w.createContext(null),K4=function(n){var t=n.children,i=n.minMenuHeight,a=n.maxMenuHeight,o=n.menuPlacement,l=n.menuPosition,d=n.menuShouldScrollIntoView,f=n.theme,u=w.useContext(Ik)||{},p=u.setPortalPlacement,g=w.useRef(null),b=w.useState(a),v=Hl(b,2),S=v[0],k=v[1],T=w.useState(null),P=Hl(T,2),M=P[0],I=P[1],U=f.spacing.controlHeight;return s1(function(){var L=g.current;if(L){var $=l==="fixed",z=d&&!$,F=W4({maxHeight:a,menuEl:L,minHeight:i,placement:o,shouldScroll:z,isFixedPosition:$,controlHeight:U});k(F.maxHeight),I(F.placement),p==null||p(F.placement)}},[a,o,l,d,i,p,U]),t({ref:g,placerProps:Dt(Dt({},n),{},{placement:M||Dk(o),maxHeight:S})})},X4=function(n){var t=n.children,i=n.innerRef,a=n.innerProps;return Ct("div",Ot({},yi(n,"menu",{menu:!0}),{ref:i},a),t)},Z4=X4,eO=function(n,t){var i=n.maxHeight,a=n.theme.spacing.baseUnit;return Dt({maxHeight:i,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},t?{}:{paddingBottom:a,paddingTop:a})},tO=function(n){var t=n.children,i=n.innerProps,a=n.innerRef,o=n.isMulti;return Ct("div",Ot({},yi(n,"menuList",{"menu-list":!0,"menu-list--is-multi":o}),{ref:a},i),t)},Rk=function(n,t){var i=n.theme,a=i.spacing.baseUnit,o=i.colors;return Dt({textAlign:"center"},t?{}:{color:o.neutral40,padding:"".concat(a*2,"px ").concat(a*3,"px")})},nO=Rk,iO=Rk,rO=function(n){var t=n.children,i=t===void 0?"No options":t,a=n.innerProps,o=Ql(n,G4);return Ct("div",Ot({},yi(Dt(Dt({},o),{},{children:i,innerProps:a}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),a),i)},aO=function(n){var t=n.children,i=t===void 0?"Loading...":t,a=n.innerProps,o=Ql(n,Y4);return Ct("div",Ot({},yi(Dt(Dt({},o),{},{children:i,innerProps:a}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),a),i)},sO=function(n){var t=n.rect,i=n.offset,a=n.position;return{left:t.left,position:a,top:i,width:t.width,zIndex:1}},oO=function(n){var t=n.appendTo,i=n.children,a=n.controlElement,o=n.innerProps,l=n.menuPlacement,d=n.menuPosition,f=w.useRef(null),u=w.useRef(null),p=w.useState(Dk(l)),g=Hl(p,2),b=g[0],v=g[1],S=w.useMemo(function(){return{setPortalPlacement:v}},[]),k=w.useState(null),T=Hl(k,2),P=T[0],M=T[1],I=w.useCallback(function(){if(a){var z=$4(a),F=d==="fixed"?0:window.pageYOffset,Q=z[b]+F;(Q!==(P==null?void 0:P.offset)||z.left!==(P==null?void 0:P.rect.left)||z.width!==(P==null?void 0:P.rect.width))&&M({offset:Q,rect:z})}},[a,d,b,P==null?void 0:P.offset,P==null?void 0:P.rect.left,P==null?void 0:P.rect.width]);s1(function(){I()},[I]);var U=w.useCallback(function(){typeof u.current=="function"&&(u.current(),u.current=null),a&&f.current&&(u.current=D4(a,f.current,I,{elementResize:"ResizeObserver"in window}))},[a,I]);s1(function(){U()},[U]);var L=w.useCallback(function(z){f.current=z,U()},[U]);if(!t&&d!=="fixed"||!P)return null;var $=Ct("div",Ot({ref:L},yi(Dt(Dt({},n),{},{offset:P.offset,position:d,rect:P.rect}),"menuPortal",{"menu-portal":!0}),o),i);return Ct(Ik.Provider,{value:S},t?MD.createPortal($,t):$)},lO=function(n){var t=n.isDisabled,i=n.isRtl;return{label:"container",direction:i?"rtl":void 0,pointerEvents:t?"none":void 0,position:"relative"}},cO=function(n){var t=n.children,i=n.innerProps,a=n.isDisabled,o=n.isRtl;return Ct("div",Ot({},yi(n,"container",{"--is-disabled":a,"--is-rtl":o}),i),t)},uO=function(n,t){var i=n.theme.spacing,a=n.isMulti,o=n.hasValue,l=n.selectProps.controlShouldRenderValue;return Dt({alignItems:"center",display:a&&o&&l?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},t?{}:{padding:"".concat(i.baseUnit/2,"px ").concat(i.baseUnit*2,"px")})},dO=function(n){var t=n.children,i=n.innerProps,a=n.isMulti,o=n.hasValue;return Ct("div",Ot({},yi(n,"valueContainer",{"value-container":!0,"value-container--is-multi":a,"value-container--has-value":o}),i),t)},fO=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},hO=function(n){var t=n.children,i=n.innerProps;return Ct("div",Ot({},yi(n,"indicatorsContainer",{indicators:!0}),i),t)},rN,pO=["size"],mO=["innerProps","isRtl","size"],gO={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},Mk=function(n){var t=n.size,i=Ql(n,pO);return Ct("svg",Ot({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:gO},i))},yw=function(n){return Ct(Mk,Ot({size:20},n),Ct("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},Ok=function(n){return Ct(Mk,Ot({size:20},n),Ct("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},Lk=function(n,t){var i=n.isFocused,a=n.theme,o=a.spacing.baseUnit,l=a.colors;return Dt({label:"indicatorContainer",display:"flex",transition:"color 150ms"},t?{}:{color:i?l.neutral60:l.neutral20,padding:o*2,":hover":{color:i?l.neutral80:l.neutral40}})},yO=Lk,xO=function(n){var t=n.children,i=n.innerProps;return Ct("div",Ot({},yi(n,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),i),t||Ct(Ok,null))},bO=Lk,vO=function(n){var t=n.children,i=n.innerProps;return Ct("div",Ot({},yi(n,"clearIndicator",{indicator:!0,"clear-indicator":!0}),i),t||Ct(yw,null))},wO=function(n,t){var i=n.isDisabled,a=n.theme,o=a.spacing.baseUnit,l=a.colors;return Dt({label:"indicatorSeparator",alignSelf:"stretch",width:1},t?{}:{backgroundColor:i?l.neutral10:l.neutral20,marginBottom:o*2,marginTop:o*2})},SO=function(n){var t=n.innerProps;return Ct("span",Ot({},t,yi(n,"indicatorSeparator",{"indicator-separator":!0})))},NO=g4(rN||(rN=y4([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),CO=function(n,t){var i=n.isFocused,a=n.size,o=n.theme,l=o.colors,d=o.spacing.baseUnit;return Dt({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:a,lineHeight:1,marginRight:a,textAlign:"center",verticalAlign:"middle"},t?{}:{color:i?l.neutral60:l.neutral20,padding:d*2})},Xv=function(n){var t=n.delay,i=n.offset;return Ct("span",{css:hw({animation:"".concat(NO," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:i?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},jO=function(n){var t=n.innerProps,i=n.isRtl,a=n.size,o=a===void 0?4:a,l=Ql(n,mO);return Ct("div",Ot({},yi(Dt(Dt({},l),{},{innerProps:t,isRtl:i,size:o}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),t),Ct(Xv,{delay:0,offset:i}),Ct(Xv,{delay:160,offset:!0}),Ct(Xv,{delay:320,offset:!i}))},_O=function(n,t){var i=n.isDisabled,a=n.isFocused,o=n.theme,l=o.colors,d=o.borderRadius,f=o.spacing;return Dt({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:f.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},t?{}:{backgroundColor:i?l.neutral5:l.neutral0,borderColor:i?l.neutral10:a?l.primary:l.neutral20,borderRadius:d,borderStyle:"solid",borderWidth:1,boxShadow:a?"0 0 0 1px ".concat(l.primary):void 0,"&:hover":{borderColor:a?l.primary:l.neutral30}})},kO=function(n){var t=n.children,i=n.isDisabled,a=n.isFocused,o=n.innerRef,l=n.innerProps,d=n.menuIsOpen;return Ct("div",Ot({ref:o},yi(n,"control",{control:!0,"control--is-disabled":i,"control--is-focused":a,"control--menu-is-open":d}),l,{"aria-disabled":i||void 0}),t)},TO=kO,EO=["data"],AO=function(n,t){var i=n.theme.spacing;return t?{}:{paddingBottom:i.baseUnit*2,paddingTop:i.baseUnit*2}},PO=function(n){var t=n.children,i=n.cx,a=n.getStyles,o=n.getClassNames,l=n.Heading,d=n.headingProps,f=n.innerProps,u=n.label,p=n.theme,g=n.selectProps;return Ct("div",Ot({},yi(n,"group",{group:!0}),f),Ct(l,Ot({},d,{selectProps:g,theme:p,getStyles:a,getClassNames:o,cx:i}),u),Ct("div",null,t))},DO=function(n,t){var i=n.theme,a=i.colors,o=i.spacing;return Dt({label:"group",cursor:"default",display:"block"},t?{}:{color:a.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:o.baseUnit*3,paddingRight:o.baseUnit*3,textTransform:"uppercase"})},IO=function(n){var t=Ek(n);t.data;var i=Ql(t,EO);return Ct("div",Ot({},yi(n,"groupHeading",{"group-heading":!0}),i))},RO=PO,MO=["innerRef","isDisabled","isHidden","inputClassName"],OO=function(n,t){var i=n.isDisabled,a=n.value,o=n.theme,l=o.spacing,d=o.colors;return Dt(Dt({visibility:i?"hidden":"visible",transform:a?"translateZ(0)":""},LO),t?{}:{margin:l.baseUnit/2,paddingBottom:l.baseUnit/2,paddingTop:l.baseUnit/2,color:d.neutral80})},Fk={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},LO={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Dt({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},Fk)},FO=function(n){return Dt({label:"input",color:"inherit",background:0,opacity:n?0:1,width:"100%"},Fk)},$O=function(n){var t=n.cx,i=n.value,a=Ek(n),o=a.innerRef,l=a.isDisabled,d=a.isHidden,f=a.inputClassName,u=Ql(a,MO);return Ct("div",Ot({},yi(n,"input",{"input-container":!0}),{"data-value":i||""}),Ct("input",Ot({className:t({input:!0},f),ref:o,style:FO(d),disabled:l},u)))},zO=$O,UO=function(n,t){var i=n.theme,a=i.spacing,o=i.borderRadius,l=i.colors;return Dt({label:"multiValue",display:"flex",minWidth:0},t?{}:{backgroundColor:l.neutral10,borderRadius:o/2,margin:a.baseUnit/2})},BO=function(n,t){var i=n.theme,a=i.borderRadius,o=i.colors,l=n.cropWithEllipsis;return Dt({overflow:"hidden",textOverflow:l||l===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},t?{}:{borderRadius:a/2,color:o.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},qO=function(n,t){var i=n.theme,a=i.spacing,o=i.borderRadius,l=i.colors,d=n.isFocused;return Dt({alignItems:"center",display:"flex"},t?{}:{borderRadius:o/2,backgroundColor:d?l.dangerLight:void 0,paddingLeft:a.baseUnit,paddingRight:a.baseUnit,":hover":{backgroundColor:l.dangerLight,color:l.danger}})},$k=function(n){var t=n.children,i=n.innerProps;return Ct("div",i,t)},VO=$k,HO=$k;function GO(e){var n=e.children,t=e.innerProps;return Ct("div",Ot({role:"button"},t),n||Ct(yw,{size:14}))}var YO=function(n){var t=n.children,i=n.components,a=n.data,o=n.innerProps,l=n.isDisabled,d=n.removeProps,f=n.selectProps,u=i.Container,p=i.Label,g=i.Remove;return Ct(u,{data:a,innerProps:Dt(Dt({},yi(n,"multiValue",{"multi-value":!0,"multi-value--is-disabled":l})),o),selectProps:f},Ct(p,{data:a,innerProps:Dt({},yi(n,"multiValueLabel",{"multi-value__label":!0})),selectProps:f},t),Ct(g,{data:a,innerProps:Dt(Dt({},yi(n,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(t||"option")},d),selectProps:f}))},WO=YO,QO=function(n,t){var i=n.isDisabled,a=n.isFocused,o=n.isSelected,l=n.theme,d=l.spacing,f=l.colors;return Dt({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},t?{}:{backgroundColor:o?f.primary:a?f.primary25:"transparent",color:i?f.neutral20:o?f.neutral0:"inherit",padding:"".concat(d.baseUnit*2,"px ").concat(d.baseUnit*3,"px"),":active":{backgroundColor:i?void 0:o?f.primary:f.primary50}})},JO=function(n){var t=n.children,i=n.isDisabled,a=n.isFocused,o=n.isSelected,l=n.innerRef,d=n.innerProps;return Ct("div",Ot({},yi(n,"option",{option:!0,"option--is-disabled":i,"option--is-focused":a,"option--is-selected":o}),{ref:l,"aria-disabled":i},d),t)},KO=JO,XO=function(n,t){var i=n.theme,a=i.spacing,o=i.colors;return Dt({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},t?{}:{color:o.neutral50,marginLeft:a.baseUnit/2,marginRight:a.baseUnit/2})},ZO=function(n){var t=n.children,i=n.innerProps;return Ct("div",Ot({},yi(n,"placeholder",{placeholder:!0}),i),t)},eL=ZO,tL=function(n,t){var i=n.isDisabled,a=n.theme,o=a.spacing,l=a.colors;return Dt({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t?{}:{color:i?l.neutral40:l.neutral80,marginLeft:o.baseUnit/2,marginRight:o.baseUnit/2})},nL=function(n){var t=n.children,i=n.isDisabled,a=n.innerProps;return Ct("div",Ot({},yi(n,"singleValue",{"single-value":!0,"single-value--is-disabled":i}),a),t)},iL=nL,rL={ClearIndicator:vO,Control:TO,DropdownIndicator:xO,DownChevron:Ok,CrossIcon:yw,Group:RO,GroupHeading:IO,IndicatorsContainer:hO,IndicatorSeparator:SO,Input:zO,LoadingIndicator:jO,Menu:Z4,MenuList:tO,MenuPortal:oO,LoadingMessage:aO,NoOptionsMessage:rO,MultiValue:WO,MultiValueContainer:VO,MultiValueLabel:HO,MultiValueRemove:GO,Option:KO,Placeholder:eL,SelectContainer:cO,SingleValue:iL,ValueContainer:dO},aL=function(n){return Dt(Dt({},rL),n.components)},aN=Number.isNaN||function(n){return typeof n=="number"&&n!==n};function sL(e,n){return!!(e===n||aN(e)&&aN(n))}function oL(e,n){if(e.length!==n.length)return!1;for(var t=0;t<e.length;t++)if(!sL(e[t],n[t]))return!1;return!0}function lL(e,n){n===void 0&&(n=oL);var t=null;function i(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];if(t&&t.lastThis===this&&n(a,t.lastArgs))return t.lastResult;var l=e.apply(this,a);return t={lastResult:l,lastArgs:a,lastThis:this},l}return i.clear=function(){t=null},i}var cL={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},uL=function(n){return Ct("span",Ot({css:cL},n))},sN=uL,dL={guidance:function(n){var t=n.isSearchable,i=n.isMulti,a=n.tabSelectsValue,o=n.context,l=n.isInitialFocus;switch(o){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(a?", press Tab to select the option and exit the menu":"",".");case"input":return l?"".concat(n["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(i?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(n){var t=n.action,i=n.label,a=i===void 0?"":i,o=n.labels,l=n.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(a,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(o.length>1?"s":""," ").concat(o.join(","),", selected.");case"select-option":return l?"option ".concat(a," is disabled. Select another option."):"option ".concat(a,", selected.");default:return""}},onFocus:function(n){var t=n.context,i=n.focused,a=n.options,o=n.label,l=o===void 0?"":o,d=n.selectValue,f=n.isDisabled,u=n.isSelected,p=n.isAppleDevice,g=function(k,T){return k&&k.length?"".concat(k.indexOf(T)+1," of ").concat(k.length):""};if(t==="value"&&d)return"value ".concat(l," focused, ").concat(g(d,i),".");if(t==="menu"&&p){var b=f?" disabled":"",v="".concat(u?" selected":"").concat(b);return"".concat(l).concat(v,", ").concat(g(a,i),".")}return""},onFilter:function(n){var t=n.inputValue,i=n.resultsMessage;return"".concat(i).concat(t?" for search term "+t:"",".")}},fL=function(n){var t=n.ariaSelection,i=n.focusedOption,a=n.focusedValue,o=n.focusableOptions,l=n.isFocused,d=n.selectValue,f=n.selectProps,u=n.id,p=n.isAppleDevice,g=f.ariaLiveMessages,b=f.getOptionLabel,v=f.inputValue,S=f.isMulti,k=f.isOptionDisabled,T=f.isSearchable,P=f.menuIsOpen,M=f.options,I=f.screenReaderStatus,U=f.tabSelectsValue,L=f.isLoading,$=f["aria-label"],z=f["aria-live"],F=w.useMemo(function(){return Dt(Dt({},dL),g||{})},[g]),Q=w.useMemo(function(){var G="";if(t&&F.onChange){var V=t.option,W=t.options,J=t.removedValue,he=t.removedValues,A=t.value,ce=function(ae){return Array.isArray(ae)?null:ae},se=J||V||ce(A),D=se?b(se):"",oe=W||he||void 0,xe=oe?oe.map(b):[],Z=Dt({isDisabled:se&&k(se,d),label:D,labels:xe},t);G=F.onChange(Z)}return G},[t,F,k,d,b]),R=w.useMemo(function(){var G="",V=i||a,W=!!(i&&d&&d.includes(i));if(V&&F.onFocus){var J={focused:V,label:b(V),isDisabled:k(V,d),isSelected:W,options:o,context:V===i?"menu":"value",selectValue:d,isAppleDevice:p};G=F.onFocus(J)}return G},[i,a,b,k,F,o,d,p]),B=w.useMemo(function(){var G="";if(P&&M.length&&!L&&F.onFilter){var V=I({count:o.length});G=F.onFilter({inputValue:v,resultsMessage:V})}return G},[o,v,P,F,M,I,L]),Y=(t==null?void 0:t.action)==="initial-input-focus",re=w.useMemo(function(){var G="";if(F.guidance){var V=a?"value":P?"menu":"input";G=F.guidance({"aria-label":$,context:V,isDisabled:i&&k(i,d),isMulti:S,isSearchable:T,tabSelectsValue:U,isInitialFocus:Y})}return G},[$,i,a,S,k,T,P,F,d,U,Y]),ne=Ct(w.Fragment,null,Ct("span",{id:"aria-selection"},Q),Ct("span",{id:"aria-focused"},R),Ct("span",{id:"aria-results"},B),Ct("span",{id:"aria-guidance"},re));return Ct(w.Fragment,null,Ct(sN,{id:u},Y&&ne),Ct(sN,{"aria-live":z,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},l&&!Y&&ne))},hL=fL,o1=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],pL=new RegExp("["+o1.map(function(e){return e.letters}).join("")+"]","g"),zk={};for(var Zv=0;Zv<o1.length;Zv++)for(var e0=o1[Zv],t0=0;t0<e0.letters.length;t0++)zk[e0.letters[t0]]=e0.base;var Uk=function(n){return n.replace(pL,function(t){return zk[t]})},mL=lL(Uk),oN=function(n){return n.replace(/^\s+|\s+$/g,"")},gL=function(n){return"".concat(n.label," ").concat(n.value)},yL=function(n){return function(t,i){if(t.data.__isNew__)return!0;var a=Dt({ignoreCase:!0,ignoreAccents:!0,stringify:gL,trim:!0,matchFrom:"any"},n),o=a.ignoreCase,l=a.ignoreAccents,d=a.stringify,f=a.trim,u=a.matchFrom,p=f?oN(i):i,g=f?oN(d(t)):d(t);return o&&(p=p.toLowerCase(),g=g.toLowerCase()),l&&(p=mL(p),g=Uk(g)),u==="start"?g.substr(0,p.length)===p:g.indexOf(p)>-1}},xL=["innerRef"];function bL(e){var n=e.innerRef,t=Ql(e,xL),i=H4(t,"onExited","in","enter","exit","appear");return Ct("input",Ot({ref:n},i,{css:hw({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var vL=function(n){n.cancelable&&n.preventDefault(),n.stopPropagation()};function wL(e){var n=e.isEnabled,t=e.onBottomArrive,i=e.onBottomLeave,a=e.onTopArrive,o=e.onTopLeave,l=w.useRef(!1),d=w.useRef(!1),f=w.useRef(0),u=w.useRef(null),p=w.useCallback(function(T,P){if(u.current!==null){var M=u.current,I=M.scrollTop,U=M.scrollHeight,L=M.clientHeight,$=u.current,z=P>0,F=U-L-I,Q=!1;F>P&&l.current&&(i&&i(T),l.current=!1),z&&d.current&&(o&&o(T),d.current=!1),z&&P>F?(t&&!l.current&&t(T),$.scrollTop=U,Q=!0,l.current=!0):!z&&-P>I&&(a&&!d.current&&a(T),$.scrollTop=0,Q=!0,d.current=!0),Q&&vL(T)}},[t,i,a,o]),g=w.useCallback(function(T){p(T,T.deltaY)},[p]),b=w.useCallback(function(T){f.current=T.changedTouches[0].clientY},[]),v=w.useCallback(function(T){var P=f.current-T.changedTouches[0].clientY;p(T,P)},[p]),S=w.useCallback(function(T){if(T){var P=B4?{passive:!1}:!1;T.addEventListener("wheel",g,P),T.addEventListener("touchstart",b,P),T.addEventListener("touchmove",v,P)}},[v,b,g]),k=w.useCallback(function(T){T&&(T.removeEventListener("wheel",g,!1),T.removeEventListener("touchstart",b,!1),T.removeEventListener("touchmove",v,!1))},[v,b,g]);return w.useEffect(function(){if(n){var T=u.current;return S(T),function(){k(T)}}},[n,S,k]),function(T){u.current=T}}var lN=["boxSizing","height","overflow","paddingRight","position"],cN={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function uN(e){e.cancelable&&e.preventDefault()}function dN(e){e.stopPropagation()}function fN(){var e=this.scrollTop,n=this.scrollHeight,t=e+this.offsetHeight;e===0?this.scrollTop=1:t===n&&(this.scrollTop=e-1)}function hN(){return"ontouchstart"in window||navigator.maxTouchPoints}var pN=!!(typeof window<"u"&&window.document&&window.document.createElement),_m=0,dh={capture:!1,passive:!1};function SL(e){var n=e.isEnabled,t=e.accountForScrollbars,i=t===void 0?!0:t,a=w.useRef({}),o=w.useRef(null),l=w.useCallback(function(f){if(pN){var u=document.body,p=u&&u.style;if(i&&lN.forEach(function(S){var k=p&&p[S];a.current[S]=k}),i&&_m<1){var g=parseInt(a.current.paddingRight,10)||0,b=document.body?document.body.clientWidth:0,v=window.innerWidth-b+g||0;Object.keys(cN).forEach(function(S){var k=cN[S];p&&(p[S]=k)}),p&&(p.paddingRight="".concat(v,"px"))}u&&hN()&&(u.addEventListener("touchmove",uN,dh),f&&(f.addEventListener("touchstart",fN,dh),f.addEventListener("touchmove",dN,dh))),_m+=1}},[i]),d=w.useCallback(function(f){if(pN){var u=document.body,p=u&&u.style;_m=Math.max(_m-1,0),i&&_m<1&&lN.forEach(function(g){var b=a.current[g];p&&(p[g]=b)}),u&&hN()&&(u.removeEventListener("touchmove",uN,dh),f&&(f.removeEventListener("touchstart",fN,dh),f.removeEventListener("touchmove",dN,dh)))}},[i]);return w.useEffect(function(){if(n){var f=o.current;return l(f),function(){d(f)}}},[n,l,d]),function(f){o.current=f}}var NL=function(n){var t=n.target;return t.ownerDocument.activeElement&&t.ownerDocument.activeElement.blur()},CL={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function jL(e){var n=e.children,t=e.lockEnabled,i=e.captureEnabled,a=i===void 0?!0:i,o=e.onBottomArrive,l=e.onBottomLeave,d=e.onTopArrive,f=e.onTopLeave,u=wL({isEnabled:a,onBottomArrive:o,onBottomLeave:l,onTopArrive:d,onTopLeave:f}),p=SL({isEnabled:t}),g=function(v){u(v),p(v)};return Ct(w.Fragment,null,t&&Ct("div",{onClick:NL,css:CL}),n(g))}var _L={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},kL=function(n){var t=n.name,i=n.onFocus;return Ct("input",{required:!0,name:t,tabIndex:-1,"aria-hidden":"true",onFocus:i,css:_L,value:"",onChange:function(){}})},TL=kL;function xw(e){var n;return typeof window<"u"&&window.navigator!=null?e.test(((n=window.navigator.userAgentData)===null||n===void 0?void 0:n.platform)||window.navigator.platform):!1}function EL(){return xw(/^iPhone/i)}function Bk(){return xw(/^Mac/i)}function AL(){return xw(/^iPad/i)||Bk()&&navigator.maxTouchPoints>1}function PL(){return EL()||AL()}function DL(){return Bk()||PL()}var IL=function(n){return n.label},RL=function(n){return n.label},ML=function(n){return n.value},OL=function(n){return!!n.isDisabled},LL={clearIndicator:bO,container:lO,control:_O,dropdownIndicator:yO,group:AO,groupHeading:DO,indicatorsContainer:fO,indicatorSeparator:wO,input:OO,loadingIndicator:CO,loadingMessage:iO,menu:J4,menuList:eO,menuPortal:sO,multiValue:UO,multiValueLabel:BO,multiValueRemove:qO,noOptionsMessage:nO,option:QO,placeholder:XO,singleValue:tL,valueContainer:uO},FL={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},$L=4,qk=4,zL=38,UL=qk*2,BL={baseUnit:qk,controlHeight:zL,menuGutter:UL},n0={borderRadius:$L,colors:FL,spacing:BL},qL={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:iN(),captureMenuScroll:!iN(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:yL(),formatGroupLabel:IL,getOptionLabel:RL,getOptionValue:ML,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:OL,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!z4(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(n){var t=n.count;return"".concat(t," result").concat(t!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function mN(e,n,t,i){var a=Gk(e,n,t),o=Yk(e,n,t),l=Hk(e,n),d=ab(e,n);return{type:"option",data:n,isDisabled:a,isSelected:o,label:l,value:d,index:i}}function Ox(e,n){return e.options.map(function(t,i){if("options"in t){var a=t.options.map(function(l,d){return mN(e,l,n,d)}).filter(function(l){return yN(e,l)});return a.length>0?{type:"group",data:t,options:a,index:i}:void 0}var o=mN(e,t,n,i);return yN(e,o)?o:void 0}).filter(q4)}function Vk(e){return e.reduce(function(n,t){return t.type==="group"?n.push.apply(n,lw(t.options.map(function(i){return i.data}))):n.push(t.data),n},[])}function gN(e,n){return e.reduce(function(t,i){return i.type==="group"?t.push.apply(t,lw(i.options.map(function(a){return{data:a.data,id:"".concat(n,"-").concat(i.index,"-").concat(a.index)}}))):t.push({data:i.data,id:"".concat(n,"-").concat(i.index)}),t},[])}function VL(e,n){return Vk(Ox(e,n))}function yN(e,n){var t=e.inputValue,i=t===void 0?"":t,a=n.data,o=n.isSelected,l=n.label,d=n.value;return(!Qk(e)||!o)&&Wk(e,{label:l,value:d,data:a},i)}function HL(e,n){var t=e.focusedValue,i=e.selectValue,a=i.indexOf(t);if(a>-1){var o=n.indexOf(t);if(o>-1)return t;if(a<n.length)return n[a]}return null}function GL(e,n){var t=e.focusedOption;return t&&n.indexOf(t)>-1?t:n[0]}var i0=function(n,t){var i,a=(i=n.find(function(o){return o.data===t}))===null||i===void 0?void 0:i.id;return a||null},Hk=function(n,t){return n.getOptionLabel(t)},ab=function(n,t){return n.getOptionValue(t)};function Gk(e,n,t){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(n,t):!1}function Yk(e,n,t){if(t.indexOf(n)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(n,t);var i=ab(e,n);return t.some(function(a){return ab(e,a)===i})}function Wk(e,n,t){return e.filterOption?e.filterOption(n,t):!0}var Qk=function(n){var t=n.hideSelectedOptions,i=n.isMulti;return t===void 0?i:t},YL=1,Jk=function(e){hM(t,e);var n=gM(t);function t(i){var a;if(dM(this,t),a=n.call(this,i),a.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},a.blockOptionHover=!1,a.isComposing=!1,a.commonProps=void 0,a.initialTouchX=0,a.initialTouchY=0,a.openAfterFocus=!1,a.scrollToFocusedOptionOnUpdate=!1,a.userIsDragging=void 0,a.controlRef=null,a.getControlRef=function(f){a.controlRef=f},a.focusedOptionRef=null,a.getFocusedOptionRef=function(f){a.focusedOptionRef=f},a.menuListRef=null,a.getMenuListRef=function(f){a.menuListRef=f},a.inputRef=null,a.getInputRef=function(f){a.inputRef=f},a.focus=a.focusInput,a.blur=a.blurInput,a.onChange=function(f,u){var p=a.props,g=p.onChange,b=p.name;u.name=b,a.ariaOnChange(f,u),g(f,u)},a.setValue=function(f,u,p){var g=a.props,b=g.closeMenuOnSelect,v=g.isMulti,S=g.inputValue;a.onInputChange("",{action:"set-value",prevInputValue:S}),b&&(a.setState({inputIsHiddenAfterUpdate:!v}),a.onMenuClose()),a.setState({clearFocusValueOnUpdate:!0}),a.onChange(f,{action:u,option:p})},a.selectOption=function(f){var u=a.props,p=u.blurInputOnSelect,g=u.isMulti,b=u.name,v=a.state.selectValue,S=g&&a.isOptionSelected(f,v),k=a.isOptionDisabled(f,v);if(S){var T=a.getOptionValue(f);a.setValue(v.filter(function(P){return a.getOptionValue(P)!==T}),"deselect-option",f)}else if(!k)g?a.setValue([].concat(lw(v),[f]),"select-option",f):a.setValue(f,"select-option");else{a.ariaOnChange(f,{action:"select-option",option:f,name:b});return}p&&a.blurInput()},a.removeValue=function(f){var u=a.props.isMulti,p=a.state.selectValue,g=a.getOptionValue(f),b=p.filter(function(S){return a.getOptionValue(S)!==g}),v=px(u,b,b[0]||null);a.onChange(v,{action:"remove-value",removedValue:f}),a.focusInput()},a.clearValue=function(){var f=a.state.selectValue;a.onChange(px(a.props.isMulti,[],null),{action:"clear",removedValues:f})},a.popValue=function(){var f=a.props.isMulti,u=a.state.selectValue,p=u[u.length-1],g=u.slice(0,u.length-1),b=px(f,g,g[0]||null);p&&a.onChange(b,{action:"pop-value",removedValue:p})},a.getFocusedOptionId=function(f){return i0(a.state.focusableOptionsWithIds,f)},a.getFocusableOptionsWithIds=function(){return gN(Ox(a.props,a.state.selectValue),a.getElementId("option"))},a.getValue=function(){return a.state.selectValue},a.cx=function(){for(var f=arguments.length,u=new Array(f),p=0;p<f;p++)u[p]=arguments[p];return M4.apply(void 0,[a.props.classNamePrefix].concat(u))},a.getOptionLabel=function(f){return Hk(a.props,f)},a.getOptionValue=function(f){return ab(a.props,f)},a.getStyles=function(f,u){var p=a.props.unstyled,g=LL[f](u,p);g.boxSizing="border-box";var b=a.props.styles[f];return b?b(g,u):g},a.getClassNames=function(f,u){var p,g;return(p=(g=a.props.classNames)[f])===null||p===void 0?void 0:p.call(g,u)},a.getElementId=function(f){return"".concat(a.state.instancePrefix,"-").concat(f)},a.getComponents=function(){return aL(a.props)},a.buildCategorizedOptions=function(){return Ox(a.props,a.state.selectValue)},a.getCategorizedOptions=function(){return a.props.menuIsOpen?a.buildCategorizedOptions():[]},a.buildFocusableOptions=function(){return Vk(a.buildCategorizedOptions())},a.getFocusableOptions=function(){return a.props.menuIsOpen?a.buildFocusableOptions():[]},a.ariaOnChange=function(f,u){a.setState({ariaSelection:Dt({value:f},u)})},a.onMenuMouseDown=function(f){f.button===0&&(f.stopPropagation(),f.preventDefault(),a.focusInput())},a.onMenuMouseMove=function(f){a.blockOptionHover=!1},a.onControlMouseDown=function(f){if(!f.defaultPrevented){var u=a.props.openMenuOnClick;a.state.isFocused?a.props.menuIsOpen?f.target.tagName!=="INPUT"&&f.target.tagName!=="TEXTAREA"&&a.onMenuClose():u&&a.openMenu("first"):(u&&(a.openAfterFocus=!0),a.focusInput()),f.target.tagName!=="INPUT"&&f.target.tagName!=="TEXTAREA"&&f.preventDefault()}},a.onDropdownIndicatorMouseDown=function(f){if(!(f&&f.type==="mousedown"&&f.button!==0)&&!a.props.isDisabled){var u=a.props,p=u.isMulti,g=u.menuIsOpen;a.focusInput(),g?(a.setState({inputIsHiddenAfterUpdate:!p}),a.onMenuClose()):a.openMenu("first"),f.preventDefault()}},a.onClearIndicatorMouseDown=function(f){f&&f.type==="mousedown"&&f.button!==0||(a.clearValue(),f.preventDefault(),a.openAfterFocus=!1,f.type==="touchend"?a.focusInput():setTimeout(function(){return a.focusInput()}))},a.onScroll=function(f){typeof a.props.closeMenuOnScroll=="boolean"?f.target instanceof HTMLElement&&kb(f.target)&&a.props.onMenuClose():typeof a.props.closeMenuOnScroll=="function"&&a.props.closeMenuOnScroll(f)&&a.props.onMenuClose()},a.onCompositionStart=function(){a.isComposing=!0},a.onCompositionEnd=function(){a.isComposing=!1},a.onTouchStart=function(f){var u=f.touches,p=u&&u.item(0);p&&(a.initialTouchX=p.clientX,a.initialTouchY=p.clientY,a.userIsDragging=!1)},a.onTouchMove=function(f){var u=f.touches,p=u&&u.item(0);if(p){var g=Math.abs(p.clientX-a.initialTouchX),b=Math.abs(p.clientY-a.initialTouchY),v=5;a.userIsDragging=g>v||b>v}},a.onTouchEnd=function(f){a.userIsDragging||(a.controlRef&&!a.controlRef.contains(f.target)&&a.menuListRef&&!a.menuListRef.contains(f.target)&&a.blurInput(),a.initialTouchX=0,a.initialTouchY=0)},a.onControlTouchEnd=function(f){a.userIsDragging||a.onControlMouseDown(f)},a.onClearIndicatorTouchEnd=function(f){a.userIsDragging||a.onClearIndicatorMouseDown(f)},a.onDropdownIndicatorTouchEnd=function(f){a.userIsDragging||a.onDropdownIndicatorMouseDown(f)},a.handleInputChange=function(f){var u=a.props.inputValue,p=f.currentTarget.value;a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange(p,{action:"input-change",prevInputValue:u}),a.props.menuIsOpen||a.onMenuOpen()},a.onInputFocus=function(f){a.props.onFocus&&a.props.onFocus(f),a.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(a.openAfterFocus||a.props.openMenuOnFocus)&&a.openMenu("first"),a.openAfterFocus=!1},a.onInputBlur=function(f){var u=a.props.inputValue;if(a.menuListRef&&a.menuListRef.contains(document.activeElement)){a.inputRef.focus();return}a.props.onBlur&&a.props.onBlur(f),a.onInputChange("",{action:"input-blur",prevInputValue:u}),a.onMenuClose(),a.setState({focusedValue:null,isFocused:!1})},a.onOptionHover=function(f){if(!(a.blockOptionHover||a.state.focusedOption===f)){var u=a.getFocusableOptions(),p=u.indexOf(f);a.setState({focusedOption:f,focusedOptionId:p>-1?a.getFocusedOptionId(f):null})}},a.shouldHideSelectedOptions=function(){return Qk(a.props)},a.onValueInputFocus=function(f){f.preventDefault(),f.stopPropagation(),a.focus()},a.onKeyDown=function(f){var u=a.props,p=u.isMulti,g=u.backspaceRemovesValue,b=u.escapeClearsValue,v=u.inputValue,S=u.isClearable,k=u.isDisabled,T=u.menuIsOpen,P=u.onKeyDown,M=u.tabSelectsValue,I=u.openMenuOnFocus,U=a.state,L=U.focusedOption,$=U.focusedValue,z=U.selectValue;if(!k&&!(typeof P=="function"&&(P(f),f.defaultPrevented))){switch(a.blockOptionHover=!0,f.key){case"ArrowLeft":if(!p||v)return;a.focusValue("previous");break;case"ArrowRight":if(!p||v)return;a.focusValue("next");break;case"Delete":case"Backspace":if(v)return;if($)a.removeValue($);else{if(!g)return;p?a.popValue():S&&a.clearValue()}break;case"Tab":if(a.isComposing||f.shiftKey||!T||!M||!L||I&&a.isOptionSelected(L,z))return;a.selectOption(L);break;case"Enter":if(f.keyCode===229)break;if(T){if(!L||a.isComposing)return;a.selectOption(L);break}return;case"Escape":T?(a.setState({inputIsHiddenAfterUpdate:!1}),a.onInputChange("",{action:"menu-close",prevInputValue:v}),a.onMenuClose()):S&&b&&a.clearValue();break;case" ":if(v)return;if(!T){a.openMenu("first");break}if(!L)return;a.selectOption(L);break;case"ArrowUp":T?a.focusOption("up"):a.openMenu("last");break;case"ArrowDown":T?a.focusOption("down"):a.openMenu("first");break;case"PageUp":if(!T)return;a.focusOption("pageup");break;case"PageDown":if(!T)return;a.focusOption("pagedown");break;case"Home":if(!T)return;a.focusOption("first");break;case"End":if(!T)return;a.focusOption("last");break;default:return}f.preventDefault()}},a.state.instancePrefix="react-select-"+(a.props.instanceId||++YL),a.state.selectValue=tN(i.value),i.menuIsOpen&&a.state.selectValue.length){var o=a.getFocusableOptionsWithIds(),l=a.buildFocusableOptions(),d=l.indexOf(a.state.selectValue[0]);a.state.focusableOptionsWithIds=o,a.state.focusedOption=l[d],a.state.focusedOptionId=i0(o,l[d])}return a}return fM(t,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&nN(this.menuListRef,this.focusedOptionRef),DL()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(a){var o=this.props,l=o.isDisabled,d=o.menuIsOpen,f=this.state.isFocused;(f&&!l&&a.isDisabled||f&&d&&!a.menuIsOpen)&&this.focusInput(),f&&l&&!a.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!f&&!l&&a.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(nN(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(a,o){this.props.onInputChange(a,o)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(a){var o=this,l=this.state,d=l.selectValue,f=l.isFocused,u=this.buildFocusableOptions(),p=a==="first"?0:u.length-1;if(!this.props.isMulti){var g=u.indexOf(d[0]);g>-1&&(p=g)}this.scrollToFocusedOptionOnUpdate=!(f&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:u[p],focusedOptionId:this.getFocusedOptionId(u[p])},function(){return o.onMenuOpen()})}},{key:"focusValue",value:function(a){var o=this.state,l=o.selectValue,d=o.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var f=l.indexOf(d);d||(f=-1);var u=l.length-1,p=-1;if(l.length){switch(a){case"previous":f===0?p=0:f===-1?p=u:p=f-1;break;case"next":f>-1&&f<u&&(p=f+1);break}this.setState({inputIsHidden:p!==-1,focusedValue:l[p]})}}}},{key:"focusOption",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",o=this.props.pageSize,l=this.state.focusedOption,d=this.getFocusableOptions();if(d.length){var f=0,u=d.indexOf(l);l||(u=-1),a==="up"?f=u>0?u-1:d.length-1:a==="down"?f=(u+1)%d.length:a==="pageup"?(f=u-o,f<0&&(f=0)):a==="pagedown"?(f=u+o,f>d.length-1&&(f=d.length-1)):a==="last"&&(f=d.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:d[f],focusedValue:null,focusedOptionId:this.getFocusedOptionId(d[f])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(n0):Dt(Dt({},n0),this.props.theme):n0}},{key:"getCommonProps",value:function(){var a=this.clearValue,o=this.cx,l=this.getStyles,d=this.getClassNames,f=this.getValue,u=this.selectOption,p=this.setValue,g=this.props,b=g.isMulti,v=g.isRtl,S=g.options,k=this.hasValue();return{clearValue:a,cx:o,getStyles:l,getClassNames:d,getValue:f,hasValue:k,isMulti:b,isRtl:v,options:S,selectOption:u,selectProps:g,setValue:p,theme:this.getTheme()}}},{key:"hasValue",value:function(){var a=this.state.selectValue;return a.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var a=this.props,o=a.isClearable,l=a.isMulti;return o===void 0?l:o}},{key:"isOptionDisabled",value:function(a,o){return Gk(this.props,a,o)}},{key:"isOptionSelected",value:function(a,o){return Yk(this.props,a,o)}},{key:"filterOption",value:function(a,o){return Wk(this.props,a,o)}},{key:"formatOptionLabel",value:function(a,o){if(typeof this.props.formatOptionLabel=="function"){var l=this.props.inputValue,d=this.state.selectValue;return this.props.formatOptionLabel(a,{context:o,inputValue:l,selectValue:d})}else return this.getOptionLabel(a)}},{key:"formatGroupLabel",value:function(a){return this.props.formatGroupLabel(a)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var a=this.props,o=a.isDisabled,l=a.isSearchable,d=a.inputId,f=a.inputValue,u=a.tabIndex,p=a.form,g=a.menuIsOpen,b=a.required,v=this.getComponents(),S=v.Input,k=this.state,T=k.inputIsHidden,P=k.ariaSelection,M=this.commonProps,I=d||this.getElementId("input"),U=Dt(Dt(Dt({"aria-autocomplete":"list","aria-expanded":g,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":b,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},g&&{"aria-controls":this.getElementId("listbox")}),!l&&{"aria-readonly":!0}),this.hasValue()?(P==null?void 0:P.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return l?w.createElement(S,Ot({},M,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:I,innerRef:this.getInputRef,isDisabled:o,isHidden:T,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:u,form:p,type:"text",value:f},U)):w.createElement(bL,Ot({id:I,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:ib,onFocus:this.onInputFocus,disabled:o,tabIndex:u,inputMode:"none",form:p,value:""},U))}},{key:"renderPlaceholderOrValue",value:function(){var a=this,o=this.getComponents(),l=o.MultiValue,d=o.MultiValueContainer,f=o.MultiValueLabel,u=o.MultiValueRemove,p=o.SingleValue,g=o.Placeholder,b=this.commonProps,v=this.props,S=v.controlShouldRenderValue,k=v.isDisabled,T=v.isMulti,P=v.inputValue,M=v.placeholder,I=this.state,U=I.selectValue,L=I.focusedValue,$=I.isFocused;if(!this.hasValue()||!S)return P?null:w.createElement(g,Ot({},b,{key:"placeholder",isDisabled:k,isFocused:$,innerProps:{id:this.getElementId("placeholder")}}),M);if(T)return U.map(function(F,Q){var R=F===L,B="".concat(a.getOptionLabel(F),"-").concat(a.getOptionValue(F));return w.createElement(l,Ot({},b,{components:{Container:d,Label:f,Remove:u},isFocused:R,isDisabled:k,key:B,index:Q,removeProps:{onClick:function(){return a.removeValue(F)},onTouchEnd:function(){return a.removeValue(F)},onMouseDown:function(re){re.preventDefault()}},data:F}),a.formatOptionLabel(F,"value"))});if(P)return null;var z=U[0];return w.createElement(p,Ot({},b,{data:z,isDisabled:k}),this.formatOptionLabel(z,"value"))}},{key:"renderClearIndicator",value:function(){var a=this.getComponents(),o=a.ClearIndicator,l=this.commonProps,d=this.props,f=d.isDisabled,u=d.isLoading,p=this.state.isFocused;if(!this.isClearable()||!o||f||!this.hasValue()||u)return null;var g={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(o,Ot({},l,{innerProps:g,isFocused:p}))}},{key:"renderLoadingIndicator",value:function(){var a=this.getComponents(),o=a.LoadingIndicator,l=this.commonProps,d=this.props,f=d.isDisabled,u=d.isLoading,p=this.state.isFocused;if(!o||!u)return null;var g={"aria-hidden":"true"};return w.createElement(o,Ot({},l,{innerProps:g,isDisabled:f,isFocused:p}))}},{key:"renderIndicatorSeparator",value:function(){var a=this.getComponents(),o=a.DropdownIndicator,l=a.IndicatorSeparator;if(!o||!l)return null;var d=this.commonProps,f=this.props.isDisabled,u=this.state.isFocused;return w.createElement(l,Ot({},d,{isDisabled:f,isFocused:u}))}},{key:"renderDropdownIndicator",value:function(){var a=this.getComponents(),o=a.DropdownIndicator;if(!o)return null;var l=this.commonProps,d=this.props.isDisabled,f=this.state.isFocused,u={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return w.createElement(o,Ot({},l,{innerProps:u,isDisabled:d,isFocused:f}))}},{key:"renderMenu",value:function(){var a=this,o=this.getComponents(),l=o.Group,d=o.GroupHeading,f=o.Menu,u=o.MenuList,p=o.MenuPortal,g=o.LoadingMessage,b=o.NoOptionsMessage,v=o.Option,S=this.commonProps,k=this.state.focusedOption,T=this.props,P=T.captureMenuScroll,M=T.inputValue,I=T.isLoading,U=T.loadingMessage,L=T.minMenuHeight,$=T.maxMenuHeight,z=T.menuIsOpen,F=T.menuPlacement,Q=T.menuPosition,R=T.menuPortalTarget,B=T.menuShouldBlockScroll,Y=T.menuShouldScrollIntoView,re=T.noOptionsMessage,ne=T.onMenuScrollToTop,G=T.onMenuScrollToBottom;if(!z)return null;var V=function(D,oe){var xe=D.type,Z=D.data,ue=D.isDisabled,ae=D.isSelected,Re=D.label,Ae=D.value,Ce=k===Z,Se=ue?void 0:function(){return a.onOptionHover(Z)},De=ue?void 0:function(){return a.selectOption(Z)},Me="".concat(a.getElementId("option"),"-").concat(oe),et={id:Me,onClick:De,onMouseMove:Se,onMouseOver:Se,tabIndex:-1,role:"option","aria-selected":a.state.isAppleDevice?void 0:ae};return w.createElement(v,Ot({},S,{innerProps:et,data:Z,isDisabled:ue,isSelected:ae,key:Me,label:Re,type:xe,value:Ae,isFocused:Ce,innerRef:Ce?a.getFocusedOptionRef:void 0}),a.formatOptionLabel(D.data,"menu"))},W;if(this.hasOptions())W=this.getCategorizedOptions().map(function(se){if(se.type==="group"){var D=se.data,oe=se.options,xe=se.index,Z="".concat(a.getElementId("group"),"-").concat(xe),ue="".concat(Z,"-heading");return w.createElement(l,Ot({},S,{key:Z,data:D,options:oe,Heading:d,headingProps:{id:ue,data:se.data},label:a.formatGroupLabel(se.data)}),se.options.map(function(ae){return V(ae,"".concat(xe,"-").concat(ae.index))}))}else if(se.type==="option")return V(se,"".concat(se.index))});else if(I){var J=U({inputValue:M});if(J===null)return null;W=w.createElement(g,S,J)}else{var he=re({inputValue:M});if(he===null)return null;W=w.createElement(b,S,he)}var A={minMenuHeight:L,maxMenuHeight:$,menuPlacement:F,menuPosition:Q,menuShouldScrollIntoView:Y},ce=w.createElement(K4,Ot({},S,A),function(se){var D=se.ref,oe=se.placerProps,xe=oe.placement,Z=oe.maxHeight;return w.createElement(f,Ot({},S,A,{innerRef:D,innerProps:{onMouseDown:a.onMenuMouseDown,onMouseMove:a.onMenuMouseMove},isLoading:I,placement:xe}),w.createElement(jL,{captureEnabled:P,onTopArrive:ne,onBottomArrive:G,lockEnabled:B},function(ue){return w.createElement(u,Ot({},S,{innerRef:function(Re){a.getMenuListRef(Re),ue(Re)},innerProps:{role:"listbox","aria-multiselectable":S.isMulti,id:a.getElementId("listbox")},isLoading:I,maxHeight:Z,focusedOption:k}),W)}))});return R||Q==="fixed"?w.createElement(p,Ot({},S,{appendTo:R,controlElement:this.controlRef,menuPlacement:F,menuPosition:Q}),ce):ce}},{key:"renderFormField",value:function(){var a=this,o=this.props,l=o.delimiter,d=o.isDisabled,f=o.isMulti,u=o.name,p=o.required,g=this.state.selectValue;if(p&&!this.hasValue()&&!d)return w.createElement(TL,{name:u,onFocus:this.onValueInputFocus});if(!(!u||d))if(f)if(l){var b=g.map(function(k){return a.getOptionValue(k)}).join(l);return w.createElement("input",{name:u,type:"hidden",value:b})}else{var v=g.length>0?g.map(function(k,T){return w.createElement("input",{key:"i-".concat(T),name:u,type:"hidden",value:a.getOptionValue(k)})}):w.createElement("input",{name:u,type:"hidden",value:""});return w.createElement("div",null,v)}else{var S=g[0]?this.getOptionValue(g[0]):"";return w.createElement("input",{name:u,type:"hidden",value:S})}}},{key:"renderLiveRegion",value:function(){var a=this.commonProps,o=this.state,l=o.ariaSelection,d=o.focusedOption,f=o.focusedValue,u=o.isFocused,p=o.selectValue,g=this.getFocusableOptions();return w.createElement(hL,Ot({},a,{id:this.getElementId("live-region"),ariaSelection:l,focusedOption:d,focusedValue:f,isFocused:u,selectValue:p,focusableOptions:g,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var a=this.getComponents(),o=a.Control,l=a.IndicatorsContainer,d=a.SelectContainer,f=a.ValueContainer,u=this.props,p=u.className,g=u.id,b=u.isDisabled,v=u.menuIsOpen,S=this.state.isFocused,k=this.commonProps=this.getCommonProps();return w.createElement(d,Ot({},k,{className:p,innerProps:{id:g,onKeyDown:this.onKeyDown},isDisabled:b,isFocused:S}),this.renderLiveRegion(),w.createElement(o,Ot({},k,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:b,isFocused:S,menuIsOpen:v}),w.createElement(f,Ot({},k,{isDisabled:b}),this.renderPlaceholderOrValue(),this.renderInput()),w.createElement(l,Ot({},k,{isDisabled:b}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(a,o){var l=o.prevProps,d=o.clearFocusValueOnUpdate,f=o.inputIsHiddenAfterUpdate,u=o.ariaSelection,p=o.isFocused,g=o.prevWasFocused,b=o.instancePrefix,v=a.options,S=a.value,k=a.menuIsOpen,T=a.inputValue,P=a.isMulti,M=tN(S),I={};if(l&&(S!==l.value||v!==l.options||k!==l.menuIsOpen||T!==l.inputValue)){var U=k?VL(a,M):[],L=k?gN(Ox(a,M),"".concat(b,"-option")):[],$=d?HL(o,M):null,z=GL(o,U),F=i0(L,z);I={selectValue:M,focusedOption:z,focusedOptionId:F,focusableOptionsWithIds:L,focusedValue:$,clearFocusValueOnUpdate:!1}}var Q=f!=null&&a!==l?{inputIsHidden:f,inputIsHiddenAfterUpdate:void 0}:{},R=u,B=p&&g;return p&&!B&&(R={value:px(P,M,M[0]||null),options:M,action:"initial-input-focus"},B=!g),(u==null?void 0:u.action)==="initial-input-focus"&&(R=null),Dt(Dt(Dt({},I),Q),{},{prevProps:a,ariaSelection:R,prevWasFocused:B})}}]),t}(w.Component);Jk.defaultProps=qL;var WL=w.forwardRef(function(e,n){var t=uM(e);return w.createElement(Jk,Ot({ref:n},t))}),Kk=WL;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let QL,JL;function KL(){return{geminiUrl:QL,vertexUrl:JL}}function XL(e,n,t){var i,a,o;if(!(!((i=e.httpOptions)===null||i===void 0)&&i.baseUrl)){const l=KL();return e.vertexai?(a=l.vertexUrl)!==null&&a!==void 0?a:n:(o=l.geminiUrl)!==null&&o!==void 0?o:t}return e.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ag{}function $t(e,n){const t=/\{([^}]+)\}/g;return e.replace(t,(i,a)=>{if(Object.prototype.hasOwnProperty.call(n,a)){const o=n[a];return o!=null?String(o):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function j(e,n,t){for(let o=0;o<n.length-1;o++){const l=n[o];if(l.endsWith("[]")){const d=l.slice(0,-2);if(!(d in e))if(Array.isArray(t))e[d]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(e[d])){const f=e[d];if(Array.isArray(t))for(let u=0;u<f.length;u++){const p=f[u];j(p,n.slice(o+1),t[u])}else for(const u of f)j(u,n.slice(o+1),t)}return}else if(l.endsWith("[0]")){const d=l.slice(0,-3);d in e||(e[d]=[{}]);const f=e[d];j(f[0],n.slice(o+1),t);return}(!e[l]||typeof e[l]!="object")&&(e[l]={}),e=e[l]}const i=n[n.length-1],a=e[i];if(a!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===a)return;if(typeof a=="object"&&typeof t=="object"&&a!==null&&t!==null)Object.assign(a,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else e[i]=t}function C(e,n){try{if(n.length===1&&n[0]==="_self")return e;for(let t=0;t<n.length;t++){if(typeof e!="object"||e===null)return;const i=n[t];if(i.endsWith("[]")){const a=i.slice(0,-2);if(a in e){const o=e[a];return Array.isArray(o)?o.map(l=>C(l,n.slice(t+1))):void 0}else return}else e=e[i]}return e}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function fi(e,n){if(!n||typeof n!="string")throw new Error("model is required and must be a string");if(e.isVertexAI()){if(n.startsWith("publishers/")||n.startsWith("projects/")||n.startsWith("models/"))return n;if(n.indexOf("/")>=0){const t=n.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${n}`}else return n.startsWith("models/")||n.startsWith("tunedModels/")?n:`models/${n}`}function Xk(e,n){const t=fi(e,n);return t?t.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:t.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${t}`:t:""}function Zk(e,n){return Array.isArray(n)?n.map(t=>sb(e,t)):[sb(e,n)]}function sb(e,n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function ZL(e,n){const t=sb(e,n);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function e3(e,n){const t=sb(e,n);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function xN(e,n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function e2(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(t=>xN(e,t)):[xN(e,n)]}function l1(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function bN(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function vN(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function sa(e,n){if(n==null)throw new Error("ContentUnion is required");return l1(n)?n:{role:"user",parts:e2(e,n)}}function t2(e,n){if(!n)return[];if(e.isVertexAI()&&Array.isArray(n))return n.flatMap(t=>{const i=sa(e,t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(e.isVertexAI()){const t=sa(e,n);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(n)?n.map(t=>sa(e,t)):[sa(e,n)]}function fu(e,n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(bN(n)||vN(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[sa(e,n)]}const t=[],i=[],a=l1(n[0]);for(const o of n){const l=l1(o);if(l!=a)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)t.push(o);else{if(bN(o)||vN(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");i.push(o)}}return a||t.push({role:"user",parts:e2(e,i)}),t}function n2(e,n){return n}function i2(e,n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Tb(e,n){return n}function Eb(e,n){if(!Array.isArray(n))throw new Error("tool is required and must be an array of Tools");return n}function t3(e,n,t,i=1){const a=!n.startsWith(`${t}/`)&&n.split("/").length===i;return e.isVertexAI()?n.startsWith("projects/")?n:n.startsWith("locations/")?`projects/${e.getProject()}/${n}`:n.startsWith(`${t}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:a?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}/${n}`:n:a?`${t}/${n}`:n}function hu(e,n){if(typeof n!="string")throw new Error("name must be a string");return t3(e,n,"cachedContents")}function r2(e,n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function pu(e,n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function n3(e){return e!=null&&typeof e=="object"&&"name"in e}function i3(e){return e!=null&&typeof e=="object"&&"video"in e}function r3(e){return e!=null&&typeof e=="object"&&"uri"in e}function a2(e,n){var t;let i;if(n3(n)&&(i=n.name),!(r3(n)&&(i=n.uri,i===void 0))&&!(i3(n)&&(i=(t=n.video)===null||t===void 0?void 0:t.uri,i===void 0))){if(typeof n=="string"&&(i=n),i===void 0)throw new Error("Could not extract file name from the provided input.");if(i.startsWith("https://")){const o=i.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${i}`);i=o[0]}else i.startsWith("files/")&&(i=i.split("files/")[1]);return i}}function s2(e,n){let t;return e.isVertexAI()?t=n?"publishers/google/models":"models":t=n?"models":"tunedModels",t}function o2(e,n){for(const t of["models","tunedModels","publisherModels"])if(a3(n,t))return n[t];return[]}function a3(e,n){return e!==null&&typeof e=="object"&&n in e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function s3(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=C(n,["data"]);i!=null&&j(t,["data"],i);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function o3(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const i=C(n,["thought"]);i!=null&&j(t,["thought"],i);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],s3(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&j(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&j(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&j(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&j(t,["functionResponse"],u);const p=C(n,["text"]);return p!=null&&j(t,["text"],p),t}function wN(e,n){const t={},i=C(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>o3(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function l3(){return{}}function c3(e,n){const t={},i=C(n,["mode"]);i!=null&&j(t,["mode"],i);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function u3(e,n){const t={},i=C(n,["dynamicRetrievalConfig"]);return i!=null&&j(t,["dynamicRetrievalConfig"],c3(e,i)),t}function d3(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&j(t,["googleSearch"],l3());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&j(t,["googleSearchRetrieval"],u3(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&j(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&j(t,["functionDeclarations"],l),t}function f3(e,n){const t={},i=C(n,["mode"]);i!=null&&j(t,["mode"],i);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function h3(e,n){const t={},i=C(n,["functionCallingConfig"]);if(i!=null&&j(t,["functionCallingConfig"],f3(e,i)),C(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function p3(e,n,t){const i={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const o=C(n,["expireTime"]);t!==void 0&&o!=null&&j(t,["expireTime"],o);const l=C(n,["displayName"]);t!==void 0&&l!=null&&j(t,["displayName"],l);const d=C(n,["contents"]);if(t!==void 0&&d!=null){let g=fu(e,d);Array.isArray(g)&&(g=g.map(b=>wN(e,b))),j(t,["contents"],g)}const f=C(n,["systemInstruction"]);t!==void 0&&f!=null&&j(t,["systemInstruction"],wN(e,sa(e,f)));const u=C(n,["tools"]);if(t!==void 0&&u!=null){let g=u;Array.isArray(g)&&(g=g.map(b=>d3(e,b))),j(t,["tools"],g)}const p=C(n,["toolConfig"]);return t!==void 0&&p!=null&&j(t,["toolConfig"],h3(e,p)),i}function m3(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["model"],Xk(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],p3(e,a,t)),t}function g3(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["_url","name"],hu(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function y3(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["_url","name"],hu(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function x3(e,n,t){const i={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const o=C(n,["expireTime"]);return t!==void 0&&o!=null&&j(t,["expireTime"],o),i}function b3(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["_url","name"],hu(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],x3(e,a,t)),t}function v3(e,n,t){const i={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&j(t,["_query","pageToken"],o),i}function w3(e,n){const t={},i=C(n,["config"]);return i!=null&&j(t,["config"],v3(e,i,t)),t}function S3(e,n){const t={},i=C(n,["displayName"]);i!=null&&j(t,["displayName"],i);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function N3(e,n){const t={},i=C(n,["videoMetadata"]);i!=null&&j(t,["videoMetadata"],i);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&j(t,["inlineData"],S3(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&j(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const p=C(n,["functionResponse"]);p!=null&&j(t,["functionResponse"],p);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function SN(e,n){const t={},i=C(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>N3(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function C3(){return{}}function j3(e,n){const t={},i=C(n,["mode"]);i!=null&&j(t,["mode"],i);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function _3(e,n){const t={},i=C(n,["dynamicRetrievalConfig"]);return i!=null&&j(t,["dynamicRetrievalConfig"],j3(e,i)),t}function k3(){return{}}function T3(e,n){const t={},i=C(n,["apiKeyString"]);return i!=null&&j(t,["apiKeyString"],i),t}function E3(e,n){const t={},i=C(n,["apiKeyConfig"]);i!=null&&j(t,["apiKeyConfig"],T3(e,i));const a=C(n,["authType"]);a!=null&&j(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&j(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&j(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&j(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&j(t,["oidcConfig"],f),t}function A3(e,n){const t={},i=C(n,["authConfig"]);return i!=null&&j(t,["authConfig"],E3(e,i)),t}function P3(e,n){const t={},i=C(n,["retrieval"]);i!=null&&j(t,["retrieval"],i),C(n,["googleSearch"])!=null&&j(t,["googleSearch"],C3());const o=C(n,["googleSearchRetrieval"]);o!=null&&j(t,["googleSearchRetrieval"],_3(e,o)),C(n,["enterpriseWebSearch"])!=null&&j(t,["enterpriseWebSearch"],k3());const d=C(n,["googleMaps"]);d!=null&&j(t,["googleMaps"],A3(e,d));const f=C(n,["codeExecution"]);f!=null&&j(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&j(t,["functionDeclarations"],u),t}function D3(e,n){const t={},i=C(n,["mode"]);i!=null&&j(t,["mode"],i);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function I3(e,n){const t={},i=C(n,["latitude"]);i!=null&&j(t,["latitude"],i);const a=C(n,["longitude"]);return a!=null&&j(t,["longitude"],a),t}function R3(e,n){const t={},i=C(n,["latLng"]);return i!=null&&j(t,["latLng"],I3(e,i)),t}function M3(e,n){const t={},i=C(n,["functionCallingConfig"]);i!=null&&j(t,["functionCallingConfig"],D3(e,i));const a=C(n,["retrievalConfig"]);return a!=null&&j(t,["retrievalConfig"],R3(e,a)),t}function O3(e,n,t){const i={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const o=C(n,["expireTime"]);t!==void 0&&o!=null&&j(t,["expireTime"],o);const l=C(n,["displayName"]);t!==void 0&&l!=null&&j(t,["displayName"],l);const d=C(n,["contents"]);if(t!==void 0&&d!=null){let g=fu(e,d);Array.isArray(g)&&(g=g.map(b=>SN(e,b))),j(t,["contents"],g)}const f=C(n,["systemInstruction"]);t!==void 0&&f!=null&&j(t,["systemInstruction"],SN(e,sa(e,f)));const u=C(n,["tools"]);if(t!==void 0&&u!=null){let g=u;Array.isArray(g)&&(g=g.map(b=>P3(e,b))),j(t,["tools"],g)}const p=C(n,["toolConfig"]);return t!==void 0&&p!=null&&j(t,["toolConfig"],M3(e,p)),i}function L3(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["model"],Xk(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],O3(e,a,t)),t}function F3(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["_url","name"],hu(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function $3(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["_url","name"],hu(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function z3(e,n,t){const i={},a=C(n,["ttl"]);t!==void 0&&a!=null&&j(t,["ttl"],a);const o=C(n,["expireTime"]);return t!==void 0&&o!=null&&j(t,["expireTime"],o),i}function U3(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["_url","name"],hu(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],z3(e,a,t)),t}function B3(e,n,t){const i={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&j(t,["_query","pageToken"],o),i}function q3(e,n){const t={},i=C(n,["config"]);return i!=null&&j(t,["config"],B3(e,i,t)),t}function Lx(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const o=C(n,["model"]);o!=null&&j(t,["model"],o);const l=C(n,["createTime"]);l!=null&&j(t,["createTime"],l);const d=C(n,["updateTime"]);d!=null&&j(t,["updateTime"],d);const f=C(n,["expireTime"]);f!=null&&j(t,["expireTime"],f);const u=C(n,["usageMetadata"]);return u!=null&&j(t,["usageMetadata"],u),t}function V3(){return{}}function H3(e,n){const t={},i=C(n,["nextPageToken"]);i!=null&&j(t,["nextPageToken"],i);const a=C(n,["cachedContents"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>Lx(e,l))),j(t,["cachedContents"],o)}return t}function Fx(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const o=C(n,["model"]);o!=null&&j(t,["model"],o);const l=C(n,["createTime"]);l!=null&&j(t,["createTime"],l);const d=C(n,["updateTime"]);d!=null&&j(t,["updateTime"],d);const f=C(n,["expireTime"]);f!=null&&j(t,["expireTime"],f);const u=C(n,["usageMetadata"]);return u!=null&&j(t,["usageMetadata"],u),t}function G3(){return{}}function Y3(e,n){const t={},i=C(n,["nextPageToken"]);i!=null&&j(t,["nextPageToken"],i);const a=C(n,["cachedContents"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>Fx(e,l))),j(t,["cachedContents"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Dh;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Dh||(Dh={}));class Ab{constructor(n,t,i,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(n,i,a)}init(n,t,i){var a,o;this.nameInternal=n,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};i?typeof i=="object"?l=Object.assign({},i):l=i:l={config:{}},l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(o=(a=l.config)===null||a===void 0?void 0:a.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(n){this.init(this.nameInternal,n,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(n){return this.pageInternal[n]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const n=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:n,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const n=await this.requestInternal(this.params);return this.initNextPage(n),this.page}hasNextPage(){var n;return((n=this.params.config)===null||n===void 0?void 0:n.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var NN;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(NN||(NN={}));var CN;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(CN||(CN={}));var jN;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(jN||(jN={}));var _N;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(_N||(_N={}));var kN;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(kN||(kN={}));var TN;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(TN||(TN={}));var EN;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(EN||(EN={}));var Ih;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT"})(Ih||(Ih={}));var AN;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY"})(AN||(AN={}));var PN;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(PN||(PN={}));var DN;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(DN||(DN={}));var IN;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(IN||(IN={}));var RN;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(RN||(RN={}));var uu;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(uu||(uu={}));var MN;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(MN||(MN={}));var c1;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(c1||(c1={}));var ON;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(ON||(ON={}));var LN;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(LN||(LN={}));var FN;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(FN||(FN={}));var $N;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})($N||($N={}));var zN;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(zN||(zN={}));var UN;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(UN||(UN={}));var BN;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi"})(BN||(BN={}));var qN;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(qN||(qN={}));var VN;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(VN||(VN={}));var HN;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(HN||(HN={}));var GN;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(GN||(GN={}));var YN;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(YN||(YN={}));var WN;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(WN||(WN={}));var QN;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(QN||(QN={}));var JN;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(JN||(JN={}));var KN;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(KN||(KN={}));var XN;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(XN||(XN={}));var ZN;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(ZN||(ZN={}));class mx{get text(){var n,t,i,a,o,l,d,f;if(((a=(i=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",p=!1;const g=[];for(const b of(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[v,S]of Object.entries(b))v!=="text"&&v!=="thought"&&(S!==null||S!==void 0)&&g.push(v);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;p=!0,u+=b.text}}return g.length>0&&console.warn(`there are non-text parts ${g} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),p?u:void 0}get data(){var n,t,i,a,o,l,d,f;if(((a=(i=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const p=[];for(const g of(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[b,v]of Object.entries(g))b!=="inlineData"&&(v!==null||v!==void 0)&&p.push(b);g.inlineData&&typeof g.inlineData.data=="string"&&(u+=atob(g.inlineData.data))}return p.length>0&&console.warn(`there are non-data parts ${p} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var n,t,i,a,o,l,d,f;if(((a=(i=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(p=>p.functionCall).map(p=>p.functionCall).filter(p=>p!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var n,t,i,a,o,l,d,f,u;if(((a=(i=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const p=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(g=>g.executableCode).map(g=>g.executableCode).filter(g=>g!==void 0);if((p==null?void 0:p.length)!==0)return(u=p==null?void 0:p[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var n,t,i,a,o,l,d,f,u;if(((a=(i=(t=(n=this.candidates)===null||n===void 0?void 0:n[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const p=(f=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(g=>g.codeExecutionResult).map(g=>g.codeExecutionResult).filter(g=>g!==void 0);if((p==null?void 0:p.length)!==0)return(u=p==null?void 0:p[0])===null||u===void 0?void 0:u.output}}class eC{}class tC{}class W3{}class Q3{}class nC{}class iC{}class rC{}class J3{}class aC{}class sC{}class oC{}class K3{}class u1{constructor(n){const t={};for(const i of n.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=n}json(){return this.responseInternal.json()}}class X3{}class Z3{}class eF{get text(){var n,t,i;let a="",o=!1;const l=[];for(const d of(i=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[f,u]of Object.entries(d))f!=="text"&&f!=="thought"&&u!==null&&l.push(f);if(typeof d.text=="string"){if(typeof d.thought=="boolean"&&d.thought)continue;o=!0,a+=d.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?a:void 0}get data(){var n,t,i;let a="";const o=[];for(const l of(i=(t=(n=this.serverContent)===null||n===void 0?void 0:n.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[d,f]of Object.entries(l))d!=="inlineData"&&f!==null&&o.push(d);l.inlineData&&typeof l.inlineData.data=="string"&&(a+=atob(l.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tF extends ag{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Ab(Dh.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=L3(this.apiClient,n);return d=$t("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>Fx(this.apiClient,p))}else{const u=m3(this.apiClient,n);return d=$t("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>Lx(this.apiClient,p))}}async get(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=F3(this.apiClient,n);return d=$t("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>Fx(this.apiClient,p))}else{const u=g3(this.apiClient,n);return d=$t("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>Lx(this.apiClient,p))}}async delete(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=$3(this.apiClient,n);return d=$t("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(()=>{const p=G3(),g=new sC;return Object.assign(g,p),g})}else{const u=y3(this.apiClient,n);return d=$t("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(()=>{const p=V3(),g=new sC;return Object.assign(g,p),g})}}async update(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=U3(this.apiClient,n);return d=$t("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>Fx(this.apiClient,p))}else{const u=b3(this.apiClient,n);return d=$t("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>Lx(this.apiClient,p))}}async listInternal(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=q3(this.apiClient,n);return d=$t("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>{const g=Y3(this.apiClient,p),b=new oC;return Object.assign(b,g),b})}else{const u=w3(this.apiClient,n);return d=$t("cachedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=H3(this.apiClient,p),b=new oC;return Object.assign(b,g),b})}}}function lC(e){var n=typeof Symbol=="function"&&Symbol.iterator,t=n&&e[n],i=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function Sr(e){return this instanceof Sr?(this.v=e,this):new Sr(e)}function ob(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(e,n||[]),a,o=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",l),a[Symbol.asyncIterator]=function(){return this},a;function l(v){return function(S){return Promise.resolve(S).then(v,g)}}function d(v,S){i[v]&&(a[v]=function(k){return new Promise(function(T,P){o.push([v,k,T,P])>1||f(v,k)})},S&&(a[v]=S(a[v])))}function f(v,S){try{u(i[v](S))}catch(k){b(o[0][3],k)}}function u(v){v.value instanceof Sr?Promise.resolve(v.value.v).then(p,g):b(o[0][2],v)}function p(v){f("next",v)}function g(v){f("throw",v)}function b(v,S){v(S),o.shift(),o.length&&f(o[0][0],o[0][1])}}function d1(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e[Symbol.asyncIterator],t;return n?n.call(e):(e=typeof lC=="function"?lC(e):e[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=e[o]&&function(l){return new Promise(function(d,f){l=e[o](l),a(d,f,l.done,l.value)})}}function a(o,l,d,f){Promise.resolve(f).then(function(u){o({value:u,done:d})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nF(e){var n;if(e.candidates==null||e.candidates.length===0)return!1;const t=(n=e.candidates[0])===null||n===void 0?void 0:n.content;return t===void 0?!1:l2(t)}function l2(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const n of e.parts)if(n===void 0||Object.keys(n).length===0||n.text!==void 0&&n.text==="")return!1;return!0}function iF(e){if(e.length!==0){if(e[0].role!=="user")throw new Error("History must start with a user turn.");for(const n of e)if(n.role!=="user"&&n.role!=="model")throw new Error(`Role must be user or model, but got ${n.role}.`)}}function rF(e){if(e===void 0||e.length===0)return[];const n=[],t=e.length;let i=0,a=e[0];for(;i<t;)if(e[i].role==="user")a=e[i],i++;else{const o=[];let l=!0;for(;i<t&&e[i].role==="model";)o.push(e[i]),l&&!l2(e[i])&&(l=!1),i++;l&&(n.push(a),n.push(...o))}return n}class aF{constructor(n,t){this.modelsModule=n,this.apiClient=t}create(n){return new sF(this.apiClient,this.modelsModule,n.model,n.config,n.history)}}class sF{constructor(n,t,i,a={},o=[]){this.apiClient=n,this.modelsModule=t,this.model=i,this.config=a,this.history=o,this.sendPromise=Promise.resolve(),iF(o)}async sendMessage(n){var t;await this.sendPromise;const i=sa(this.apiClient,n.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=n.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,l;const f=(l=(o=(await a).candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content,u=f?[f]:[];this.recordHistory(i,u)})(),await this.sendPromise,a}async sendMessageStream(n){var t;await this.sendPromise;const i=sa(this.apiClient,n.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=n.config)!==null&&t!==void 0?t:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const o=await a;return this.processStreamResponse(o,i)}getHistory(n=!1){return n?rF(this.history):this.history}processStreamResponse(n,t){var i,a;return ob(this,arguments,function*(){var l,d,f,u;const p=[];try{for(var g=!0,b=d1(n),v;v=yield Sr(b.next()),l=v.done,!l;g=!0){u=v.value,g=!1;const S=u;if(nF(S)){const k=(a=(i=S.candidates)===null||i===void 0?void 0:i[0])===null||a===void 0?void 0:a.content;k!==void 0&&p.push(k)}yield yield Sr(S)}}catch(S){d={error:S}}finally{try{!g&&!l&&(f=b.return)&&(yield Sr(f.call(b)))}finally{if(d)throw d.error}}this.recordHistory(t,p)})}recordHistory(n,t){let i=[];t.length>0&&t.every(a=>a.role==="model")?i=t:i.push({role:"model",parts:[]}),this.history.push(n),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function oF(e,n,t){const i={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);return t!==void 0&&o!=null&&j(t,["_query","pageToken"],o),i}function lF(e,n){const t={},i=C(n,["config"]);return i!=null&&j(t,["config"],oF(e,i,t)),t}function cF(e,n){const t={},i=C(n,["details"]);i!=null&&j(t,["details"],i);const a=C(n,["message"]);a!=null&&j(t,["message"],a);const o=C(n,["code"]);return o!=null&&j(t,["code"],o),t}function uF(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const o=C(n,["mimeType"]);o!=null&&j(t,["mimeType"],o);const l=C(n,["sizeBytes"]);l!=null&&j(t,["sizeBytes"],l);const d=C(n,["createTime"]);d!=null&&j(t,["createTime"],d);const f=C(n,["expirationTime"]);f!=null&&j(t,["expirationTime"],f);const u=C(n,["updateTime"]);u!=null&&j(t,["updateTime"],u);const p=C(n,["sha256Hash"]);p!=null&&j(t,["sha256Hash"],p);const g=C(n,["uri"]);g!=null&&j(t,["uri"],g);const b=C(n,["downloadUri"]);b!=null&&j(t,["downloadUri"],b);const v=C(n,["state"]);v!=null&&j(t,["state"],v);const S=C(n,["source"]);S!=null&&j(t,["source"],S);const k=C(n,["videoMetadata"]);k!=null&&j(t,["videoMetadata"],k);const T=C(n,["error"]);return T!=null&&j(t,["error"],cF(e,T)),t}function dF(e,n){const t={},i=C(n,["file"]);i!=null&&j(t,["file"],uF(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function fF(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["_url","file"],a2(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function hF(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["_url","file"],a2(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function pF(e,n){const t={},i=C(n,["details"]);i!=null&&j(t,["details"],i);const a=C(n,["message"]);a!=null&&j(t,["message"],a);const o=C(n,["code"]);return o!=null&&j(t,["code"],o),t}function f1(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const o=C(n,["mimeType"]);o!=null&&j(t,["mimeType"],o);const l=C(n,["sizeBytes"]);l!=null&&j(t,["sizeBytes"],l);const d=C(n,["createTime"]);d!=null&&j(t,["createTime"],d);const f=C(n,["expirationTime"]);f!=null&&j(t,["expirationTime"],f);const u=C(n,["updateTime"]);u!=null&&j(t,["updateTime"],u);const p=C(n,["sha256Hash"]);p!=null&&j(t,["sha256Hash"],p);const g=C(n,["uri"]);g!=null&&j(t,["uri"],g);const b=C(n,["downloadUri"]);b!=null&&j(t,["downloadUri"],b);const v=C(n,["state"]);v!=null&&j(t,["state"],v);const S=C(n,["source"]);S!=null&&j(t,["source"],S);const k=C(n,["videoMetadata"]);k!=null&&j(t,["videoMetadata"],k);const T=C(n,["error"]);return T!=null&&j(t,["error"],pF(e,T)),t}function mF(e,n){const t={},i=C(n,["nextPageToken"]);i!=null&&j(t,["nextPageToken"],i);const a=C(n,["files"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>f1(e,l))),j(t,["files"],o)}return t}function gF(){return{}}function yF(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xF extends ag{constructor(n){super(),this.apiClient=n,this.list=async(t={})=>new Ab(Dh.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(n){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(n.file,n.config).then(t=>f1(this.apiClient,t))}async download(n){await this.apiClient.downloadFile(n)}async listInternal(n){var t,i;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=lF(this.apiClient,n);return o=$t("files",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),a.then(f=>{const u=mF(this.apiClient,f),p=new K3;return Object.assign(p,u),p})}}async createInternal(n){var t,i;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=dF(this.apiClient,n);return o=$t("upload/v1beta/files",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),a.then(()=>{const f=gF(),u=new X3;return Object.assign(u,f),u})}}async get(n){var t,i;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=fF(this.apiClient,n);return o=$t("files/{file}",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),a.then(f=>f1(this.apiClient,f))}}async delete(n){var t,i;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=hF(this.apiClient,n);return o=$t("files/{file}",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),a.then(()=>{const f=yF(),u=new Z3;return Object.assign(u,f),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bF(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=C(n,["data"]);i!=null&&j(t,["data"],i);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function vF(e,n){const t={},i=C(n,["displayName"]);i!=null&&j(t,["displayName"],i);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function wF(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const i=C(n,["thought"]);i!=null&&j(t,["thought"],i);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],bF(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&j(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&j(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&j(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&j(t,["functionResponse"],u);const p=C(n,["text"]);return p!=null&&j(t,["text"],p),t}function SF(e,n){const t={},i=C(n,["videoMetadata"]);i!=null&&j(t,["videoMetadata"],i);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&j(t,["inlineData"],vF(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&j(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const p=C(n,["functionResponse"]);p!=null&&j(t,["functionResponse"],p);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function NF(e,n){const t={},i=C(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>wF(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function CF(e,n){const t={},i=C(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>SF(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function jF(){return{}}function _F(){return{}}function kF(e,n){const t={},i=C(n,["mode"]);i!=null&&j(t,["mode"],i);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function TF(e,n){const t={},i=C(n,["mode"]);i!=null&&j(t,["mode"],i);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function EF(e,n){const t={},i=C(n,["dynamicRetrievalConfig"]);return i!=null&&j(t,["dynamicRetrievalConfig"],kF(e,i)),t}function AF(e,n){const t={},i=C(n,["dynamicRetrievalConfig"]);return i!=null&&j(t,["dynamicRetrievalConfig"],TF(e,i)),t}function PF(){return{}}function DF(e,n){const t={},i=C(n,["apiKeyString"]);return i!=null&&j(t,["apiKeyString"],i),t}function IF(e,n){const t={},i=C(n,["apiKeyConfig"]);i!=null&&j(t,["apiKeyConfig"],DF(e,i));const a=C(n,["authType"]);a!=null&&j(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&j(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&j(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&j(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&j(t,["oidcConfig"],f),t}function RF(e,n){const t={},i=C(n,["authConfig"]);return i!=null&&j(t,["authConfig"],IF(e,i)),t}function MF(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&j(t,["googleSearch"],jF());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&j(t,["googleSearchRetrieval"],EF(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&j(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&j(t,["functionDeclarations"],l),t}function OF(e,n){const t={},i=C(n,["retrieval"]);i!=null&&j(t,["retrieval"],i),C(n,["googleSearch"])!=null&&j(t,["googleSearch"],_F());const o=C(n,["googleSearchRetrieval"]);o!=null&&j(t,["googleSearchRetrieval"],AF(e,o)),C(n,["enterpriseWebSearch"])!=null&&j(t,["enterpriseWebSearch"],PF());const d=C(n,["googleMaps"]);d!=null&&j(t,["googleMaps"],RF(e,d));const f=C(n,["codeExecution"]);f!=null&&j(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&j(t,["functionDeclarations"],u),t}function LF(e,n){const t={},i=C(n,["handle"]);if(i!=null&&j(t,["handle"],i),C(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function FF(e,n){const t={},i=C(n,["handle"]);i!=null&&j(t,["handle"],i);const a=C(n,["transparent"]);return a!=null&&j(t,["transparent"],a),t}function cC(){return{}}function uC(){return{}}function $F(e,n){const t={},i=C(n,["disabled"]);i!=null&&j(t,["disabled"],i);const a=C(n,["startOfSpeechSensitivity"]);a!=null&&j(t,["startOfSpeechSensitivity"],a);const o=C(n,["endOfSpeechSensitivity"]);o!=null&&j(t,["endOfSpeechSensitivity"],o);const l=C(n,["prefixPaddingMs"]);l!=null&&j(t,["prefixPaddingMs"],l);const d=C(n,["silenceDurationMs"]);return d!=null&&j(t,["silenceDurationMs"],d),t}function zF(e,n){const t={},i=C(n,["disabled"]);i!=null&&j(t,["disabled"],i);const a=C(n,["startOfSpeechSensitivity"]);a!=null&&j(t,["startOfSpeechSensitivity"],a);const o=C(n,["endOfSpeechSensitivity"]);o!=null&&j(t,["endOfSpeechSensitivity"],o);const l=C(n,["prefixPaddingMs"]);l!=null&&j(t,["prefixPaddingMs"],l);const d=C(n,["silenceDurationMs"]);return d!=null&&j(t,["silenceDurationMs"],d),t}function UF(e,n){const t={},i=C(n,["automaticActivityDetection"]);i!=null&&j(t,["automaticActivityDetection"],$F(e,i));const a=C(n,["activityHandling"]);a!=null&&j(t,["activityHandling"],a);const o=C(n,["turnCoverage"]);return o!=null&&j(t,["turnCoverage"],o),t}function BF(e,n){const t={},i=C(n,["automaticActivityDetection"]);i!=null&&j(t,["automaticActivityDetection"],zF(e,i));const a=C(n,["activityHandling"]);a!=null&&j(t,["activityHandling"],a);const o=C(n,["turnCoverage"]);return o!=null&&j(t,["turnCoverage"],o),t}function qF(e,n){const t={},i=C(n,["targetTokens"]);return i!=null&&j(t,["targetTokens"],i),t}function VF(e,n){const t={},i=C(n,["targetTokens"]);return i!=null&&j(t,["targetTokens"],i),t}function HF(e,n){const t={},i=C(n,["triggerTokens"]);i!=null&&j(t,["triggerTokens"],i);const a=C(n,["slidingWindow"]);return a!=null&&j(t,["slidingWindow"],qF(e,a)),t}function GF(e,n){const t={},i=C(n,["triggerTokens"]);i!=null&&j(t,["triggerTokens"],i);const a=C(n,["slidingWindow"]);return a!=null&&j(t,["slidingWindow"],VF(e,a)),t}function YF(e,n,t){const i={},a=C(n,["generationConfig"]);t!==void 0&&a!=null&&j(t,["setup","generationConfig"],a);const o=C(n,["responseModalities"]);t!==void 0&&o!=null&&j(t,["setup","generationConfig","responseModalities"],o);const l=C(n,["temperature"]);t!==void 0&&l!=null&&j(t,["setup","generationConfig","temperature"],l);const d=C(n,["topP"]);t!==void 0&&d!=null&&j(t,["setup","generationConfig","topP"],d);const f=C(n,["topK"]);t!==void 0&&f!=null&&j(t,["setup","generationConfig","topK"],f);const u=C(n,["maxOutputTokens"]);t!==void 0&&u!=null&&j(t,["setup","generationConfig","maxOutputTokens"],u);const p=C(n,["mediaResolution"]);t!==void 0&&p!=null&&j(t,["setup","generationConfig","mediaResolution"],p);const g=C(n,["seed"]);t!==void 0&&g!=null&&j(t,["setup","generationConfig","seed"],g);const b=C(n,["speechConfig"]);t!==void 0&&b!=null&&j(t,["setup","generationConfig","speechConfig"],b);const v=C(n,["systemInstruction"]);t!==void 0&&v!=null&&j(t,["setup","systemInstruction"],NF(e,sa(e,v)));const S=C(n,["tools"]);if(t!==void 0&&S!=null){let U=Eb(e,S);Array.isArray(U)&&(U=U.map(L=>MF(e,Tb(e,L)))),j(t,["setup","tools"],U)}const k=C(n,["sessionResumption"]);t!==void 0&&k!=null&&j(t,["setup","sessionResumption"],LF(e,k));const T=C(n,["inputAudioTranscription"]);t!==void 0&&T!=null&&j(t,["setup","inputAudioTranscription"],cC());const P=C(n,["outputAudioTranscription"]);t!==void 0&&P!=null&&j(t,["setup","outputAudioTranscription"],cC());const M=C(n,["realtimeInputConfig"]);t!==void 0&&M!=null&&j(t,["setup","realtimeInputConfig"],UF(e,M));const I=C(n,["contextWindowCompression"]);return t!==void 0&&I!=null&&j(t,["setup","contextWindowCompression"],HF(e,I)),i}function WF(e,n,t){const i={},a=C(n,["generationConfig"]);t!==void 0&&a!=null&&j(t,["setup","generationConfig"],a);const o=C(n,["responseModalities"]);t!==void 0&&o!=null&&j(t,["setup","generationConfig","responseModalities"],o);const l=C(n,["temperature"]);t!==void 0&&l!=null&&j(t,["setup","generationConfig","temperature"],l);const d=C(n,["topP"]);t!==void 0&&d!=null&&j(t,["setup","generationConfig","topP"],d);const f=C(n,["topK"]);t!==void 0&&f!=null&&j(t,["setup","generationConfig","topK"],f);const u=C(n,["maxOutputTokens"]);t!==void 0&&u!=null&&j(t,["setup","generationConfig","maxOutputTokens"],u);const p=C(n,["mediaResolution"]);t!==void 0&&p!=null&&j(t,["setup","generationConfig","mediaResolution"],p);const g=C(n,["seed"]);t!==void 0&&g!=null&&j(t,["setup","generationConfig","seed"],g);const b=C(n,["speechConfig"]);t!==void 0&&b!=null&&j(t,["setup","generationConfig","speechConfig"],b);const v=C(n,["systemInstruction"]);t!==void 0&&v!=null&&j(t,["setup","systemInstruction"],CF(e,sa(e,v)));const S=C(n,["tools"]);if(t!==void 0&&S!=null){let U=Eb(e,S);Array.isArray(U)&&(U=U.map(L=>OF(e,Tb(e,L)))),j(t,["setup","tools"],U)}const k=C(n,["sessionResumption"]);t!==void 0&&k!=null&&j(t,["setup","sessionResumption"],FF(e,k));const T=C(n,["inputAudioTranscription"]);t!==void 0&&T!=null&&j(t,["setup","inputAudioTranscription"],uC());const P=C(n,["outputAudioTranscription"]);t!==void 0&&P!=null&&j(t,["setup","outputAudioTranscription"],uC());const M=C(n,["realtimeInputConfig"]);t!==void 0&&M!=null&&j(t,["setup","realtimeInputConfig"],BF(e,M));const I=C(n,["contextWindowCompression"]);return t!==void 0&&I!=null&&j(t,["setup","contextWindowCompression"],GF(e,I)),i}function QF(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["setup","model"],fi(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],YF(e,a,t)),t}function JF(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["setup","model"],fi(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],WF(e,a,t)),t}function KF(){return{}}function XF(){return{}}function ZF(){return{}}function e6(){return{}}function t6(e,n){const t={},i=C(n,["media"]);i!=null&&j(t,["mediaChunks"],Zk(e,i));const a=C(n,["audio"]);a!=null&&j(t,["audio"],e3(e,a));const o=C(n,["audioStreamEnd"]);o!=null&&j(t,["audioStreamEnd"],o);const l=C(n,["video"]);l!=null&&j(t,["video"],ZL(e,l));const d=C(n,["text"]);return d!=null&&j(t,["text"],d),C(n,["activityStart"])!=null&&j(t,["activityStart"],KF()),C(n,["activityEnd"])!=null&&j(t,["activityEnd"],ZF()),t}function n6(e,n){const t={},i=C(n,["media"]);if(i!=null&&j(t,["mediaChunks"],Zk(e,i)),C(n,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const a=C(n,["audioStreamEnd"]);if(a!=null&&j(t,["audioStreamEnd"],a),C(n,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(C(n,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return C(n,["activityStart"])!=null&&j(t,["activityStart"],XF()),C(n,["activityEnd"])!=null&&j(t,["activityEnd"],e6()),t}function i6(){return{}}function r6(){return{}}function a6(e,n){const t={},i=C(n,["data"]);i!=null&&j(t,["data"],i);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function s6(e,n){const t={},i=C(n,["displayName"]);i!=null&&j(t,["displayName"],i);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function o6(e,n){const t={},i=C(n,["thought"]);i!=null&&j(t,["thought"],i);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],a6(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&j(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&j(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&j(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&j(t,["functionResponse"],u);const p=C(n,["text"]);return p!=null&&j(t,["text"],p),t}function l6(e,n){const t={},i=C(n,["videoMetadata"]);i!=null&&j(t,["videoMetadata"],i);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&j(t,["inlineData"],s6(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&j(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const p=C(n,["functionResponse"]);p!=null&&j(t,["functionResponse"],p);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function c6(e,n){const t={},i=C(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>o6(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function u6(e,n){const t={},i=C(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>l6(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function dC(e,n){const t={},i=C(n,["text"]);i!=null&&j(t,["text"],i);const a=C(n,["finished"]);return a!=null&&j(t,["finished"],a),t}function fC(e,n){const t={},i=C(n,["text"]);i!=null&&j(t,["text"],i);const a=C(n,["finished"]);return a!=null&&j(t,["finished"],a),t}function d6(e,n){const t={},i=C(n,["modelTurn"]);i!=null&&j(t,["modelTurn"],c6(e,i));const a=C(n,["turnComplete"]);a!=null&&j(t,["turnComplete"],a);const o=C(n,["interrupted"]);o!=null&&j(t,["interrupted"],o);const l=C(n,["groundingMetadata"]);l!=null&&j(t,["groundingMetadata"],l);const d=C(n,["generationComplete"]);d!=null&&j(t,["generationComplete"],d);const f=C(n,["inputTranscription"]);f!=null&&j(t,["inputTranscription"],dC(e,f));const u=C(n,["outputTranscription"]);return u!=null&&j(t,["outputTranscription"],dC(e,u)),t}function f6(e,n){const t={},i=C(n,["modelTurn"]);i!=null&&j(t,["modelTurn"],u6(e,i));const a=C(n,["turnComplete"]);a!=null&&j(t,["turnComplete"],a);const o=C(n,["interrupted"]);o!=null&&j(t,["interrupted"],o);const l=C(n,["groundingMetadata"]);l!=null&&j(t,["groundingMetadata"],l);const d=C(n,["generationComplete"]);d!=null&&j(t,["generationComplete"],d);const f=C(n,["inputTranscription"]);f!=null&&j(t,["inputTranscription"],fC(e,f));const u=C(n,["outputTranscription"]);return u!=null&&j(t,["outputTranscription"],fC(e,u)),t}function h6(e,n){const t={},i=C(n,["id"]);i!=null&&j(t,["id"],i);const a=C(n,["args"]);a!=null&&j(t,["args"],a);const o=C(n,["name"]);return o!=null&&j(t,["name"],o),t}function p6(e,n){const t={},i=C(n,["args"]);i!=null&&j(t,["args"],i);const a=C(n,["name"]);return a!=null&&j(t,["name"],a),t}function m6(e,n){const t={},i=C(n,["functionCalls"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(o=>h6(e,o))),j(t,["functionCalls"],a)}return t}function g6(e,n){const t={},i=C(n,["functionCalls"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(o=>p6(e,o))),j(t,["functionCalls"],a)}return t}function y6(e,n){const t={},i=C(n,["ids"]);return i!=null&&j(t,["ids"],i),t}function x6(e,n){const t={},i=C(n,["ids"]);return i!=null&&j(t,["ids"],i),t}function gx(e,n){const t={},i=C(n,["modality"]);i!=null&&j(t,["modality"],i);const a=C(n,["tokenCount"]);return a!=null&&j(t,["tokenCount"],a),t}function yx(e,n){const t={},i=C(n,["modality"]);i!=null&&j(t,["modality"],i);const a=C(n,["tokenCount"]);return a!=null&&j(t,["tokenCount"],a),t}function b6(e,n){const t={},i=C(n,["promptTokenCount"]);i!=null&&j(t,["promptTokenCount"],i);const a=C(n,["cachedContentTokenCount"]);a!=null&&j(t,["cachedContentTokenCount"],a);const o=C(n,["responseTokenCount"]);o!=null&&j(t,["responseTokenCount"],o);const l=C(n,["toolUsePromptTokenCount"]);l!=null&&j(t,["toolUsePromptTokenCount"],l);const d=C(n,["thoughtsTokenCount"]);d!=null&&j(t,["thoughtsTokenCount"],d);const f=C(n,["totalTokenCount"]);f!=null&&j(t,["totalTokenCount"],f);const u=C(n,["promptTokensDetails"]);if(u!=null){let v=u;Array.isArray(v)&&(v=v.map(S=>gx(e,S))),j(t,["promptTokensDetails"],v)}const p=C(n,["cacheTokensDetails"]);if(p!=null){let v=p;Array.isArray(v)&&(v=v.map(S=>gx(e,S))),j(t,["cacheTokensDetails"],v)}const g=C(n,["responseTokensDetails"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(S=>gx(e,S))),j(t,["responseTokensDetails"],v)}const b=C(n,["toolUsePromptTokensDetails"]);if(b!=null){let v=b;Array.isArray(v)&&(v=v.map(S=>gx(e,S))),j(t,["toolUsePromptTokensDetails"],v)}return t}function v6(e,n){const t={},i=C(n,["promptTokenCount"]);i!=null&&j(t,["promptTokenCount"],i);const a=C(n,["cachedContentTokenCount"]);a!=null&&j(t,["cachedContentTokenCount"],a);const o=C(n,["candidatesTokenCount"]);o!=null&&j(t,["responseTokenCount"],o);const l=C(n,["toolUsePromptTokenCount"]);l!=null&&j(t,["toolUsePromptTokenCount"],l);const d=C(n,["thoughtsTokenCount"]);d!=null&&j(t,["thoughtsTokenCount"],d);const f=C(n,["totalTokenCount"]);f!=null&&j(t,["totalTokenCount"],f);const u=C(n,["promptTokensDetails"]);if(u!=null){let S=u;Array.isArray(S)&&(S=S.map(k=>yx(e,k))),j(t,["promptTokensDetails"],S)}const p=C(n,["cacheTokensDetails"]);if(p!=null){let S=p;Array.isArray(S)&&(S=S.map(k=>yx(e,k))),j(t,["cacheTokensDetails"],S)}const g=C(n,["candidatesTokensDetails"]);if(g!=null){let S=g;Array.isArray(S)&&(S=S.map(k=>yx(e,k))),j(t,["responseTokensDetails"],S)}const b=C(n,["toolUsePromptTokensDetails"]);if(b!=null){let S=b;Array.isArray(S)&&(S=S.map(k=>yx(e,k))),j(t,["toolUsePromptTokensDetails"],S)}const v=C(n,["trafficType"]);return v!=null&&j(t,["trafficType"],v),t}function w6(e,n){const t={},i=C(n,["timeLeft"]);return i!=null&&j(t,["timeLeft"],i),t}function S6(e,n){const t={},i=C(n,["timeLeft"]);return i!=null&&j(t,["timeLeft"],i),t}function N6(e,n){const t={},i=C(n,["newHandle"]);i!=null&&j(t,["newHandle"],i);const a=C(n,["resumable"]);a!=null&&j(t,["resumable"],a);const o=C(n,["lastConsumedClientMessageIndex"]);return o!=null&&j(t,["lastConsumedClientMessageIndex"],o),t}function C6(e,n){const t={},i=C(n,["newHandle"]);i!=null&&j(t,["newHandle"],i);const a=C(n,["resumable"]);a!=null&&j(t,["resumable"],a);const o=C(n,["lastConsumedClientMessageIndex"]);return o!=null&&j(t,["lastConsumedClientMessageIndex"],o),t}function j6(e,n){const t={};C(n,["setupComplete"])!=null&&j(t,["setupComplete"],i6());const a=C(n,["serverContent"]);a!=null&&j(t,["serverContent"],d6(e,a));const o=C(n,["toolCall"]);o!=null&&j(t,["toolCall"],m6(e,o));const l=C(n,["toolCallCancellation"]);l!=null&&j(t,["toolCallCancellation"],y6(e,l));const d=C(n,["usageMetadata"]);d!=null&&j(t,["usageMetadata"],b6(e,d));const f=C(n,["goAway"]);f!=null&&j(t,["goAway"],w6(e,f));const u=C(n,["sessionResumptionUpdate"]);return u!=null&&j(t,["sessionResumptionUpdate"],N6(e,u)),t}function _6(e,n){const t={};C(n,["setupComplete"])!=null&&j(t,["setupComplete"],r6());const a=C(n,["serverContent"]);a!=null&&j(t,["serverContent"],f6(e,a));const o=C(n,["toolCall"]);o!=null&&j(t,["toolCall"],g6(e,o));const l=C(n,["toolCallCancellation"]);l!=null&&j(t,["toolCallCancellation"],x6(e,l));const d=C(n,["usageMetadata"]);d!=null&&j(t,["usageMetadata"],v6(e,d));const f=C(n,["goAway"]);f!=null&&j(t,["goAway"],S6(e,f));const u=C(n,["sessionResumptionUpdate"]);return u!=null&&j(t,["sessionResumptionUpdate"],C6(e,u)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function k6(e,n){const t={};if(C(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=C(n,["data"]);i!=null&&j(t,["data"],i);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function T6(e,n){const t={};if(C(n,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const i=C(n,["thought"]);i!=null&&j(t,["thought"],i);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],k6(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&j(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&j(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&j(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&j(t,["functionResponse"],u);const p=C(n,["text"]);return p!=null&&j(t,["text"],p),t}function Pb(e,n){const t={},i=C(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>T6(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function E6(e,n){const t={};if(C(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=C(n,["category"]);i!=null&&j(t,["category"],i);const a=C(n,["threshold"]);return a!=null&&j(t,["threshold"],a),t}function A6(){return{}}function P6(e,n){const t={},i=C(n,["mode"]);i!=null&&j(t,["mode"],i);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function D6(e,n){const t={},i=C(n,["dynamicRetrievalConfig"]);return i!=null&&j(t,["dynamicRetrievalConfig"],P6(e,i)),t}function I6(e,n){const t={};if(C(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");C(n,["googleSearch"])!=null&&j(t,["googleSearch"],A6());const a=C(n,["googleSearchRetrieval"]);if(a!=null&&j(t,["googleSearchRetrieval"],D6(e,a)),C(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(C(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=C(n,["codeExecution"]);o!=null&&j(t,["codeExecution"],o);const l=C(n,["functionDeclarations"]);return l!=null&&j(t,["functionDeclarations"],l),t}function R6(e,n){const t={},i=C(n,["mode"]);i!=null&&j(t,["mode"],i);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function M6(e,n){const t={},i=C(n,["functionCallingConfig"]);if(i!=null&&j(t,["functionCallingConfig"],R6(e,i)),C(n,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function O6(e,n){const t={},i=C(n,["voiceName"]);return i!=null&&j(t,["voiceName"],i),t}function L6(e,n){const t={},i=C(n,["prebuiltVoiceConfig"]);return i!=null&&j(t,["prebuiltVoiceConfig"],O6(e,i)),t}function F6(e,n){const t={},i=C(n,["voiceConfig"]);i!=null&&j(t,["voiceConfig"],L6(e,i));const a=C(n,["languageCode"]);return a!=null&&j(t,["languageCode"],a),t}function $6(e,n){const t={},i=C(n,["includeThoughts"]);i!=null&&j(t,["includeThoughts"],i);const a=C(n,["thinkingBudget"]);return a!=null&&j(t,["thinkingBudget"],a),t}function z6(e,n,t){const i={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&j(t,["systemInstruction"],Pb(e,sa(e,a)));const o=C(n,["temperature"]);o!=null&&j(i,["temperature"],o);const l=C(n,["topP"]);l!=null&&j(i,["topP"],l);const d=C(n,["topK"]);d!=null&&j(i,["topK"],d);const f=C(n,["candidateCount"]);f!=null&&j(i,["candidateCount"],f);const u=C(n,["maxOutputTokens"]);u!=null&&j(i,["maxOutputTokens"],u);const p=C(n,["stopSequences"]);p!=null&&j(i,["stopSequences"],p);const g=C(n,["responseLogprobs"]);g!=null&&j(i,["responseLogprobs"],g);const b=C(n,["logprobs"]);b!=null&&j(i,["logprobs"],b);const v=C(n,["presencePenalty"]);v!=null&&j(i,["presencePenalty"],v);const S=C(n,["frequencyPenalty"]);S!=null&&j(i,["frequencyPenalty"],S);const k=C(n,["seed"]);k!=null&&j(i,["seed"],k);const T=C(n,["responseMimeType"]);T!=null&&j(i,["responseMimeType"],T);const P=C(n,["responseSchema"]);if(P!=null&&j(i,["responseSchema"],n2(e,P)),C(n,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(C(n,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const M=C(n,["safetySettings"]);if(t!==void 0&&M!=null){let R=M;Array.isArray(R)&&(R=R.map(B=>E6(e,B))),j(t,["safetySettings"],R)}const I=C(n,["tools"]);if(t!==void 0&&I!=null){let R=Eb(e,I);Array.isArray(R)&&(R=R.map(B=>I6(e,Tb(e,B)))),j(t,["tools"],R)}const U=C(n,["toolConfig"]);if(t!==void 0&&U!=null&&j(t,["toolConfig"],M6(e,U)),C(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const L=C(n,["cachedContent"]);t!==void 0&&L!=null&&j(t,["cachedContent"],hu(e,L));const $=C(n,["responseModalities"]);$!=null&&j(i,["responseModalities"],$);const z=C(n,["mediaResolution"]);z!=null&&j(i,["mediaResolution"],z);const F=C(n,["speechConfig"]);if(F!=null&&j(i,["speechConfig"],F6(e,i2(e,F))),C(n,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Q=C(n,["thinkingConfig"]);return Q!=null&&j(i,["thinkingConfig"],$6(e,Q)),i}function hC(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["contents"]);if(a!=null){let l=fu(e,a);Array.isArray(l)&&(l=l.map(d=>Pb(e,d))),j(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&j(t,["generationConfig"],z6(e,o,t)),t}function U6(e,n,t){const i={},a=C(n,["taskType"]);t!==void 0&&a!=null&&j(t,["requests[]","taskType"],a);const o=C(n,["title"]);t!==void 0&&o!=null&&j(t,["requests[]","title"],o);const l=C(n,["outputDimensionality"]);if(t!==void 0&&l!=null&&j(t,["requests[]","outputDimensionality"],l),C(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(C(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return i}function B6(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["contents"]);a!=null&&j(t,["requests[]","content"],t2(e,a));const o=C(n,["config"]);o!=null&&j(t,["config"],U6(e,o,t));const l=C(n,["model"]);return l!==void 0&&j(t,["requests[]","model"],fi(e,l)),t}function q6(e,n,t){const i={};if(C(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(C(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const a=C(n,["numberOfImages"]);t!==void 0&&a!=null&&j(t,["parameters","sampleCount"],a);const o=C(n,["aspectRatio"]);t!==void 0&&o!=null&&j(t,["parameters","aspectRatio"],o);const l=C(n,["guidanceScale"]);if(t!==void 0&&l!=null&&j(t,["parameters","guidanceScale"],l),C(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const d=C(n,["safetyFilterLevel"]);t!==void 0&&d!=null&&j(t,["parameters","safetySetting"],d);const f=C(n,["personGeneration"]);t!==void 0&&f!=null&&j(t,["parameters","personGeneration"],f);const u=C(n,["includeSafetyAttributes"]);t!==void 0&&u!=null&&j(t,["parameters","includeSafetyAttributes"],u);const p=C(n,["includeRaiReason"]);t!==void 0&&p!=null&&j(t,["parameters","includeRaiReason"],p);const g=C(n,["language"]);t!==void 0&&g!=null&&j(t,["parameters","language"],g);const b=C(n,["outputMimeType"]);t!==void 0&&b!=null&&j(t,["parameters","outputOptions","mimeType"],b);const v=C(n,["outputCompressionQuality"]);if(t!==void 0&&v!=null&&j(t,["parameters","outputOptions","compressionQuality"],v),C(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(C(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return i}function V6(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const o=C(n,["config"]);return o!=null&&j(t,["config"],q6(e,o,t)),t}function H6(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","name"],fi(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function G6(e,n,t){const i={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&j(t,["_query","pageToken"],o);const l=C(n,["filter"]);t!==void 0&&l!=null&&j(t,["_query","filter"],l);const d=C(n,["queryBase"]);return t!==void 0&&d!=null&&j(t,["_url","models_url"],s2(e,d)),i}function Y6(e,n){const t={},i=C(n,["config"]);return i!=null&&j(t,["config"],G6(e,i,t)),t}function W6(e,n,t){const i={},a=C(n,["displayName"]);t!==void 0&&a!=null&&j(t,["displayName"],a);const o=C(n,["description"]);t!==void 0&&o!=null&&j(t,["description"],o);const l=C(n,["defaultCheckpointId"]);return t!==void 0&&l!=null&&j(t,["defaultCheckpointId"],l),i}function Q6(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","name"],fi(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],W6(e,a,t)),t}function J6(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","name"],fi(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function K6(e,n){const t={};if(C(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(C(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(C(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function X6(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["contents"]);if(a!=null){let l=fu(e,a);Array.isArray(l)&&(l=l.map(d=>Pb(e,d))),j(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&j(t,["config"],K6(e,o)),t}function Z6(e,n){const t={};if(C(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const i=C(n,["imageBytes"]);i!=null&&j(t,["bytesBase64Encoded"],pu(e,i));const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function e5(e,n,t){const i={},a=C(n,["numberOfVideos"]);if(t!==void 0&&a!=null&&j(t,["parameters","sampleCount"],a),C(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(C(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=C(n,["durationSeconds"]);if(t!==void 0&&o!=null&&j(t,["parameters","durationSeconds"],o),C(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=C(n,["aspectRatio"]);if(t!==void 0&&l!=null&&j(t,["parameters","aspectRatio"],l),C(n,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const d=C(n,["personGeneration"]);if(t!==void 0&&d!=null&&j(t,["parameters","personGeneration"],d),C(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const f=C(n,["negativePrompt"]);if(t!==void 0&&f!=null&&j(t,["parameters","negativePrompt"],f),C(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return i}function t5(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const o=C(n,["image"]);o!=null&&j(t,["instances[0]","image"],Z6(e,o));const l=C(n,["config"]);return l!=null&&j(t,["config"],e5(e,l,t)),t}function n5(e,n){const t={},i=C(n,["displayName"]);i!=null&&j(t,["displayName"],i);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function i5(e,n){const t={},i=C(n,["videoMetadata"]);i!=null&&j(t,["videoMetadata"],i);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&j(t,["inlineData"],n5(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&j(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const p=C(n,["functionResponse"]);p!=null&&j(t,["functionResponse"],p);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function Bh(e,n){const t={},i=C(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>i5(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function r5(e,n){const t={},i=C(n,["featureSelectionPreference"]);return i!=null&&j(t,["featureSelectionPreference"],i),t}function a5(e,n){const t={},i=C(n,["method"]);i!=null&&j(t,["method"],i);const a=C(n,["category"]);a!=null&&j(t,["category"],a);const o=C(n,["threshold"]);return o!=null&&j(t,["threshold"],o),t}function s5(){return{}}function o5(e,n){const t={},i=C(n,["mode"]);i!=null&&j(t,["mode"],i);const a=C(n,["dynamicThreshold"]);return a!=null&&j(t,["dynamicThreshold"],a),t}function l5(e,n){const t={},i=C(n,["dynamicRetrievalConfig"]);return i!=null&&j(t,["dynamicRetrievalConfig"],o5(e,i)),t}function c5(){return{}}function u5(e,n){const t={},i=C(n,["apiKeyString"]);return i!=null&&j(t,["apiKeyString"],i),t}function d5(e,n){const t={},i=C(n,["apiKeyConfig"]);i!=null&&j(t,["apiKeyConfig"],u5(e,i));const a=C(n,["authType"]);a!=null&&j(t,["authType"],a);const o=C(n,["googleServiceAccountConfig"]);o!=null&&j(t,["googleServiceAccountConfig"],o);const l=C(n,["httpBasicAuthConfig"]);l!=null&&j(t,["httpBasicAuthConfig"],l);const d=C(n,["oauthConfig"]);d!=null&&j(t,["oauthConfig"],d);const f=C(n,["oidcConfig"]);return f!=null&&j(t,["oidcConfig"],f),t}function f5(e,n){const t={},i=C(n,["authConfig"]);return i!=null&&j(t,["authConfig"],d5(e,i)),t}function c2(e,n){const t={},i=C(n,["retrieval"]);i!=null&&j(t,["retrieval"],i),C(n,["googleSearch"])!=null&&j(t,["googleSearch"],s5());const o=C(n,["googleSearchRetrieval"]);o!=null&&j(t,["googleSearchRetrieval"],l5(e,o)),C(n,["enterpriseWebSearch"])!=null&&j(t,["enterpriseWebSearch"],c5());const d=C(n,["googleMaps"]);d!=null&&j(t,["googleMaps"],f5(e,d));const f=C(n,["codeExecution"]);f!=null&&j(t,["codeExecution"],f);const u=C(n,["functionDeclarations"]);return u!=null&&j(t,["functionDeclarations"],u),t}function h5(e,n){const t={},i=C(n,["mode"]);i!=null&&j(t,["mode"],i);const a=C(n,["allowedFunctionNames"]);return a!=null&&j(t,["allowedFunctionNames"],a),t}function p5(e,n){const t={},i=C(n,["latitude"]);i!=null&&j(t,["latitude"],i);const a=C(n,["longitude"]);return a!=null&&j(t,["longitude"],a),t}function m5(e,n){const t={},i=C(n,["latLng"]);return i!=null&&j(t,["latLng"],p5(e,i)),t}function g5(e,n){const t={},i=C(n,["functionCallingConfig"]);i!=null&&j(t,["functionCallingConfig"],h5(e,i));const a=C(n,["retrievalConfig"]);return a!=null&&j(t,["retrievalConfig"],m5(e,a)),t}function y5(e,n){const t={},i=C(n,["voiceName"]);return i!=null&&j(t,["voiceName"],i),t}function x5(e,n){const t={},i=C(n,["prebuiltVoiceConfig"]);return i!=null&&j(t,["prebuiltVoiceConfig"],y5(e,i)),t}function b5(e,n){const t={},i=C(n,["voiceConfig"]);i!=null&&j(t,["voiceConfig"],x5(e,i));const a=C(n,["languageCode"]);return a!=null&&j(t,["languageCode"],a),t}function v5(e,n){const t={},i=C(n,["includeThoughts"]);i!=null&&j(t,["includeThoughts"],i);const a=C(n,["thinkingBudget"]);return a!=null&&j(t,["thinkingBudget"],a),t}function w5(e,n,t){const i={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&j(t,["systemInstruction"],Bh(e,sa(e,a)));const o=C(n,["temperature"]);o!=null&&j(i,["temperature"],o);const l=C(n,["topP"]);l!=null&&j(i,["topP"],l);const d=C(n,["topK"]);d!=null&&j(i,["topK"],d);const f=C(n,["candidateCount"]);f!=null&&j(i,["candidateCount"],f);const u=C(n,["maxOutputTokens"]);u!=null&&j(i,["maxOutputTokens"],u);const p=C(n,["stopSequences"]);p!=null&&j(i,["stopSequences"],p);const g=C(n,["responseLogprobs"]);g!=null&&j(i,["responseLogprobs"],g);const b=C(n,["logprobs"]);b!=null&&j(i,["logprobs"],b);const v=C(n,["presencePenalty"]);v!=null&&j(i,["presencePenalty"],v);const S=C(n,["frequencyPenalty"]);S!=null&&j(i,["frequencyPenalty"],S);const k=C(n,["seed"]);k!=null&&j(i,["seed"],k);const T=C(n,["responseMimeType"]);T!=null&&j(i,["responseMimeType"],T);const P=C(n,["responseSchema"]);P!=null&&j(i,["responseSchema"],n2(e,P));const M=C(n,["routingConfig"]);M!=null&&j(i,["routingConfig"],M);const I=C(n,["modelSelectionConfig"]);I!=null&&j(i,["modelConfig"],r5(e,I));const U=C(n,["safetySettings"]);if(t!==void 0&&U!=null){let ne=U;Array.isArray(ne)&&(ne=ne.map(G=>a5(e,G))),j(t,["safetySettings"],ne)}const L=C(n,["tools"]);if(t!==void 0&&L!=null){let ne=Eb(e,L);Array.isArray(ne)&&(ne=ne.map(G=>c2(e,Tb(e,G)))),j(t,["tools"],ne)}const $=C(n,["toolConfig"]);t!==void 0&&$!=null&&j(t,["toolConfig"],g5(e,$));const z=C(n,["labels"]);t!==void 0&&z!=null&&j(t,["labels"],z);const F=C(n,["cachedContent"]);t!==void 0&&F!=null&&j(t,["cachedContent"],hu(e,F));const Q=C(n,["responseModalities"]);Q!=null&&j(i,["responseModalities"],Q);const R=C(n,["mediaResolution"]);R!=null&&j(i,["mediaResolution"],R);const B=C(n,["speechConfig"]);B!=null&&j(i,["speechConfig"],b5(e,i2(e,B)));const Y=C(n,["audioTimestamp"]);Y!=null&&j(i,["audioTimestamp"],Y);const re=C(n,["thinkingConfig"]);return re!=null&&j(i,["thinkingConfig"],v5(e,re)),i}function pC(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["contents"]);if(a!=null){let l=fu(e,a);Array.isArray(l)&&(l=l.map(d=>Bh(e,d))),j(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&j(t,["generationConfig"],w5(e,o,t)),t}function S5(e,n,t){const i={},a=C(n,["taskType"]);t!==void 0&&a!=null&&j(t,["instances[]","task_type"],a);const o=C(n,["title"]);t!==void 0&&o!=null&&j(t,["instances[]","title"],o);const l=C(n,["outputDimensionality"]);t!==void 0&&l!=null&&j(t,["parameters","outputDimensionality"],l);const d=C(n,["mimeType"]);t!==void 0&&d!=null&&j(t,["instances[]","mimeType"],d);const f=C(n,["autoTruncate"]);return t!==void 0&&f!=null&&j(t,["parameters","autoTruncate"],f),i}function N5(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["contents"]);a!=null&&j(t,["instances[]","content"],t2(e,a));const o=C(n,["config"]);return o!=null&&j(t,["config"],S5(e,o,t)),t}function C5(e,n,t){const i={},a=C(n,["outputGcsUri"]);t!==void 0&&a!=null&&j(t,["parameters","storageUri"],a);const o=C(n,["negativePrompt"]);t!==void 0&&o!=null&&j(t,["parameters","negativePrompt"],o);const l=C(n,["numberOfImages"]);t!==void 0&&l!=null&&j(t,["parameters","sampleCount"],l);const d=C(n,["aspectRatio"]);t!==void 0&&d!=null&&j(t,["parameters","aspectRatio"],d);const f=C(n,["guidanceScale"]);t!==void 0&&f!=null&&j(t,["parameters","guidanceScale"],f);const u=C(n,["seed"]);t!==void 0&&u!=null&&j(t,["parameters","seed"],u);const p=C(n,["safetyFilterLevel"]);t!==void 0&&p!=null&&j(t,["parameters","safetySetting"],p);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&j(t,["parameters","personGeneration"],g);const b=C(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&j(t,["parameters","includeSafetyAttributes"],b);const v=C(n,["includeRaiReason"]);t!==void 0&&v!=null&&j(t,["parameters","includeRaiReason"],v);const S=C(n,["language"]);t!==void 0&&S!=null&&j(t,["parameters","language"],S);const k=C(n,["outputMimeType"]);t!==void 0&&k!=null&&j(t,["parameters","outputOptions","mimeType"],k);const T=C(n,["outputCompressionQuality"]);t!==void 0&&T!=null&&j(t,["parameters","outputOptions","compressionQuality"],T);const P=C(n,["addWatermark"]);t!==void 0&&P!=null&&j(t,["parameters","addWatermark"],P);const M=C(n,["enhancePrompt"]);return t!==void 0&&M!=null&&j(t,["parameters","enhancePrompt"],M),i}function j5(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const o=C(n,["config"]);return o!=null&&j(t,["config"],C5(e,o,t)),t}function bw(e,n){const t={},i=C(n,["gcsUri"]);i!=null&&j(t,["gcsUri"],i);const a=C(n,["imageBytes"]);a!=null&&j(t,["bytesBase64Encoded"],pu(e,a));const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function _5(e,n){const t={},i=C(n,["maskMode"]);i!=null&&j(t,["maskMode"],i);const a=C(n,["segmentationClasses"]);a!=null&&j(t,["maskClasses"],a);const o=C(n,["maskDilation"]);return o!=null&&j(t,["dilation"],o),t}function k5(e,n){const t={},i=C(n,["controlType"]);i!=null&&j(t,["controlType"],i);const a=C(n,["enableControlImageComputation"]);return a!=null&&j(t,["computeControl"],a),t}function T5(e,n){const t={},i=C(n,["styleDescription"]);return i!=null&&j(t,["styleDescription"],i),t}function E5(e,n){const t={},i=C(n,["subjectType"]);i!=null&&j(t,["subjectType"],i);const a=C(n,["subjectDescription"]);return a!=null&&j(t,["subjectDescription"],a),t}function A5(e,n){const t={},i=C(n,["referenceImage"]);i!=null&&j(t,["referenceImage"],bw(e,i));const a=C(n,["referenceId"]);a!=null&&j(t,["referenceId"],a);const o=C(n,["referenceType"]);o!=null&&j(t,["referenceType"],o);const l=C(n,["maskImageConfig"]);l!=null&&j(t,["maskImageConfig"],_5(e,l));const d=C(n,["controlImageConfig"]);d!=null&&j(t,["controlImageConfig"],k5(e,d));const f=C(n,["styleImageConfig"]);f!=null&&j(t,["styleImageConfig"],T5(e,f));const u=C(n,["subjectImageConfig"]);return u!=null&&j(t,["subjectImageConfig"],E5(e,u)),t}function P5(e,n,t){const i={},a=C(n,["outputGcsUri"]);t!==void 0&&a!=null&&j(t,["parameters","storageUri"],a);const o=C(n,["negativePrompt"]);t!==void 0&&o!=null&&j(t,["parameters","negativePrompt"],o);const l=C(n,["numberOfImages"]);t!==void 0&&l!=null&&j(t,["parameters","sampleCount"],l);const d=C(n,["aspectRatio"]);t!==void 0&&d!=null&&j(t,["parameters","aspectRatio"],d);const f=C(n,["guidanceScale"]);t!==void 0&&f!=null&&j(t,["parameters","guidanceScale"],f);const u=C(n,["seed"]);t!==void 0&&u!=null&&j(t,["parameters","seed"],u);const p=C(n,["safetyFilterLevel"]);t!==void 0&&p!=null&&j(t,["parameters","safetySetting"],p);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&j(t,["parameters","personGeneration"],g);const b=C(n,["includeSafetyAttributes"]);t!==void 0&&b!=null&&j(t,["parameters","includeSafetyAttributes"],b);const v=C(n,["includeRaiReason"]);t!==void 0&&v!=null&&j(t,["parameters","includeRaiReason"],v);const S=C(n,["language"]);t!==void 0&&S!=null&&j(t,["parameters","language"],S);const k=C(n,["outputMimeType"]);t!==void 0&&k!=null&&j(t,["parameters","outputOptions","mimeType"],k);const T=C(n,["outputCompressionQuality"]);t!==void 0&&T!=null&&j(t,["parameters","outputOptions","compressionQuality"],T);const P=C(n,["editMode"]);t!==void 0&&P!=null&&j(t,["parameters","editMode"],P);const M=C(n,["baseSteps"]);return t!==void 0&&M!=null&&j(t,["parameters","editConfig","baseSteps"],M),i}function D5(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const o=C(n,["referenceImages"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>A5(e,f))),j(t,["instances[0]","referenceImages"],d)}const l=C(n,["config"]);return l!=null&&j(t,["config"],P5(e,l,t)),t}function I5(e,n,t){const i={},a=C(n,["includeRaiReason"]);t!==void 0&&a!=null&&j(t,["parameters","includeRaiReason"],a);const o=C(n,["outputMimeType"]);t!==void 0&&o!=null&&j(t,["parameters","outputOptions","mimeType"],o);const l=C(n,["outputCompressionQuality"]);t!==void 0&&l!=null&&j(t,["parameters","outputOptions","compressionQuality"],l);const d=C(n,["numberOfImages"]);t!==void 0&&d!=null&&j(t,["parameters","sampleCount"],d);const f=C(n,["mode"]);return t!==void 0&&f!=null&&j(t,["parameters","mode"],f),i}function R5(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["image"]);a!=null&&j(t,["instances[0]","image"],bw(e,a));const o=C(n,["upscaleFactor"]);o!=null&&j(t,["parameters","upscaleConfig","upscaleFactor"],o);const l=C(n,["config"]);return l!=null&&j(t,["config"],I5(e,l,t)),t}function M5(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","name"],fi(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function O5(e,n,t){const i={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&j(t,["_query","pageToken"],o);const l=C(n,["filter"]);t!==void 0&&l!=null&&j(t,["_query","filter"],l);const d=C(n,["queryBase"]);return t!==void 0&&d!=null&&j(t,["_url","models_url"],s2(e,d)),i}function L5(e,n){const t={},i=C(n,["config"]);return i!=null&&j(t,["config"],O5(e,i,t)),t}function F5(e,n,t){const i={},a=C(n,["displayName"]);t!==void 0&&a!=null&&j(t,["displayName"],a);const o=C(n,["description"]);t!==void 0&&o!=null&&j(t,["description"],o);const l=C(n,["defaultCheckpointId"]);return t!==void 0&&l!=null&&j(t,["defaultCheckpointId"],l),i}function $5(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],F5(e,a,t)),t}function z5(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","name"],fi(e,i));const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function U5(e,n,t){const i={},a=C(n,["systemInstruction"]);t!==void 0&&a!=null&&j(t,["systemInstruction"],Bh(e,sa(e,a)));const o=C(n,["tools"]);if(t!==void 0&&o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>c2(e,f))),j(t,["tools"],d)}const l=C(n,["generationConfig"]);return t!==void 0&&l!=null&&j(t,["generationConfig"],l),i}function B5(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["contents"]);if(a!=null){let l=fu(e,a);Array.isArray(l)&&(l=l.map(d=>Bh(e,d))),j(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&j(t,["config"],U5(e,o,t)),t}function q5(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["contents"]);if(a!=null){let l=fu(e,a);Array.isArray(l)&&(l=l.map(d=>Bh(e,d))),j(t,["contents"],l)}const o=C(n,["config"]);return o!=null&&j(t,["config"],o),t}function V5(e,n,t){const i={},a=C(n,["numberOfVideos"]);t!==void 0&&a!=null&&j(t,["parameters","sampleCount"],a);const o=C(n,["outputGcsUri"]);t!==void 0&&o!=null&&j(t,["parameters","storageUri"],o);const l=C(n,["fps"]);t!==void 0&&l!=null&&j(t,["parameters","fps"],l);const d=C(n,["durationSeconds"]);t!==void 0&&d!=null&&j(t,["parameters","durationSeconds"],d);const f=C(n,["seed"]);t!==void 0&&f!=null&&j(t,["parameters","seed"],f);const u=C(n,["aspectRatio"]);t!==void 0&&u!=null&&j(t,["parameters","aspectRatio"],u);const p=C(n,["resolution"]);t!==void 0&&p!=null&&j(t,["parameters","resolution"],p);const g=C(n,["personGeneration"]);t!==void 0&&g!=null&&j(t,["parameters","personGeneration"],g);const b=C(n,["pubsubTopic"]);t!==void 0&&b!=null&&j(t,["parameters","pubsubTopic"],b);const v=C(n,["negativePrompt"]);t!==void 0&&v!=null&&j(t,["parameters","negativePrompt"],v);const S=C(n,["enhancePrompt"]);return t!==void 0&&S!=null&&j(t,["parameters","enhancePrompt"],S),i}function H5(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["_url","model"],fi(e,i));const a=C(n,["prompt"]);a!=null&&j(t,["instances[0]","prompt"],a);const o=C(n,["image"]);o!=null&&j(t,["instances[0]","image"],bw(e,o));const l=C(n,["config"]);return l!=null&&j(t,["config"],V5(e,l,t)),t}function G5(e,n){const t={},i=C(n,["data"]);i!=null&&j(t,["data"],i);const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function Y5(e,n){const t={},i=C(n,["thought"]);i!=null&&j(t,["thought"],i);const a=C(n,["inlineData"]);a!=null&&j(t,["inlineData"],G5(e,a));const o=C(n,["codeExecutionResult"]);o!=null&&j(t,["codeExecutionResult"],o);const l=C(n,["executableCode"]);l!=null&&j(t,["executableCode"],l);const d=C(n,["fileData"]);d!=null&&j(t,["fileData"],d);const f=C(n,["functionCall"]);f!=null&&j(t,["functionCall"],f);const u=C(n,["functionResponse"]);u!=null&&j(t,["functionResponse"],u);const p=C(n,["text"]);return p!=null&&j(t,["text"],p),t}function W5(e,n){const t={},i=C(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>Y5(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function Q5(e,n){const t={},i=C(n,["citationSources"]);return i!=null&&j(t,["citations"],i),t}function J5(e,n){const t={},i=C(n,["content"]);i!=null&&j(t,["content"],W5(e,i));const a=C(n,["citationMetadata"]);a!=null&&j(t,["citationMetadata"],Q5(e,a));const o=C(n,["tokenCount"]);o!=null&&j(t,["tokenCount"],o);const l=C(n,["finishReason"]);l!=null&&j(t,["finishReason"],l);const d=C(n,["avgLogprobs"]);d!=null&&j(t,["avgLogprobs"],d);const f=C(n,["groundingMetadata"]);f!=null&&j(t,["groundingMetadata"],f);const u=C(n,["index"]);u!=null&&j(t,["index"],u);const p=C(n,["logprobsResult"]);p!=null&&j(t,["logprobsResult"],p);const g=C(n,["safetyRatings"]);return g!=null&&j(t,["safetyRatings"],g),t}function mC(e,n){const t={},i=C(n,["candidates"]);if(i!=null){let d=i;Array.isArray(d)&&(d=d.map(f=>J5(e,f))),j(t,["candidates"],d)}const a=C(n,["modelVersion"]);a!=null&&j(t,["modelVersion"],a);const o=C(n,["promptFeedback"]);o!=null&&j(t,["promptFeedback"],o);const l=C(n,["usageMetadata"]);return l!=null&&j(t,["usageMetadata"],l),t}function K5(e,n){const t={},i=C(n,["values"]);return i!=null&&j(t,["values"],i),t}function X5(){return{}}function Z5(e,n){const t={},i=C(n,["embeddings"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>K5(e,l))),j(t,["embeddings"],o)}return C(n,["metadata"])!=null&&j(t,["metadata"],X5()),t}function e$(e,n){const t={},i=C(n,["bytesBase64Encoded"]);i!=null&&j(t,["imageBytes"],pu(e,i));const a=C(n,["mimeType"]);return a!=null&&j(t,["mimeType"],a),t}function u2(e,n){const t={},i=C(n,["safetyAttributes","categories"]);i!=null&&j(t,["categories"],i);const a=C(n,["safetyAttributes","scores"]);a!=null&&j(t,["scores"],a);const o=C(n,["contentType"]);return o!=null&&j(t,["contentType"],o),t}function t$(e,n){const t={},i=C(n,["_self"]);i!=null&&j(t,["image"],e$(e,i));const a=C(n,["raiFilteredReason"]);a!=null&&j(t,["raiFilteredReason"],a);const o=C(n,["_self"]);return o!=null&&j(t,["safetyAttributes"],u2(e,o)),t}function n$(e,n){const t={},i=C(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>t$(e,l))),j(t,["generatedImages"],o)}const a=C(n,["positivePromptSafetyAttributes"]);return a!=null&&j(t,["positivePromptSafetyAttributes"],u2(e,a)),t}function i$(e,n){const t={},i=C(n,["baseModel"]);i!=null&&j(t,["baseModel"],i);const a=C(n,["createTime"]);a!=null&&j(t,["createTime"],a);const o=C(n,["updateTime"]);return o!=null&&j(t,["updateTime"],o),t}function h1(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const o=C(n,["description"]);o!=null&&j(t,["description"],o);const l=C(n,["version"]);l!=null&&j(t,["version"],l);const d=C(n,["_self"]);d!=null&&j(t,["tunedModelInfo"],i$(e,d));const f=C(n,["inputTokenLimit"]);f!=null&&j(t,["inputTokenLimit"],f);const u=C(n,["outputTokenLimit"]);u!=null&&j(t,["outputTokenLimit"],u);const p=C(n,["supportedGenerationMethods"]);return p!=null&&j(t,["supportedActions"],p),t}function r$(e,n){const t={},i=C(n,["nextPageToken"]);i!=null&&j(t,["nextPageToken"],i);const a=C(n,["_self"]);if(a!=null){let o=o2(e,a);Array.isArray(o)&&(o=o.map(l=>h1(e,l))),j(t,["models"],o)}return t}function a$(){return{}}function s$(e,n){const t={},i=C(n,["totalTokens"]);i!=null&&j(t,["totalTokens"],i);const a=C(n,["cachedContentTokenCount"]);return a!=null&&j(t,["cachedContentTokenCount"],a),t}function o$(e,n){const t={},i=C(n,["video","uri"]);i!=null&&j(t,["uri"],i);const a=C(n,["video","encodedVideo"]);a!=null&&j(t,["videoBytes"],pu(e,a));const o=C(n,["encoding"]);return o!=null&&j(t,["mimeType"],o),t}function l$(e,n){const t={},i=C(n,["_self"]);return i!=null&&j(t,["video"],o$(e,i)),t}function c$(e,n){const t={},i=C(n,["generatedSamples"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(d=>l$(e,d))),j(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&j(t,["raiMediaFilteredReasons"],o),t}function u$(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const o=C(n,["done"]);o!=null&&j(t,["done"],o);const l=C(n,["error"]);l!=null&&j(t,["error"],l);const d=C(n,["response","generateVideoResponse"]);return d!=null&&j(t,["response"],c$(e,d)),t}function d$(e,n){const t={},i=C(n,["displayName"]);i!=null&&j(t,["displayName"],i);const a=C(n,["data"]);a!=null&&j(t,["data"],a);const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function f$(e,n){const t={},i=C(n,["videoMetadata"]);i!=null&&j(t,["videoMetadata"],i);const a=C(n,["thought"]);a!=null&&j(t,["thought"],a);const o=C(n,["inlineData"]);o!=null&&j(t,["inlineData"],d$(e,o));const l=C(n,["codeExecutionResult"]);l!=null&&j(t,["codeExecutionResult"],l);const d=C(n,["executableCode"]);d!=null&&j(t,["executableCode"],d);const f=C(n,["fileData"]);f!=null&&j(t,["fileData"],f);const u=C(n,["functionCall"]);u!=null&&j(t,["functionCall"],u);const p=C(n,["functionResponse"]);p!=null&&j(t,["functionResponse"],p);const g=C(n,["text"]);return g!=null&&j(t,["text"],g),t}function h$(e,n){const t={},i=C(n,["parts"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>f$(e,l))),j(t,["parts"],o)}const a=C(n,["role"]);return a!=null&&j(t,["role"],a),t}function p$(e,n){const t={},i=C(n,["citations"]);return i!=null&&j(t,["citations"],i),t}function m$(e,n){const t={},i=C(n,["content"]);i!=null&&j(t,["content"],h$(e,i));const a=C(n,["citationMetadata"]);a!=null&&j(t,["citationMetadata"],p$(e,a));const o=C(n,["finishMessage"]);o!=null&&j(t,["finishMessage"],o);const l=C(n,["finishReason"]);l!=null&&j(t,["finishReason"],l);const d=C(n,["avgLogprobs"]);d!=null&&j(t,["avgLogprobs"],d);const f=C(n,["groundingMetadata"]);f!=null&&j(t,["groundingMetadata"],f);const u=C(n,["index"]);u!=null&&j(t,["index"],u);const p=C(n,["logprobsResult"]);p!=null&&j(t,["logprobsResult"],p);const g=C(n,["safetyRatings"]);return g!=null&&j(t,["safetyRatings"],g),t}function gC(e,n){const t={},i=C(n,["candidates"]);if(i!=null){let u=i;Array.isArray(u)&&(u=u.map(p=>m$(e,p))),j(t,["candidates"],u)}const a=C(n,["createTime"]);a!=null&&j(t,["createTime"],a);const o=C(n,["responseId"]);o!=null&&j(t,["responseId"],o);const l=C(n,["modelVersion"]);l!=null&&j(t,["modelVersion"],l);const d=C(n,["promptFeedback"]);d!=null&&j(t,["promptFeedback"],d);const f=C(n,["usageMetadata"]);return f!=null&&j(t,["usageMetadata"],f),t}function g$(e,n){const t={},i=C(n,["truncated"]);i!=null&&j(t,["truncated"],i);const a=C(n,["token_count"]);return a!=null&&j(t,["tokenCount"],a),t}function y$(e,n){const t={},i=C(n,["values"]);i!=null&&j(t,["values"],i);const a=C(n,["statistics"]);return a!=null&&j(t,["statistics"],g$(e,a)),t}function x$(e,n){const t={},i=C(n,["billableCharacterCount"]);return i!=null&&j(t,["billableCharacterCount"],i),t}function b$(e,n){const t={},i=C(n,["predictions[]","embeddings"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>y$(e,l))),j(t,["embeddings"],o)}const a=C(n,["metadata"]);return a!=null&&j(t,["metadata"],x$(e,a)),t}function v$(e,n){const t={},i=C(n,["gcsUri"]);i!=null&&j(t,["gcsUri"],i);const a=C(n,["bytesBase64Encoded"]);a!=null&&j(t,["imageBytes"],pu(e,a));const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function d2(e,n){const t={},i=C(n,["safetyAttributes","categories"]);i!=null&&j(t,["categories"],i);const a=C(n,["safetyAttributes","scores"]);a!=null&&j(t,["scores"],a);const o=C(n,["contentType"]);return o!=null&&j(t,["contentType"],o),t}function vw(e,n){const t={},i=C(n,["_self"]);i!=null&&j(t,["image"],v$(e,i));const a=C(n,["raiFilteredReason"]);a!=null&&j(t,["raiFilteredReason"],a);const o=C(n,["_self"]);o!=null&&j(t,["safetyAttributes"],d2(e,o));const l=C(n,["prompt"]);return l!=null&&j(t,["enhancedPrompt"],l),t}function w$(e,n){const t={},i=C(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>vw(e,l))),j(t,["generatedImages"],o)}const a=C(n,["positivePromptSafetyAttributes"]);return a!=null&&j(t,["positivePromptSafetyAttributes"],d2(e,a)),t}function S$(e,n){const t={},i=C(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(o=>vw(e,o))),j(t,["generatedImages"],a)}return t}function N$(e,n){const t={},i=C(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(o=>vw(e,o))),j(t,["generatedImages"],a)}return t}function C$(e,n){const t={},i=C(n,["endpoint"]);i!=null&&j(t,["name"],i);const a=C(n,["deployedModelId"]);return a!=null&&j(t,["deployedModelId"],a),t}function j$(e,n){const t={},i=C(n,["labels","google-vertex-llm-tuning-base-model-id"]);i!=null&&j(t,["baseModel"],i);const a=C(n,["createTime"]);a!=null&&j(t,["createTime"],a);const o=C(n,["updateTime"]);return o!=null&&j(t,["updateTime"],o),t}function _$(e,n){const t={},i=C(n,["checkpointId"]);i!=null&&j(t,["checkpointId"],i);const a=C(n,["epoch"]);a!=null&&j(t,["epoch"],a);const o=C(n,["step"]);return o!=null&&j(t,["step"],o),t}function p1(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["displayName"]);a!=null&&j(t,["displayName"],a);const o=C(n,["description"]);o!=null&&j(t,["description"],o);const l=C(n,["versionId"]);l!=null&&j(t,["version"],l);const d=C(n,["deployedModels"]);if(d!=null){let b=d;Array.isArray(b)&&(b=b.map(v=>C$(e,v))),j(t,["endpoints"],b)}const f=C(n,["labels"]);f!=null&&j(t,["labels"],f);const u=C(n,["_self"]);u!=null&&j(t,["tunedModelInfo"],j$(e,u));const p=C(n,["defaultCheckpointId"]);p!=null&&j(t,["defaultCheckpointId"],p);const g=C(n,["checkpoints"]);if(g!=null){let b=g;Array.isArray(b)&&(b=b.map(v=>_$(e,v))),j(t,["checkpoints"],b)}return t}function k$(e,n){const t={},i=C(n,["nextPageToken"]);i!=null&&j(t,["nextPageToken"],i);const a=C(n,["_self"]);if(a!=null){let o=o2(e,a);Array.isArray(o)&&(o=o.map(l=>p1(e,l))),j(t,["models"],o)}return t}function T$(){return{}}function E$(e,n){const t={},i=C(n,["totalTokens"]);return i!=null&&j(t,["totalTokens"],i),t}function A$(e,n){const t={},i=C(n,["tokensInfo"]);return i!=null&&j(t,["tokensInfo"],i),t}function P$(e,n){const t={},i=C(n,["gcsUri"]);i!=null&&j(t,["uri"],i);const a=C(n,["bytesBase64Encoded"]);a!=null&&j(t,["videoBytes"],pu(e,a));const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function D$(e,n){const t={},i=C(n,["_self"]);return i!=null&&j(t,["video"],P$(e,i)),t}function I$(e,n){const t={},i=C(n,["videos"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(d=>D$(e,d))),j(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&j(t,["raiMediaFilteredReasons"],o),t}function R$(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const o=C(n,["done"]);o!=null&&j(t,["done"],o);const l=C(n,["error"]);l!=null&&j(t,["error"],l);const d=C(n,["response"]);return d!=null&&j(t,["response"],I$(e,d)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const M$="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function O$(e,n,t){const i=new eF;let a;if(t.data instanceof Blob?a=JSON.parse(await t.data.text()):a=JSON.parse(t.data),e.isVertexAI()){const o=_6(e,a);Object.assign(i,o)}else{const o=j6(e,a);Object.assign(i,o)}n(i)}class L${constructor(n,t,i){this.apiClient=n,this.auth=t,this.webSocketFactory=i}async connect(n){var t,i,a,o;const l=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let f;const u=U$(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())f=`${l}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(u);else{const U=this.apiClient.getApiKey();f=`${l}/ws/google.ai.generativelanguage.${d}.GenerativeService.BidiGenerateContent?key=${U}`}let p=()=>{};const g=new Promise(U=>{p=U}),b=n.callbacks,v=function(){var U;(U=b==null?void 0:b.onopen)===null||U===void 0||U.call(b),p({})},S=this.apiClient,k={onopen:v,onmessage:U=>{O$(S,b.onmessage,U)},onerror:(t=b==null?void 0:b.onerror)!==null&&t!==void 0?t:function(U){},onclose:(i=b==null?void 0:b.onclose)!==null&&i!==void 0?i:function(U){}},T=this.webSocketFactory.create(f,z$(u),k);T.connect(),await g;let P=fi(this.apiClient,n.model);if(this.apiClient.isVertexAI()&&P.startsWith("publishers/")){const U=this.apiClient.getProject(),L=this.apiClient.getLocation();P=`projects/${U}/locations/${L}/`+P}let M={};this.apiClient.isVertexAI()&&((a=n.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(n.config===void 0?n.config={responseModalities:[uu.AUDIO]}:n.config.responseModalities=[uu.AUDIO]),!((o=n.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const I={model:P,config:n.config,callbacks:n.callbacks};return this.apiClient.isVertexAI()?M=JF(this.apiClient,I):M=QF(this.apiClient,I),delete M.config,T.send(JSON.stringify(M)),new $$(T,this.apiClient)}}const F$={turnComplete:!0};class $${constructor(n,t){this.conn=n,this.apiClient=t}tLiveClientContent(n,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=fu(n,t.turns),n.isVertexAI()?i=i.map(a=>Bh(n,a)):i=i.map(a=>Pb(n,a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(n,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const o of i){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!n.isVertexAI()&&!("id"in o))throw new Error(M$)}return{toolResponse:{functionResponses:i}}}sendClientContent(n){n=Object.assign(Object.assign({},F$),n);const t=this.tLiveClientContent(this.apiClient,n);this.conn.send(JSON.stringify(t))}sendRealtimeInput(n){let t={};this.apiClient.isVertexAI()?t={realtimeInput:n6(this.apiClient,n)}:t={realtimeInput:t6(this.apiClient,n)},this.conn.send(JSON.stringify(t))}sendToolResponse(n){if(n.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,n);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function z$(e){const n={};return e.forEach((t,i)=>{n[i]=t}),n}function U$(e){const n=new Headers;for(const[t,i]of Object.entries(e))n.append(t,i);return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class B$ extends ag{constructor(n){super(),this.apiClient=n,this.generateContent=async t=>await this.generateContentInternal(t),this.generateContentStream=async t=>await this.generateContentStreamInternal(t),this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var a;let o;const l=[];if(i!=null&&i.generatedImages)for(const f of i.generatedImages)f&&(f!=null&&f.safetyAttributes)&&((a=f==null?void 0:f.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?o=f==null?void 0:f.safetyAttributes:l.push(f);let d;return o?d={generatedImages:l,positivePromptSafetyAttributes:o}:d={generatedImages:l},d}),this.list=async t=>{var i;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((i=l.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Ab(Dh.PAGED_ITEM_MODELS,d=>this.listInternal(d),await this.listInternal(l),l)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const a={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(a)}}async generateContentInternal(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=pC(this.apiClient,n);return d=$t("{model}:generateContent",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>{const g=gC(this.apiClient,p),b=new mx;return Object.assign(b,g),b})}else{const u=hC(this.apiClient,n);return d=$t("{model}:generateContent",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=mC(this.apiClient,p),b=new mx;return Object.assign(b,g),b})}}async generateContentStreamInternal(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=pC(this.apiClient,n);d=$t("{model}:streamGenerateContent?alt=sse",u._url),f=u._query,delete u.config,delete u._url,delete u._query;const p=this.apiClient;return l=p.requestStream({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}),l.then(function(g){return ob(this,arguments,function*(){var b,v,S,k;try{for(var T=!0,P=d1(g),M;M=yield Sr(P.next()),b=M.done,!b;T=!0){k=M.value,T=!1;const U=gC(p,yield Sr(k.json())),L=new mx;Object.assign(L,U),yield yield Sr(L)}}catch(I){v={error:I}}finally{try{!T&&!b&&(S=P.return)&&(yield Sr(S.call(P)))}finally{if(v)throw v.error}}})})}else{const u=hC(this.apiClient,n);d=$t("{model}:streamGenerateContent?alt=sse",u._url),f=u._query,delete u.config,delete u._url,delete u._query;const p=this.apiClient;return l=p.requestStream({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}),l.then(function(g){return ob(this,arguments,function*(){var b,v,S,k;try{for(var T=!0,P=d1(g),M;M=yield Sr(P.next()),b=M.done,!b;T=!0){k=M.value,T=!1;const U=mC(p,yield Sr(k.json())),L=new mx;Object.assign(L,U),yield yield Sr(L)}}catch(I){v={error:I}}finally{try{!T&&!b&&(S=P.return)&&(yield Sr(S.call(P)))}finally{if(v)throw v.error}}})})}}async embedContent(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=N5(this.apiClient,n);return d=$t("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>{const g=b$(this.apiClient,p),b=new eC;return Object.assign(b,g),b})}else{const u=B6(this.apiClient,n);return d=$t("{model}:batchEmbedContents",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=Z5(this.apiClient,p),b=new eC;return Object.assign(b,g),b})}}async generateImagesInternal(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=j5(this.apiClient,n);return d=$t("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>{const g=w$(this.apiClient,p),b=new tC;return Object.assign(b,g),b})}else{const u=V6(this.apiClient,n);return d=$t("{model}:predict",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=n$(this.apiClient,p),b=new tC;return Object.assign(b,g),b})}}async editImageInternal(n){var t,i;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=D5(this.apiClient,n);return o=$t("{model}:predict",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),a.then(f=>{const u=S$(this.apiClient,f),p=new W3;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(n){var t,i;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=R5(this.apiClient,n);return o=$t("{model}:predict",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),a.then(f=>{const u=N$(this.apiClient,f),p=new Q3;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async get(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=M5(this.apiClient,n);return d=$t("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>p1(this.apiClient,p))}else{const u=H6(this.apiClient,n);return d=$t("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>h1(this.apiClient,p))}}async listInternal(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=L5(this.apiClient,n);return d=$t("{models_url}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>{const g=k$(this.apiClient,p),b=new nC;return Object.assign(b,g),b})}else{const u=Y6(this.apiClient,n);return d=$t("{models_url}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=r$(this.apiClient,p),b=new nC;return Object.assign(b,g),b})}}async update(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=$5(this.apiClient,n);return d=$t("{model}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>p1(this.apiClient,p))}else{const u=Q6(this.apiClient,n);return d=$t("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>h1(this.apiClient,p))}}async delete(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=z5(this.apiClient,n);return d=$t("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(()=>{const p=T$(),g=new iC;return Object.assign(g,p),g})}else{const u=J6(this.apiClient,n);return d=$t("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(()=>{const p=a$(),g=new iC;return Object.assign(g,p),g})}}async countTokens(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=B5(this.apiClient,n);return d=$t("{model}:countTokens",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>{const g=E$(this.apiClient,p),b=new rC;return Object.assign(b,g),b})}else{const u=X6(this.apiClient,n);return d=$t("{model}:countTokens",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=s$(this.apiClient,p),b=new rC;return Object.assign(b,g),b})}}async computeTokens(n){var t,i;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=q5(this.apiClient,n);return o=$t("{model}:computeTokens",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),a.then(f=>{const u=A$(this.apiClient,f),p=new J3;return Object.assign(p,u),p})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=H5(this.apiClient,n);return d=$t("{model}:predictLongRunning",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>R$(this.apiClient,p))}else{const u=t5(this.apiClient,n);return d=$t("{model}:predictLongRunning",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>u$(this.apiClient,p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function q$(e,n){const t={},i=C(n,["operationName"]);i!=null&&j(t,["_url","operationName"],i);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function V$(e,n){const t={},i=C(n,["operationName"]);i!=null&&j(t,["_url","operationName"],i);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function H$(e,n){const t={},i=C(n,["operationName"]);i!=null&&j(t,["operationName"],i);const a=C(n,["resourceName"]);a!=null&&j(t,["_url","resourceName"],a);const o=C(n,["config"]);return o!=null&&j(t,["config"],o),t}function G$(e,n){const t={},i=C(n,["video","uri"]);i!=null&&j(t,["uri"],i);const a=C(n,["video","encodedVideo"]);a!=null&&j(t,["videoBytes"],pu(e,a));const o=C(n,["encoding"]);return o!=null&&j(t,["mimeType"],o),t}function Y$(e,n){const t={},i=C(n,["_self"]);return i!=null&&j(t,["video"],G$(e,i)),t}function W$(e,n){const t={},i=C(n,["generatedSamples"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(d=>Y$(e,d))),j(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&j(t,["raiMediaFilteredReasons"],o),t}function Q$(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const o=C(n,["done"]);o!=null&&j(t,["done"],o);const l=C(n,["error"]);l!=null&&j(t,["error"],l);const d=C(n,["response","generateVideoResponse"]);return d!=null&&j(t,["response"],W$(e,d)),t}function J$(e,n){const t={},i=C(n,["gcsUri"]);i!=null&&j(t,["uri"],i);const a=C(n,["bytesBase64Encoded"]);a!=null&&j(t,["videoBytes"],pu(e,a));const o=C(n,["mimeType"]);return o!=null&&j(t,["mimeType"],o),t}function K$(e,n){const t={},i=C(n,["_self"]);return i!=null&&j(t,["video"],J$(e,i)),t}function X$(e,n){const t={},i=C(n,["videos"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(d=>K$(e,d))),j(t,["generatedVideos"],l)}const a=C(n,["raiMediaFilteredCount"]);a!=null&&j(t,["raiMediaFilteredCount"],a);const o=C(n,["raiMediaFilteredReasons"]);return o!=null&&j(t,["raiMediaFilteredReasons"],o),t}function yC(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const o=C(n,["done"]);o!=null&&j(t,["done"],o);const l=C(n,["error"]);l!=null&&j(t,["error"],l);const d=C(n,["response"]);return d!=null&&j(t,["response"],X$(e,d)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Z$ extends ag{constructor(n){super(),this.apiClient=n}async getVideosOperation(n){const t=n.operation,i=n.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=t.name.split("/operations/")[0];let o;return i&&"httpOptions"in i&&(o=i.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:a,config:{httpOptions:o}})}else return this.getVideosOperationInternal({operationName:t.name,config:i})}async getVideosOperationInternal(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=V$(this.apiClient,n);return d=$t("{operationName}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>yC(this.apiClient,p))}else{const u=q$(this.apiClient,n);return d=$t("{operationName}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>Q$(this.apiClient,p))}}async fetchPredictVideosOperationInternal(n){var t,i;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=H$(this.apiClient,n);return o=$t("{resourceName}:fetchPredictOperation",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),a.then(f=>yC(this.apiClient,f))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ez="Content-Type",tz="X-Server-Timeout",nz="User-Agent",iz="x-goog-api-client",rz="0.14.1",az=`google-genai-sdk/${rz}`,sz="v1beta1",oz="v1beta",xC=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class f2 extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ClientError"}}class m1 extends Error{constructor(n,t){t?super(n,{cause:t}):super(n,{cause:new Error().stack}),this.message=n,this.name="ServerError"}}class lz{constructor(n){var t,i;this.clientOptions=Object.assign(Object.assign({},n),{project:n.project,location:n.location,apiKey:n.apiKey,vertexai:n.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:sz,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:oz,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,n.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,n.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var n;return(n=this.clientOptions.vertexai)!==null&&n!==void 0?n:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(n){if(!n||n.baseUrl===void 0||n.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[n.baseUrl.endsWith("/")?n.baseUrl.slice(0,-1):n.baseUrl];return n.apiVersion&&n.apiVersion!==""&&i.push(n.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const n=this.getBaseUrl(),t=new URL(n);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(n){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=n;else throw new Error("HTTP options are not correctly set.")}constructUrl(n,t,i){const a=[this.getRequestUrlInternal(t)];return i&&a.push(this.getBaseResourcePath()),n!==""&&a.push(n),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(n){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||n.path.startsWith("projects/")||n.httpMethod==="GET"&&n.path.startsWith("publishers/google/models"))}async request(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const i=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,i);if(n.queryParams)for(const[l,d]of Object.entries(n.queryParams))a.searchParams.append(l,String(d));let o={};if(n.httpMethod==="GET"){if(n.body&&n.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=n.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,n.abortSignal),this.unaryApiCall(a,o,n.httpMethod)}patchHttpOptions(n,t){const i=JSON.parse(JSON.stringify(n));for(const[a,o]of Object.entries(t))typeof o=="object"?i[a]=Object.assign(Object.assign({},i[a]),o):o!==void 0&&(i[a]=o);return i}async requestStream(n){let t=this.clientOptions.httpOptions;n.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,n.httpOptions));const i=this.shouldPrependVertexProjectPath(n),a=this.constructUrl(n.path,t,i);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let o={};return o.body=n.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,n.abortSignal),this.streamApiCall(a,o,n.httpMethod)}async includeExtraHttpOptionsToRequestInit(n,t,i){if(t&&t.timeout||i){const a=new AbortController,o=a.signal;t.timeout&&(t==null?void 0:t.timeout)>0&&setTimeout(()=>a.abort(),t.timeout),i&&i.addEventListener("abort",()=>{a.abort()}),n.signal=o}return n.headers=await this.getHeadersInternal(t),n}async unaryApiCall(n,t,i){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:i})).then(async a=>(await bC(a),new u1(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(n,t,i){return this.apiCall(n.toString(),Object.assign(Object.assign({},t),{method:i})).then(async a=>(await bC(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(n){var t;return ob(this,arguments,function*(){const a=(t=n==null?void 0:n.body)===null||t===void 0?void 0:t.getReader(),o=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let l="";for(;;){const{done:d,value:f}=yield Sr(a.read());if(d){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=o.decode(f);try{const g=JSON.parse(u);if("error"in g){const b=JSON.parse(JSON.stringify(g.error)),v=b.status,S=b.code,k=`got status: ${v}. ${JSON.stringify(g)}`;if(S>=400&&S<500)throw new f2(k);if(S>=500&&S<600)throw new m1(k)}}catch(g){const b=g;if(b.name==="ClientError"||b.name==="ServerError")throw g}l+=u;let p=l.match(xC);for(;p;){const g=p[1];try{const b=new Response(g,{headers:n==null?void 0:n.headers,status:n==null?void 0:n.status,statusText:n==null?void 0:n.statusText});yield yield Sr(new u1(b)),l=l.slice(p[0].length),p=l.match(xC)}catch(b){throw new Error(`exception parsing stream chunk ${g}. ${b}`)}}}}finally{a.releaseLock()}})}async apiCall(n,t){return fetch(n,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const n={},t=az+" "+this.clientOptions.userAgentExtra;return n[nz]=t,n[iz]=t,n[ez]="application/json",n}async getHeadersInternal(n){const t=new Headers;if(n&&n.headers){for(const[i,a]of Object.entries(n.headers))t.append(i,a);n.timeout&&n.timeout>0&&t.append(tz,String(Math.ceil(n.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(n,t){var i;const a={};t!=null&&(a.mimeType=t.mimeType,a.name=t.name,a.displayName=t.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const o=this.clientOptions.uploader,l=await o.stat(n);a.sizeBytes=String(l.size);const d=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:l.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=d;const f=await this.fetchUploadUrl(a,t);return o.upload(n,f,this)}async downloadFile(n){await this.clientOptions.downloader.download(n,this)}async fetchUploadUrl(n,t){var i;let a={};t!=null&&t.httpOptions?a=t.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${n.mimeType}`}};const o={file:n},l=await this.request({path:$t("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:a});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(i=l==null?void 0:l.headers)===null||i===void 0?void 0:i["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function bC(e){var n;if(e===void 0)throw new m1("response is undefined");if(!e.ok){const t=e.status,i=e.statusText;let a;!((n=e.headers.get("content-type"))===null||n===void 0)&&n.includes("application/json")?a=await e.json():a={error:{message:await e.text(),code:e.status,status:e.statusText}};const o=`got status: ${t} ${i}. ${JSON.stringify(a)}`;throw t>=400&&t<500?new f2(o):t>=500&&t<600?new m1(o):new Error(o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cz(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["_url","name"],i);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function uz(e,n,t){const i={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&j(t,["_query","pageToken"],o);const l=C(n,["filter"]);return t!==void 0&&l!=null&&j(t,["_query","filter"],l),i}function dz(e,n){const t={},i=C(n,["config"]);return i!=null&&j(t,["config"],uz(e,i,t)),t}function fz(e,n){const t={},i=C(n,["textInput"]);i!=null&&j(t,["textInput"],i);const a=C(n,["output"]);return a!=null&&j(t,["output"],a),t}function hz(e,n){const t={};if(C(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const i=C(n,["examples"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(o=>fz(e,o))),j(t,["examples","examples"],a)}return t}function pz(e,n,t){const i={};if(C(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const a=C(n,["tunedModelDisplayName"]);if(t!==void 0&&a!=null&&j(t,["displayName"],a),C(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=C(n,["epochCount"]);t!==void 0&&o!=null&&j(t,["tuningTask","hyperparameters","epochCount"],o);const l=C(n,["learningRateMultiplier"]);if(l!=null&&j(i,["tuningTask","hyperparameters","learningRateMultiplier"],l),C(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(C(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const d=C(n,["batchSize"]);t!==void 0&&d!=null&&j(t,["tuningTask","hyperparameters","batchSize"],d);const f=C(n,["learningRate"]);return t!==void 0&&f!=null&&j(t,["tuningTask","hyperparameters","learningRate"],f),i}function mz(e,n){const t={},i=C(n,["baseModel"]);i!=null&&j(t,["baseModel"],i);const a=C(n,["trainingDataset"]);a!=null&&j(t,["tuningTask","trainingData"],hz(e,a));const o=C(n,["config"]);return o!=null&&j(t,["config"],pz(e,o,t)),t}function gz(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["_url","name"],i);const a=C(n,["config"]);return a!=null&&j(t,["config"],a),t}function yz(e,n,t){const i={},a=C(n,["pageSize"]);t!==void 0&&a!=null&&j(t,["_query","pageSize"],a);const o=C(n,["pageToken"]);t!==void 0&&o!=null&&j(t,["_query","pageToken"],o);const l=C(n,["filter"]);return t!==void 0&&l!=null&&j(t,["_query","filter"],l),i}function xz(e,n){const t={},i=C(n,["config"]);return i!=null&&j(t,["config"],yz(e,i,t)),t}function bz(e,n,t){const i={},a=C(n,["gcsUri"]);if(t!==void 0&&a!=null&&j(t,["supervisedTuningSpec","trainingDatasetUri"],a),C(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function vz(e,n){const t={},i=C(n,["gcsUri"]);return i!=null&&j(t,["validationDatasetUri"],i),t}function wz(e,n,t){const i={},a=C(n,["validationDataset"]);t!==void 0&&a!=null&&j(t,["supervisedTuningSpec"],vz(e,a));const o=C(n,["tunedModelDisplayName"]);t!==void 0&&o!=null&&j(t,["tunedModelDisplayName"],o);const l=C(n,["description"]);t!==void 0&&l!=null&&j(t,["description"],l);const d=C(n,["epochCount"]);t!==void 0&&d!=null&&j(t,["supervisedTuningSpec","hyperParameters","epochCount"],d);const f=C(n,["learningRateMultiplier"]);t!==void 0&&f!=null&&j(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],f);const u=C(n,["exportLastCheckpointOnly"]);t!==void 0&&u!=null&&j(t,["supervisedTuningSpec","exportLastCheckpointOnly"],u);const p=C(n,["adapterSize"]);if(t!==void 0&&p!=null&&j(t,["supervisedTuningSpec","hyperParameters","adapterSize"],p),C(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(C(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return i}function Sz(e,n){const t={},i=C(n,["baseModel"]);i!=null&&j(t,["baseModel"],i);const a=C(n,["trainingDataset"]);a!=null&&j(t,["supervisedTuningSpec","trainingDatasetUri"],bz(e,a,t));const o=C(n,["config"]);return o!=null&&j(t,["config"],wz(e,o,t)),t}function Nz(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["model"],i);const a=C(n,["name"]);return a!=null&&j(t,["endpoint"],a),t}function h2(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["state"]);a!=null&&j(t,["state"],r2(e,a));const o=C(n,["createTime"]);o!=null&&j(t,["createTime"],o);const l=C(n,["tuningTask","startTime"]);l!=null&&j(t,["startTime"],l);const d=C(n,["tuningTask","completeTime"]);d!=null&&j(t,["endTime"],d);const f=C(n,["updateTime"]);f!=null&&j(t,["updateTime"],f);const u=C(n,["description"]);u!=null&&j(t,["description"],u);const p=C(n,["baseModel"]);p!=null&&j(t,["baseModel"],p);const g=C(n,["_self"]);g!=null&&j(t,["tunedModel"],Nz(e,g));const b=C(n,["distillationSpec"]);b!=null&&j(t,["distillationSpec"],b);const v=C(n,["experiment"]);v!=null&&j(t,["experiment"],v);const S=C(n,["labels"]);S!=null&&j(t,["labels"],S);const k=C(n,["pipelineJob"]);k!=null&&j(t,["pipelineJob"],k);const T=C(n,["tunedModelDisplayName"]);return T!=null&&j(t,["tunedModelDisplayName"],T),t}function Cz(e,n){const t={},i=C(n,["nextPageToken"]);i!=null&&j(t,["nextPageToken"],i);const a=C(n,["tunedModels"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>h2(e,l))),j(t,["tuningJobs"],o)}return t}function jz(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["metadata"]);a!=null&&j(t,["metadata"],a);const o=C(n,["done"]);o!=null&&j(t,["done"],o);const l=C(n,["error"]);return l!=null&&j(t,["error"],l),t}function _z(e,n){const t={},i=C(n,["checkpointId"]);i!=null&&j(t,["checkpointId"],i);const a=C(n,["epoch"]);a!=null&&j(t,["epoch"],a);const o=C(n,["step"]);o!=null&&j(t,["step"],o);const l=C(n,["endpoint"]);return l!=null&&j(t,["endpoint"],l),t}function kz(e,n){const t={},i=C(n,["model"]);i!=null&&j(t,["model"],i);const a=C(n,["endpoint"]);a!=null&&j(t,["endpoint"],a);const o=C(n,["checkpoints"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(d=>_z(e,d))),j(t,["checkpoints"],l)}return t}function g1(e,n){const t={},i=C(n,["name"]);i!=null&&j(t,["name"],i);const a=C(n,["state"]);a!=null&&j(t,["state"],r2(e,a));const o=C(n,["createTime"]);o!=null&&j(t,["createTime"],o);const l=C(n,["startTime"]);l!=null&&j(t,["startTime"],l);const d=C(n,["endTime"]);d!=null&&j(t,["endTime"],d);const f=C(n,["updateTime"]);f!=null&&j(t,["updateTime"],f);const u=C(n,["error"]);u!=null&&j(t,["error"],u);const p=C(n,["description"]);p!=null&&j(t,["description"],p);const g=C(n,["baseModel"]);g!=null&&j(t,["baseModel"],g);const b=C(n,["tunedModel"]);b!=null&&j(t,["tunedModel"],kz(e,b));const v=C(n,["supervisedTuningSpec"]);v!=null&&j(t,["supervisedTuningSpec"],v);const S=C(n,["tuningDataStats"]);S!=null&&j(t,["tuningDataStats"],S);const k=C(n,["encryptionSpec"]);k!=null&&j(t,["encryptionSpec"],k);const T=C(n,["partnerModelTuningSpec"]);T!=null&&j(t,["partnerModelTuningSpec"],T);const P=C(n,["distillationSpec"]);P!=null&&j(t,["distillationSpec"],P);const M=C(n,["experiment"]);M!=null&&j(t,["experiment"],M);const I=C(n,["labels"]);I!=null&&j(t,["labels"],I);const U=C(n,["pipelineJob"]);U!=null&&j(t,["pipelineJob"],U);const L=C(n,["tunedModelDisplayName"]);return L!=null&&j(t,["tunedModelDisplayName"],L),t}function Tz(e,n){const t={},i=C(n,["nextPageToken"]);i!=null&&j(t,["nextPageToken"],i);const a=C(n,["tuningJobs"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>g1(e,l))),j(t,["tuningJobs"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ez extends ag{constructor(n){super(),this.apiClient=n,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Ab(Dh.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const i=await this.tuneMldevInternal(t);let a="";return i.metadata!==void 0&&i.metadata.tunedModel!==void 0?a=i.metadata.tunedModel:i.name!==void 0&&i.name.includes("/operations/")&&(a=i.name.split("/operations/")[0]),{name:a,state:c1.JOB_STATE_QUEUED}}}}async getInternal(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=gz(this.apiClient,n);return d=$t("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>g1(this.apiClient,p))}else{const u=cz(this.apiClient,n);return d=$t("{name}",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>h2(this.apiClient,p))}}async listInternal(n){var t,i,a,o;let l,d="",f={};if(this.apiClient.isVertexAI()){const u=xz(this.apiClient,n);return d=$t("tuningJobs",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),l.then(p=>{const g=Tz(this.apiClient,p),b=new aC;return Object.assign(b,g),b})}else{const u=dz(this.apiClient,n);return d=$t("tunedModels",u._url),f=u._query,delete u.config,delete u._url,delete u._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(a=n.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(o=n.config)===null||o===void 0?void 0:o.abortSignal}).then(p=>p.json()),l.then(p=>{const g=Cz(this.apiClient,p),b=new aC;return Object.assign(b,g),b})}}async tuneInternal(n){var t,i;let a,o="",l={};if(this.apiClient.isVertexAI()){const d=Sz(this.apiClient,n);return o=$t("tuningJobs",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),a.then(f=>g1(this.apiClient,f))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(n){var t,i;let a,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=mz(this.apiClient,n);return o=$t("tunedModels",d._url),l=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=n.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),a.then(f=>jz(this.apiClient,f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Az{async download(n,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Pz=1024*1024*8,Dz=3,Iz=1e3,Rz=2,r0="x-goog-upload-status";async function Mz(e,n,t){var i,a,o;let l=0,d=0,f=new u1(new Response),u="upload";for(l=e.size;d<l;){const g=Math.min(Pz,l-d),b=e.slice(d,d+g);d+g>=l&&(u+=", finalize");let v=0,S=Iz;for(;v<Dz&&(f=await t.request({path:"",body:b,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:n,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(d),"Content-Length":String(g)}}}),!(!((i=f==null?void 0:f.headers)===null||i===void 0)&&i[r0]));)v++,await Lz(S),S=S*Rz;if(d+=g,((a=f==null?void 0:f.headers)===null||a===void 0?void 0:a[r0])!=="active")break;if(l<=d)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const p=await(f==null?void 0:f.json());if(((o=f==null?void 0:f.headers)===null||o===void 0?void 0:o[r0])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return p.file}async function Oz(e){return{size:e.size,type:e.type}}function Lz(e){return new Promise(n=>setTimeout(n,e))}class Fz{async upload(n,t,i){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await Mz(n,t,i)}async stat(n){if(typeof n=="string")throw new Error("File path is not supported in browser uploader.");return await Oz(n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $z{create(n,t,i){return new zz(n,t,i)}}class zz{constructor(n,t,i){this.url=n,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(n){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(n)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const vC="x-goog-api-key";class Uz{constructor(n){this.apiKey=n}async addAuthHeaders(n){n.get(vC)===null&&n.append(vC,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Bz="gl-node/";class p2{constructor(n){var t;if(n.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(n.project||n.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=n.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=n.apiKey;const i=XL(n,void 0,void 0);i&&(n.httpOptions?n.httpOptions.baseUrl=i:n.httpOptions={baseUrl:i}),this.apiVersion=n.apiVersion;const a=new Uz(this.apiKey);this.apiClient=new lz({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:n.httpOptions,userAgentExtra:Bz+"web",uploader:new Fz,downloader:new Az}),this.models=new B$(this.apiClient),this.live=new L$(this.apiClient,a,new $z),this.chats=new aF(this.models,this.apiClient),this.caches=new tF(this.apiClient),this.files=new xF(this.apiClient),this.operations=new Z$(this.apiClient),this.tunings=new Ez(this.apiClient)}}const fh=new Map,m2=(()=>{const e=new Promise(n=>{window.addEventListener("pointerdown",n,{once:!0}),window.addEventListener("keydown",n,{once:!0})});return async n=>{try{const t=new Audio;if(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",await t.play(),n!=null&&n.id&&fh.has(n.id)){const a=fh.get(n.id);if(a)return a}const i=new AudioContext(n);return n!=null&&n.id&&fh.set(n.id,i),i}catch{if(await e,n!=null&&n.id&&fh.has(n.id)){const a=fh.get(n.id);if(a)return a}const i=new AudioContext(n);return n!=null&&n.id&&fh.set(n.id,i),i}}})();function qz(e){var n=atob(e),t=new Uint8Array(n.length);for(let i=0;i<n.length;i++)t[i]=n.charCodeAt(i);return t.buffer}const Vz=`
class AudioProcessingWorklet extends AudioWorkletProcessor {

  // send and clear buffer every 2048 samples, 
  // which at 16khz is about 8 times a second
  buffer = new Int16Array(2048);

  // current write index
  bufferWriteIndex = 0;

  constructor() {
    super();
    this.hasAudio = false;
  }

  /**
   * @param inputs Float32Array[][] [input#][channel#][sample#] so to access first inputs 1st channel inputs[0][0]
   * @param outputs Float32Array[][]
   */
  process(inputs) {
    if (inputs[0].length) {
      const channel0 = inputs[0][0];
      this.processChunk(channel0);
    }
    return true;
  }

  sendAndClearBuffer(){
    this.port.postMessage({
      event: "chunk",
      data: {
        int16arrayBuffer: this.buffer.slice(0, this.bufferWriteIndex).buffer,
      },
    });
    this.bufferWriteIndex = 0;
  }

  processChunk(float32Array) {
    const l = float32Array.length;
    
    for (let i = 0; i < l; i++) {
      // convert float32 -1 to 1 to int16 -32768 to 32767
      const int16Value = float32Array[i] * 32768;
      this.buffer[this.bufferWriteIndex++] = int16Value;
      if(this.bufferWriteIndex >= this.buffer.length) {
        this.sendAndClearBuffer();
      }
    }

    if(this.bufferWriteIndex >= this.buffer.length) {
      this.sendAndClearBuffer();
    }
  }
}
`,g2=`
  class VolMeter extends AudioWorkletProcessor {
    volume
    updateIntervalInMS
    nextUpdateFrame

    constructor() {
      super()
      this.volume = 0
      this.updateIntervalInMS = 25
      this.nextUpdateFrame = this.updateIntervalInMS
      this.port.onmessage = event => {
        if (event.data.updateIntervalInMS) {
          this.updateIntervalInMS = event.data.updateIntervalInMS
        }
      }
    }

    get intervalInFrames() {
      return (this.updateIntervalInMS / 1000) * sampleRate
    }

    process(inputs) {
      const input = inputs[0]

      if (input.length > 0) {
        const samples = input[0]
        let sum = 0
        let rms = 0

        for (let i = 0; i < samples.length; ++i) {
          sum += samples[i] * samples[i]
        }

        rms = Math.sqrt(sum / samples.length)
        this.volume = Math.max(rms, this.volume * 0.7)

        this.nextUpdateFrame -= samples.length
        if (this.nextUpdateFrame < 0) {
          this.nextUpdateFrame += this.intervalInFrames
          this.port.postMessage({volume: this.volume})
        }
      }

      return true
    }
  }`,xx=new Map,y1=(e,n)=>{const t=new Blob([`registerProcessor("${e}", ${n})`],{type:"application/javascript"});return URL.createObjectURL(t)};var a0={exports:{}},wC;function Hz(){return wC||(wC=1,function(e){var n=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function a(f,u,p){this.fn=f,this.context=u,this.once=p||!1}function o(f,u,p,g,b){if(typeof p!="function")throw new TypeError("The listener must be a function");var v=new a(p,g||f,b),S=t?t+u:u;return f._events[S]?f._events[S].fn?f._events[S]=[f._events[S],v]:f._events[S].push(v):(f._events[S]=v,f._eventsCount++),f}function l(f,u){--f._eventsCount===0?f._events=new i:delete f._events[u]}function d(){this._events=new i,this._eventsCount=0}d.prototype.eventNames=function(){var u=[],p,g;if(this._eventsCount===0)return u;for(g in p=this._events)n.call(p,g)&&u.push(t?g.slice(1):g);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(p)):u},d.prototype.listeners=function(u){var p=t?t+u:u,g=this._events[p];if(!g)return[];if(g.fn)return[g.fn];for(var b=0,v=g.length,S=new Array(v);b<v;b++)S[b]=g[b].fn;return S},d.prototype.listenerCount=function(u){var p=t?t+u:u,g=this._events[p];return g?g.fn?1:g.length:0},d.prototype.emit=function(u,p,g,b,v,S){var k=t?t+u:u;if(!this._events[k])return!1;var T=this._events[k],P=arguments.length,M,I;if(T.fn){switch(T.once&&this.removeListener(u,T.fn,void 0,!0),P){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,p),!0;case 3:return T.fn.call(T.context,p,g),!0;case 4:return T.fn.call(T.context,p,g,b),!0;case 5:return T.fn.call(T.context,p,g,b,v),!0;case 6:return T.fn.call(T.context,p,g,b,v,S),!0}for(I=1,M=new Array(P-1);I<P;I++)M[I-1]=arguments[I];T.fn.apply(T.context,M)}else{var U=T.length,L;for(I=0;I<U;I++)switch(T[I].once&&this.removeListener(u,T[I].fn,void 0,!0),P){case 1:T[I].fn.call(T[I].context);break;case 2:T[I].fn.call(T[I].context,p);break;case 3:T[I].fn.call(T[I].context,p,g);break;case 4:T[I].fn.call(T[I].context,p,g,b);break;default:if(!M)for(L=1,M=new Array(P-1);L<P;L++)M[L-1]=arguments[L];T[I].fn.apply(T[I].context,M)}}return!0},d.prototype.on=function(u,p,g){return o(this,u,p,g,!1)},d.prototype.once=function(u,p,g){return o(this,u,p,g,!0)},d.prototype.removeListener=function(u,p,g,b){var v=t?t+u:u;if(!this._events[v])return this;if(!p)return l(this,v),this;var S=this._events[v];if(S.fn)S.fn===p&&(!b||S.once)&&(!g||S.context===g)&&l(this,v);else{for(var k=0,T=[],P=S.length;k<P;k++)(S[k].fn!==p||b&&!S[k].once||g&&S[k].context!==g)&&T.push(S[k]);T.length?this._events[v]=T.length===1?T[0]:T:l(this,v)}return this},d.prototype.removeAllListeners=function(u){var p;return u?(p=t?t+u:u,this._events[p]&&l(this,p)):(this._events=new i,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=t,d.EventEmitter=d,e.exports=d}(a0)),a0.exports}var Gz=Hz();const y2=Ud(Gz);function Yz(e){for(var n="",t=new Uint8Array(e),i=t.byteLength,a=0;a<i;a++)n+=String.fromCharCode(t[a]);return window.btoa(n)}class x2 extends y2{constructor(t=16e3){super();Hn(this,"stream");Hn(this,"audioContext");Hn(this,"source");Hn(this,"recording",!1);Hn(this,"recordingWorklet");Hn(this,"vuWorklet");Hn(this,"starting",null);this.sampleRate=t}async start(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Could not request user media");this.starting=new Promise(async t=>{this.stream=await navigator.mediaDevices.getUserMedia({audio:!0}),this.audioContext=await m2({sampleRate:this.sampleRate}),this.source=this.audioContext.createMediaStreamSource(this.stream);const i="audio-recorder-worklet",a=y1(i,Vz);await this.audioContext.audioWorklet.addModule(a),this.recordingWorklet=new AudioWorkletNode(this.audioContext,i),this.recordingWorklet.port.onmessage=async l=>{const d=l.data.data.int16arrayBuffer;if(d){const f=Yz(d);this.emit("data",f)}},this.source.connect(this.recordingWorklet);const o="vu-meter";await this.audioContext.audioWorklet.addModule(y1(o,g2)),this.vuWorklet=new AudioWorkletNode(this.audioContext,o),this.vuWorklet.port.onmessage=l=>{this.emit("volume",l.data.volume)},this.source.connect(this.vuWorklet),this.recording=!0,t(),this.starting=null})}stop(){const t=()=>{var i,a;(i=this.source)==null||i.disconnect(),(a=this.stream)==null||a.getTracks().forEach(o=>o.stop()),this.stream=void 0,this.recordingWorklet=void 0,this.vuWorklet=void 0,this.audioContext&&(this.audioContext.close(),this.audioContext=void 0)};if(this.starting){this.starting.then(t);return}t()}}const Wz=3,Qz=({active:e,volume:n,hover:t})=>{const i=w.useRef([]);return w.useEffect(()=>{let a=null;const o=()=>{i.current.forEach((l,d)=>{l&&(l.style.height=`${Math.min(24,4+n*(d===1?400:60))}px`)}),a=window.setTimeout(o,100)};return o(),()=>clearTimeout(a)},[n]),r.jsx("div",{className:au("audioPulse",{active:e,hover:t}),children:Array(Wz).fill(null).map((a,o)=>r.jsx("div",{ref:l=>{i.current[o]=l},style:{animationDelay:`${o*133}ms`}},o))})};var Fm={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var Jz=Fm.exports,SC;function Kz(){return SC||(SC=1,function(e,n){(function(){var t,i="4.17.21",a=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",d="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",u=500,p="__lodash_placeholder__",g=1,b=2,v=4,S=1,k=2,T=1,P=2,M=4,I=8,U=16,L=32,$=64,z=128,F=256,Q=512,R=30,B="...",Y=800,re=16,ne=1,G=2,V=3,W=1/0,J=9007199254740991,he=17976931348623157e292,A=NaN,ce=4294967295,se=ce-1,D=ce>>>1,oe=[["ary",z],["bind",T],["bindKey",P],["curry",I],["curryRight",U],["flip",Q],["partial",L],["partialRight",$],["rearg",F]],xe="[object Arguments]",Z="[object Array]",ue="[object AsyncFunction]",ae="[object Boolean]",Re="[object Date]",Ae="[object DOMException]",Ce="[object Error]",Se="[object Function]",De="[object GeneratorFunction]",Me="[object Map]",et="[object Number]",ct="[object Null]",ut="[object Object]",at="[object Promise]",qt="[object Proxy]",jt="[object RegExp]",_e="[object Set]",Fe="[object String]",Pe="[object Symbol]",Ue="[object Undefined]",ve="[object WeakMap]",ee="[object WeakSet]",fe="[object ArrayBuffer]",qe="[object DataView]",nt="[object Float32Array]",lt="[object Float64Array]",wt="[object Int8Array]",Ve="[object Int16Array]",be="[object Int32Array]",ye="[object Uint8Array]",Oe="[object Uint8ClampedArray]",He="[object Uint16Array]",tt="[object Uint32Array]",rt=/\b__p \+= '';/g,Ft=/\b(__p \+=) '' \+/g,Kn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Pn=/&(?:amp|lt|gt|quot|#39);/g,Et=/[&<>"']/g,Vt=RegExp(Pn.source),hi=RegExp(Et.source),gn=/<%-([\s\S]+?)%>/g,Dn=/<%([\s\S]+?)%>/g,Bt=/<%=([\s\S]+?)%>/g,Ys=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ws=/^\w*$/,Fi=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,zn=/[\\^$.*+?()[\]{}|]/g,Ri=RegExp(zn.source),ha=/^\s+/,xu=/\s/,bu=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qh=/\{\n\/\* \[wrapped with (.+)\] \*/,Zo=/,? & /,Qs=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Kl=/[()=,{}\[\]\/\s]/,ds=/\\(\\)?/g,Js=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ks=/\w*$/,Xs=/^[-+]0x[0-9a-f]+$/i,pi=/^0b[01]+$/i,Vd=/^\[object .+?Constructor\]$/,Hd=/^0o[0-7]+$/i,fs=/^(?:0|[1-9]\d*)$/,Zs=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Xl=/($^)/,Gd=/['\n\r\u2028\u2029\\]/g,hs="\\ud800-\\udfff",qr="\\u0300-\\u036f",Ra="\\ufe20-\\ufe2f",el="\\u20d0-\\u20ff",kr=qr+Ra+el,tl="\\u2700-\\u27bf",nl="a-z\\xdf-\\xf6\\xf8-\\xff",Ma="\\xac\\xb1\\xd7\\xf7",Zl="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ec="\\u2000-\\u206f",tc=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",vu="A-Z\\xc0-\\xd6\\xd8-\\xde",Yi="\\ufe0e\\ufe0f",nc=Ma+Zl+ec+tc,ic="[']",il="["+hs+"]",eo="["+nc+"]",Oa="["+kr+"]",rc="\\d+",Wi="["+tl+"]",to="["+nl+"]",ac="[^"+hs+nc+rc+tl+nl+vu+"]",ps="\\ud83c[\\udffb-\\udfff]",ms="(?:"+Oa+"|"+ps+")",rl="[^"+hs+"]",al="(?:\\ud83c[\\udde6-\\uddff]){2}",Tr="[\\ud800-\\udbff][\\udc00-\\udfff]",Vr="["+vu+"]",no="\\u200d",sc="(?:"+to+"|"+ac+")",io="(?:"+Vr+"|"+ac+")",Yd="(?:"+ic+"(?:d|ll|m|re|s|t|ve))?",oc="(?:"+ic+"(?:D|LL|M|RE|S|T|VE))?",gs=ms+"?",ro="["+Yi+"]?",sl="(?:"+no+"(?:"+[rl,al,Tr].join("|")+")"+ro+gs+")*",La="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Fa="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ol=ro+gs+sl,ll="(?:"+[Wi,al,Tr].join("|")+")"+ol,lc="(?:"+[rl+Oa+"?",Oa,al,Tr,il].join("|")+")",Qi=RegExp(ic,"g"),Er=RegExp(Oa,"g"),ao=RegExp(ps+"(?="+ps+")|"+lc+ol,"g"),Ar=RegExp([Vr+"?"+to+"+"+Yd+"(?="+[eo,Vr,"$"].join("|")+")",io+"+"+oc+"(?="+[eo,Vr+sc,"$"].join("|")+")",Vr+"?"+sc+"+"+Yd,Vr+"+"+oc,Fa,La,rc,ll].join("|"),"g"),$a=RegExp("["+no+hs+kr+Yi+"]"),cl=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,cc=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],uc=-1,hn={};hn[nt]=hn[lt]=hn[wt]=hn[Ve]=hn[be]=hn[ye]=hn[Oe]=hn[He]=hn[tt]=!0,hn[xe]=hn[Z]=hn[fe]=hn[ae]=hn[qe]=hn[Re]=hn[Ce]=hn[Se]=hn[Me]=hn[et]=hn[ut]=hn[jt]=hn[_e]=hn[Fe]=hn[ve]=!1;var Sn={};Sn[xe]=Sn[Z]=Sn[fe]=Sn[qe]=Sn[ae]=Sn[Re]=Sn[nt]=Sn[lt]=Sn[wt]=Sn[Ve]=Sn[be]=Sn[Me]=Sn[et]=Sn[ut]=Sn[jt]=Sn[_e]=Sn[Fe]=Sn[Pe]=Sn[ye]=Sn[Oe]=Sn[He]=Sn[tt]=!0,Sn[Ce]=Sn[Se]=Sn[ve]=!1;var ul={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Mi={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},pa={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},dl={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},so=parseFloat,Wd=parseInt,oo=typeof ru=="object"&&ru&&ru.Object===Object&&ru,dc=typeof self=="object"&&self&&self.Object===Object&&self,Un=oo||dc||Function("return this")(),ma=n&&!n.nodeType&&n,za=ma&&!0&&e&&!e.nodeType&&e,fc=za&&za.exports===ma,fl=fc&&oo.process,Ji=function(){try{var ke=za&&za.require&&za.require("util").types;return ke||fl&&fl.binding&&fl.binding("util")}catch{}}(),yn=Ji&&Ji.isArrayBuffer,hc=Ji&&Ji.isDate,hl=Ji&&Ji.isMap,pc=Ji&&Ji.isRegExp,lo=Ji&&Ji.isSet,co=Ji&&Ji.isTypedArray;function $i(ke,Ye,Be){switch(Be.length){case 0:return ke.call(Ye);case 1:return ke.call(Ye,Be[0]);case 2:return ke.call(Ye,Be[0],Be[1]);case 3:return ke.call(Ye,Be[0],Be[1],Be[2])}return ke.apply(Ye,Be)}function Qd(ke,Ye,Be,ft){for(var kt=-1,on=ke==null?0:ke.length;++kt<on;){var si=ke[kt];Ye(ft,si,Be(si),ke)}return ft}function xi(ke,Ye){for(var Be=-1,ft=ke==null?0:ke.length;++Be<ft&&Ye(ke[Be],Be,ke)!==!1;);return ke}function Jd(ke,Ye){for(var Be=ke==null?0:ke.length;Be--&&Ye(ke[Be],Be,ke)!==!1;);return ke}function mc(ke,Ye){for(var Be=-1,ft=ke==null?0:ke.length;++Be<ft;)if(!Ye(ke[Be],Be,ke))return!1;return!0}function Ki(ke,Ye){for(var Be=-1,ft=ke==null?0:ke.length,kt=0,on=[];++Be<ft;){var si=ke[Be];Ye(si,Be,ke)&&(on[kt++]=si)}return on}function ga(ke,Ye){var Be=ke==null?0:ke.length;return!!Be&&fo(ke,Ye,0)>-1}function gc(ke,Ye,Be){for(var ft=-1,kt=ke==null?0:ke.length;++ft<kt;)if(Be(Ye,ke[ft]))return!0;return!1}function Bn(ke,Ye){for(var Be=-1,ft=ke==null?0:ke.length,kt=Array(ft);++Be<ft;)kt[Be]=Ye(ke[Be],Be,ke);return kt}function Hr(ke,Ye){for(var Be=-1,ft=Ye.length,kt=ke.length;++Be<ft;)ke[kt+Be]=Ye[Be];return ke}function ys(ke,Ye,Be,ft){var kt=-1,on=ke==null?0:ke.length;for(ft&&on&&(Be=ke[++kt]);++kt<on;)Be=Ye(Be,ke[kt],kt,ke);return Be}function Jh(ke,Ye,Be,ft){var kt=ke==null?0:ke.length;for(ft&&kt&&(Be=ke[--kt]);kt--;)Be=Ye(Be,ke[kt],kt,ke);return Be}function Ua(ke,Ye){for(var Be=-1,ft=ke==null?0:ke.length;++Be<ft;)if(Ye(ke[Be],Be,ke))return!0;return!1}var Kh=gl("length");function Kd(ke){return ke.split("")}function uo(ke){return ke.match(Qs)||[]}function xs(ke,Ye,Be){var ft;return Be(ke,function(kt,on,si){if(Ye(kt,on,si))return ft=on,!1}),ft}function Ba(ke,Ye,Be,ft){for(var kt=ke.length,on=Be+(ft?1:-1);ft?on--:++on<kt;)if(Ye(ke[on],on,ke))return on;return-1}function fo(ke,Ye,Be){return Ye===Ye?ep(ke,Ye,Be):Ba(ke,bs,Be)}function pl(ke,Ye,Be,ft){for(var kt=Be-1,on=ke.length;++kt<on;)if(ft(ke[kt],Ye))return kt;return-1}function bs(ke){return ke!==ke}function ml(ke,Ye){var Be=ke==null?0:ke.length;return Be?xc(ke,Ye)/Be:A}function gl(ke){return function(Ye){return Ye==null?t:Ye[ke]}}function yc(ke){return function(Ye){return ke==null?t:ke[Ye]}}function wu(ke,Ye,Be,ft,kt){return kt(ke,function(on,si,ln){Be=ft?(ft=!1,on):Ye(Be,on,si,ln)}),Be}function Xd(ke,Ye){var Be=ke.length;for(ke.sort(Ye);Be--;)ke[Be]=ke[Be].value;return ke}function xc(ke,Ye){for(var Be,ft=-1,kt=ke.length;++ft<kt;){var on=Ye(ke[ft]);on!==t&&(Be=Be===t?on:Be+on)}return Be}function qa(ke,Ye){for(var Be=-1,ft=Array(ke);++Be<ke;)ft[Be]=Ye(Be);return ft}function Xh(ke,Ye){return Bn(Ye,function(Be){return[Be,ke[Be]]})}function Zd(ke){return ke&&ke.slice(0,ju(ke)+1).replace(ha,"")}function Xi(ke){return function(Ye){return ke(Ye)}}function yl(ke,Ye){return Bn(Ye,function(Be){return ke[Be]})}function ho(ke,Ye){return ke.has(Ye)}function ya(ke,Ye){for(var Be=-1,ft=ke.length;++Be<ft&&fo(Ye,ke[Be],0)>-1;);return Be}function po(ke,Ye){for(var Be=ke.length;Be--&&fo(Ye,ke[Be],0)>-1;);return Be}function Va(ke,Ye){for(var Be=ke.length,ft=0;Be--;)ke[Be]===Ye&&++ft;return ft}var Pr=yc(ul),Gr=yc(Mi);function Su(ke){return"\\"+dl[ke]}function bc(ke,Ye){return ke==null?t:ke[Ye]}function xa(ke){return $a.test(ke)}function Nu(ke){return cl.test(ke)}function mo(ke){for(var Ye,Be=[];!(Ye=ke.next()).done;)Be.push(Ye.value);return Be}function xl(ke){var Ye=-1,Be=Array(ke.size);return ke.forEach(function(ft,kt){Be[++Ye]=[kt,ft]}),Be}function Cu(ke,Ye){return function(Be){return ke(Ye(Be))}}function Ha(ke,Ye){for(var Be=-1,ft=ke.length,kt=0,on=[];++Be<ft;){var si=ke[Be];(si===Ye||si===p)&&(ke[Be]=p,on[kt++]=Be)}return on}function bl(ke){var Ye=-1,Be=Array(ke.size);return ke.forEach(function(ft){Be[++Ye]=ft}),Be}function Zh(ke){var Ye=-1,Be=Array(ke.size);return ke.forEach(function(ft){Be[++Ye]=[ft,ft]}),Be}function ep(ke,Ye,Be){for(var ft=Be-1,kt=ke.length;++ft<kt;)if(ke[ft]===Ye)return ft;return-1}function Zi(ke,Ye,Be){for(var ft=Be+1;ft--;)if(ke[ft]===Ye)return ft;return ft}function Yr(ke){return xa(ke)?ef(ke):Kh(ke)}function lr(ke){return xa(ke)?vl(ke):Kd(ke)}function ju(ke){for(var Ye=ke.length;Ye--&&xu.test(ke.charAt(Ye)););return Ye}var vs=yc(pa);function ef(ke){for(var Ye=ao.lastIndex=0;ao.test(ke);)++Ye;return Ye}function vl(ke){return ke.match(ao)||[]}function tp(ke){return ke.match(Ar)||[]}var Ga=function ke(Ye){Ye=Ye==null?Un:Ya.defaults(Un.Object(),Ye,Ya.pick(Un,cc));var Be=Ye.Array,ft=Ye.Date,kt=Ye.Error,on=Ye.Function,si=Ye.Math,ln=Ye.Object,vc=Ye.RegExp,tf=Ye.String,er=Ye.TypeError,wc=Be.prototype,np=on.prototype,ws=ln.prototype,go=Ye["__core-js_shared__"],yo=np.toString,te=ws.hasOwnProperty,de=0,le=function(){var m=/[^.]+$/.exec(go&&go.keys&&go.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),we=ws.toString,We=yo.call(ln),dt=Un._,vt=vc("^"+yo.call(te).replace(zn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),bt=fc?Ye.Buffer:t,qn=Ye.Symbol,zi=Ye.Uint8Array,Ss=bt?bt.allocUnsafe:t,_u=Cu(ln.getPrototypeOf,ln),ku=ln.create,wl=ws.propertyIsEnumerable,nf=wc.splice,cr=qn?qn.isConcatSpreadable:t,Sl=qn?qn.iterator:t,tr=qn?qn.toStringTag:t,Tu=function(){try{var m=_o(ln,"defineProperty");return m({},"",{}),m}catch{}}(),rf=Ye.clearTimeout!==Un.clearTimeout&&Ye.clearTimeout,Nl=ft&&ft.now!==Un.Date.now&&ft.now,ip=Ye.setTimeout!==Un.setTimeout&&Ye.setTimeout,Sc=si.ceil,Ns=si.floor,xo=ln.getOwnPropertySymbols,af=bt?bt.isBuffer:t,Eu=Ye.isFinite,Wr=wc.join,Qr=Cu(ln.keys,ln),Gn=si.max,Xn=si.min,Cs=ft.now,Cl=Ye.parseInt,rp=si.random,ap=wc.reverse,Au=_o(Ye,"DataView"),bi=_o(Ye,"Map"),Zn=_o(Ye,"Promise"),an=_o(Ye,"Set"),ba=_o(Ye,"WeakMap"),ur=_o(ln,"create"),Nc=ba&&new ba,Jr={},pg=Is(Au),mg=Is(bi),Pu=Is(Zn),Du=Is(an),gg=Is(ba),bo=qn?qn.prototype:t,jl=bo?bo.valueOf:t,vo=bo?bo.toString:t;function K(m){if(ai(m)&&!Lt(m)&&!(m instanceof Xt)){if(m instanceof dr)return m;if(te.call(m,"__wrapped__"))return wi(m)}return new dr(m)}var Dr=function(){function m(){}return function(y){if(!ti(y))return{};if(ku)return ku(y);m.prototype=y;var _=new m;return m.prototype=t,_}}();function Kr(){}function dr(m,y){this.__wrapped__=m,this.__actions__=[],this.__chain__=!!y,this.__index__=0,this.__values__=t}K.templateSettings={escape:gn,evaluate:Dn,interpolate:Bt,variable:"",imports:{_:K}},K.prototype=Kr.prototype,K.prototype.constructor=K,dr.prototype=Dr(Kr.prototype),dr.prototype.constructor=dr;function Xt(m){this.__wrapped__=m,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ce,this.__views__=[]}function Iu(){var m=new Xt(this.__wrapped__);return m.__actions__=vi(this.__actions__),m.__dir__=this.__dir__,m.__filtered__=this.__filtered__,m.__iteratees__=vi(this.__iteratees__),m.__takeCount__=this.__takeCount__,m.__views__=vi(this.__views__),m}function sf(){if(this.__filtered__){var m=new Xt(this);m.__dir__=-1,m.__filtered__=!0}else m=this.clone(),m.__dir__*=-1;return m}function _l(){var m=this.__wrapped__.value(),y=this.__dir__,_=Lt(m),O=y<0,H=_?m.length:0,ie=Qg(0,H,this.__views__),pe=ie.start,Ne=ie.end,Ee=Ne-pe,Ke=O?Ne:pe-1,Ze=this.__iteratees__,it=Ze.length,mt=0,yt=Xn(Ee,this.__takeCount__);if(!_||!O&&H==Ee&&yt==Ee)return Mg(m,this.__actions__);var Rt=[];e:for(;Ee--&&mt<yt;){Ke+=y;for(var en=-1,Mt=m[Ke];++en<it;){var un=Ze[en],bn=un.iteratee,_a=un.type,$r=bn(Mt);if(_a==G)Mt=$r;else if(!$r){if(_a==ne)continue e;break e}}Rt[mt++]=Mt}return Rt}Xt.prototype=Dr(Kr.prototype),Xt.prototype.constructor=Xt;function oi(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var O=m[y];this.set(O[0],O[1])}}function of(){this.__data__=ur?ur(null):{},this.size=0}function yg(m){var y=this.has(m)&&delete this.__data__[m];return this.size-=y?1:0,y}function Yb(m){var y=this.__data__;if(ur){var _=y[m];return _===f?t:_}return te.call(y,m)?y[m]:t}function Wb(m){var y=this.__data__;return ur?y[m]!==t:te.call(y,m)}function Qb(m,y){var _=this.__data__;return this.size+=this.has(m)?0:1,_[m]=ur&&y===t?f:y,this}oi.prototype.clear=of,oi.prototype.delete=yg,oi.prototype.get=Yb,oi.prototype.has=Wb,oi.prototype.set=Qb;function On(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var O=m[y];this.set(O[0],O[1])}}function sp(){this.__data__=[],this.size=0}function Ru(m){var y=this.__data__,_=_c(y,m);if(_<0)return!1;var O=y.length-1;return _==O?y.pop():nf.call(y,_,1),--this.size,!0}function Mu(m){var y=this.__data__,_=_c(y,m);return _<0?t:y[_][1]}function op(m){return _c(this.__data__,m)>-1}function Cc(m,y){var _=this.__data__,O=_c(_,m);return O<0?(++this.size,_.push([m,y])):_[O][1]=y,this}On.prototype.clear=sp,On.prototype.delete=Ru,On.prototype.get=Mu,On.prototype.has=op,On.prototype.set=Cc;function fr(m){var y=-1,_=m==null?0:m.length;for(this.clear();++y<_;){var O=m[y];this.set(O[0],O[1])}}function Jb(){this.size=0,this.__data__={hash:new oi,map:new(bi||On),string:new oi}}function xg(m){var y=Dc(this,m).delete(m);return this.size-=y?1:0,y}function Kb(m){return Dc(this,m).get(m)}function bg(m){return Dc(this,m).has(m)}function kl(m,y){var _=Dc(this,m),O=_.size;return _.set(m,y),this.size+=_.size==O?0:1,this}fr.prototype.clear=Jb,fr.prototype.delete=xg,fr.prototype.get=Kb,fr.prototype.has=bg,fr.prototype.set=kl;function js(m){var y=-1,_=m==null?0:m.length;for(this.__data__=new fr;++y<_;)this.add(m[y])}function lf(m){return this.__data__.set(m,f),this}function vg(m){return this.__data__.has(m)}js.prototype.add=js.prototype.push=lf,js.prototype.has=vg;function nr(m){var y=this.__data__=new On(m);this.size=y.size}function wg(){this.__data__=new On,this.size=0}function cf(m){var y=this.__data__,_=y.delete(m);return this.size=y.size,_}function lp(m){return this.__data__.get(m)}function Sg(m){return this.__data__.has(m)}function uf(m,y){var _=this.__data__;if(_ instanceof On){var O=_.__data__;if(!bi||O.length<a-1)return O.push([m,y]),this.size=++_.size,this;_=this.__data__=new fr(O)}return _.set(m,y),this.size=_.size,this}nr.prototype.clear=wg,nr.prototype.delete=cf,nr.prototype.get=lp,nr.prototype.has=Sg,nr.prototype.set=uf;function cp(m,y){var _=Lt(m),O=!_&&Ls(m),H=!_&&!O&&Oo(m),ie=!_&&!O&&!H&&Gc(m),pe=_||O||H||ie,Ne=pe?qa(m.length,tf):[],Ee=Ne.length;for(var Ke in m)(y||te.call(m,Ke))&&!(pe&&(Ke=="length"||H&&(Ke=="offset"||Ke=="parent")||ie&&(Ke=="buffer"||Ke=="byteLength"||Ke=="byteOffset")||Na(Ke,Ee)))&&Ne.push(Ke);return Ne}function jc(m){var y=m.length;return y?m[vf(0,y-1)]:t}function Ng(m,y){return ld(vi(m),wa(y,0,m.length))}function Cg(m){return ld(vi(m))}function Wa(m,y,_){(_!==t&&!br(m[y],_)||_===t&&!(y in m))&&va(m,y,_)}function Tl(m,y,_){var O=m[y];(!(te.call(m,y)&&br(O,_))||_===t&&!(y in m))&&va(m,y,_)}function _c(m,y){for(var _=m.length;_--;)if(br(m[_][0],y))return _;return-1}function wo(m,y,_,O){return ks(m,function(H,ie,pe){y(O,H,_(H),pe)}),O}function _s(m,y){return m&&mr(y,Ci(y),m)}function Ou(m,y){return m&&mr(y,Ei(y),m)}function va(m,y,_){y=="__proto__"&&Tu?Tu(m,y,{configurable:!0,enumerable:!0,value:_,writable:!0}):m[y]=_}function Lu(m,y){for(var _=-1,O=y.length,H=Be(O),ie=m==null;++_<O;)H[_]=ie?t:Sd(m,y[_]);return H}function wa(m,y,_){return m===m&&(_!==t&&(m=m<=_?m:_),y!==t&&(m=m>=y?m:y)),m}function Ui(m,y,_,O,H,ie){var pe,Ne=y&g,Ee=y&b,Ke=y&v;if(_&&(pe=H?_(m,O,H,ie):_(m)),pe!==t)return pe;if(!ti(m))return m;var Ze=Lt(m);if(Ze){if(pe=Mp(m),!Ne)return vi(m,pe)}else{var it=Ti(m),mt=it==Se||it==De;if(Oo(m))return kp(m,Ne);if(it==ut||it==xe||mt&&!H){if(pe=Ee||mt?{}:Op(m),!Ne)return Ee?Ju(m,Ou(pe,m)):_f(m,_s(pe,m))}else{if(!Sn[it])return H?m:{};pe=Lp(m,it,Ne)}}ie||(ie=new nr);var yt=ie.get(m);if(yt)return yt;ie.set(m,pe),Uy(m)?m.forEach(function(Mt){pe.add(Ui(Mt,y,_,Mt,m,ie))}):Kf(m)&&m.forEach(function(Mt,un){pe.set(un,Ui(Mt,y,_,un,m,ie))});var Rt=Ke?Ee?Af:Ef:Ee?Ei:Ci,en=Ze?t:Rt(m);return xi(en||m,function(Mt,un){en&&(un=Mt,Mt=m[un]),Tl(pe,un,Ui(Mt,y,_,un,m,ie))}),pe}function jg(m){var y=Ci(m);return function(_){return up(_,m,y)}}function up(m,y,_){var O=_.length;if(m==null)return!O;for(m=ln(m);O--;){var H=_[O],ie=y[H],pe=m[H];if(pe===t&&!(H in m)||!ie(pe))return!1}return!0}function El(m,y,_){if(typeof m!="function")throw new er(l);return Rc(function(){m.apply(t,_)},y)}function So(m,y,_,O){var H=-1,ie=ga,pe=!0,Ne=m.length,Ee=[],Ke=y.length;if(!Ne)return Ee;_&&(y=Bn(y,Xi(_))),O?(ie=gc,pe=!1):y.length>=a&&(ie=ho,pe=!1,y=new js(y));e:for(;++H<Ne;){var Ze=m[H],it=_==null?Ze:_(Ze);if(Ze=O||Ze!==0?Ze:0,pe&&it===it){for(var mt=Ke;mt--;)if(y[mt]===it)continue e;Ee.push(Ze)}else ie(y,it,O)||Ee.push(Ze)}return Ee}var ks=Pp(Bi),df=Pp(Tc,!0);function dp(m,y){var _=!0;return ks(m,function(O,H,ie){return _=!!y(O,H,ie),_}),_}function Sa(m,y,_){for(var O=-1,H=m.length;++O<H;){var ie=m[O],pe=y(ie);if(pe!=null&&(Ne===t?pe===pe&&!ar(pe):_(pe,Ne)))var Ne=pe,Ee=ie}return Ee}function Qt(m,y,_,O){var H=m.length;for(_=Ut(_),_<0&&(_=-_>H?0:H+_),O=O===t||O>H?H:Ut(O),O<0&&(O+=H),O=_>O?0:is(O);_<O;)m[_++]=y;return m}function jn(m,y){var _=[];return ks(m,function(O,H,ie){y(O,H,ie)&&_.push(O)}),_}function sn(m,y,_,O,H){var ie=-1,pe=m.length;for(_||(_=Ps),H||(H=[]);++ie<pe;){var Ne=m[ie];y>0&&_(Ne)?y>1?sn(Ne,y-1,_,O,H):Hr(H,Ne):O||(H[H.length]=Ne)}return H}var kc=Ol(),Al=Ol(!0);function Bi(m,y){return m&&kc(m,y,Ci)}function Tc(m,y){return m&&Al(m,y,Ci)}function No(m,y){return Ki(y,function(_){return Ca(m[_])})}function Xr(m,y){y=Es(y,m);for(var _=0,O=y.length;m!=null&&_<O;)m=m[Cn(y[_++])];return _&&_==O?m:t}function _g(m,y,_){var O=y(m);return Lt(m)?O:Hr(O,_(m))}function cn(m){return m==null?m===t?Ue:ct:tr&&tr in ln(m)?Wg(m):ey(m)}function Fu(m,y){return m>y}function fp(m,y){return m!=null&&te.call(m,y)}function kg(m,y){return m!=null&&y in ln(m)}function Tg(m,y,_){return m>=Xn(y,_)&&m<Gn(y,_)}function hp(m,y,_){for(var O=_?gc:ga,H=m[0].length,ie=m.length,pe=ie,Ne=Be(ie),Ee=1/0,Ke=[];pe--;){var Ze=m[pe];pe&&y&&(Ze=Bn(Ze,Xi(y))),Ee=Xn(Ze.length,Ee),Ne[pe]=!_&&(y||H>=120&&Ze.length>=120)?new js(pe&&Ze):t}Ze=m[0];var it=-1,mt=Ne[0];e:for(;++it<H&&Ke.length<Ee;){var yt=Ze[it],Rt=y?y(yt):yt;if(yt=_||yt!==0?yt:0,!(mt?ho(mt,Rt):O(Ke,Rt,_))){for(pe=ie;--pe;){var en=Ne[pe];if(!(en?ho(en,Rt):O(m[pe],Rt,_)))continue e}mt&&mt.push(Rt),Ke.push(yt)}}return Ke}function pp(m,y,_,O){return Bi(m,function(H,ie,pe){y(O,_(H),ie,pe)}),O}function Pl(m,y,_){y=Es(y,m),m=Ic(m,y);var O=m==null?m:m[Cn(qi(y))];return O==null?t:$i(O,m,_)}function ff(m){return ai(m)&&cn(m)==xe}function hr(m){return ai(m)&&cn(m)==fe}function mi(m){return ai(m)&&cn(m)==Re}function Dl(m,y,_,O,H){return m===y?!0:m==null||y==null||!ai(m)&&!ai(y)?m!==m&&y!==y:$u(m,y,_,O,Dl,H)}function $u(m,y,_,O,H,ie){var pe=Lt(m),Ne=Lt(y),Ee=pe?Z:Ti(m),Ke=Ne?Z:Ti(y);Ee=Ee==xe?ut:Ee,Ke=Ke==xe?ut:Ke;var Ze=Ee==ut,it=Ke==ut,mt=Ee==Ke;if(mt&&Oo(m)){if(!Oo(y))return!1;pe=!0,Ze=!1}if(mt&&!Ze)return ie||(ie=new nr),pe||Gc(m)?Gg(m,y,_,O,H,ie):Yg(m,y,Ee,_,O,H,ie);if(!(_&S)){var yt=Ze&&te.call(m,"__wrapped__"),Rt=it&&te.call(y,"__wrapped__");if(yt||Rt){var en=yt?m.value():m,Mt=Rt?y.value():y;return ie||(ie=new nr),H(en,Mt,_,O,ie)}}return mt?(ie||(ie=new nr),ki(m,y,_,O,H,ie)):!1}function hf(m){return ai(m)&&Ti(m)==Me}function zu(m,y,_,O){var H=_.length,ie=H,pe=!O;if(m==null)return!ie;for(m=ln(m);H--;){var Ne=_[H];if(pe&&Ne[2]?Ne[1]!==m[Ne[0]]:!(Ne[0]in m))return!1}for(;++H<ie;){Ne=_[H];var Ee=Ne[0],Ke=m[Ee],Ze=Ne[1];if(pe&&Ne[2]){if(Ke===t&&!(Ee in m))return!1}else{var it=new nr;if(O)var mt=O(Ke,Ze,Ee,m,y,it);if(!(mt===t?Dl(Ze,Ke,S|k,O,it):mt))return!1}}return!0}function Qa(m){if(!ti(m)||Of(m))return!1;var y=Ca(m)?vt:Vd;return y.test(Is(m))}function pf(m){return ai(m)&&cn(m)==jt}function mp(m){return ai(m)&&Ti(m)==_e}function gp(m){return ai(m)&&Ul(m.length)&&!!hn[cn(m)]}function yp(m){return typeof m=="function"?m:m==null?$e:typeof m=="object"?Lt(m)?yf(m[0],m[1]):bp(m):xn(m)}function mf(m){if(!Ln(m))return Qr(m);var y=[];for(var _ in ln(m))te.call(m,_)&&_!="constructor"&&y.push(_);return y}function Eg(m){if(!ti(m))return ko(m);var y=Ln(m),_=[];for(var O in m)O=="constructor"&&(y||!te.call(m,O))||_.push(O);return _}function gf(m,y){return m<y}function xp(m,y){var _=-1,O=Si(m)?Be(m.length):[];return ks(m,function(H,ie,pe){O[++_]=y(H,ie,pe)}),O}function bp(m){var y=Df(m);return y.length==1&&y[0][2]?Xg(y[0][0],y[0][1]):function(_){return _===m||zu(_,m,y)}}function yf(m,y){return Rf(m)&&Kg(y)?Xg(Cn(m),y):function(_){var O=Sd(_,m);return O===t&&O===y?Jc(_,m):Dl(y,O,S|k)}}function Uu(m,y,_,O,H){m!==y&&kc(y,function(ie,pe){if(H||(H=new nr),ti(ie))Xb(m,y,pe,_,Uu,O,H);else{var Ne=O?O(Lf(m,pe),ie,pe+"",m,y,H):t;Ne===t&&(Ne=ie),Wa(m,pe,Ne)}},Ei)}function Xb(m,y,_,O,H,ie,pe){var Ne=Lf(m,_),Ee=Lf(y,_),Ke=pe.get(Ee);if(Ke){Wa(m,_,Ke);return}var Ze=ie?ie(Ne,Ee,_+"",m,y,pe):t,it=Ze===t;if(it){var mt=Lt(Ee),yt=!mt&&Oo(Ee),Rt=!mt&&!yt&&Gc(Ee);Ze=Ee,mt||yt||Rt?Lt(Ne)?Ze=Ne:ui(Ne)?Ze=vi(Ne):yt?(it=!1,Ze=kp(Ee,!0)):Rt?(it=!1,Ze=Ep(Ee,!0)):Ze=[]:na(Ee)||Ls(Ee)?(Ze=Ne,Ls(Ne)?Ze=Vy(Ne):(!ti(Ne)||Ca(Ne))&&(Ze=Op(Ee))):it=!1}it&&(pe.set(Ee,Ze),H(Ze,Ee,O,ie,pe),pe.delete(Ee)),Wa(m,_,Ze)}function vp(m,y){var _=m.length;if(_)return y+=y<0?_:0,Na(y,_)?m[y]:t}function wp(m,y,_){y.length?y=Bn(y,function(ie){return Lt(ie)?function(pe){return Xr(pe,ie.length===1?ie[0]:ie)}:ie}):y=[$e];var O=-1;y=Bn(y,Xi(St()));var H=xp(m,function(ie,pe,Ne){var Ee=Bn(y,function(Ke){return Ke(ie)});return{criteria:Ee,index:++O,value:ie}});return Xd(H,function(ie,pe){return $g(ie,pe,_)})}function Ag(m,y){return xf(m,y,function(_,O){return Jc(m,O)})}function xf(m,y,_){for(var O=-1,H=y.length,ie={};++O<H;){var pe=y[O],Ne=Xr(m,pe);_(Ne,pe)&&Ac(ie,Es(pe,m),Ne)}return ie}function Pg(m){return function(y){return Xr(y,m)}}function bf(m,y,_,O){var H=O?pl:fo,ie=-1,pe=y.length,Ne=m;for(m===y&&(y=vi(y)),_&&(Ne=Bn(m,Xi(_)));++ie<pe;)for(var Ee=0,Ke=y[ie],Ze=_?_(Ke):Ke;(Ee=H(Ne,Ze,Ee,O))>-1;)Ne!==m&&nf.call(Ne,Ee,1),nf.call(m,Ee,1);return m}function Sp(m,y){for(var _=m?y.length:0,O=_-1;_--;){var H=y[_];if(_==O||H!==ie){var ie=H;Na(H)?nf.call(m,H,1):Hu(m,H)}}return m}function vf(m,y){return m+Ns(rp()*(y-m+1))}function Dg(m,y,_,O){for(var H=-1,ie=Gn(Sc((y-m)/(_||1)),0),pe=Be(ie);ie--;)pe[O?ie:++H]=m,m+=_;return pe}function Np(m,y){var _="";if(!m||y<1||y>J)return _;do y%2&&(_+=m),y=Ns(y/2),y&&(m+=m);while(y);return _}function Ht(m,y){return sd(Fp(m,y,$e),m+"")}function Ec(m){return jc(Xc(m))}function wf(m,y){var _=Xc(m);return ld(_,wa(y,0,_.length))}function Ac(m,y,_,O){if(!ti(m))return m;y=Es(y,m);for(var H=-1,ie=y.length,pe=ie-1,Ne=m;Ne!=null&&++H<ie;){var Ee=Cn(y[H]),Ke=_;if(Ee==="__proto__"||Ee==="constructor"||Ee==="prototype")return m;if(H!=pe){var Ze=Ne[Ee];Ke=O?O(Ze,Ee,Ne):t,Ke===t&&(Ke=ti(Ze)?Ze:Na(y[H+1])?[]:{})}Tl(Ne,Ee,Ke),Ne=Ne[Ee]}return m}var Bu=Nc?function(m,y){return Nc.set(m,y),m}:$e,qu=Tu?function(m,y){return Tu(m,"toString",{configurable:!0,enumerable:!1,value:Le(y),writable:!0})}:$e;function Ig(m){return ld(Xc(m))}function Ir(m,y,_){var O=-1,H=m.length;y<0&&(y=-y>H?0:H+y),_=_>H?H:_,_<0&&(_+=H),H=y>_?0:_-y>>>0,y>>>=0;for(var ie=Be(H);++O<H;)ie[O]=m[O+y];return ie}function Rg(m,y){var _;return ks(m,function(O,H,ie){return _=y(O,H,ie),!_}),!!_}function Vu(m,y,_){var O=0,H=m==null?O:m.length;if(typeof y=="number"&&y===y&&H<=D){for(;O<H;){var ie=O+H>>>1,pe=m[ie];pe!==null&&!ar(pe)&&(_?pe<=y:pe<y)?O=ie+1:H=ie}return H}return Sf(m,y,$e,_)}function Sf(m,y,_,O){var H=0,ie=m==null?0:m.length;if(ie===0)return 0;y=_(y);for(var pe=y!==y,Ne=y===null,Ee=ar(y),Ke=y===t;H<ie;){var Ze=Ns((H+ie)/2),it=_(m[Ze]),mt=it!==t,yt=it===null,Rt=it===it,en=ar(it);if(pe)var Mt=O||Rt;else Ke?Mt=Rt&&(O||mt):Ne?Mt=Rt&&mt&&(O||!yt):Ee?Mt=Rt&&mt&&!yt&&(O||!en):yt||en?Mt=!1:Mt=O?it<=y:it<y;Mt?H=Ze+1:ie=Ze}return Xn(ie,se)}function Cp(m,y){for(var _=-1,O=m.length,H=0,ie=[];++_<O;){var pe=m[_],Ne=y?y(pe):pe;if(!_||!br(Ne,Ee)){var Ee=Ne;ie[H++]=pe===0?0:pe}}return ie}function Nf(m){return typeof m=="number"?m:ar(m)?A:+m}function pr(m){if(typeof m=="string")return m;if(Lt(m))return Bn(m,pr)+"";if(ar(m))return vo?vo.call(m):"";var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function Ts(m,y,_){var O=-1,H=ga,ie=m.length,pe=!0,Ne=[],Ee=Ne;if(_)pe=!1,H=gc;else if(ie>=a){var Ke=y?null:Vg(m);if(Ke)return bl(Ke);pe=!1,H=ho,Ee=new js}else Ee=y?[]:Ne;e:for(;++O<ie;){var Ze=m[O],it=y?y(Ze):Ze;if(Ze=_||Ze!==0?Ze:0,pe&&it===it){for(var mt=Ee.length;mt--;)if(Ee[mt]===it)continue e;y&&Ee.push(it),Ne.push(Ze)}else H(Ee,it,_)||(Ee!==Ne&&Ee.push(it),Ne.push(Ze))}return Ne}function Hu(m,y){return y=Es(y,m),m=Ic(m,y),m==null||delete m[Cn(qi(y))]}function jp(m,y,_,O){return Ac(m,y,_(Xr(m,y)),O)}function Gu(m,y,_,O){for(var H=m.length,ie=O?H:-1;(O?ie--:++ie<H)&&y(m[ie],ie,m););return _?Ir(m,O?0:ie,O?ie+1:H):Ir(m,O?ie+1:0,O?H:ie)}function Mg(m,y){var _=m;return _ instanceof Xt&&(_=_.value()),ys(y,function(O,H){return H.func.apply(H.thisArg,Hr([O],H.args))},_)}function Yu(m,y,_){var O=m.length;if(O<2)return O?Ts(m[0]):[];for(var H=-1,ie=Be(O);++H<O;)for(var pe=m[H],Ne=-1;++Ne<O;)Ne!=H&&(ie[H]=So(ie[H]||pe,m[Ne],y,_));return Ts(sn(ie,1),y,_)}function _p(m,y,_){for(var O=-1,H=m.length,ie=y.length,pe={};++O<H;){var Ne=O<ie?y[O]:t;_(pe,m[O],Ne)}return pe}function Cf(m){return ui(m)?m:[]}function Wu(m){return typeof m=="function"?m:$e}function Es(m,y){return Lt(m)?m:Rf(m,y)?[m]:Za(Nn(m))}var Og=Ht;function Co(m,y,_){var O=m.length;return _=_===t?O:_,!y&&_>=O?m:Ir(m,y,_)}var Lg=rf||function(m){return Un.clearTimeout(m)};function kp(m,y){if(y)return m.slice();var _=m.length,O=Ss?Ss(_):new m.constructor(_);return m.copy(O),O}function Il(m){var y=new m.constructor(m.byteLength);return new zi(y).set(new zi(m)),y}function Tp(m,y){var _=y?Il(m.buffer):m.buffer;return new m.constructor(_,m.byteOffset,m.byteLength)}function jf(m){var y=new m.constructor(m.source,Ks.exec(m));return y.lastIndex=m.lastIndex,y}function Fg(m){return jl?ln(jl.call(m)):{}}function Ep(m,y){var _=y?Il(m.buffer):m.buffer;return new m.constructor(_,m.byteOffset,m.length)}function Qu(m,y){if(m!==y){var _=m!==t,O=m===null,H=m===m,ie=ar(m),pe=y!==t,Ne=y===null,Ee=y===y,Ke=ar(y);if(!Ne&&!Ke&&!ie&&m>y||ie&&pe&&Ee&&!Ne&&!Ke||O&&pe&&Ee||!_&&Ee||!H)return 1;if(!O&&!ie&&!Ke&&m<y||Ke&&_&&H&&!O&&!ie||Ne&&_&&H||!pe&&H||!Ee)return-1}return 0}function $g(m,y,_){for(var O=-1,H=m.criteria,ie=y.criteria,pe=H.length,Ne=_.length;++O<pe;){var Ee=Qu(H[O],ie[O]);if(Ee){if(O>=Ne)return Ee;var Ke=_[O];return Ee*(Ke=="desc"?-1:1)}}return m.index-y.index}function Ap(m,y,_,O){for(var H=-1,ie=m.length,pe=_.length,Ne=-1,Ee=y.length,Ke=Gn(ie-pe,0),Ze=Be(Ee+Ke),it=!O;++Ne<Ee;)Ze[Ne]=y[Ne];for(;++H<pe;)(it||H<ie)&&(Ze[_[H]]=m[H]);for(;Ke--;)Ze[Ne++]=m[H++];return Ze}function zg(m,y,_,O){for(var H=-1,ie=m.length,pe=-1,Ne=_.length,Ee=-1,Ke=y.length,Ze=Gn(ie-Ne,0),it=Be(Ze+Ke),mt=!O;++H<Ze;)it[H]=m[H];for(var yt=H;++Ee<Ke;)it[yt+Ee]=y[Ee];for(;++pe<Ne;)(mt||H<ie)&&(it[yt+_[pe]]=m[H++]);return it}function vi(m,y){var _=-1,O=m.length;for(y||(y=Be(O));++_<O;)y[_]=m[_];return y}function mr(m,y,_,O){var H=!_;_||(_={});for(var ie=-1,pe=y.length;++ie<pe;){var Ne=y[ie],Ee=O?O(_[Ne],m[Ne],Ne,_,m):t;Ee===t&&(Ee=m[Ne]),H?va(_,Ne,Ee):Tl(_,Ne,Ee)}return _}function _f(m,y){return mr(m,nd(m),y)}function Ju(m,y){return mr(m,If(m),y)}function Rl(m,y){return function(_,O){var H=Lt(_)?Qd:wo,ie=y?y():{};return H(_,m,St(O,2),ie)}}function Ml(m){return Ht(function(y,_){var O=-1,H=_.length,ie=H>1?_[H-1]:t,pe=H>2?_[2]:t;for(ie=m.length>3&&typeof ie=="function"?(H--,ie):t,pe&&rr(_[0],_[1],pe)&&(ie=H<3?t:ie,H=1),y=ln(y);++O<H;){var Ne=_[O];Ne&&m(y,Ne,O,ie)}return y})}function Pp(m,y){return function(_,O){if(_==null)return _;if(!Si(_))return m(_,O);for(var H=_.length,ie=y?H:-1,pe=ln(_);(y?ie--:++ie<H)&&O(pe[ie],ie,pe)!==!1;);return _}}function Ol(m){return function(y,_,O){for(var H=-1,ie=ln(y),pe=O(y),Ne=pe.length;Ne--;){var Ee=pe[m?Ne:++H];if(_(ie[Ee],Ee,ie)===!1)break}return y}}function Ug(m,y,_){var O=y&T,H=Zr(m);function ie(){var pe=this&&this!==Un&&this instanceof ie?H:m;return pe.apply(O?_:this,arguments)}return ie}function Rr(m){return function(y){y=Nn(y);var _=xa(y)?lr(y):t,O=_?_[0]:y.charAt(0),H=_?Co(_,1).join(""):y.slice(1);return O[m]()+H}}function ir(m){return function(y){return ys(N(Fs(y).replace(Qi,"")),m,"")}}function Zr(m){return function(){var y=arguments;switch(y.length){case 0:return new m;case 1:return new m(y[0]);case 2:return new m(y[0],y[1]);case 3:return new m(y[0],y[1],y[2]);case 4:return new m(y[0],y[1],y[2],y[3]);case 5:return new m(y[0],y[1],y[2],y[3],y[4]);case 6:return new m(y[0],y[1],y[2],y[3],y[4],y[5]);case 7:return new m(y[0],y[1],y[2],y[3],y[4],y[5],y[6])}var _=Dr(m.prototype),O=m.apply(_,y);return ti(O)?O:_}}function Bg(m,y,_){var O=Zr(m);function H(){for(var ie=arguments.length,pe=Be(ie),Ne=ie,Ee=Fl(H);Ne--;)pe[Ne]=arguments[Ne];var Ke=ie<3&&pe[0]!==Ee&&pe[ie-1]!==Ee?[]:Ha(pe,Ee);if(ie-=Ke.length,ie<_)return Dp(m,y,li,H.placeholder,t,pe,Ke,t,t,_-ie);var Ze=this&&this!==Un&&this instanceof H?O:m;return $i(Ze,this,pe)}return H}function As(m){return function(y,_,O){var H=ln(y);if(!Si(y)){var ie=St(_,3);y=Ci(y),_=function(Ne){return ie(H[Ne],Ne,H)}}var pe=m(y,_,O);return pe>-1?H[ie?y[pe]:pe]:t}}function Ja(m){return Yn(function(y){var _=y.length,O=_,H=dr.prototype.thru;for(m&&y.reverse();O--;){var ie=y[O];if(typeof ie!="function")throw new er(l);if(H&&!pe&&td(ie)=="wrapper")var pe=new dr([],!0)}for(O=pe?O:_;++O<_;){ie=y[O];var Ne=td(ie),Ee=Ne=="wrapper"?Pf(ie):t;Ee&&Mf(Ee[0])&&Ee[1]==(z|I|L|F)&&!Ee[4].length&&Ee[9]==1?pe=pe[td(Ee[0])].apply(pe,Ee[3]):pe=ie.length==1&&Mf(ie)?pe[Ne]():pe.thru(ie)}return function(){var Ke=arguments,Ze=Ke[0];if(pe&&Ke.length==1&&Lt(Ze))return pe.plant(Ze).value();for(var it=0,mt=_?y[it].apply(this,Ke):Ze;++it<_;)mt=y[it].call(this,mt);return mt}})}function li(m,y,_,O,H,ie,pe,Ne,Ee,Ke){var Ze=y&z,it=y&T,mt=y&P,yt=y&(I|U),Rt=y&Q,en=mt?t:Zr(m);function Mt(){for(var un=arguments.length,bn=Be(un),_a=un;_a--;)bn[_a]=arguments[_a];if(yt)var $r=Fl(Mt),ka=Va(bn,$r);if(O&&(bn=Ap(bn,O,H,yt)),ie&&(bn=zg(bn,ie,pe,yt)),un-=ka,yt&&un<Ke){var ji=Ha(bn,$r);return Dp(m,y,li,Mt.placeholder,_,bn,ji,Ne,Ee,Ke-un)}var $s=it?_:this,Bl=mt?$s[m]:m;return un=bn.length,Ne?bn=Xa(bn,Ne):Rt&&un>1&&bn.reverse(),Ze&&Ee<un&&(bn.length=Ee),this&&this!==Un&&this instanceof Mt&&(Bl=en||Zr(Bl)),Bl.apply($s,bn)}return Mt}function Ku(m,y){return function(_,O){return pp(_,m,y(O),{})}}function Pc(m,y){return function(_,O){var H;if(_===t&&O===t)return y;if(_!==t&&(H=_),O!==t){if(H===t)return O;typeof _=="string"||typeof O=="string"?(_=pr(_),O=pr(O)):(_=Nf(_),O=Nf(O)),H=m(_,O)}return H}}function Xu(m){return Yn(function(y){return y=Bn(y,Xi(St())),Ht(function(_){var O=this;return m(y,function(H){return $i(H,O,_)})})})}function Zu(m,y){y=y===t?" ":pr(y);var _=y.length;if(_<2)return _?Np(y,m):y;var O=Np(y,Sc(m/Yr(y)));return xa(y)?Co(lr(O),0,m).join(""):O.slice(0,m)}function qg(m,y,_,O){var H=y&T,ie=Zr(m);function pe(){for(var Ne=-1,Ee=arguments.length,Ke=-1,Ze=O.length,it=Be(Ze+Ee),mt=this&&this!==Un&&this instanceof pe?ie:m;++Ke<Ze;)it[Ke]=O[Ke];for(;Ee--;)it[Ke++]=arguments[++Ne];return $i(mt,H?_:this,it)}return pe}function jo(m){return function(y,_,O){return O&&typeof O!="number"&&rr(y,_,O)&&(_=O=t),y=ns(y),_===t?(_=y,y=0):_=ns(_),O=O===t?y<_?1:-1:ns(O),Dg(y,_,O,m)}}function Ll(m){return function(y,_){return typeof y=="string"&&typeof _=="string"||(y=ia(y),_=ia(_)),m(y,_)}}function Dp(m,y,_,O,H,ie,pe,Ne,Ee,Ke){var Ze=y&I,it=Ze?pe:t,mt=Ze?t:pe,yt=Ze?ie:t,Rt=Ze?t:ie;y|=Ze?L:$,y&=~(Ze?$:L),y&M||(y&=-4);var en=[m,y,H,yt,it,Rt,mt,Ne,Ee,Ke],Mt=_.apply(t,en);return Mf(m)&&Ff(Mt,en),Mt.placeholder=O,$f(Mt,m,y)}function kf(m){var y=si[m];return function(_,O){if(_=ia(_),O=O==null?0:Xn(Ut(O),292),O&&Eu(_)){var H=(Nn(_)+"e").split("e"),ie=y(H[0]+"e"+(+H[1]+O));return H=(Nn(ie)+"e").split("e"),+(H[0]+"e"+(+H[1]-O))}return y(_)}}var Vg=an&&1/bl(new an([,-0]))[1]==W?function(m){return new an(m)}:gt;function ed(m){return function(y){var _=Ti(y);return _==Me?xl(y):_==_e?Zh(y):Xh(y,m(y))}}function Ka(m,y,_,O,H,ie,pe,Ne){var Ee=y&P;if(!Ee&&typeof m!="function")throw new er(l);var Ke=O?O.length:0;if(Ke||(y&=-97,O=H=t),pe=pe===t?pe:Gn(Ut(pe),0),Ne=Ne===t?Ne:Ut(Ne),Ke-=H?H.length:0,y&$){var Ze=O,it=H;O=H=t}var mt=Ee?t:Pf(m),yt=[m,y,_,O,H,Ze,it,ie,pe,Ne];if(mt&&ad(yt,mt),m=yt[0],y=yt[1],_=yt[2],O=yt[3],H=yt[4],Ne=yt[9]=yt[9]===t?Ee?0:m.length:Gn(yt[9]-Ke,0),!Ne&&y&(I|U)&&(y&=-25),!y||y==T)var Rt=Ug(m,y,_);else y==I||y==U?Rt=Bg(m,y,Ne):(y==L||y==(T|L))&&!H.length?Rt=qg(m,y,_,O):Rt=li.apply(t,yt);var en=mt?Bu:Ff;return $f(en(Rt,yt),m,y)}function Tf(m,y,_,O){return m===t||br(m,ws[_])&&!te.call(O,_)?y:m}function Ip(m,y,_,O,H,ie){return ti(m)&&ti(y)&&(ie.set(y,m),Uu(m,y,t,Ip,ie),ie.delete(y)),m}function Hg(m){return na(m)?t:m}function Gg(m,y,_,O,H,ie){var pe=_&S,Ne=m.length,Ee=y.length;if(Ne!=Ee&&!(pe&&Ee>Ne))return!1;var Ke=ie.get(m),Ze=ie.get(y);if(Ke&&Ze)return Ke==y&&Ze==m;var it=-1,mt=!0,yt=_&k?new js:t;for(ie.set(m,y),ie.set(y,m);++it<Ne;){var Rt=m[it],en=y[it];if(O)var Mt=pe?O(en,Rt,it,y,m,ie):O(Rt,en,it,m,y,ie);if(Mt!==t){if(Mt)continue;mt=!1;break}if(yt){if(!Ua(y,function(un,bn){if(!ho(yt,bn)&&(Rt===un||H(Rt,un,_,O,ie)))return yt.push(bn)})){mt=!1;break}}else if(!(Rt===en||H(Rt,en,_,O,ie))){mt=!1;break}}return ie.delete(m),ie.delete(y),mt}function Yg(m,y,_,O,H,ie,pe){switch(_){case qe:if(m.byteLength!=y.byteLength||m.byteOffset!=y.byteOffset)return!1;m=m.buffer,y=y.buffer;case fe:return!(m.byteLength!=y.byteLength||!ie(new zi(m),new zi(y)));case ae:case Re:case et:return br(+m,+y);case Ce:return m.name==y.name&&m.message==y.message;case jt:case Fe:return m==y+"";case Me:var Ne=xl;case _e:var Ee=O&S;if(Ne||(Ne=bl),m.size!=y.size&&!Ee)return!1;var Ke=pe.get(m);if(Ke)return Ke==y;O|=k,pe.set(m,y);var Ze=Gg(Ne(m),Ne(y),O,H,ie,pe);return pe.delete(m),Ze;case Pe:if(jl)return jl.call(m)==jl.call(y)}return!1}function ki(m,y,_,O,H,ie){var pe=_&S,Ne=Ef(m),Ee=Ne.length,Ke=Ef(y),Ze=Ke.length;if(Ee!=Ze&&!pe)return!1;for(var it=Ee;it--;){var mt=Ne[it];if(!(pe?mt in y:te.call(y,mt)))return!1}var yt=ie.get(m),Rt=ie.get(y);if(yt&&Rt)return yt==y&&Rt==m;var en=!0;ie.set(m,y),ie.set(y,m);for(var Mt=pe;++it<Ee;){mt=Ne[it];var un=m[mt],bn=y[mt];if(O)var _a=pe?O(bn,un,mt,y,m,ie):O(un,bn,mt,m,y,ie);if(!(_a===t?un===bn||H(un,bn,_,O,ie):_a)){en=!1;break}Mt||(Mt=mt=="constructor")}if(en&&!Mt){var $r=m.constructor,ka=y.constructor;$r!=ka&&"constructor"in m&&"constructor"in y&&!(typeof $r=="function"&&$r instanceof $r&&typeof ka=="function"&&ka instanceof ka)&&(en=!1)}return ie.delete(m),ie.delete(y),en}function Yn(m){return sd(Fp(m,t,yr),m+"")}function Ef(m){return _g(m,Ci,nd)}function Af(m){return _g(m,Ei,If)}var Pf=Nc?function(m){return Nc.get(m)}:gt;function td(m){for(var y=m.name+"",_=Jr[y],O=te.call(Jr,y)?_.length:0;O--;){var H=_[O],ie=H.func;if(ie==null||ie==m)return H.name}return y}function Fl(m){var y=te.call(K,"placeholder")?K:m;return y.placeholder}function St(){var m=K.iteratee||At;return m=m===At?yp:m,arguments.length?m(arguments[0],arguments[1]):m}function Dc(m,y){var _=m.__data__;return Ds(y)?_[typeof y=="string"?"string":"hash"]:_.map}function Df(m){for(var y=Ci(m),_=y.length;_--;){var O=y[_],H=m[O];y[_]=[O,H,Kg(H)]}return y}function _o(m,y){var _=bc(m,y);return Qa(_)?_:t}function Wg(m){var y=te.call(m,tr),_=m[tr];try{m[tr]=t;var O=!0}catch{}var H=we.call(m);return O&&(y?m[tr]=_:delete m[tr]),H}var nd=xo?function(m){return m==null?[]:(m=ln(m),Ki(xo(m),function(y){return wl.call(m,y)}))}:Mv,If=xo?function(m){for(var y=[];m;)Hr(y,nd(m)),m=_u(m);return y}:Mv,Ti=cn;(Au&&Ti(new Au(new ArrayBuffer(1)))!=qe||bi&&Ti(new bi)!=Me||Zn&&Ti(Zn.resolve())!=at||an&&Ti(new an)!=_e||ba&&Ti(new ba)!=ve)&&(Ti=function(m){var y=cn(m),_=y==ut?m.constructor:t,O=_?Is(_):"";if(O)switch(O){case pg:return qe;case mg:return Me;case Pu:return at;case Du:return _e;case gg:return ve}return y});function Qg(m,y,_){for(var O=-1,H=_.length;++O<H;){var ie=_[O],pe=ie.size;switch(ie.type){case"drop":m+=pe;break;case"dropRight":y-=pe;break;case"take":y=Xn(y,m+pe);break;case"takeRight":m=Gn(m,y-pe);break}}return{start:m,end:y}}function Rp(m){var y=m.match(Qh);return y?y[1].split(Zo):[]}function id(m,y,_){y=Es(y,m);for(var O=-1,H=y.length,ie=!1;++O<H;){var pe=Cn(y[O]);if(!(ie=m!=null&&_(m,pe)))break;m=m[pe]}return ie||++O!=H?ie:(H=m==null?0:m.length,!!H&&Ul(H)&&Na(pe,H)&&(Lt(m)||Ls(m)))}function Mp(m){var y=m.length,_=new m.constructor(y);return y&&typeof m[0]=="string"&&te.call(m,"index")&&(_.index=m.index,_.input=m.input),_}function Op(m){return typeof m.constructor=="function"&&!Ln(m)?Dr(_u(m)):{}}function Lp(m,y,_){var O=m.constructor;switch(y){case fe:return Il(m);case ae:case Re:return new O(+m);case qe:return Tp(m,_);case nt:case lt:case wt:case Ve:case be:case ye:case Oe:case He:case tt:return Ep(m,_);case Me:return new O;case et:case Fe:return new O(m);case jt:return jf(m);case _e:return new O;case Pe:return Fg(m)}}function Jg(m,y){var _=y.length;if(!_)return m;var O=_-1;return y[O]=(_>1?"& ":"")+y[O],y=y.join(_>2?", ":" "),m.replace(bu,`{
/* [wrapped with `+y+`] */
`)}function Ps(m){return Lt(m)||Ls(m)||!!(cr&&m&&m[cr])}function Na(m,y){var _=typeof m;return y=y??J,!!y&&(_=="number"||_!="symbol"&&fs.test(m))&&m>-1&&m%1==0&&m<y}function rr(m,y,_){if(!ti(_))return!1;var O=typeof y;return(O=="number"?Si(_)&&Na(y,_.length):O=="string"&&y in _)?br(_[y],m):!1}function Rf(m,y){if(Lt(m))return!1;var _=typeof m;return _=="number"||_=="symbol"||_=="boolean"||m==null||ar(m)?!0:Ws.test(m)||!Ys.test(m)||y!=null&&m in ln(y)}function Ds(m){var y=typeof m;return y=="string"||y=="number"||y=="symbol"||y=="boolean"?m!=="__proto__":m===null}function Mf(m){var y=td(m),_=K[y];if(typeof _!="function"||!(y in Xt.prototype))return!1;if(m===_)return!0;var O=Pf(_);return!!O&&m===O[0]}function Of(m){return!!le&&le in m}var rd=go?Ca:Ov;function Ln(m){var y=m&&m.constructor,_=typeof y=="function"&&y.prototype||ws;return m===_}function Kg(m){return m===m&&!ti(m)}function Xg(m,y){return function(_){return _==null?!1:_[m]===y&&(y!==t||m in ln(_))}}function Zg(m){var y=gd(m,function(O){return _.size===u&&_.clear(),O}),_=y.cache;return y}function ad(m,y){var _=m[1],O=y[1],H=_|O,ie=H<(T|P|z),pe=O==z&&_==I||O==z&&_==F&&m[7].length<=y[8]||O==(z|F)&&y[7].length<=y[8]&&_==I;if(!(ie||pe))return m;O&T&&(m[2]=y[2],H|=_&T?0:M);var Ne=y[3];if(Ne){var Ee=m[3];m[3]=Ee?Ap(Ee,Ne,y[4]):Ne,m[4]=Ee?Ha(m[3],p):y[4]}return Ne=y[5],Ne&&(Ee=m[5],m[5]=Ee?zg(Ee,Ne,y[6]):Ne,m[6]=Ee?Ha(m[5],p):y[6]),Ne=y[7],Ne&&(m[7]=Ne),O&z&&(m[8]=m[8]==null?y[8]:Xn(m[8],y[8])),m[9]==null&&(m[9]=y[9]),m[0]=y[0],m[1]=H,m}function ko(m){var y=[];if(m!=null)for(var _ in ln(m))y.push(_);return y}function ey(m){return we.call(m)}function Fp(m,y,_){return y=Gn(y===t?m.length-1:y,0),function(){for(var O=arguments,H=-1,ie=Gn(O.length-y,0),pe=Be(ie);++H<ie;)pe[H]=O[y+H];H=-1;for(var Ne=Be(y+1);++H<y;)Ne[H]=O[H];return Ne[y]=_(pe),$i(m,this,Ne)}}function Ic(m,y){return y.length<2?m:Xr(m,Ir(y,0,-1))}function Xa(m,y){for(var _=m.length,O=Xn(y.length,_),H=vi(m);O--;){var ie=y[O];m[O]=Na(ie,_)?H[ie]:t}return m}function Lf(m,y){if(!(y==="constructor"&&typeof m[y]=="function")&&y!="__proto__")return m[y]}var Ff=od(Bu),Rc=ip||function(m,y){return Un.setTimeout(m,y)},sd=od(qu);function $f(m,y,_){var O=y+"";return sd(m,Jg(O,ty(Rp(O),_)))}function od(m){var y=0,_=0;return function(){var O=Cs(),H=re-(O-_);if(_=O,H>0){if(++y>=Y)return arguments[0]}else y=0;return m.apply(t,arguments)}}function ld(m,y){var _=-1,O=m.length,H=O-1;for(y=y===t?O:y;++_<y;){var ie=vf(_,H),pe=m[ie];m[ie]=m[_],m[_]=pe}return m.length=y,m}var Za=Zg(function(m){var y=[];return m.charCodeAt(0)===46&&y.push(""),m.replace(Fi,function(_,O,H,ie){y.push(H?ie.replace(ds,"$1"):O||_)}),y});function Cn(m){if(typeof m=="string"||ar(m))return m;var y=m+"";return y=="0"&&1/m==-1/0?"-0":y}function Is(m){if(m!=null){try{return yo.call(m)}catch{}try{return m+""}catch{}}return""}function ty(m,y){return xi(oe,function(_){var O="_."+_[0];y&_[1]&&!ga(m,O)&&m.push(O)}),m.sort()}function wi(m){if(m instanceof Xt)return m.clone();var y=new dr(m.__wrapped__,m.__chain__);return y.__actions__=vi(m.__actions__),y.__index__=m.__index__,y.__values__=m.__values__,y}function Zb(m,y,_){(_?rr(m,y,_):y===t)?y=1:y=Gn(Ut(y),0);var O=m==null?0:m.length;if(!O||y<1)return[];for(var H=0,ie=0,pe=Be(Sc(O/y));H<O;)pe[ie++]=Ir(m,H,H+=y);return pe}function ny(m){for(var y=-1,_=m==null?0:m.length,O=0,H=[];++y<_;){var ie=m[y];ie&&(H[O++]=ie)}return H}function iy(){var m=arguments.length;if(!m)return[];for(var y=Be(m-1),_=arguments[0],O=m;O--;)y[O-1]=arguments[O];return Hr(Lt(_)?vi(_):[_],sn(y,1))}var ei=Ht(function(m,y){return ui(m)?So(m,sn(y,1,ui,!0)):[]}),gr=Ht(function(m,y){var _=qi(y);return ui(_)&&(_=t),ui(m)?So(m,sn(y,1,ui,!0),St(_,2)):[]}),Rs=Ht(function(m,y){var _=qi(y);return ui(_)&&(_=t),ui(m)?So(m,sn(y,1,ui,!0),t,_):[]});function ry(m,y,_){var O=m==null?0:m.length;return O?(y=_||y===t?1:Ut(y),Ir(m,y<0?0:y,O)):[]}function ay(m,y,_){var O=m==null?0:m.length;return O?(y=_||y===t?1:Ut(y),y=O-y,Ir(m,0,y<0?0:y)):[]}function ev(m,y){return m&&m.length?Gu(m,St(y,3),!0,!0):[]}function $p(m,y){return m&&m.length?Gu(m,St(y,3),!0):[]}function Mr(m,y,_,O){var H=m==null?0:m.length;return H?(_&&typeof _!="number"&&rr(m,y,_)&&(_=0,O=H),Qt(m,y,_,O)):[]}function ea(m,y,_){var O=m==null?0:m.length;if(!O)return-1;var H=_==null?0:Ut(_);return H<0&&(H=Gn(O+H,0)),Ba(m,St(y,3),H)}function zp(m,y,_){var O=m==null?0:m.length;if(!O)return-1;var H=O-1;return _!==t&&(H=Ut(_),H=_<0?Gn(O+H,0):Xn(H,O-1)),Ba(m,St(y,3),H,!0)}function yr(m){var y=m==null?0:m.length;return y?sn(m,1):[]}function sy(m){var y=m==null?0:m.length;return y?sn(m,W):[]}function To(m,y){var _=m==null?0:m.length;return _?(y=y===t?1:Ut(y),sn(m,y)):[]}function $l(m){for(var y=-1,_=m==null?0:m.length,O={};++y<_;){var H=m[y];O[H[0]]=H[1]}return O}function Ms(m){return m&&m.length?m[0]:t}function Up(m,y,_){var O=m==null?0:m.length;if(!O)return-1;var H=_==null?0:Ut(_);return H<0&&(H=Gn(O+H,0)),fo(m,y,H)}function Bp(m){var y=m==null?0:m.length;return y?Ir(m,0,-1):[]}var es=Ht(function(m){var y=Bn(m,Cf);return y.length&&y[0]===m[0]?hp(y):[]}),oy=Ht(function(m){var y=qi(m),_=Bn(m,Cf);return y===qi(_)?y=t:_.pop(),_.length&&_[0]===m[0]?hp(_,St(y,2)):[]}),Mc=Ht(function(m){var y=qi(m),_=Bn(m,Cf);return y=typeof y=="function"?y:t,y&&_.pop(),_.length&&_[0]===m[0]?hp(_,t,y):[]});function cd(m,y){return m==null?"":Wr.call(m,y)}function qi(m){var y=m==null?0:m.length;return y?m[y-1]:t}function Oc(m,y,_){var O=m==null?0:m.length;if(!O)return-1;var H=O;return _!==t&&(H=Ut(_),H=H<0?Gn(O+H,0):Xn(H,O-1)),y===y?Zi(m,y,H):Ba(m,bs,H,!0)}function ly(m,y){return m&&m.length?vp(m,Ut(y)):t}var cy=Ht(Lc);function Lc(m,y){return m&&m.length&&y&&y.length?bf(m,y):m}function uy(m,y,_){return m&&m.length&&y&&y.length?bf(m,y,St(_,2)):m}function zf(m,y,_){return m&&m.length&&y&&y.length?bf(m,y,t,_):m}var dy=Yn(function(m,y){var _=m==null?0:m.length,O=Lu(m,y);return Sp(m,Bn(y,function(H){return Na(H,_)?+H:H}).sort(Qu)),O});function tv(m,y){var _=[];if(!(m&&m.length))return _;var O=-1,H=[],ie=m.length;for(y=St(y,3);++O<ie;){var pe=m[O];y(pe,O,m)&&(_.push(pe),H.push(O))}return Sp(m,H),_}function qp(m){return m==null?m:ap.call(m)}function _n(m,y,_){var O=m==null?0:m.length;return O?(_&&typeof _!="number"&&rr(m,y,_)?(y=0,_=O):(y=y==null?0:Ut(y),_=_===t?O:Ut(_)),Ir(m,y,_)):[]}function Vn(m,y){return Vu(m,y)}function tn(m,y,_){return Sf(m,y,St(_,2))}function pn(m,y){var _=m==null?0:m.length;if(_){var O=Vu(m,y);if(O<_&&br(m[O],y))return O}return-1}function kn(m,y){return Vu(m,y,!0)}function Or(m,y,_){return Sf(m,y,St(_,2),!0)}function Eo(m,y){var _=m==null?0:m.length;if(_){var O=Vu(m,y,!0)-1;if(br(m[O],y))return O}return-1}function Fc(m){return m&&m.length?Cp(m):[]}function Vp(m,y){return m&&m.length?Cp(m,St(y,2)):[]}function Os(m){var y=m==null?0:m.length;return y?Ir(m,1,y):[]}function ci(m,y,_){return m&&m.length?(y=_||y===t?1:Ut(y),Ir(m,0,y<0?0:y)):[]}function Ao(m,y,_){var O=m==null?0:m.length;return O?(y=_||y===t?1:Ut(y),y=O-y,Ir(m,y<0?0:y,O)):[]}function zl(m,y){return m&&m.length?Gu(m,St(y,3),!1,!0):[]}function Hp(m,y){return m&&m.length?Gu(m,St(y,3)):[]}var ta=Ht(function(m){return Ts(sn(m,1,ui,!0))}),$c=Ht(function(m){var y=qi(m);return ui(y)&&(y=t),Ts(sn(m,1,ui,!0),St(y,2))}),ud=Ht(function(m){var y=qi(m);return y=typeof y=="function"?y:t,Ts(sn(m,1,ui,!0),t,y)});function xr(m){return m&&m.length?Ts(m):[]}function Gp(m,y){return m&&m.length?Ts(m,St(y,2)):[]}function Yp(m,y){return y=typeof y=="function"?y:t,m&&m.length?Ts(m,t,y):[]}function zc(m){if(!(m&&m.length))return[];var y=0;return m=Ki(m,function(_){if(ui(_))return y=Gn(_.length,y),!0}),qa(y,function(_){return Bn(m,gl(_))})}function dd(m,y){if(!(m&&m.length))return[];var _=zc(m);return y==null?_:Bn(_,function(O){return $i(y,t,O)})}var Po=Ht(function(m,y){return ui(m)?So(m,y):[]}),Oi=Ht(function(m){return Yu(Ki(m,ui))}),Do=Ht(function(m){var y=qi(m);return ui(y)&&(y=t),Yu(Ki(m,ui),St(y,2))}),Uc=Ht(function(m){var y=qi(m);return y=typeof y=="function"?y:t,Yu(Ki(m,ui),t,y)}),Bc=Ht(zc);function Wp(m,y){return _p(m||[],y||[],Tl)}function Qp(m,y){return _p(m||[],y||[],Ac)}var fy=Ht(function(m){var y=m.length,_=y>1?m[y-1]:t;return _=typeof _=="function"?(m.pop(),_):t,dd(m,_)});function qc(m){var y=K(m);return y.__chain__=!0,y}function Jp(m,y){return y(m),m}function Vi(m,y){return y(m)}var hy=Yn(function(m){var y=m.length,_=y?m[0]:0,O=this.__wrapped__,H=function(ie){return Lu(ie,m)};return y>1||this.__actions__.length||!(O instanceof Xt)||!Na(_)?this.thru(H):(O=O.slice(_,+_+(y?1:0)),O.__actions__.push({func:Vi,args:[H],thisArg:t}),new dr(O,this.__chain__).thru(function(ie){return y&&!ie.length&&ie.push(t),ie}))});function Lr(){return qc(this)}function py(){return new dr(this.value(),this.__chain__)}function my(){this.__values__===t&&(this.__values__=Fr(this.value()));var m=this.__index__>=this.__values__.length,y=m?t:this.__values__[this.__index__++];return{done:m,value:y}}function nv(){return this}function Io(m){for(var y,_=this;_ instanceof Kr;){var O=wi(_);O.__index__=0,O.__values__=t,y?H.__wrapped__=O:y=O;var H=O;_=_.__wrapped__}return H.__wrapped__=m,y}function Uf(){var m=this.__wrapped__;if(m instanceof Xt){var y=m;return this.__actions__.length&&(y=new Xt(this)),y=y.reverse(),y.__actions__.push({func:Vi,args:[qp],thisArg:t}),new dr(y,this.__chain__)}return this.thru(qp)}function Kp(){return Mg(this.__wrapped__,this.__actions__)}var Vc=Rl(function(m,y,_){te.call(m,_)?++m[_]:va(m,_,1)});function gy(m,y,_){var O=Lt(m)?mc:dp;return _&&rr(m,y,_)&&(y=t),O(m,St(y,3))}function yy(m,y){var _=Lt(m)?Ki:jn;return _(m,St(y,3))}var xy=As(ea),Xp=As(zp);function Zp(m,y){return sn(fd(m,y),1)}function iv(m,y){return sn(fd(m,y),W)}function rv(m,y,_){return _=_===t?1:Ut(_),sn(fd(m,y),_)}function by(m,y){var _=Lt(m)?xi:ks;return _(m,St(y,3))}function em(m,y){var _=Lt(m)?Jd:df;return _(m,St(y,3))}var vy=Rl(function(m,y,_){te.call(m,_)?m[_].push(y):va(m,_,[y])});function Hc(m,y,_,O){m=Si(m)?m:Xc(m),_=_&&!O?Ut(_):0;var H=m.length;return _<0&&(_=Gn(H+_,0)),Zf(m)?_<=H&&m.indexOf(y,_)>-1:!!H&&fo(m,y,_)>-1}var Bf=Ht(function(m,y,_){var O=-1,H=typeof y=="function",ie=Si(m)?Be(m.length):[];return ks(m,function(pe){ie[++O]=H?$i(y,pe,_):Pl(pe,y,_)}),ie}),wy=Rl(function(m,y,_){va(m,_,y)});function fd(m,y){var _=Lt(m)?Bn:xp;return _(m,St(y,3))}function Sy(m,y,_,O){return m==null?[]:(Lt(y)||(y=y==null?[]:[y]),_=O?t:_,Lt(_)||(_=_==null?[]:[_]),wp(m,y,_))}var Ny=Rl(function(m,y,_){m[_?0:1].push(y)},function(){return[[],[]]});function Cy(m,y,_){var O=Lt(m)?ys:wu,H=arguments.length<3;return O(m,St(y,4),_,H,ks)}function jy(m,y,_){var O=Lt(m)?Jh:wu,H=arguments.length<3;return O(m,St(y,4),_,H,df)}function qf(m,y){var _=Lt(m)?Ki:jn;return _(m,yd(St(y,3)))}function _y(m){var y=Lt(m)?jc:Ec;return y(m)}function ky(m,y,_){(_?rr(m,y,_):y===t)?y=1:y=Ut(y);var O=Lt(m)?Ng:wf;return O(m,y)}function Fn(m){var y=Lt(m)?Cg:Ig;return y(m)}function tm(m){if(m==null)return 0;if(Si(m))return Zf(m)?Yr(m):m.length;var y=Ti(m);return y==Me||y==_e?m.size:mf(m).length}function av(m,y,_){var O=Lt(m)?Ua:Rg;return _&&rr(m,y,_)&&(y=t),O(m,St(y,3))}var Ty=Ht(function(m,y){if(m==null)return[];var _=y.length;return _>1&&rr(m,y[0],y[1])?y=[]:_>2&&rr(y[0],y[1],y[2])&&(y=[y[0]]),wp(m,sn(y,1),[])}),Vf=Nl||function(){return Un.Date.now()};function sv(m,y){if(typeof y!="function")throw new er(l);return m=Ut(m),function(){if(--m<1)return y.apply(this,arguments)}}function Ey(m,y,_){return y=_?t:y,y=m&&y==null?m.length:y,Ka(m,z,t,t,t,t,y)}function hd(m,y){var _;if(typeof y!="function")throw new er(l);return m=Ut(m),function(){return--m>0&&(_=y.apply(this,arguments)),m<=1&&(y=t),_}}var Ro=Ht(function(m,y,_){var O=T;if(_.length){var H=Ha(_,Fl(Ro));O|=L}return Ka(m,O,y,_,H)}),Hf=Ht(function(m,y,_){var O=T|P;if(_.length){var H=Ha(_,Fl(Hf));O|=L}return Ka(y,O,m,_,H)});function pd(m,y,_){y=_?t:y;var O=Ka(m,I,t,t,t,t,t,y);return O.placeholder=pd.placeholder,O}function Gf(m,y,_){y=_?t:y;var O=Ka(m,U,t,t,t,t,t,y);return O.placeholder=Gf.placeholder,O}function Mo(m,y,_){var O,H,ie,pe,Ne,Ee,Ke=0,Ze=!1,it=!1,mt=!0;if(typeof m!="function")throw new er(l);y=ia(y)||0,ti(_)&&(Ze=!!_.leading,it="maxWait"in _,ie=it?Gn(ia(_.maxWait)||0,y):ie,mt="trailing"in _?!!_.trailing:mt);function yt(ji){var $s=O,Bl=H;return O=H=t,Ke=ji,pe=m.apply(Bl,$s),pe}function Rt(ji){return Ke=ji,Ne=Rc(un,y),Ze?yt(ji):pe}function en(ji){var $s=ji-Ee,Bl=ji-Ke,sS=y-$s;return it?Xn(sS,ie-Bl):sS}function Mt(ji){var $s=ji-Ee,Bl=ji-Ke;return Ee===t||$s>=y||$s<0||it&&Bl>=ie}function un(){var ji=Vf();if(Mt(ji))return bn(ji);Ne=Rc(un,en(ji))}function bn(ji){return Ne=t,mt&&O?yt(ji):(O=H=t,pe)}function _a(){Ne!==t&&Lg(Ne),Ke=0,O=Ee=H=Ne=t}function $r(){return Ne===t?pe:bn(Vf())}function ka(){var ji=Vf(),$s=Mt(ji);if(O=arguments,H=this,Ee=ji,$s){if(Ne===t)return Rt(Ee);if(it)return Lg(Ne),Ne=Rc(un,y),yt(Ee)}return Ne===t&&(Ne=Rc(un,y)),pe}return ka.cancel=_a,ka.flush=$r,ka}var ts=Ht(function(m,y){return El(m,1,y)}),md=Ht(function(m,y,_){return El(m,ia(y)||0,_)});function ov(m){return Ka(m,Q)}function gd(m,y){if(typeof m!="function"||y!=null&&typeof y!="function")throw new er(l);var _=function(){var O=arguments,H=y?y.apply(this,O):O[0],ie=_.cache;if(ie.has(H))return ie.get(H);var pe=m.apply(this,O);return _.cache=ie.set(H,pe)||ie,pe};return _.cache=new(gd.Cache||fr),_}gd.Cache=fr;function yd(m){if(typeof m!="function")throw new er(l);return function(){var y=arguments;switch(y.length){case 0:return!m.call(this);case 1:return!m.call(this,y[0]);case 2:return!m.call(this,y[0],y[1]);case 3:return!m.call(this,y[0],y[1],y[2])}return!m.apply(this,y)}}function Ay(m){return hd(2,m)}var Py=Og(function(m,y){y=y.length==1&&Lt(y[0])?Bn(y[0],Xi(St())):Bn(sn(y,1),Xi(St()));var _=y.length;return Ht(function(O){for(var H=-1,ie=Xn(O.length,_);++H<ie;)O[H]=y[H].call(this,O[H]);return $i(m,this,O)})}),nm=Ht(function(m,y){var _=Ha(y,Fl(nm));return Ka(m,L,t,y,_)}),Yf=Ht(function(m,y){var _=Ha(y,Fl(Yf));return Ka(m,$,t,y,_)}),Dy=Yn(function(m,y){return Ka(m,F,t,t,t,y)});function Iy(m,y){if(typeof m!="function")throw new er(l);return y=y===t?y:Ut(y),Ht(m,y)}function lv(m,y){if(typeof m!="function")throw new er(l);return y=y==null?0:Gn(Ut(y),0),Ht(function(_){var O=_[y],H=Co(_,0,y);return O&&Hr(H,O),$i(m,this,H)})}function im(m,y,_){var O=!0,H=!0;if(typeof m!="function")throw new er(l);return ti(_)&&(O="leading"in _?!!_.leading:O,H="trailing"in _?!!_.trailing:H),Mo(m,y,{leading:O,maxWait:y,trailing:H})}function rm(m){return Ey(m,1)}function cv(m,y){return nm(Wu(y),m)}function uv(){if(!arguments.length)return[];var m=arguments[0];return Lt(m)?m:[m]}function xd(m){return Ui(m,v)}function dv(m,y){return y=typeof y=="function"?y:t,Ui(m,v,y)}function Ry(m){return Ui(m,g|v)}function nn(m,y){return y=typeof y=="function"?y:t,Ui(m,g|v,y)}function am(m,y){return y==null||up(m,y,Ci(y))}function br(m,y){return m===y||m!==m&&y!==y}var sm=Ll(Fu),My=Ll(function(m,y){return m>=y}),Ls=ff(function(){return arguments}())?ff:function(m){return ai(m)&&te.call(m,"callee")&&!wl.call(m,"callee")},Lt=Be.isArray,Wf=yn?Xi(yn):hr;function Si(m){return m!=null&&Ul(m.length)&&!Ca(m)}function ui(m){return ai(m)&&Si(m)}function fv(m){return m===!0||m===!1||ai(m)&&cn(m)==ae}var Oo=af||Ov,Oy=hc?Xi(hc):mi;function Ly(m){return ai(m)&&m.nodeType===1&&!na(m)}function Qf(m){if(m==null)return!0;if(Si(m)&&(Lt(m)||typeof m=="string"||typeof m.splice=="function"||Oo(m)||Gc(m)||Ls(m)))return!m.length;var y=Ti(m);if(y==Me||y==_e)return!m.size;if(Ln(m))return!mf(m).length;for(var _ in m)if(te.call(m,_))return!1;return!0}function In(m,y){return Dl(m,y)}function om(m,y,_){_=typeof _=="function"?_:t;var O=_?_(m,y):t;return O===t?Dl(m,y,t,_):!!O}function Ni(m){if(!ai(m))return!1;var y=cn(m);return y==Ce||y==Ae||typeof m.message=="string"&&typeof m.name=="string"&&!na(m)}function hv(m){return typeof m=="number"&&Eu(m)}function Ca(m){if(!ti(m))return!1;var y=cn(m);return y==Se||y==De||y==ue||y==qt}function Jf(m){return typeof m=="number"&&m==Ut(m)}function Ul(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=J}function ti(m){var y=typeof m;return m!=null&&(y=="object"||y=="function")}function ai(m){return m!=null&&typeof m=="object"}var Kf=hl?Xi(hl):hf;function lm(m,y){return m===y||zu(m,y,Df(y))}function pv(m,y,_){return _=typeof _=="function"?_:t,zu(m,y,Df(y),_)}function Fy(m){return zy(m)&&m!=+m}function mv(m){if(rd(m))throw new kt(o);return Qa(m)}function $y(m){return m===null}function gv(m){return m==null}function zy(m){return typeof m=="number"||ai(m)&&cn(m)==et}function na(m){if(!ai(m)||cn(m)!=ut)return!1;var y=_u(m);if(y===null)return!0;var _=te.call(y,"constructor")&&y.constructor;return typeof _=="function"&&_ instanceof _&&yo.call(_)==We}var Xf=pc?Xi(pc):pf;function cm(m){return Jf(m)&&m>=-9007199254740991&&m<=J}var Uy=lo?Xi(lo):mp;function Zf(m){return typeof m=="string"||!Lt(m)&&ai(m)&&cn(m)==Fe}function ar(m){return typeof m=="symbol"||ai(m)&&cn(m)==Pe}var Gc=co?Xi(co):gp;function ja(m){return m===t}function um(m){return ai(m)&&Ti(m)==ve}function By(m){return ai(m)&&cn(m)==ee}var qy=Ll(gf),bd=Ll(function(m,y){return m<=y});function Fr(m){if(!m)return[];if(Si(m))return Zf(m)?lr(m):vi(m);if(Sl&&m[Sl])return mo(m[Sl]());var y=Ti(m),_=y==Me?xl:y==_e?bl:Xc;return _(m)}function ns(m){if(!m)return m===0?m:0;if(m=ia(m),m===W||m===-1/0){var y=m<0?-1:1;return y*he}return m===m?m:0}function Ut(m){var y=ns(m),_=y%1;return y===y?_?y-_:y:0}function is(m){return m?wa(Ut(m),0,ce):0}function ia(m){if(typeof m=="number")return m;if(ar(m))return A;if(ti(m)){var y=typeof m.valueOf=="function"?m.valueOf():m;m=ti(y)?y+"":y}if(typeof m!="string")return m===0?m:+m;m=Zd(m);var _=pi.test(m);return _||Hd.test(m)?Wd(m.slice(2),_?2:8):Xs.test(m)?A:+m}function Vy(m){return mr(m,Ei(m))}function Yc(m){return m?wa(Ut(m),-9007199254740991,J):m===0?m:0}function Nn(m){return m==null?"":pr(m)}var yv=Ml(function(m,y){if(Ln(y)||Si(y)){mr(y,Ci(y),m);return}for(var _ in y)te.call(y,_)&&Tl(m,_,y[_])}),Hy=Ml(function(m,y){mr(y,Ei(y),m)}),eh=Ml(function(m,y,_,O){mr(y,Ei(y),m,O)}),xv=Ml(function(m,y,_,O){mr(y,Ci(y),m,O)}),bv=Yn(Lu);function vv(m,y){var _=Dr(m);return y==null?_:_s(_,y)}var wv=Ht(function(m,y){m=ln(m);var _=-1,O=y.length,H=O>2?y[2]:t;for(H&&rr(y[0],y[1],H)&&(O=1);++_<O;)for(var ie=y[_],pe=Ei(ie),Ne=-1,Ee=pe.length;++Ne<Ee;){var Ke=pe[Ne],Ze=m[Ke];(Ze===t||br(Ze,ws[Ke])&&!te.call(m,Ke))&&(m[Ke]=ie[Ke])}return m}),Gy=Ht(function(m){return m.push(t,Ip),$i(Nd,t,m)});function Wc(m,y){return xs(m,St(y,3),Bi)}function vd(m,y){return xs(m,St(y,3),Tc)}function Yy(m,y){return m==null?m:kc(m,St(y,3),Ei)}function Sv(m,y){return m==null?m:Al(m,St(y,3),Ei)}function Qc(m,y){return m&&Bi(m,St(y,3))}function wd(m,y){return m&&Tc(m,St(y,3))}function Wy(m){return m==null?[]:No(m,Ci(m))}function th(m){return m==null?[]:No(m,Ei(m))}function Sd(m,y,_){var O=m==null?t:Xr(m,y);return O===t?_:O}function dm(m,y){return m!=null&&id(m,y,fp)}function Jc(m,y){return m!=null&&id(m,y,kg)}var Qy=Ku(function(m,y,_){y!=null&&typeof y.toString!="function"&&(y=we.call(y)),m[y]=_},Le($e)),Jy=Ku(function(m,y,_){y!=null&&typeof y.toString!="function"&&(y=we.call(y)),te.call(m,y)?m[y].push(_):m[y]=[_]},St),Nv=Ht(Pl);function Ci(m){return Si(m)?cp(m):mf(m)}function Ei(m){return Si(m)?cp(m,!0):Eg(m)}function Cv(m,y){var _={};return y=St(y,3),Bi(m,function(O,H,ie){va(_,y(O,H,ie),O)}),_}function jv(m,y){var _={};return y=St(y,3),Bi(m,function(O,H,ie){va(_,H,y(O,H,ie))}),_}var _v=Ml(function(m,y,_){Uu(m,y,_)}),Nd=Ml(function(m,y,_,O){Uu(m,y,_,O)}),nh=Yn(function(m,y){var _={};if(m==null)return _;var O=!1;y=Bn(y,function(ie){return ie=Es(ie,m),O||(O=ie.length>1),ie}),mr(m,Af(m),_),O&&(_=Ui(_,g|b|v,Hg));for(var H=y.length;H--;)Hu(_,y[H]);return _});function fm(m,y){return Kc(m,yd(St(y)))}var kv=Yn(function(m,y){return m==null?{}:Ag(m,y)});function Kc(m,y){if(m==null)return{};var _=Bn(Af(m),function(O){return[O]});return y=St(y),xf(m,_,function(O,H){return y(O,H[0])})}function Tv(m,y,_){y=Es(y,m);var O=-1,H=y.length;for(H||(H=1,m=t);++O<H;){var ie=m==null?t:m[Cn(y[O])];ie===t&&(O=H,ie=_),m=Ca(ie)?ie.call(m):ie}return m}function Ky(m,y,_){return m==null?m:Ac(m,y,_)}function Xy(m,y,_,O){return O=typeof O=="function"?O:t,m==null?m:Ac(m,y,_,O)}var hm=ed(Ci),pm=ed(Ei);function mm(m,y,_){var O=Lt(m),H=O||Oo(m)||Gc(m);if(y=St(y,4),_==null){var ie=m&&m.constructor;H?_=O?new ie:[]:ti(m)?_=Ca(ie)?Dr(_u(m)):{}:_={}}return(H?xi:Bi)(m,function(pe,Ne,Ee){return y(_,pe,Ne,Ee)}),_}function Zy(m,y){return m==null?!0:Hu(m,y)}function ih(m,y,_){return m==null?m:jp(m,y,Wu(_))}function Ev(m,y,_,O){return O=typeof O=="function"?O:t,m==null?m:jp(m,y,Wu(_),O)}function Xc(m){return m==null?[]:yl(m,Ci(m))}function gm(m){return m==null?[]:yl(m,Ei(m))}function ym(m,y,_){return _===t&&(_=y,y=t),_!==t&&(_=ia(_),_=_===_?_:0),y!==t&&(y=ia(y),y=y===y?y:0),wa(ia(m),y,_)}function rh(m,y,_){return y=ns(y),_===t?(_=y,y=0):_=ns(_),m=ia(m),Tg(m,y,_)}function xm(m,y,_){if(_&&typeof _!="boolean"&&rr(m,y,_)&&(y=_=t),_===t&&(typeof y=="boolean"?(_=y,y=t):typeof m=="boolean"&&(_=m,m=t)),m===t&&y===t?(m=0,y=1):(m=ns(m),y===t?(y=m,m=0):y=ns(y)),m>y){var O=m;m=y,y=O}if(_||m%1||y%1){var H=rp();return Xn(m+H*(y-m+so("1e-"+((H+"").length-1))),y)}return vf(m,y)}var ex=ir(function(m,y,_){return y=y.toLowerCase(),m+(_?ah(y):y)});function ah(m){return x(Nn(m).toLowerCase())}function Fs(m){return m=Nn(m),m&&m.replace(Zs,Pr).replace(Er,"")}function Lo(m,y,_){m=Nn(m),y=pr(y);var O=m.length;_=_===t?O:wa(Ut(_),0,O);var H=_;return _-=y.length,_>=0&&m.slice(_,H)==y}function Fo(m){return m=Nn(m),m&&hi.test(m)?m.replace(Et,Gr):m}function Cd(m){return m=Nn(m),m&&Ri.test(m)?m.replace(zn,"\\$&"):m}var jd=ir(function(m,y,_){return m+(_?"-":"")+y.toLowerCase()}),$o=ir(function(m,y,_){return m+(_?" ":"")+y.toLowerCase()}),Av=Rr("toLowerCase");function tx(m,y,_){m=Nn(m),y=Ut(y);var O=y?Yr(m):0;if(!y||O>=y)return m;var H=(y-O)/2;return Zu(Ns(H),_)+m+Zu(Sc(H),_)}function _d(m,y,_){m=Nn(m),y=Ut(y);var O=y?Yr(m):0;return y&&O<y?m+Zu(y-O,_):m}function Pv(m,y,_){m=Nn(m),y=Ut(y);var O=y?Yr(m):0;return y&&O<y?Zu(y-O,_)+m:m}function nx(m,y,_){return _||y==null?y=0:y&&(y=+y),Cl(Nn(m).replace(ha,""),y||0)}function sh(m,y,_){return(_?rr(m,y,_):y===t)?y=1:y=Ut(y),Np(Nn(m),y)}function ix(){var m=arguments,y=Nn(m[0]);return m.length<3?y:y.replace(m[1],m[2])}var Dv=ir(function(m,y,_){return m+(_?"_":"")+y.toLowerCase()});function oh(m,y,_){return _&&typeof _!="number"&&rr(m,y,_)&&(y=_=t),_=_===t?ce:_>>>0,_?(m=Nn(m),m&&(typeof y=="string"||y!=null&&!Xf(y))&&(y=pr(y),!y&&xa(m))?Co(lr(m),0,_):m.split(y,_)):[]}var lh=ir(function(m,y,_){return m+(_?" ":"")+x(y)});function rx(m,y,_){return m=Nn(m),_=_==null?0:wa(Ut(_),0,m.length),y=pr(y),m.slice(_,_+y.length)==y}function kd(m,y,_){var O=K.templateSettings;_&&rr(m,y,_)&&(y=t),m=Nn(m),y=eh({},y,O,Tf);var H=eh({},y.imports,O.imports,Tf),ie=Ci(H),pe=yl(H,ie),Ne,Ee,Ke=0,Ze=y.interpolate||Xl,it="__p += '",mt=vc((y.escape||Xl).source+"|"+Ze.source+"|"+(Ze===Bt?Js:Xl).source+"|"+(y.evaluate||Xl).source+"|$","g"),yt="//# sourceURL="+(te.call(y,"sourceURL")?(y.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++uc+"]")+`
`;m.replace(mt,function(Mt,un,bn,_a,$r,ka){return bn||(bn=_a),it+=m.slice(Ke,ka).replace(Gd,Su),un&&(Ne=!0,it+=`' +
__e(`+un+`) +
'`),$r&&(Ee=!0,it+=`';
`+$r+`;
__p += '`),bn&&(it+=`' +
((__t = (`+bn+`)) == null ? '' : __t) +
'`),Ke=ka+Mt.length,Mt}),it+=`';
`;var Rt=te.call(y,"variable")&&y.variable;if(!Rt)it=`with (obj) {
`+it+`
}
`;else if(Kl.test(Rt))throw new kt(d);it=(Ee?it.replace(rt,""):it).replace(Ft,"$1").replace(Kn,"$1;"),it="function("+(Rt||"obj")+`) {
`+(Rt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Ne?", __e = _.escape":"")+(Ee?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+it+`return __p
}`;var en=E(function(){return on(ie,yt+"return "+it).apply(t,pe)});if(en.source=it,Ni(en))throw en;return en}function bm(m){return Nn(m).toLowerCase()}function ch(m){return Nn(m).toUpperCase()}function ax(m,y,_){if(m=Nn(m),m&&(_||y===t))return Zd(m);if(!m||!(y=pr(y)))return m;var O=lr(m),H=lr(y),ie=ya(O,H),pe=po(O,H)+1;return Co(O,ie,pe).join("")}function Iv(m,y,_){if(m=Nn(m),m&&(_||y===t))return m.slice(0,ju(m)+1);if(!m||!(y=pr(y)))return m;var O=lr(m),H=po(O,lr(y))+1;return Co(O,0,H).join("")}function uh(m,y,_){if(m=Nn(m),m&&(_||y===t))return m.replace(ha,"");if(!m||!(y=pr(y)))return m;var O=lr(m),H=ya(O,lr(y));return Co(O,H).join("")}function s(m,y){var _=R,O=B;if(ti(y)){var H="separator"in y?y.separator:H;_="length"in y?Ut(y.length):_,O="omission"in y?pr(y.omission):O}m=Nn(m);var ie=m.length;if(xa(m)){var pe=lr(m);ie=pe.length}if(_>=ie)return m;var Ne=_-Yr(O);if(Ne<1)return O;var Ee=pe?Co(pe,0,Ne).join(""):m.slice(0,Ne);if(H===t)return Ee+O;if(pe&&(Ne+=Ee.length-Ne),Xf(H)){if(m.slice(Ne).search(H)){var Ke,Ze=Ee;for(H.global||(H=vc(H.source,Nn(Ks.exec(H))+"g")),H.lastIndex=0;Ke=H.exec(Ze);)var it=Ke.index;Ee=Ee.slice(0,it===t?Ne:it)}}else if(m.indexOf(pr(H),Ne)!=Ne){var mt=Ee.lastIndexOf(H);mt>-1&&(Ee=Ee.slice(0,mt))}return Ee+O}function c(m){return m=Nn(m),m&&Vt.test(m)?m.replace(Pn,vs):m}var h=ir(function(m,y,_){return m+(_?" ":"")+y.toUpperCase()}),x=Rr("toUpperCase");function N(m,y,_){return m=Nn(m),y=_?t:y,y===t?Nu(m)?tp(m):uo(m):m.match(y)||[]}var E=Ht(function(m,y){try{return $i(m,t,y)}catch(_){return Ni(_)?_:new kt(_)}}),q=Yn(function(m,y){return xi(y,function(_){_=Cn(_),va(m,_,Ro(m[_],m))}),m});function X(m){var y=m==null?0:m.length,_=St();return m=y?Bn(m,function(O){if(typeof O[1]!="function")throw new er(l);return[_(O[0]),O[1]]}):[],Ht(function(O){for(var H=-1;++H<y;){var ie=m[H];if($i(ie[0],this,O))return $i(ie[1],this,O)}})}function ge(m){return jg(Ui(m,g))}function Le(m){return function(){return m}}function Qe(m,y){return m==null||m!==m?y:m}var Xe=Ja(),ze=Ja(!0);function $e(m){return m}function At(m){return yp(typeof m=="function"?m:Ui(m,g))}function Tt(m){return bp(Ui(m,g))}function Rn(m,y){return yf(m,Ui(y,g))}var Te=Ht(function(m,y){return function(_){return Pl(_,m,y)}}),je=Ht(function(m,y){return function(_){return Pl(m,_,y)}});function Ie(m,y,_){var O=Ci(y),H=No(y,O);_==null&&!(ti(y)&&(H.length||!O.length))&&(_=y,y=m,m=this,H=No(y,Ci(y)));var ie=!(ti(_)&&"chain"in _)||!!_.chain,pe=Ca(m);return xi(H,function(Ne){var Ee=y[Ne];m[Ne]=Ee,pe&&(m.prototype[Ne]=function(){var Ke=this.__chain__;if(ie||Ke){var Ze=m(this.__wrapped__),it=Ze.__actions__=vi(this.__actions__);return it.push({func:Ee,args:arguments,thisArg:m}),Ze.__chain__=Ke,Ze}return Ee.apply(m,Hr([this.value()],arguments))})}),m}function Je(){return Un._===this&&(Un._=dt),this}function gt(){}function Zt(m){return m=Ut(m),Ht(function(y){return vp(y,m)})}var xt=Xu(Bn),Pt=Xu(mc),Ai=Xu(Ua);function xn(m){return Rf(m)?gl(Cn(m)):Pg(m)}function zo(m){return function(y){return m==null?t:Xr(m,y)}}var Rv=jo(),_A=jo(!0);function Mv(){return[]}function Ov(){return!1}function kA(){return{}}function TA(){return""}function EA(){return!0}function AA(m,y){if(m=Ut(m),m<1||m>J)return[];var _=ce,O=Xn(m,ce);y=St(y),m-=ce;for(var H=qa(O,y);++_<m;)y(_);return H}function PA(m){return Lt(m)?Bn(m,Cn):ar(m)?[m]:vi(Za(Nn(m)))}function DA(m){var y=++de;return Nn(m)+y}var IA=Pc(function(m,y){return m+y},0),RA=kf("ceil"),MA=Pc(function(m,y){return m/y},1),OA=kf("floor");function LA(m){return m&&m.length?Sa(m,$e,Fu):t}function FA(m,y){return m&&m.length?Sa(m,St(y,2),Fu):t}function $A(m){return ml(m,$e)}function zA(m,y){return ml(m,St(y,2))}function UA(m){return m&&m.length?Sa(m,$e,gf):t}function BA(m,y){return m&&m.length?Sa(m,St(y,2),gf):t}var qA=Pc(function(m,y){return m*y},1),VA=kf("round"),HA=Pc(function(m,y){return m-y},0);function GA(m){return m&&m.length?xc(m,$e):0}function YA(m,y){return m&&m.length?xc(m,St(y,2)):0}return K.after=sv,K.ary=Ey,K.assign=yv,K.assignIn=Hy,K.assignInWith=eh,K.assignWith=xv,K.at=bv,K.before=hd,K.bind=Ro,K.bindAll=q,K.bindKey=Hf,K.castArray=uv,K.chain=qc,K.chunk=Zb,K.compact=ny,K.concat=iy,K.cond=X,K.conforms=ge,K.constant=Le,K.countBy=Vc,K.create=vv,K.curry=pd,K.curryRight=Gf,K.debounce=Mo,K.defaults=wv,K.defaultsDeep=Gy,K.defer=ts,K.delay=md,K.difference=ei,K.differenceBy=gr,K.differenceWith=Rs,K.drop=ry,K.dropRight=ay,K.dropRightWhile=ev,K.dropWhile=$p,K.fill=Mr,K.filter=yy,K.flatMap=Zp,K.flatMapDeep=iv,K.flatMapDepth=rv,K.flatten=yr,K.flattenDeep=sy,K.flattenDepth=To,K.flip=ov,K.flow=Xe,K.flowRight=ze,K.fromPairs=$l,K.functions=Wy,K.functionsIn=th,K.groupBy=vy,K.initial=Bp,K.intersection=es,K.intersectionBy=oy,K.intersectionWith=Mc,K.invert=Qy,K.invertBy=Jy,K.invokeMap=Bf,K.iteratee=At,K.keyBy=wy,K.keys=Ci,K.keysIn=Ei,K.map=fd,K.mapKeys=Cv,K.mapValues=jv,K.matches=Tt,K.matchesProperty=Rn,K.memoize=gd,K.merge=_v,K.mergeWith=Nd,K.method=Te,K.methodOf=je,K.mixin=Ie,K.negate=yd,K.nthArg=Zt,K.omit=nh,K.omitBy=fm,K.once=Ay,K.orderBy=Sy,K.over=xt,K.overArgs=Py,K.overEvery=Pt,K.overSome=Ai,K.partial=nm,K.partialRight=Yf,K.partition=Ny,K.pick=kv,K.pickBy=Kc,K.property=xn,K.propertyOf=zo,K.pull=cy,K.pullAll=Lc,K.pullAllBy=uy,K.pullAllWith=zf,K.pullAt=dy,K.range=Rv,K.rangeRight=_A,K.rearg=Dy,K.reject=qf,K.remove=tv,K.rest=Iy,K.reverse=qp,K.sampleSize=ky,K.set=Ky,K.setWith=Xy,K.shuffle=Fn,K.slice=_n,K.sortBy=Ty,K.sortedUniq=Fc,K.sortedUniqBy=Vp,K.split=oh,K.spread=lv,K.tail=Os,K.take=ci,K.takeRight=Ao,K.takeRightWhile=zl,K.takeWhile=Hp,K.tap=Jp,K.throttle=im,K.thru=Vi,K.toArray=Fr,K.toPairs=hm,K.toPairsIn=pm,K.toPath=PA,K.toPlainObject=Vy,K.transform=mm,K.unary=rm,K.union=ta,K.unionBy=$c,K.unionWith=ud,K.uniq=xr,K.uniqBy=Gp,K.uniqWith=Yp,K.unset=Zy,K.unzip=zc,K.unzipWith=dd,K.update=ih,K.updateWith=Ev,K.values=Xc,K.valuesIn=gm,K.without=Po,K.words=N,K.wrap=cv,K.xor=Oi,K.xorBy=Do,K.xorWith=Uc,K.zip=Bc,K.zipObject=Wp,K.zipObjectDeep=Qp,K.zipWith=fy,K.entries=hm,K.entriesIn=pm,K.extend=Hy,K.extendWith=eh,Ie(K,K),K.add=IA,K.attempt=E,K.camelCase=ex,K.capitalize=ah,K.ceil=RA,K.clamp=ym,K.clone=xd,K.cloneDeep=Ry,K.cloneDeepWith=nn,K.cloneWith=dv,K.conformsTo=am,K.deburr=Fs,K.defaultTo=Qe,K.divide=MA,K.endsWith=Lo,K.eq=br,K.escape=Fo,K.escapeRegExp=Cd,K.every=gy,K.find=xy,K.findIndex=ea,K.findKey=Wc,K.findLast=Xp,K.findLastIndex=zp,K.findLastKey=vd,K.floor=OA,K.forEach=by,K.forEachRight=em,K.forIn=Yy,K.forInRight=Sv,K.forOwn=Qc,K.forOwnRight=wd,K.get=Sd,K.gt=sm,K.gte=My,K.has=dm,K.hasIn=Jc,K.head=Ms,K.identity=$e,K.includes=Hc,K.indexOf=Up,K.inRange=rh,K.invoke=Nv,K.isArguments=Ls,K.isArray=Lt,K.isArrayBuffer=Wf,K.isArrayLike=Si,K.isArrayLikeObject=ui,K.isBoolean=fv,K.isBuffer=Oo,K.isDate=Oy,K.isElement=Ly,K.isEmpty=Qf,K.isEqual=In,K.isEqualWith=om,K.isError=Ni,K.isFinite=hv,K.isFunction=Ca,K.isInteger=Jf,K.isLength=Ul,K.isMap=Kf,K.isMatch=lm,K.isMatchWith=pv,K.isNaN=Fy,K.isNative=mv,K.isNil=gv,K.isNull=$y,K.isNumber=zy,K.isObject=ti,K.isObjectLike=ai,K.isPlainObject=na,K.isRegExp=Xf,K.isSafeInteger=cm,K.isSet=Uy,K.isString=Zf,K.isSymbol=ar,K.isTypedArray=Gc,K.isUndefined=ja,K.isWeakMap=um,K.isWeakSet=By,K.join=cd,K.kebabCase=jd,K.last=qi,K.lastIndexOf=Oc,K.lowerCase=$o,K.lowerFirst=Av,K.lt=qy,K.lte=bd,K.max=LA,K.maxBy=FA,K.mean=$A,K.meanBy=zA,K.min=UA,K.minBy=BA,K.stubArray=Mv,K.stubFalse=Ov,K.stubObject=kA,K.stubString=TA,K.stubTrue=EA,K.multiply=qA,K.nth=ly,K.noConflict=Je,K.noop=gt,K.now=Vf,K.pad=tx,K.padEnd=_d,K.padStart=Pv,K.parseInt=nx,K.random=xm,K.reduce=Cy,K.reduceRight=jy,K.repeat=sh,K.replace=ix,K.result=Tv,K.round=VA,K.runInContext=ke,K.sample=_y,K.size=tm,K.snakeCase=Dv,K.some=av,K.sortedIndex=Vn,K.sortedIndexBy=tn,K.sortedIndexOf=pn,K.sortedLastIndex=kn,K.sortedLastIndexBy=Or,K.sortedLastIndexOf=Eo,K.startCase=lh,K.startsWith=rx,K.subtract=HA,K.sum=GA,K.sumBy=YA,K.template=kd,K.times=AA,K.toFinite=ns,K.toInteger=Ut,K.toLength=is,K.toLower=bm,K.toNumber=ia,K.toSafeInteger=Yc,K.toString=Nn,K.toUpper=ch,K.trim=ax,K.trimEnd=Iv,K.trimStart=uh,K.truncate=s,K.unescape=c,K.uniqueId=DA,K.upperCase=h,K.upperFirst=x,K.each=by,K.eachRight=em,K.first=Ms,Ie(K,function(){var m={};return Bi(K,function(y,_){te.call(K.prototype,_)||(m[_]=y)}),m}(),{chain:!1}),K.VERSION=i,xi(["bind","bindKey","curry","curryRight","partial","partialRight"],function(m){K[m].placeholder=K}),xi(["drop","take"],function(m,y){Xt.prototype[m]=function(_){_=_===t?1:Gn(Ut(_),0);var O=this.__filtered__&&!y?new Xt(this):this.clone();return O.__filtered__?O.__takeCount__=Xn(_,O.__takeCount__):O.__views__.push({size:Xn(_,ce),type:m+(O.__dir__<0?"Right":"")}),O},Xt.prototype[m+"Right"]=function(_){return this.reverse()[m](_).reverse()}}),xi(["filter","map","takeWhile"],function(m,y){var _=y+1,O=_==ne||_==V;Xt.prototype[m]=function(H){var ie=this.clone();return ie.__iteratees__.push({iteratee:St(H,3),type:_}),ie.__filtered__=ie.__filtered__||O,ie}}),xi(["head","last"],function(m,y){var _="take"+(y?"Right":"");Xt.prototype[m]=function(){return this[_](1).value()[0]}}),xi(["initial","tail"],function(m,y){var _="drop"+(y?"":"Right");Xt.prototype[m]=function(){return this.__filtered__?new Xt(this):this[_](1)}}),Xt.prototype.compact=function(){return this.filter($e)},Xt.prototype.find=function(m){return this.filter(m).head()},Xt.prototype.findLast=function(m){return this.reverse().find(m)},Xt.prototype.invokeMap=Ht(function(m,y){return typeof m=="function"?new Xt(this):this.map(function(_){return Pl(_,m,y)})}),Xt.prototype.reject=function(m){return this.filter(yd(St(m)))},Xt.prototype.slice=function(m,y){m=Ut(m);var _=this;return _.__filtered__&&(m>0||y<0)?new Xt(_):(m<0?_=_.takeRight(-m):m&&(_=_.drop(m)),y!==t&&(y=Ut(y),_=y<0?_.dropRight(-y):_.take(y-m)),_)},Xt.prototype.takeRightWhile=function(m){return this.reverse().takeWhile(m).reverse()},Xt.prototype.toArray=function(){return this.take(ce)},Bi(Xt.prototype,function(m,y){var _=/^(?:filter|find|map|reject)|While$/.test(y),O=/^(?:head|last)$/.test(y),H=K[O?"take"+(y=="last"?"Right":""):y],ie=O||/^find/.test(y);H&&(K.prototype[y]=function(){var pe=this.__wrapped__,Ne=O?[1]:arguments,Ee=pe instanceof Xt,Ke=Ne[0],Ze=Ee||Lt(pe),it=function(un){var bn=H.apply(K,Hr([un],Ne));return O&&mt?bn[0]:bn};Ze&&_&&typeof Ke=="function"&&Ke.length!=1&&(Ee=Ze=!1);var mt=this.__chain__,yt=!!this.__actions__.length,Rt=ie&&!mt,en=Ee&&!yt;if(!ie&&Ze){pe=en?pe:new Xt(this);var Mt=m.apply(pe,Ne);return Mt.__actions__.push({func:Vi,args:[it],thisArg:t}),new dr(Mt,mt)}return Rt&&en?m.apply(this,Ne):(Mt=this.thru(it),Rt?O?Mt.value()[0]:Mt.value():Mt)})}),xi(["pop","push","shift","sort","splice","unshift"],function(m){var y=wc[m],_=/^(?:push|sort|unshift)$/.test(m)?"tap":"thru",O=/^(?:pop|shift)$/.test(m);K.prototype[m]=function(){var H=arguments;if(O&&!this.__chain__){var ie=this.value();return y.apply(Lt(ie)?ie:[],H)}return this[_](function(pe){return y.apply(Lt(pe)?pe:[],H)})}}),Bi(Xt.prototype,function(m,y){var _=K[y];if(_){var O=_.name+"";te.call(Jr,O)||(Jr[O]=[]),Jr[O].push({name:y,func:_})}}),Jr[li(t,P).name]=[{name:"wrapper",func:t}],Xt.prototype.clone=Iu,Xt.prototype.reverse=sf,Xt.prototype.value=_l,K.prototype.at=hy,K.prototype.chain=Lr,K.prototype.commit=py,K.prototype.next=my,K.prototype.plant=Io,K.prototype.reverse=Uf,K.prototype.toJSON=K.prototype.valueOf=K.prototype.value=Kp,K.prototype.first=K.prototype.head,Sl&&(K.prototype[Sl]=nv),K},Ya=Ga();za?((za.exports=Ya)._=Ya,ma._=Ya):Un._=Ya}).call(Jz)}(Fm,Fm.exports)),Fm.exports}var b2=Kz();class Xz{constructor(n){Hn(this,"sampleRate",24e3);Hn(this,"bufferSize",7680);Hn(this,"audioQueue",[]);Hn(this,"isPlaying",!1);Hn(this,"isStreamComplete",!1);Hn(this,"checkInterval",null);Hn(this,"scheduledTime",0);Hn(this,"initialBufferTime",.1);Hn(this,"gainNode");Hn(this,"source");Hn(this,"endOfQueueAudioSource",null);Hn(this,"onComplete",()=>{});this.context=n,this.gainNode=this.context.createGain(),this.source=this.context.createBufferSource(),this.gainNode.connect(this.context.destination),this.addPCM16=this.addPCM16.bind(this)}async addWorklet(n,t,i){let a=xx.get(this.context);if(a&&a[n])return a[n].handlers.push(i),Promise.resolve(this);a||(xx.set(this.context,{}),a=xx.get(this.context)),a[n]={handlers:[i]};const o=y1(n,t);await this.context.audioWorklet.addModule(o);const l=new AudioWorkletNode(this.context,n);return a[n].node=l,this}_processPCM16Chunk(n){const t=new Float32Array(n.length/2),i=new DataView(n.buffer);for(let a=0;a<n.length/2;a++)try{const o=i.getInt16(a*2,!0);t[a]=o/32768}catch(o){console.error(o)}return t}addPCM16(n){this.isStreamComplete=!1;let t=this._processPCM16Chunk(n);for(;t.length>=this.bufferSize;){const i=t.slice(0,this.bufferSize);this.audioQueue.push(i),t=t.slice(this.bufferSize)}t.length>0&&this.audioQueue.push(t),this.isPlaying||(this.isPlaying=!0,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.scheduleNextBuffer())}createAudioBuffer(n){const t=this.context.createBuffer(1,n.length,this.sampleRate);return t.getChannelData(0).set(n),t}scheduleNextBuffer(){for(;this.audioQueue.length>0&&this.scheduledTime<this.context.currentTime+.2;){const t=this.audioQueue.shift(),i=this.createAudioBuffer(t),a=this.context.createBufferSource();this.audioQueue.length===0&&(this.endOfQueueAudioSource&&(this.endOfQueueAudioSource.onended=null),this.endOfQueueAudioSource=a,a.onended=()=>{!this.audioQueue.length&&this.endOfQueueAudioSource===a&&(this.endOfQueueAudioSource=null,this.onComplete())}),a.buffer=i,a.connect(this.gainNode);const o=xx.get(this.context);o&&Object.entries(o).forEach(([,d])=>{const{node:f,handlers:u}=d;f&&(a.connect(f),f.port.onmessage=function(p){u.forEach(g=>{g.call(f.port,p)})},f.connect(this.context.destination))});const l=Math.max(this.scheduledTime,this.context.currentTime);a.start(l),this.scheduledTime=l+i.duration}if(this.audioQueue.length===0)this.isStreamComplete?(this.isPlaying=!1,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)):this.checkInterval||(this.checkInterval=window.setInterval(()=>{this.audioQueue.length>0&&this.scheduleNextBuffer()},100));else{const t=(this.scheduledTime-this.context.currentTime)*1e3;setTimeout(()=>this.scheduleNextBuffer(),Math.max(0,t-50))}}stop(){this.isPlaying=!1,this.isStreamComplete=!0,this.audioQueue=[],this.scheduledTime=this.context.currentTime,this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.gainNode.gain.linearRampToValueAtTime(0,this.context.currentTime+.1),setTimeout(()=>{this.gainNode.disconnect(),this.gainNode=this.context.createGain(),this.gainNode.connect(this.context.destination)},200)}async resume(){this.context.state==="suspended"&&await this.context.resume(),this.isStreamComplete=!1,this.scheduledTime=this.context.currentTime+this.initialBufferTime,this.gainNode.gain.setValueAtTime(1,this.context.currentTime)}complete(){this.isStreamComplete=!0,this.onComplete()}}function v2(e,n){return function(){return e.apply(n,arguments)}}const{toString:Zz}=Object.prototype,{getPrototypeOf:ww}=Object,Db=(e=>n=>{const t=Zz.call(n);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Gs=e=>(e=e.toLowerCase(),n=>Db(n)===e),Ib=e=>n=>typeof n===e,{isArray:qh}=Array,Jm=Ib("undefined");function eU(e){return e!==null&&!Jm(e)&&e.constructor!==null&&!Jm(e.constructor)&&Da(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const w2=Gs("ArrayBuffer");function tU(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&w2(e.buffer),n}const nU=Ib("string"),Da=Ib("function"),S2=Ib("number"),Rb=e=>e!==null&&typeof e=="object",iU=e=>e===!0||e===!1,$x=e=>{if(Db(e)!=="object")return!1;const n=ww(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},rU=Gs("Date"),aU=Gs("File"),sU=Gs("Blob"),oU=Gs("FileList"),lU=e=>Rb(e)&&Da(e.pipe),cU=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||Da(e.append)&&((n=Db(e))==="formdata"||n==="object"&&Da(e.toString)&&e.toString()==="[object FormData]"))},uU=Gs("URLSearchParams"),[dU,fU,hU,pU]=["ReadableStream","Request","Response","Headers"].map(Gs),mU=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function sg(e,n,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let i,a;if(typeof e!="object"&&(e=[e]),qh(e))for(i=0,a=e.length;i<a;i++)n.call(null,e[i],i,e);else{const o=t?Object.getOwnPropertyNames(e):Object.keys(e),l=o.length;let d;for(i=0;i<l;i++)d=o[i],n.call(null,e[d],d,e)}}function N2(e,n){n=n.toLowerCase();const t=Object.keys(e);let i=t.length,a;for(;i-- >0;)if(a=t[i],n===a.toLowerCase())return a;return null}const Dd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,C2=e=>!Jm(e)&&e!==Dd;function x1(){const{caseless:e}=C2(this)&&this||{},n={},t=(i,a)=>{const o=e&&N2(n,a)||a;$x(n[o])&&$x(i)?n[o]=x1(n[o],i):$x(i)?n[o]=x1({},i):qh(i)?n[o]=i.slice():n[o]=i};for(let i=0,a=arguments.length;i<a;i++)arguments[i]&&sg(arguments[i],t);return n}const gU=(e,n,t,{allOwnKeys:i}={})=>(sg(n,(a,o)=>{t&&Da(a)?e[o]=v2(a,t):e[o]=a},{allOwnKeys:i}),e),yU=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),xU=(e,n,t,i)=>{e.prototype=Object.create(n.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),t&&Object.assign(e.prototype,t)},bU=(e,n,t,i)=>{let a,o,l;const d={};if(n=n||{},e==null)return n;do{for(a=Object.getOwnPropertyNames(e),o=a.length;o-- >0;)l=a[o],(!i||i(l,e,n))&&!d[l]&&(n[l]=e[l],d[l]=!0);e=t!==!1&&ww(e)}while(e&&(!t||t(e,n))&&e!==Object.prototype);return n},vU=(e,n,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=n.length;const i=e.indexOf(n,t);return i!==-1&&i===t},wU=e=>{if(!e)return null;if(qh(e))return e;let n=e.length;if(!S2(n))return null;const t=new Array(n);for(;n-- >0;)t[n]=e[n];return t},SU=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&ww(Uint8Array)),NU=(e,n)=>{const i=(e&&e[Symbol.iterator]).call(e);let a;for(;(a=i.next())&&!a.done;){const o=a.value;n.call(e,o[0],o[1])}},CU=(e,n)=>{let t;const i=[];for(;(t=e.exec(n))!==null;)i.push(t);return i},jU=Gs("HTMLFormElement"),_U=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,i,a){return i.toUpperCase()+a}),NC=(({hasOwnProperty:e})=>(n,t)=>e.call(n,t))(Object.prototype),kU=Gs("RegExp"),j2=(e,n)=>{const t=Object.getOwnPropertyDescriptors(e),i={};sg(t,(a,o)=>{let l;(l=n(a,o,e))!==!1&&(i[o]=l||a)}),Object.defineProperties(e,i)},TU=e=>{j2(e,(n,t)=>{if(Da(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const i=e[t];if(Da(i)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},EU=(e,n)=>{const t={},i=a=>{a.forEach(o=>{t[o]=!0})};return qh(e)?i(e):i(String(e).split(n)),t},AU=()=>{},PU=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n;function DU(e){return!!(e&&Da(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const IU=e=>{const n=new Array(10),t=(i,a)=>{if(Rb(i)){if(n.indexOf(i)>=0)return;if(!("toJSON"in i)){n[a]=i;const o=qh(i)?[]:{};return sg(i,(l,d)=>{const f=t(l,a+1);!Jm(f)&&(o[d]=f)}),n[a]=void 0,o}}return i};return t(e,0)},RU=Gs("AsyncFunction"),MU=e=>e&&(Rb(e)||Da(e))&&Da(e.then)&&Da(e.catch),_2=((e,n)=>e?setImmediate:n?((t,i)=>(Dd.addEventListener("message",({source:a,data:o})=>{a===Dd&&o===t&&i.length&&i.shift()()},!1),a=>{i.push(a),Dd.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Da(Dd.postMessage)),OU=typeof queueMicrotask<"u"?queueMicrotask.bind(Dd):typeof process<"u"&&process.nextTick||_2,Ge={isArray:qh,isArrayBuffer:w2,isBuffer:eU,isFormData:cU,isArrayBufferView:tU,isString:nU,isNumber:S2,isBoolean:iU,isObject:Rb,isPlainObject:$x,isReadableStream:dU,isRequest:fU,isResponse:hU,isHeaders:pU,isUndefined:Jm,isDate:rU,isFile:aU,isBlob:sU,isRegExp:kU,isFunction:Da,isStream:lU,isURLSearchParams:uU,isTypedArray:SU,isFileList:oU,forEach:sg,merge:x1,extend:gU,trim:mU,stripBOM:yU,inherits:xU,toFlatObject:bU,kindOf:Db,kindOfTest:Gs,endsWith:vU,toArray:wU,forEachEntry:NU,matchAll:CU,isHTMLForm:jU,hasOwnProperty:NC,hasOwnProp:NC,reduceDescriptors:j2,freezeMethods:TU,toObjectSet:EU,toCamelCase:_U,noop:AU,toFiniteNumber:PU,findKey:N2,global:Dd,isContextDefined:C2,isSpecCompliantForm:DU,toJSONObject:IU,isAsyncFn:RU,isThenable:MU,setImmediate:_2,asap:OU};function Wt(e,n,t,i,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),t&&(this.config=t),i&&(this.request=i),a&&(this.response=a,this.status=a.status?a.status:null)}Ge.inherits(Wt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ge.toJSONObject(this.config),code:this.code,status:this.status}}});const k2=Wt.prototype,T2={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{T2[e]={value:e}});Object.defineProperties(Wt,T2);Object.defineProperty(k2,"isAxiosError",{value:!0});Wt.from=(e,n,t,i,a,o)=>{const l=Object.create(k2);return Ge.toFlatObject(e,l,function(f){return f!==Error.prototype},d=>d!=="isAxiosError"),Wt.call(l,e.message,n,t,i,a),l.cause=e,l.name=e.name,o&&Object.assign(l,o),l};const LU=null;function b1(e){return Ge.isPlainObject(e)||Ge.isArray(e)}function E2(e){return Ge.endsWith(e,"[]")?e.slice(0,-2):e}function CC(e,n,t){return e?e.concat(n).map(function(a,o){return a=E2(a),!t&&o?"["+a+"]":a}).join(t?".":""):n}function FU(e){return Ge.isArray(e)&&!e.some(b1)}const $U=Ge.toFlatObject(Ge,{},null,function(n){return/^is[A-Z]/.test(n)});function Mb(e,n,t){if(!Ge.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,t=Ge.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(k,T){return!Ge.isUndefined(T[k])});const i=t.metaTokens,a=t.visitor||p,o=t.dots,l=t.indexes,f=(t.Blob||typeof Blob<"u"&&Blob)&&Ge.isSpecCompliantForm(n);if(!Ge.isFunction(a))throw new TypeError("visitor must be a function");function u(S){if(S===null)return"";if(Ge.isDate(S))return S.toISOString();if(!f&&Ge.isBlob(S))throw new Wt("Blob is not supported. Use a Buffer instead.");return Ge.isArrayBuffer(S)||Ge.isTypedArray(S)?f&&typeof Blob=="function"?new Blob([S]):Buffer.from(S):S}function p(S,k,T){let P=S;if(S&&!T&&typeof S=="object"){if(Ge.endsWith(k,"{}"))k=i?k:k.slice(0,-2),S=JSON.stringify(S);else if(Ge.isArray(S)&&FU(S)||(Ge.isFileList(S)||Ge.endsWith(k,"[]"))&&(P=Ge.toArray(S)))return k=E2(k),P.forEach(function(I,U){!(Ge.isUndefined(I)||I===null)&&n.append(l===!0?CC([k],U,o):l===null?k:k+"[]",u(I))}),!1}return b1(S)?!0:(n.append(CC(T,k,o),u(S)),!1)}const g=[],b=Object.assign($U,{defaultVisitor:p,convertValue:u,isVisitable:b1});function v(S,k){if(!Ge.isUndefined(S)){if(g.indexOf(S)!==-1)throw Error("Circular reference detected in "+k.join("."));g.push(S),Ge.forEach(S,function(P,M){(!(Ge.isUndefined(P)||P===null)&&a.call(n,P,Ge.isString(M)?M.trim():M,k,b))===!0&&v(P,k?k.concat(M):[M])}),g.pop()}}if(!Ge.isObject(e))throw new TypeError("data must be an object");return v(e),n}function jC(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return n[i]})}function Sw(e,n){this._pairs=[],e&&Mb(e,this,n)}const A2=Sw.prototype;A2.append=function(n,t){this._pairs.push([n,t])};A2.toString=function(n){const t=n?function(i){return n.call(this,i,jC)}:jC;return this._pairs.map(function(a){return t(a[0])+"="+t(a[1])},"").join("&")};function zU(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function P2(e,n,t){if(!n)return e;const i=t&&t.encode||zU;Ge.isFunction(t)&&(t={serialize:t});const a=t&&t.serialize;let o;if(a?o=a(n,t):o=Ge.isURLSearchParams(n)?n.toString():new Sw(n,t).toString(i),o){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class _C{constructor(){this.handlers=[]}use(n,t,i){return this.handlers.push({fulfilled:n,rejected:t,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){Ge.forEach(this.handlers,function(i){i!==null&&n(i)})}}const D2={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},UU=typeof URLSearchParams<"u"?URLSearchParams:Sw,BU=typeof FormData<"u"?FormData:null,qU=typeof Blob<"u"?Blob:null,VU={isBrowser:!0,classes:{URLSearchParams:UU,FormData:BU,Blob:qU},protocols:["http","https","file","blob","url","data"]},Nw=typeof window<"u"&&typeof document<"u",v1=typeof navigator=="object"&&navigator||void 0,HU=Nw&&(!v1||["ReactNative","NativeScript","NS"].indexOf(v1.product)<0),GU=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",YU=Nw&&window.location.href||"http://localhost",WU=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Nw,hasStandardBrowserEnv:HU,hasStandardBrowserWebWorkerEnv:GU,navigator:v1,origin:YU},Symbol.toStringTag,{value:"Module"})),Nr={...WU,...VU};function QU(e,n){return Mb(e,new Nr.classes.URLSearchParams,Object.assign({visitor:function(t,i,a,o){return Nr.isNode&&Ge.isBuffer(t)?(this.append(i,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},n))}function JU(e){return Ge.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function KU(e){const n={},t=Object.keys(e);let i;const a=t.length;let o;for(i=0;i<a;i++)o=t[i],n[o]=e[o];return n}function I2(e){function n(t,i,a,o){let l=t[o++];if(l==="__proto__")return!0;const d=Number.isFinite(+l),f=o>=t.length;return l=!l&&Ge.isArray(a)?a.length:l,f?(Ge.hasOwnProp(a,l)?a[l]=[a[l],i]:a[l]=i,!d):((!a[l]||!Ge.isObject(a[l]))&&(a[l]=[]),n(t,i,a[l],o)&&Ge.isArray(a[l])&&(a[l]=KU(a[l])),!d)}if(Ge.isFormData(e)&&Ge.isFunction(e.entries)){const t={};return Ge.forEachEntry(e,(i,a)=>{n(JU(i),a,t,0)}),t}return null}function XU(e,n,t){if(Ge.isString(e))try{return(n||JSON.parse)(e),Ge.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(t||JSON.stringify)(e)}const og={transitional:D2,adapter:["xhr","http","fetch"],transformRequest:[function(n,t){const i=t.getContentType()||"",a=i.indexOf("application/json")>-1,o=Ge.isObject(n);if(o&&Ge.isHTMLForm(n)&&(n=new FormData(n)),Ge.isFormData(n))return a?JSON.stringify(I2(n)):n;if(Ge.isArrayBuffer(n)||Ge.isBuffer(n)||Ge.isStream(n)||Ge.isFile(n)||Ge.isBlob(n)||Ge.isReadableStream(n))return n;if(Ge.isArrayBufferView(n))return n.buffer;if(Ge.isURLSearchParams(n))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let d;if(o){if(i.indexOf("application/x-www-form-urlencoded")>-1)return QU(n,this.formSerializer).toString();if((d=Ge.isFileList(n))||i.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return Mb(d?{"files[]":n}:n,f&&new f,this.formSerializer)}}return o||a?(t.setContentType("application/json",!1),XU(n)):n}],transformResponse:[function(n){const t=this.transitional||og.transitional,i=t&&t.forcedJSONParsing,a=this.responseType==="json";if(Ge.isResponse(n)||Ge.isReadableStream(n))return n;if(n&&Ge.isString(n)&&(i&&!this.responseType||a)){const l=!(t&&t.silentJSONParsing)&&a;try{return JSON.parse(n)}catch(d){if(l)throw d.name==="SyntaxError"?Wt.from(d,Wt.ERR_BAD_RESPONSE,this,null,this.response):d}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Nr.classes.FormData,Blob:Nr.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ge.forEach(["delete","get","head","post","put","patch"],e=>{og.headers[e]={}});const ZU=Ge.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),e8=e=>{const n={};let t,i,a;return e&&e.split(`
`).forEach(function(l){a=l.indexOf(":"),t=l.substring(0,a).trim().toLowerCase(),i=l.substring(a+1).trim(),!(!t||n[t]&&ZU[t])&&(t==="set-cookie"?n[t]?n[t].push(i):n[t]=[i]:n[t]=n[t]?n[t]+", "+i:i)}),n},kC=Symbol("internals");function km(e){return e&&String(e).trim().toLowerCase()}function zx(e){return e===!1||e==null?e:Ge.isArray(e)?e.map(zx):String(e)}function t8(e){const n=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=t.exec(e);)n[i[1]]=i[2];return n}const n8=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function s0(e,n,t,i,a){if(Ge.isFunction(i))return i.call(this,n,t);if(a&&(n=t),!!Ge.isString(n)){if(Ge.isString(i))return n.indexOf(i)!==-1;if(Ge.isRegExp(i))return i.test(n)}}function i8(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,t,i)=>t.toUpperCase()+i)}function r8(e,n){const t=Ge.toCamelCase(" "+n);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+t,{value:function(a,o,l){return this[i].call(this,n,a,o,l)},configurable:!0})})}let oa=class{constructor(n){n&&this.set(n)}set(n,t,i){const a=this;function o(d,f,u){const p=km(f);if(!p)throw new Error("header name must be a non-empty string");const g=Ge.findKey(a,p);(!g||a[g]===void 0||u===!0||u===void 0&&a[g]!==!1)&&(a[g||f]=zx(d))}const l=(d,f)=>Ge.forEach(d,(u,p)=>o(u,p,f));if(Ge.isPlainObject(n)||n instanceof this.constructor)l(n,t);else if(Ge.isString(n)&&(n=n.trim())&&!n8(n))l(e8(n),t);else if(Ge.isHeaders(n))for(const[d,f]of n.entries())o(f,d,i);else n!=null&&o(t,n,i);return this}get(n,t){if(n=km(n),n){const i=Ge.findKey(this,n);if(i){const a=this[i];if(!t)return a;if(t===!0)return t8(a);if(Ge.isFunction(t))return t.call(this,a,i);if(Ge.isRegExp(t))return t.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,t){if(n=km(n),n){const i=Ge.findKey(this,n);return!!(i&&this[i]!==void 0&&(!t||s0(this,this[i],i,t)))}return!1}delete(n,t){const i=this;let a=!1;function o(l){if(l=km(l),l){const d=Ge.findKey(i,l);d&&(!t||s0(i,i[d],d,t))&&(delete i[d],a=!0)}}return Ge.isArray(n)?n.forEach(o):o(n),a}clear(n){const t=Object.keys(this);let i=t.length,a=!1;for(;i--;){const o=t[i];(!n||s0(this,this[o],o,n,!0))&&(delete this[o],a=!0)}return a}normalize(n){const t=this,i={};return Ge.forEach(this,(a,o)=>{const l=Ge.findKey(i,o);if(l){t[l]=zx(a),delete t[o];return}const d=n?i8(o):String(o).trim();d!==o&&delete t[o],t[d]=zx(a),i[d]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const t=Object.create(null);return Ge.forEach(this,(i,a)=>{i!=null&&i!==!1&&(t[a]=n&&Ge.isArray(i)?i.join(", "):i)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,t])=>n+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...t){const i=new this(n);return t.forEach(a=>i.set(a)),i}static accessor(n){const i=(this[kC]=this[kC]={accessors:{}}).accessors,a=this.prototype;function o(l){const d=km(l);i[d]||(r8(a,l),i[d]=!0)}return Ge.isArray(n)?n.forEach(o):o(n),this}};oa.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ge.reduceDescriptors(oa.prototype,({value:e},n)=>{let t=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(i){this[t]=i}}});Ge.freezeMethods(oa);function o0(e,n){const t=this||og,i=n||t,a=oa.from(i.headers);let o=i.data;return Ge.forEach(e,function(d){o=d.call(t,o,a.normalize(),n?n.status:void 0)}),a.normalize(),o}function R2(e){return!!(e&&e.__CANCEL__)}function Vh(e,n,t){Wt.call(this,e??"canceled",Wt.ERR_CANCELED,n,t),this.name="CanceledError"}Ge.inherits(Vh,Wt,{__CANCEL__:!0});function M2(e,n,t){const i=t.config.validateStatus;!t.status||!i||i(t.status)?e(t):n(new Wt("Request failed with status code "+t.status,[Wt.ERR_BAD_REQUEST,Wt.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function a8(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function s8(e,n){e=e||10;const t=new Array(e),i=new Array(e);let a=0,o=0,l;return n=n!==void 0?n:1e3,function(f){const u=Date.now(),p=i[o];l||(l=u),t[a]=f,i[a]=u;let g=o,b=0;for(;g!==a;)b+=t[g++],g=g%e;if(a=(a+1)%e,a===o&&(o=(o+1)%e),u-l<n)return;const v=p&&u-p;return v?Math.round(b*1e3/v):void 0}}function o8(e,n){let t=0,i=1e3/n,a,o;const l=(u,p=Date.now())=>{t=p,a=null,o&&(clearTimeout(o),o=null),e.apply(null,u)};return[(...u)=>{const p=Date.now(),g=p-t;g>=i?l(u,p):(a=u,o||(o=setTimeout(()=>{o=null,l(a)},i-g)))},()=>a&&l(a)]}const lb=(e,n,t=3)=>{let i=0;const a=s8(50,250);return o8(o=>{const l=o.loaded,d=o.lengthComputable?o.total:void 0,f=l-i,u=a(f),p=l<=d;i=l;const g={loaded:l,total:d,progress:d?l/d:void 0,bytes:f,rate:u||void 0,estimated:u&&d&&p?(d-l)/u:void 0,event:o,lengthComputable:d!=null,[n?"download":"upload"]:!0};e(g)},t)},TC=(e,n)=>{const t=e!=null;return[i=>n[0]({lengthComputable:t,total:e,loaded:i}),n[1]]},EC=e=>(...n)=>Ge.asap(()=>e(...n)),l8=Nr.hasStandardBrowserEnv?((e,n)=>t=>(t=new URL(t,Nr.origin),e.protocol===t.protocol&&e.host===t.host&&(n||e.port===t.port)))(new URL(Nr.origin),Nr.navigator&&/(msie|trident)/i.test(Nr.navigator.userAgent)):()=>!0,c8=Nr.hasStandardBrowserEnv?{write(e,n,t,i,a,o){const l=[e+"="+encodeURIComponent(n)];Ge.isNumber(t)&&l.push("expires="+new Date(t).toGMTString()),Ge.isString(i)&&l.push("path="+i),Ge.isString(a)&&l.push("domain="+a),o===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function u8(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function d8(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function O2(e,n,t){let i=!u8(n);return e&&(i||t==!1)?d8(e,n):n}const AC=e=>e instanceof oa?{...e}:e;function Fd(e,n){n=n||{};const t={};function i(u,p,g,b){return Ge.isPlainObject(u)&&Ge.isPlainObject(p)?Ge.merge.call({caseless:b},u,p):Ge.isPlainObject(p)?Ge.merge({},p):Ge.isArray(p)?p.slice():p}function a(u,p,g,b){if(Ge.isUndefined(p)){if(!Ge.isUndefined(u))return i(void 0,u,g,b)}else return i(u,p,g,b)}function o(u,p){if(!Ge.isUndefined(p))return i(void 0,p)}function l(u,p){if(Ge.isUndefined(p)){if(!Ge.isUndefined(u))return i(void 0,u)}else return i(void 0,p)}function d(u,p,g){if(g in n)return i(u,p);if(g in e)return i(void 0,u)}const f={url:o,method:o,data:o,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:d,headers:(u,p,g)=>a(AC(u),AC(p),g,!0)};return Ge.forEach(Object.keys(Object.assign({},e,n)),function(p){const g=f[p]||a,b=g(e[p],n[p],p);Ge.isUndefined(b)&&g!==d||(t[p]=b)}),t}const L2=e=>{const n=Fd({},e);let{data:t,withXSRFToken:i,xsrfHeaderName:a,xsrfCookieName:o,headers:l,auth:d}=n;n.headers=l=oa.from(l),n.url=P2(O2(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),d&&l.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):"")));let f;if(Ge.isFormData(t)){if(Nr.hasStandardBrowserEnv||Nr.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((f=l.getContentType())!==!1){const[u,...p]=f?f.split(";").map(g=>g.trim()).filter(Boolean):[];l.setContentType([u||"multipart/form-data",...p].join("; "))}}if(Nr.hasStandardBrowserEnv&&(i&&Ge.isFunction(i)&&(i=i(n)),i||i!==!1&&l8(n.url))){const u=a&&o&&c8.read(o);u&&l.set(a,u)}return n},f8=typeof XMLHttpRequest<"u",h8=f8&&function(e){return new Promise(function(t,i){const a=L2(e);let o=a.data;const l=oa.from(a.headers).normalize();let{responseType:d,onUploadProgress:f,onDownloadProgress:u}=a,p,g,b,v,S;function k(){v&&v(),S&&S(),a.cancelToken&&a.cancelToken.unsubscribe(p),a.signal&&a.signal.removeEventListener("abort",p)}let T=new XMLHttpRequest;T.open(a.method.toUpperCase(),a.url,!0),T.timeout=a.timeout;function P(){if(!T)return;const I=oa.from("getAllResponseHeaders"in T&&T.getAllResponseHeaders()),L={data:!d||d==="text"||d==="json"?T.responseText:T.response,status:T.status,statusText:T.statusText,headers:I,config:e,request:T};M2(function(z){t(z),k()},function(z){i(z),k()},L),T=null}"onloadend"in T?T.onloadend=P:T.onreadystatechange=function(){!T||T.readyState!==4||T.status===0&&!(T.responseURL&&T.responseURL.indexOf("file:")===0)||setTimeout(P)},T.onabort=function(){T&&(i(new Wt("Request aborted",Wt.ECONNABORTED,e,T)),T=null)},T.onerror=function(){i(new Wt("Network Error",Wt.ERR_NETWORK,e,T)),T=null},T.ontimeout=function(){let U=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const L=a.transitional||D2;a.timeoutErrorMessage&&(U=a.timeoutErrorMessage),i(new Wt(U,L.clarifyTimeoutError?Wt.ETIMEDOUT:Wt.ECONNABORTED,e,T)),T=null},o===void 0&&l.setContentType(null),"setRequestHeader"in T&&Ge.forEach(l.toJSON(),function(U,L){T.setRequestHeader(L,U)}),Ge.isUndefined(a.withCredentials)||(T.withCredentials=!!a.withCredentials),d&&d!=="json"&&(T.responseType=a.responseType),u&&([b,S]=lb(u,!0),T.addEventListener("progress",b)),f&&T.upload&&([g,v]=lb(f),T.upload.addEventListener("progress",g),T.upload.addEventListener("loadend",v)),(a.cancelToken||a.signal)&&(p=I=>{T&&(i(!I||I.type?new Vh(null,e,T):I),T.abort(),T=null)},a.cancelToken&&a.cancelToken.subscribe(p),a.signal&&(a.signal.aborted?p():a.signal.addEventListener("abort",p)));const M=a8(a.url);if(M&&Nr.protocols.indexOf(M)===-1){i(new Wt("Unsupported protocol "+M+":",Wt.ERR_BAD_REQUEST,e));return}T.send(o||null)})},p8=(e,n)=>{const{length:t}=e=e?e.filter(Boolean):[];if(n||t){let i=new AbortController,a;const o=function(u){if(!a){a=!0,d();const p=u instanceof Error?u:this.reason;i.abort(p instanceof Wt?p:new Vh(p instanceof Error?p.message:p))}};let l=n&&setTimeout(()=>{l=null,o(new Wt(`timeout ${n} of ms exceeded`,Wt.ETIMEDOUT))},n);const d=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(o):u.removeEventListener("abort",o)}),e=null)};e.forEach(u=>u.addEventListener("abort",o));const{signal:f}=i;return f.unsubscribe=()=>Ge.asap(d),f}},m8=function*(e,n){let t=e.byteLength;if(t<n){yield e;return}let i=0,a;for(;i<t;)a=i+n,yield e.slice(i,a),i=a},g8=async function*(e,n){for await(const t of y8(e))yield*m8(t,n)},y8=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const n=e.getReader();try{for(;;){const{done:t,value:i}=await n.read();if(t)break;yield i}}finally{await n.cancel()}},PC=(e,n,t,i)=>{const a=g8(e,n);let o=0,l,d=f=>{l||(l=!0,i&&i(f))};return new ReadableStream({async pull(f){try{const{done:u,value:p}=await a.next();if(u){d(),f.close();return}let g=p.byteLength;if(t){let b=o+=g;t(b)}f.enqueue(new Uint8Array(p))}catch(u){throw d(u),u}},cancel(f){return d(f),a.return()}},{highWaterMark:2})},Ob=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",F2=Ob&&typeof ReadableStream=="function",x8=Ob&&(typeof TextEncoder=="function"?(e=>n=>e.encode(n))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),$2=(e,...n)=>{try{return!!e(...n)}catch{return!1}},b8=F2&&$2(()=>{let e=!1;const n=new Request(Nr.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!n}),DC=64*1024,w1=F2&&$2(()=>Ge.isReadableStream(new Response("").body)),cb={stream:w1&&(e=>e.body)};Ob&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!cb[n]&&(cb[n]=Ge.isFunction(e[n])?t=>t[n]():(t,i)=>{throw new Wt(`Response type '${n}' is not supported`,Wt.ERR_NOT_SUPPORT,i)})})})(new Response);const v8=async e=>{if(e==null)return 0;if(Ge.isBlob(e))return e.size;if(Ge.isSpecCompliantForm(e))return(await new Request(Nr.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Ge.isArrayBufferView(e)||Ge.isArrayBuffer(e))return e.byteLength;if(Ge.isURLSearchParams(e)&&(e=e+""),Ge.isString(e))return(await x8(e)).byteLength},w8=async(e,n)=>{const t=Ge.toFiniteNumber(e.getContentLength());return t??v8(n)},S8=Ob&&(async e=>{let{url:n,method:t,data:i,signal:a,cancelToken:o,timeout:l,onDownloadProgress:d,onUploadProgress:f,responseType:u,headers:p,withCredentials:g="same-origin",fetchOptions:b}=L2(e);u=u?(u+"").toLowerCase():"text";let v=p8([a,o&&o.toAbortSignal()],l),S;const k=v&&v.unsubscribe&&(()=>{v.unsubscribe()});let T;try{if(f&&b8&&t!=="get"&&t!=="head"&&(T=await w8(p,i))!==0){let L=new Request(n,{method:"POST",body:i,duplex:"half"}),$;if(Ge.isFormData(i)&&($=L.headers.get("content-type"))&&p.setContentType($),L.body){const[z,F]=TC(T,lb(EC(f)));i=PC(L.body,DC,z,F)}}Ge.isString(g)||(g=g?"include":"omit");const P="credentials"in Request.prototype;S=new Request(n,{...b,signal:v,method:t.toUpperCase(),headers:p.normalize().toJSON(),body:i,duplex:"half",credentials:P?g:void 0});let M=await fetch(S);const I=w1&&(u==="stream"||u==="response");if(w1&&(d||I&&k)){const L={};["status","statusText","headers"].forEach(Q=>{L[Q]=M[Q]});const $=Ge.toFiniteNumber(M.headers.get("content-length")),[z,F]=d&&TC($,lb(EC(d),!0))||[];M=new Response(PC(M.body,DC,z,()=>{F&&F(),k&&k()}),L)}u=u||"text";let U=await cb[Ge.findKey(cb,u)||"text"](M,e);return!I&&k&&k(),await new Promise((L,$)=>{M2(L,$,{data:U,headers:oa.from(M.headers),status:M.status,statusText:M.statusText,config:e,request:S})})}catch(P){throw k&&k(),P&&P.name==="TypeError"&&/fetch/i.test(P.message)?Object.assign(new Wt("Network Error",Wt.ERR_NETWORK,e,S),{cause:P.cause||P}):Wt.from(P,P&&P.code,e,S)}}),S1={http:LU,xhr:h8,fetch:S8};Ge.forEach(S1,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const IC=e=>`- ${e}`,N8=e=>Ge.isFunction(e)||e===null||e===!1,z2={getAdapter:e=>{e=Ge.isArray(e)?e:[e];const{length:n}=e;let t,i;const a={};for(let o=0;o<n;o++){t=e[o];let l;if(i=t,!N8(t)&&(i=S1[(l=String(t)).toLowerCase()],i===void 0))throw new Wt(`Unknown adapter '${l}'`);if(i)break;a[l||"#"+o]=i}if(!i){const o=Object.entries(a).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let l=n?o.length>1?`since :
`+o.map(IC).join(`
`):" "+IC(o[0]):"as no adapter specified";throw new Wt("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return i},adapters:S1};function l0(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Vh(null,e)}function RC(e){return l0(e),e.headers=oa.from(e.headers),e.data=o0.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),z2.getAdapter(e.adapter||og.adapter)(e).then(function(i){return l0(e),i.data=o0.call(e,e.transformResponse,i),i.headers=oa.from(i.headers),i},function(i){return R2(i)||(l0(e),i&&i.response&&(i.response.data=o0.call(e,e.transformResponse,i.response),i.response.headers=oa.from(i.response.headers))),Promise.reject(i)})}const U2="1.8.4",Lb={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{Lb[e]=function(i){return typeof i===e||"a"+(n<1?"n ":" ")+e}});const MC={};Lb.transitional=function(n,t,i){function a(o,l){return"[Axios v"+U2+"] Transitional option '"+o+"'"+l+(i?". "+i:"")}return(o,l,d)=>{if(n===!1)throw new Wt(a(l," has been removed"+(t?" in "+t:"")),Wt.ERR_DEPRECATED);return t&&!MC[l]&&(MC[l]=!0,console.warn(a(l," has been deprecated since v"+t+" and will be removed in the near future"))),n?n(o,l,d):!0}};Lb.spelling=function(n){return(t,i)=>(console.warn(`${i} is likely a misspelling of ${n}`),!0)};function C8(e,n,t){if(typeof e!="object")throw new Wt("options must be an object",Wt.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let a=i.length;for(;a-- >0;){const o=i[a],l=n[o];if(l){const d=e[o],f=d===void 0||l(d,o,e);if(f!==!0)throw new Wt("option "+o+" must be "+f,Wt.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Wt("Unknown option "+o,Wt.ERR_BAD_OPTION)}}const Ux={assertOptions:C8,validators:Lb},Uo=Ux.validators;let Id=class{constructor(n){this.defaults=n,this.interceptors={request:new _C,response:new _C}}async request(n,t){try{return await this._request(n,t)}catch(i){if(i instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const o=a.stack?a.stack.replace(/^.+\n/,""):"";try{i.stack?o&&!String(i.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+o):i.stack=o}catch{}}throw i}}_request(n,t){typeof n=="string"?(t=t||{},t.url=n):t=n||{},t=Fd(this.defaults,t);const{transitional:i,paramsSerializer:a,headers:o}=t;i!==void 0&&Ux.assertOptions(i,{silentJSONParsing:Uo.transitional(Uo.boolean),forcedJSONParsing:Uo.transitional(Uo.boolean),clarifyTimeoutError:Uo.transitional(Uo.boolean)},!1),a!=null&&(Ge.isFunction(a)?t.paramsSerializer={serialize:a}:Ux.assertOptions(a,{encode:Uo.function,serialize:Uo.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Ux.assertOptions(t,{baseUrl:Uo.spelling("baseURL"),withXsrfToken:Uo.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let l=o&&Ge.merge(o.common,o[t.method]);o&&Ge.forEach(["delete","get","head","post","put","patch","common"],S=>{delete o[S]}),t.headers=oa.concat(l,o);const d=[];let f=!0;this.interceptors.request.forEach(function(k){typeof k.runWhen=="function"&&k.runWhen(t)===!1||(f=f&&k.synchronous,d.unshift(k.fulfilled,k.rejected))});const u=[];this.interceptors.response.forEach(function(k){u.push(k.fulfilled,k.rejected)});let p,g=0,b;if(!f){const S=[RC.bind(this),void 0];for(S.unshift.apply(S,d),S.push.apply(S,u),b=S.length,p=Promise.resolve(t);g<b;)p=p.then(S[g++],S[g++]);return p}b=d.length;let v=t;for(g=0;g<b;){const S=d[g++],k=d[g++];try{v=S(v)}catch(T){k.call(this,T);break}}try{p=RC.call(this,v)}catch(S){return Promise.reject(S)}for(g=0,b=u.length;g<b;)p=p.then(u[g++],u[g++]);return p}getUri(n){n=Fd(this.defaults,n);const t=O2(n.baseURL,n.url,n.allowAbsoluteUrls);return P2(t,n.params,n.paramsSerializer)}};Ge.forEach(["delete","get","head","options"],function(n){Id.prototype[n]=function(t,i){return this.request(Fd(i||{},{method:n,url:t,data:(i||{}).data}))}});Ge.forEach(["post","put","patch"],function(n){function t(i){return function(o,l,d){return this.request(Fd(d||{},{method:n,headers:i?{"Content-Type":"multipart/form-data"}:{},url:o,data:l}))}}Id.prototype[n]=t(),Id.prototype[n+"Form"]=t(!0)});let j8=class B2{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});const i=this;this.promise.then(a=>{if(!i._listeners)return;let o=i._listeners.length;for(;o-- >0;)i._listeners[o](a);i._listeners=null}),this.promise.then=a=>{let o;const l=new Promise(d=>{i.subscribe(d),o=d}).then(a);return l.cancel=function(){i.unsubscribe(o)},l},n(function(o,l,d){i.reason||(i.reason=new Vh(o,l,d),t(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const t=this._listeners.indexOf(n);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const n=new AbortController,t=i=>{n.abort(i)};return this.subscribe(t),n.signal.unsubscribe=()=>this.unsubscribe(t),n.signal}static source(){let n;return{token:new B2(function(a){n=a}),cancel:n}}};function _8(e){return function(t){return e.apply(null,t)}}function k8(e){return Ge.isObject(e)&&e.isAxiosError===!0}const N1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(N1).forEach(([e,n])=>{N1[n]=e});function q2(e){const n=new Id(e),t=v2(Id.prototype.request,n);return Ge.extend(t,Id.prototype,n,{allOwnKeys:!0}),Ge.extend(t,n,null,{allOwnKeys:!0}),t.create=function(a){return q2(Fd(e,a))},t}const _i=q2(og);_i.Axios=Id;_i.CanceledError=Vh;_i.CancelToken=j8;_i.isCancel=R2;_i.VERSION=U2;_i.toFormData=Mb;_i.AxiosError=Wt;_i.Cancel=_i.CanceledError;_i.all=function(n){return Promise.all(n)};_i.spread=_8;_i.isAxiosError=k8;_i.mergeConfig=Fd;_i.AxiosHeaders=oa;_i.formToJSON=e=>I2(Ge.isHTMLForm(e)?new FormData(e):e);_i.getAdapter=z2.getAdapter;_i.HttpStatusCode=N1;_i.default=_i;const{Axios:Lne,AxiosError:Fne,CanceledError:$ne,isCancel:zne,CancelToken:Une,VERSION:Bne,all:qne,Cancel:Vne,isAxiosError:Hne,spread:Gne,toFormData:Yne,AxiosHeaders:Wne,HttpStatusCode:Qne,formToJSON:Jne,getAdapter:Kne,mergeConfig:Xne}=_i,T8=()=>{const e=localStorage.getItem("currentClinicId");return e||(console.warn("getCurrentClinicId: Clinic ID not found. Returning null. Ensure this is implemented correctly."),null)},V2=()=>localStorage.getItem("authToken");function E8(){const[e,n]=w.useState(null),[t,i]=w.useState(!1);return w.useEffect(()=>{const d=()=>{i(!1),n(null)};if(e)return e.getTracks().forEach(f=>f.addEventListener("ended",d)),()=>{e.getTracks().forEach(f=>f.removeEventListener("ended",d))}},[e]),{type:"screen",start:async()=>{const d=await navigator.mediaDevices.getDisplayMedia({video:!0});return n(d),i(!0),d},stop:()=>{e&&(e.getTracks().forEach(d=>d.stop()),n(null),i(!1))},isStreaming:t,stream:e}}function A8(){const[e,n]=w.useState(null),[t,i]=w.useState(!1);return w.useEffect(()=>{const d=()=>{i(!1),n(null)};if(e)return e.getTracks().forEach(f=>f.addEventListener("ended",d)),()=>{e.getTracks().forEach(f=>f.removeEventListener("ended",d))}},[e]),{type:"webcam",start:async()=>{const d=await navigator.mediaDevices.getUserMedia({video:!0});return n(d),i(!0),d},stop:()=>{e&&(e.getTracks().forEach(d=>d.stop()),n(null),i(!1))},isStreaming:t,stream:e}}class P8 extends y2{constructor(t){super();Hn(this,"client");Hn(this,"_status","disconnected");Hn(this,"_session",null);Hn(this,"_model",null);Hn(this,"config",null);this.client=new p2(t),this.send=this.send.bind(this),this.onopen=this.onopen.bind(this),this.onerror=this.onerror.bind(this),this.onclose=this.onclose.bind(this),this.onmessage=this.onmessage.bind(this)}get status(){return this._status}get session(){return this._session}get model(){return this._model}getConfig(){return{...this.config}}log(t,i){const a={date:new Date,type:t,message:i};this.emit("log",a)}async connect(t,i){if(this._status==="connected"||this._status==="connecting")return!1;this._status="connecting",this.config=i,this._model=t;const a={onopen:this.onopen,onmessage:this.onmessage,onerror:this.onerror,onclose:this.onclose};try{this._session=await this.client.live.connect({model:t,config:i,callbacks:a})}catch(o){return console.error("Error connecting to GenAI Live:",o),this._status="disconnected",!1}return this._status="connected",!0}disconnect(){var t;return this.session?((t=this.session)==null||t.close(),this._session=null,this._status="disconnected",this.log("client.close","Disconnected"),!0):!1}onopen(){this.log("client.open","Connected"),this.emit("open")}onerror(t){this.log("server.error",t.message),this.emit("error",t)}onclose(t){this.log("server.close",`disconnected ${t.reason?`with reason: ${t.reason}`:""}`),this.emit("close",t)}async onmessage(t){var i;if(t.setupComplete){this.log("server.send","setupComplete"),this.emit("setupcomplete");return}if(t.toolCall){this.log("server.toolCall",t),this.emit("toolcall",t.toolCall);return}if(t.toolCallCancellation){this.log("server.toolCallCancellation",t),this.emit("toolcallcancellation",t.toolCallCancellation);return}if(t.serverContent){const{serverContent:a}=t;if("interrupted"in a){this.log("server.content","interrupted"),this.emit("interrupted");return}if("turnComplete"in a&&(this.log("server.content","turnComplete"),this.emit("turncomplete")),"modelTurn"in a){let o=((i=a.modelTurn)==null?void 0:i.parts)||[];const l=o.filter(p=>{var g;return p.inlineData&&((g=p.inlineData.mimeType)==null?void 0:g.startsWith("audio/pcm"))}),d=l.map(p=>{var g;return(g=p.inlineData)==null?void 0:g.data}),f=b2.difference(o,l);if(d.forEach(p=>{if(p){const g=qz(p);this.emit("audio",g),this.log("server.audio",`buffer (${g.byteLength})`)}}),!f.length)return;o=f;const u={modelTurn:{parts:o}};this.emit("content",u),this.log("server.content",t)}}else console.log("received unmatched message",t)}sendRealtimeInput(t){var l;let i=!1,a=!1;for(const d of t)if((l=this.session)==null||l.sendRealtimeInput({media:d}),d.mimeType.includes("audio")&&(i=!0),d.mimeType.includes("image")&&(a=!0),i&&a)break;const o=i&&a?"audio + video":i?"audio":a?"video":"unknown";this.log("client.realtimeInput",o)}sendToolResponse(t){var i;t.functionResponses&&t.functionResponses.length&&((i=this.session)==null||i.sendToolResponse({functionResponses:t.functionResponses}),this.log("client.toolResponse",t))}send(t,i=!0){var a;(a=this.session)==null||a.sendClientContent({turns:t,turnComplete:i}),this.log("client.send",{turns:Array.isArray(t)?t:[t],turnComplete:i})}}function D8(e){const n=w.useMemo(()=>new P8(e),[e]),t=w.useRef(null),[i,a]=w.useState("models/gemini-2.5-flash-live-preview"),[o,l]=w.useState({}),[d,f]=w.useState(!1),[u,p]=w.useState(0),[g,b]=w.useState(null);w.useEffect(()=>{t.current||m2({id:"audio-out"}).then(k=>{t.current=new Xz(k),t.current.addWorklet("vumeter-out",g2,T=>{p(T.data.volume)}).then(()=>{})})},[t]),w.useEffect(()=>{const k=()=>{f(!0)},T=()=>{f(!1)},P=L=>{console.error("error",L)},M=()=>{var L;return(L=t.current)==null?void 0:L.stop()},I=L=>{var $;return($=t.current)==null?void 0:$.addPCM16(new Uint8Array(L))},U=L=>{if(console.log("Received content event:",L),L.modelTurn&&L.modelTurn.parts){const $=L.modelTurn.parts.filter(z=>"text"in z&&z.text);if($.length>0){const z=$.map(F=>F.text).join(" ");b(z),console.log("AI Summary received:",z)}}};return n.on("error",P).on("open",k).on("close",T).on("interrupted",M).on("audio",I).on("content",U),()=>{n.off("error",P).off("open",k).off("close",T).off("interrupted",M).off("audio",I).off("content",U).disconnect()}},[n]);const v=w.useCallback(async()=>{if(!o)throw new Error("config has not been set");n.disconnect(),await n.connect(i,o)},[n,o,i]),S=w.useCallback(async()=>{n.disconnect(),f(!1)},[f,n]);return{client:n,config:o,setConfig:l,model:i,setModel:a,connected:d,connect:v,disconnect:S,volume:u,aiSummary:g}}const H2=w.createContext(void 0),Cw=({options:e,children:n})=>{const t=D8(e);return r.jsx(H2.Provider,{value:t,children:n})},mu=()=>{const e=w.useContext(H2);if(!e)throw new Error("useLiveAPIContext must be used wihin a LiveAPIProvider");return e};function I8(){const{config:e,setConfig:n}=mu(),[t,i]=w.useState({value:"audio",label:"audio"}),a=w.useCallback(o=>{n({...e,responseModalities:[o==="audio"?uu.AUDIO:uu.TEXT]})},[e,n]);return r.jsxs("div",{className:"select-group",children:[r.jsx("label",{htmlFor:"response-modality-selector",children:"Response modality"}),r.jsx(Kk,{id:"response-modality-selector",className:"react-select",classNamePrefix:"react-select",styles:{},defaultValue:t,options:[{value:"audio",label:"audio"},{value:"text",label:"text"}],onChange:o=>{i(o),o&&(o.value==="audio"||o.value==="text")&&a(o.value)}})]})}const OC=[{value:"Puck",label:"Puck"},{value:"Charon",label:"Charon"},{value:"Kore",label:"Kore"},{value:"Fenrir",label:"Fenrir"},{value:"Aoede",label:"Aoede"}];function R8(){const{config:e,setConfig:n}=mu();w.useEffect(()=>{var d,f,u;const o=((u=(f=(d=e.speechConfig)==null?void 0:d.voiceConfig)==null?void 0:f.prebuiltVoiceConfig)==null?void 0:u.voiceName)||"Atari02";i({value:o,label:o})},[e]);const[t,i]=w.useState(OC[5]),a=w.useCallback(o=>{n({...e,speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:o}}}})},[e,n]);return r.jsxs("div",{className:"select-group",children:[r.jsx("label",{htmlFor:"voice-selector",children:"Voice"}),r.jsx(Kk,{id:"voice-selector",className:"react-select",classNamePrefix:"react-select",styles:{},value:t,defaultValue:t,options:OC,onChange:o=>{i(o),o&&a(o.value)}})]})}function M8(){const[e,n]=w.useState(!1),{config:t,setConfig:i,connected:a}=mu(),o=w.useMemo(()=>Array.isArray(t.tools)?t.tools.filter(u=>Array.isArray(u.functionDeclarations)).map(u=>u.functionDeclarations).filter(u=>!!u).flat():[],[t]),l=w.useMemo(()=>{var u;return t.systemInstruction?typeof t.systemInstruction=="string"?t.systemInstruction:Array.isArray(t.systemInstruction)?t.systemInstruction.map(p=>typeof p=="string"?p:p.text).join(`
`):typeof t.systemInstruction=="object"&&"parts"in t.systemInstruction&&((u=t.systemInstruction.parts)==null?void 0:u.map(p=>p.text).join(`
`))||"":""},[t]),d=w.useCallback(u=>{const p={...t,systemInstruction:u.target.value};i(p)},[t,i]),f=w.useCallback((u,p)=>{var b;const g={...t,tools:((b=t.tools)==null?void 0:b.map(v=>{const S=v;return Array.isArray(S.functionDeclarations)?{...v,functionDeclarations:S.functionDeclarations.map(k=>k.name===u?{...k,description:p}:k)}:v}))||[]};i(g)},[t,i]);return r.jsxs("div",{className:"settings-dialog",children:[r.jsx("button",{className:"action-button material-symbols-outlined",onClick:()=>n(!e),children:"settings"}),r.jsx("dialog",{className:"dialog",style:{display:e?"block":"none"},children:r.jsxs("div",{className:`dialog-container ${a?"disabled":""}`,children:[a&&r.jsx("div",{className:"connected-indicator",children:r.jsx("p",{children:"These settings can only be applied before connecting and will override other settings."})}),r.jsxs("div",{className:"mode-selectors",children:[r.jsx(I8,{}),r.jsx(R8,{})]}),r.jsx("h3",{children:"System Instructions"}),r.jsx("textarea",{className:"system",onChange:d,value:l}),r.jsx("h4",{children:"Function declarations"}),r.jsx("div",{className:"function-declarations",children:r.jsx("div",{className:"fd-rows",children:o.map((u,p)=>{var g;return r.jsxs("div",{className:"fd-row",children:[r.jsx("span",{className:"fd-row-name",children:u.name}),r.jsx("span",{className:"fd-row-args",children:Object.keys(((g=u.parameters)==null?void 0:g.properties)||{}).map((b,v)=>r.jsx("span",{children:b},v))}),r.jsx("input",{className:"fd-row-description",type:"text",defaultValue:u.description,onBlur:b=>f(u.name,b.target.value)},`fd-${u.description}`)]},`function-${p}`)})})})]})})]})}const LC=w.memo(({isStreaming:e,onIcon:n,offIcon:t,start:i,stop:a})=>e?r.jsx("button",{className:"action-button",onClick:a,children:r.jsx("span",{className:"material-symbols-outlined",children:n})}):r.jsx("button",{className:"action-button",onClick:i,children:r.jsx("span",{className:"material-symbols-outlined",children:t})}));function O8({videoRef:e,children:n,onVideoStreamChange:t=()=>{},supportsVideo:i,enableEditingSettings:a}){const o=[A8(),E8()],[l,d]=w.useState(null),[f,u]=o,[p,g]=w.useState(0),[b]=w.useState(()=>new x2),[v,S]=w.useState(!1),k=w.useRef(null),T=w.useRef(null),{client:P,connected:M,connect:I,disconnect:U,volume:L}=mu();w.useEffect(()=>{!M&&T.current&&T.current.focus()},[M]),w.useEffect(()=>{document.documentElement.style.setProperty("--volume",`${Math.max(5,Math.min(p*200,8))}px`)},[p]),w.useEffect(()=>{const z=F=>{P.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:F}])};return M&&!v&&b?b.on("data",z).on("volume",g).start():b.stop(),()=>{b.off("data",z).off("volume",g)}},[M,P,v,b]),w.useEffect(()=>{e.current&&(e.current.srcObject=l);let z=-1;function F(){const Q=e.current,R=k.current;if(!Q||!R)return;const B=R.getContext("2d");if(R.width=Q.videoWidth*.25,R.height=Q.videoHeight*.25,R.width+R.height>0){B.drawImage(Q,0,0,R.width,R.height);const Y=R.toDataURL("image/jpeg",1),re=Y.slice(Y.indexOf(",")+1,1/0);P.sendRealtimeInput([{mimeType:"image/jpeg",data:re}])}M&&(z=window.setTimeout(F,1e3/.5))}return M&&l!==null&&requestAnimationFrame(F),()=>{clearTimeout(z)}},[M,l,P,e]);const $=z=>async()=>{if(z){const F=await z.start();d(F),t(F)}else d(null),t(null);o.filter(F=>F!==z).forEach(F=>F.stop())};return r.jsxs("section",{className:"control-tray",children:[r.jsx("canvas",{style:{display:"none"},ref:k}),r.jsxs("nav",{className:au("actions-nav",{disabled:!M}),children:[r.jsx("button",{className:au("action-button mic-button",{recording:!v&&M}),onClick:()=>S(!v),children:v?r.jsx("span",{className:"material-symbols-outlined filled",children:"mic_off"}):r.jsx("span",{className:"material-symbols-outlined filled",children:"mic"})}),r.jsx("div",{className:"action-button no-action outlined",children:r.jsx(Qz,{volume:L,active:M,hover:!1})}),i&&r.jsxs(r.Fragment,{children:[r.jsx(LC,{isStreaming:u.isStreaming,start:$(u),stop:$(),onIcon:"cancel_presentation",offIcon:"present_to_all"}),r.jsx(LC,{isStreaming:f.isStreaming,start:$(f),stop:$(),onIcon:"videocam_off",offIcon:"videocam"})]}),n]}),r.jsxs("div",{className:au("connection-container",{connected:M}),children:[r.jsx("div",{className:"connection-button-container",children:r.jsx("button",{ref:T,className:au("action-button connect-toggle",{connected:M}),onClick:M?U:I,children:r.jsx("span",{className:"material-symbols-outlined filled",children:M?"pause":"play_arrow"})})}),r.jsx("span",{className:"text-indicator",children:"Streaming"})]}),a?r.jsx(M8,{}):""]})}const FC={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Ih.OBJECT,properties:{summary:{type:Ih.STRING,description:"The summary of the patient's case."}},required:["summary"]}},L8=({patientData:e,tokenNumber:n})=>{const[t,i]=w.useState(""),{client:a,setConfig:o,setModel:l}=mu();return w.useEffect(()=>{l("models/gemini-2.5-flash-live-preview"),o({responseModalities:[uu.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:`Your job is to:

If patient details like name, age, sex, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details (e.g., phone number) are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's name, age, sex, and phone number.

When pronouncing a phone number, always state each digit individually (e.g., "six three" instead of "sixty-three" or "six billion three").

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in Telugu.dont write the telugu words in english`}]},tools:[{functionDeclarations:[FC]}]})},[o,l]),w.useEffect(()=>{const d=f=>{if(!f.functionCalls)return;const u=f.functionCalls.find(p=>p.name===FC.name);if(u){const p=u.args.summary;i(p)}f.functionCalls.length&&setTimeout(()=>{var p;return a.sendToolResponse({functionResponses:(p=f.functionCalls)==null?void 0:p.map(g=>({response:{output:{success:!0}},id:g.id,name:g.name}))})},200)};return a.on("toolcall",d),()=>{a.off("toolcall",d)}},[a]),w.useEffect(()=>{if(t){const d=encodeURIComponent(t);n?window.location.href=`https://hms.newtons.in/handle-complaint-url?token=${n}&caseDetails=${d}`:window.location.href=`https://hms.newtons.in/dashboard/search-patient?caseDetails=${d}`}},[t,n]),r.jsxs("div",{className:"hospital-reception",children:[r.jsx("h1",{children:"Newtons Ai"}),r.jsx("p",{children:"Newtons Ai"}),n&&r.jsxs("h2",{children:["Token Number: ",n]}),e&&r.jsxs("div",{children:[r.jsx("h2",{children:"Patient Details"}),r.jsx("pre",{children:JSON.stringify(e,null,2)})]}),t&&r.jsxs("div",{children:[r.jsx("h2",{children:"Case Summary (from Tool Call)"}),r.jsx("p",{children:t})]})]})},$C="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes";async function F8(){const e=V2();if(!e)return console.warn("No auth token found, using default Live API key."),$C;try{const t=(await _i.get("/api/clinics/gemini-api-key",{headers:{Authorization:`Bearer ${e}`}})).data.geminiApiKey;if(t)return t}catch(n){console.error("Failed to fetch clinic-specific Live API key:",n)}return console.warn("Clinic-specific Live API key not found or failed to fetch, using default."),$C}function $8(){const e=w.useRef(null),[n,t]=w.useState(null),[i,a]=w.useState(null);return w.useEffect(()=>{(async()=>{try{const l=await F8();a({apiKey:l})}catch(l){console.error("Error setting Live API options:",l)}})()},[]),i?r.jsx("div",{className:"App",children:r.jsx(Cw,{options:i,children:r.jsx(z8,{videoRef:e,setVideoStream:t,videoStream:n})})}):r.jsx("div",{children:"Loading Live API settings..."})}const z8=({videoRef:e,setVideoStream:n,videoStream:t})=>{const[i,a]=w.useState(null),[o,l]=w.useState(null),{connected:d,client:f,connect:u,config:p,model:g}=mu(),[b,v]=w.useState(""),S=w.useRef(null),[k,T]=w.useState(!1);w.useEffect(()=>{const M=window.matchMedia("(prefers-color-scheme: dark)"),I=U=>{document.documentElement.setAttribute("data-theme",U.matches?"dark":"light")};return I(M),M.addEventListener("change",I),()=>M.removeEventListener("change",I)},[]),w.useEffect(()=>{const M=new URLSearchParams(window.location.search),I={};for(const[U,L]of M.entries())U==="token_number"?l(L):I[U]=L;a(I)},[]),w.useEffect(()=>{Object.keys(p).length>0&&g&&u()},[u,p,g]),w.useEffect(()=>{if(d&&i&&!k){const M=JSON.stringify(i,null,2);f.send([{text:M}]),v(""),T(!0)}},[d,i,f,k]),w.useEffect(()=>{i&&v(JSON.stringify(i,null,2))},[i]);const P=()=>{f.send([{text:b}]),v(""),S.current&&(S.current.innerText="")};return r.jsx("div",{className:"streaming-console",children:r.jsxs("main",{children:[r.jsxs("div",{className:"main-app-area",children:[r.jsx(L8,{patientData:i,tokenNumber:o}),r.jsx("video",{className:au("stream",{hidden:!e.current||!t}),ref:e,autoPlay:!0,playsInline:!0})]}),r.jsx("div",{className:au("input-container",{disabled:!d}),children:r.jsxs("div",{className:"input-content",children:[r.jsx("textarea",{className:"input-area",ref:S,onKeyDown:M=>{M.key==="Enter"&&!M.shiftKey&&(M.preventDefault(),M.stopPropagation(),P())},onChange:M=>v(M.target.value),value:b}),r.jsx("span",{className:au("input-content-placeholder",{hidden:b.length}),children:"Typesomething..."}),r.jsx("button",{className:"send-button material-symbols-outlined filled",onClick:P,children:"send"})]})}),r.jsx(O8,{videoRef:e,supportsVideo:!0,onVideoStreamChange:n,enableEditingSettings:!0})]})})},zC="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",U8=({volume:e,active:n})=>{const t=Array.from({length:5},(i,a)=>r.jsx("div",{className:`audio-bar ${n?"active":""}`,style:{height:n?`${Math.min(24,20+e*40*(1+Math.sin(a)*.3))}px`:"8px",animationDelay:`${a*.1}s`}},a));return r.jsx("div",{className:"audio-pulse",children:t})},B8=w.forwardRef(({videoRef:e,supportsVideo:n,onVideoStreamChange:t,textInput:i,onSubmitTextInput:a},o)=>{var $;const{connected:l,connect:d,disconnect:f,client:u,volume:p}=mu(),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[P]=w.useState(()=>new x2),M=async()=>{l?await f():(await d(),i.trim()&&a())};w.useEffect(()=>{const z=F=>{u.sendRealtimeInput([{mimeType:"audio/pcm;rate=16000",data:F}])};return l&&!g?P.on("data",z).start():P.stop(),()=>{P.off("data",z),P.stop()}},[l,u,g,P]);const I=w.useCallback(async()=>{if(v)L==null||L.getTracks().forEach(z=>z.stop()),t(null),S(!1);else try{const z=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=z),t(z),S(!0)}catch(z){console.error("Error accessing webcam:",z),S(!1)}},[v,t,e]),U=w.useCallback(async()=>{if(k)L==null||L.getTracks().forEach(z=>z.stop()),t(null),T(!1);else try{const z=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1});e.current&&(e.current.srcObject=z),t(z),T(!0)}catch(z){console.error("Error accessing screen share:",z),T(!1)}},[k,t,e]),L=($=e.current)==null?void 0:$.srcObject;return w.useEffect(()=>()=>{L&&L.getTracks().forEach(z=>z.stop())},[L]),w.useImperativeHandle(o,()=>({handleConnect:M})),r.jsx("div",{className:"live-api-control-tray",children:r.jsxs("div",{className:"live-api-control-tray-inner",children:[r.jsxs("div",{className:"live-api-control-group",children:[r.jsx("button",{onClick:()=>b(!g),disabled:!l,className:`live-api-control-button ${l&&!g?"mic-active":"mic-inactive"}`,"aria-label":g?"Unmute microphone":"Mute microphone",children:g?r.jsx(aR,{className:"w-5 h-5"}):r.jsx(ak,{className:"w-5 h-5"})}),r.jsx("div",{className:"live-api-audio-pulse-container",children:r.jsx(U8,{volume:p,active:l})}),n&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:U,disabled:!l,className:`live-api-control-button ${k?"video-active":"video-inactive"}`,"aria-label":k?"Stop screen share":"Start screen share",children:r.jsx(lR,{className:"w-5 h-5"})}),r.jsx("button",{onClick:I,disabled:!l,className:`live-api-control-button ${v?"video-active":"video-inactive"}`,"aria-label":v?"Turn off webcam":"Turn on webcam",children:r.jsx(eM,{className:"w-5 h-5"})})]})]}),r.jsxs("div",{className:"live-api-control-group",children:[r.jsxs("div",{className:"live-api-status-indicator",children:[r.jsx("div",{className:`live-api-status-dot ${l?"connected":"disconnected"}`}),r.jsx("span",{className:"live-api-status-text",children:l?"Streaming":"Disconnected"})]}),r.jsx("button",{onClick:M,className:`live-api-connect-button ${l?"connected":"disconnected"}`,children:l?r.jsxs(r.Fragment,{children:[r.jsx(mR,{className:"w-5 h-5"}),r.jsx("span",{children:"Pause"})]}):r.jsxs(r.Fragment,{children:[r.jsx(SR,{className:"w-5 h-5"}),r.jsx("span",{children:"Start"})]})})]})]})})}),q8=({patientData:e,tokenNumber:n,aiSummary:t,clinicName:i})=>r.jsxs("div",{className:"hospital-reception-container",children:[r.jsxs("div",{className:"hospital-reception-logo-section",children:[r.jsx("div",{className:"hospital-reception-logo",children:r.jsx("span",{children:i.charAt(0)})}),r.jsxs("h1",{className:"hospital-reception-title",children:[i," AI"]}),r.jsxs("p",{className:"hospital-reception-subtitle",children:["Intelligent ",i," Reception Assistant"]})]}),n&&r.jsxs("div",{className:"hospital-reception-token-card",children:[r.jsx("h2",{className:"hospital-reception-token-title",children:"Token Number"}),r.jsx("p",{className:"hospital-reception-token-number",children:n})]}),e?r.jsxs("div",{className:"hospital-reception-patient-info-card",children:[r.jsx("h3",{className:"hospital-reception-patient-info-title",children:"Patient Information"}),r.jsx("div",{className:"hospital-reception-patient-info-content",children:r.jsx("pre",{className:"hospital-reception-patient-info-pre",children:JSON.stringify(e,null,2)})})]}):r.jsxs("div",{className:"hospital-reception-patient-info-card",children:[r.jsx("h3",{className:"hospital-reception-patient-info-title",children:"New Case"}),r.jsx("p",{className:"hospital-reception-patient-info-pre",children:"No patient data provided. This is a new case."})]}),t&&r.jsxs("div",{className:"hospital-reception-summary-card",children:[r.jsx("h3",{className:"hospital-reception-summary-title",children:"Case Summary"}),r.jsx("p",{className:"hospital-reception-summary-text",children:t})]})]}),UC={name:"case_summary",description:"Writes a summary of the patient's case in English.",parameters:{type:Ih.OBJECT,properties:{summary:{type:Ih.STRING,description:"The summary of the patient's case."}},required:["summary"]}},V8=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:i,clinicName:a})=>{const o=w.useRef(null),l=w.useRef(null),[d,f]=w.useState(null),[u,p]=w.useState("hi"),{client:g,connected:b,setConfig:v,setModel:S,disconnect:k}=mu(),T=w.useMemo(()=>{let L=`Your job is to:

If patient details like name, age, and case information are already provided, automatically understand that it's a repeat visit.

    If it's a repeat visit, warmly receive the patient by asking if their previous problems have resolved or how they are feeling now.

    If any required details (Name, Age) are missing even in a repeat visit, collect those missing details.

    If these details are not available (for a new visit), collect the patient's Name and Age only. Do not ask for their phone number.

    You should guess the patient's sex based on their voice or appearance.

For every visit, collect the patient's history by asking questions. Once you are confident about the history, you should use the 'case_summary' tool to write the summary of the case in English. After collecting all the information and summarizing the case, you should ask the patient to wait in the reception. You should always speak in Telugu. Dont write the telugu words in english.`;return n&&(L+=`

Patient Data: ${JSON.stringify(n,null,2)}`),{responseModalities:[uu.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Aoede"}}},systemInstruction:{parts:[{text:L}]},tools:[{functionDeclarations:[UC]}]}},[n]);w.useEffect(()=>{S("models/gemini-2.5-flash-native-audio-preview-12-2025"),v(T);const L=setTimeout(()=>{l.current&&!b&&l.current.handleConnect()},2e3);return()=>clearTimeout(L)},[v,S,T,b]),w.useEffect(()=>()=>{b&&k()},[b,k]);const[P,M]=w.useState(null);w.useEffect(()=>{const L=$=>{if(!$.functionCalls)return;const z=$.functionCalls.find(F=>F.name===UC.name);if(z){const F=z.args.summary;M(F),i(F)}$.functionCalls.length&&setTimeout(()=>{var F;return g.sendToolResponse({functionResponses:(F=$.functionCalls)==null?void 0:F.map(Q=>({response:{output:{success:!0}},id:Q.id,name:Q.name}))})},200)};return g.on("toolcall",L),()=>{g.off("toolcall",L)}},[g,i]);const I=()=>{u.trim()&&(g.send([{text:u}]),p(""))},U=L=>{L.key==="Enter"&&!L.shiftKey&&(L.preventDefault(),I())};return r.jsx("div",{className:"live-api-modal-overlay",children:r.jsxs("div",{className:"live-api-modal-content",children:[r.jsxs("div",{className:"live-api-modal-header",children:[r.jsxs("div",{className:"live-api-modal-header-left",children:[r.jsx("div",{className:"live-api-modal-logo",children:r.jsx("span",{children:a.charAt(0)})}),r.jsxs("div",{children:[r.jsx("h1",{className:"live-api-modal-title",children:a}),r.jsxs("p",{className:"live-api-modal-subtitle",children:[a," Hospital Assistant"]})]})]}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsx("button",{onClick:e,className:"live-api-modal-close-button","aria-label":"Close modal",children:r.jsx(Qn,{className:"w-6 h-6"})})})]}),r.jsx("div",{className:"live-api-modal-main-content",children:r.jsxs("div",{className:"flex-1 flex flex-col",children:[r.jsxs("div",{className:"live-api-reception-area",children:[r.jsx(q8,{patientData:n,tokenNumber:t,aiSummary:P,clinicName:a}),d&&r.jsx("video",{ref:o,autoPlay:!0,playsInline:!0,className:"live-api-video-stream"})]}),r.jsx("div",{className:"live-api-input-area",children:r.jsxs("div",{className:"live-api-input-container",children:[r.jsx("textarea",{value:u,onChange:L=>p(L.target.value),onKeyDown:U,placeholder:"Type your message here...",disabled:!b,rows:1,className:"live-api-textarea"}),r.jsx("button",{onClick:I,disabled:!b||!u.trim(),className:"live-api-send-button","aria-label":"Send message",children:r.jsx(ER,{className:"w-5 h-5"})})]})}),r.jsx(B8,{ref:l,videoRef:o,supportsVideo:!0,onVideoStreamChange:f,textInput:u,onSubmitTextInput:I})]})})]})})},G2=({onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:i})=>{const[a,o]=w.useState(null),[l,d]=w.useState("Newtons Ai"),[f,u]=w.useState(!0);if(w.useEffect(()=>{(async()=>{try{let b=null,v="Newtons Ai";try{const S=await me("/api/clinics/settings");if(S.ok){const k=await S.json();k.name&&k.name!==""&&(v=k.name),k.gemini_api_key&&k.gemini_api_key.trim()!==""&&(b=k.gemini_api_key.trim())}}catch(S){console.warn("Failed to fetch clinic settings",S)}if(d(v),b)o(b);else{try{const S=await me("/api/global-settings/app_gemini_api_key");if(S.ok){const k=await S.json();if(k.value&&k.value.trim()!==""){o(k.value.trim());return}}}catch(S){console.warn("Failed to fetch global key fallback",S)}o(zC)}}catch(b){console.error("Unexpected error in getSettings:",b),o(zC)}finally{u(!1)}})()},[]),f)return r.jsx("div",{className:"live-api-modal-overlay",children:r.jsx("div",{className:"live-api-modal-content",style:{maxHeight:"200px",maxWidth:"400px",borderRadius:"1rem",justifyContent:"center"},children:r.jsxs("div",{className:"live-api-loading-container",children:[r.jsx("div",{className:"live-api-loading-spinner"}),r.jsx("div",{className:"live-api-loading-text",children:"Initializing AI Assistant..."})]})})});if(!a)return r.jsx("div",{className:"live-api-modal-overlay",children:r.jsx("div",{className:"live-api-modal-content",children:r.jsx("div",{children:"Error: API Key not available."})})});const p={apiKey:a};return r.jsx(Cw,{options:p,children:r.jsx(V8,{onClose:e,patientData:n,tokenNumber:t,onAiSummaryChange:i,clinicName:l})})},H8="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",G8={apiKey:H8},Sh=()=>{const[e,n]=w.useState(""),[t,i]=w.useState([]),[a,o]=w.useState(!1),[l,d]=w.useState(null),[f,u]=w.useState(!1),[p,g]=w.useState(null),b=w.useRef(null),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[P,M]=w.useState(null),[I,U]=w.useState(null),[L,$]=w.useState([]),z=_t(),F=Gi();w.useEffect(()=>{(async()=>{try{const W=new URLSearchParams({page:"1",limit:"5",sortBy:"createdAt",sortOrder:"desc"}),J=await me(`/api/patients?${W.toString()}`);if(J.ok){const he=await J.json();$(he.patients||[])}}catch(W){console.error("Error fetching recent patients:",W)}})()},[]);const Q=w.useCallback(async V=>{const W=V||e;if(!W.trim()){g("Please enter complaint details.");return}u(!0),g(null);try{const J=await me("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"New Patient - Direct Entry",age:null,gender:null,phone:null,address:null})});if(!J.ok){const se=await J.json().catch(()=>({message:"Failed to create patient"}));if(J.status===403&&se.message.includes("Patient limit")){z("/start-clinic-subscription",{state:{errorMessage:se.message}});return}throw new Error(se.message||`Failed to create patient: ${J.statusText}`)}const he=await J.json();if(!he||!he.id)throw new Error("Failed to create new patient or retrieve patient ID.");const A=await me("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:he.id,complaint:W})});if(!A.ok){const se=await A.text();throw new Error(`Failed to create queue entry: ${se||A.statusText}`)}const ce=await A.json();if(!ce||!ce.id)throw new Error("Failed to create new complaint record or retrieve record ID.");z(`/dashboard/edit-complaint/${ce.id}`,{state:{initialComplaint:W}})}catch(J){console.error("Error starting new complaint:",J),J.message.includes("Patient limit")?(g(`Error: ${J.message}. Please upgrade your plan.`),z("/start-clinic-subscription")):g(`Error: ${J.message||"Failed to start new complaint process."}`)}finally{u(!1)}},[e,z]);w.useEffect(()=>{const V=b.current;V&&(V.style.height="auto",V.style.height=`${V.scrollHeight}px`);const J=new URLSearchParams(F.search).get("caseDetails");if(J){const he=decodeURIComponent(J);he!==e&&(n(he),S(!0))}},[F.search,e]),w.useEffect(()=>{v&&e.trim()&&(z(F.pathname,{replace:!0}),Q(e),S(!1))},[v,e,Q,z,F.pathname]),w.useEffect(()=>{const V=b.current;V&&(V.style.height="auto",V.style.height=`${V.scrollHeight}px`)},[e]),w.useEffect(()=>{P&&(n(P),T(!1),Q(P),M(null))},[P,Q]);const R=()=>{U({id:null,token:null,name:"New Case",age:null,gender:null}),T(!0)},B=w.useMemo(()=>wb(async V=>{const W=V.trim(),J=/^\d+$/.test(W),he=W.split(/\s+/).length;if(W.length<2||J&&W.length>10||!J&&he>2){i([]),o(!1),d(null);return}o(!0),d(null);try{const A=new URLSearchParams({search:encodeURIComponent(V),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),ce=await me(`/api/patients?${A.toString()}`);if(!ce.ok){const D=await ce.text();throw new Error(`API Error (${ce.status}): ${D||ce.statusText}`)}const se=await ce.json();i(se.patients)}catch(A){console.error("Error searching patients:",A),d(A.message||"Failed to search patients."),i([])}finally{o(!1)}},300),[]),Y=V=>{const W=V.target.value;n(W);const J=W.trim(),he=/^\d+$/.test(J),A=J.split(/\s+/).length;J.length>=2&&!(he&&J.length>10||!he&&A>2)?o(!0):(o(!1),i([])),B(W)},re=V=>{V.key==="Enter"&&!V.shiftKey&&(V.preventDefault(),t.length>0&&!a?ne(t[0]):e.trim()&&!a&&Q(e))},ne=async V=>{V&&V.id&&z(`/dashboard/edit-complaint/patient/${V.id}`)},G=[{icon:"",title:"Example: Fever & Cold",description:"Rajesh Kumar, 35 year old male, fever since 2 days, cold, body pain, no cough",text:"Rajesh Kumar, 35 year old male, fever since 2 days, cold, body pain, no cough"},{icon:"",title:"Example: Stomach Ache",description:"Priya Sharma, 28 year old female, stomach pain after eating, acidity, bloating since 3 days",text:"Priya Sharma, 28 year old female, stomach pain after eating, acidity, bloating since 3 days"}];return r.jsxs("div",{className:"patient-search-page-container",children:[r.jsxs("div",{className:"patient-search-header",children:[r.jsx("button",{onClick:()=>z("/dashboard/queue"),className:"patient-search-button patient-search-button-primary",children:"OPD Queue"}),r.jsx("button",{onClick:()=>z(-1),className:"patient-search-button patient-search-button-back",children:r.jsx(rn,{size:16})})]}),r.jsxs("div",{className:"patient-search-content-box",children:[l&&r.jsx("p",{className:"patient-search-error",children:l}),p&&r.jsx("p",{className:"patient-search-error",children:p}),L.length>0&&r.jsxs("div",{className:"newly-registered-section",children:[r.jsx("div",{className:"recent-list",children:L.map(V=>r.jsxs("div",{className:"recent-patient-pill",onClick:()=>ne(V),children:[r.jsxs("div",{className:"recent-name-container",children:[r.jsx("span",{className:"recent-name",children:V.name||"New Patient"}),r.jsxs("span",{className:"recent-token",children:["#",V.token]})]}),r.jsxs("div",{className:"recent-info",children:[V.age," yrs / ",V.gender]})]},V.id))}),r.jsx("div",{className:"newly-registered-label",children:"NEWLY REGISTERED"})]}),r.jsxs("div",{className:"example-cases-section",children:[r.jsxs("div",{className:"example-cases-header",children:[r.jsx("span",{className:"sparkles-icon",children:""}),r.jsx("h3",{children:"Try AI with Example Cases"})]}),r.jsx("div",{className:"example-cards-container",children:G.map((V,W)=>r.jsxs("div",{className:"example-case-card",onClick:()=>n(V.text),children:[r.jsx("div",{className:"example-icon",children:V.icon}),r.jsxs("div",{className:"example-content",children:[r.jsx("div",{className:"example-title",children:V.title}),r.jsx("div",{className:"example-description",children:V.description})]})]},W))})]})]}),r.jsxs("div",{className:"sticky-chat-input-box",children:[t.length>0&&!f&&r.jsx("ul",{className:"patient-search-results-list",children:t.map(V=>r.jsxs("li",{onClick:()=>ne(V),className:"patient-search-result-item",children:[r.jsxs("div",{className:"patient-search-result-item-name-container",children:[r.jsxs("span",{className:"patient-search-result-item-token",children:["[#",V.token,"]"]}),r.jsx("span",{className:"patient-search-result-item-name",children:V.name})]}),r.jsxs("div",{className:"patient-search-result-item-details",children:[V.age?`${V.age} yrs`:"",V.age&&V.gender?" / ":"",V.gender||"N/A"]})]},V.id))}),e.length>=2&&!a&&t.length===0&&!l&&r.jsxs("p",{className:"patient-search-no-results",children:['No patients found matching, taking new case: "',e,'".']}),r.jsxs("div",{className:"chat-input-controls",children:[r.jsx("textarea",{ref:b,placeholder:"Search by Name/Phone/Token or Enter New Case: Name, Age, Sex, Complaint...",value:e,onChange:Y,onKeyDown:re,className:"chat-input",autoFocus:!0,disabled:f,rows:1}),r.jsx("button",{onClick:e.trim()?()=>Q(e):R,className:`chat-submit-button ${f||a?"opacity-50":""}`,disabled:f||a||!!e.trim()&&!e.trim(),"aria-label":e.trim()?"Create New Case":"Use Microphone",children:f||a?r.jsx("div",{className:"spinner"}):e.trim()?r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24",children:r.jsx("path",{d:"M12 4l1.41 1.41L7.83 11H20v2H7.83l5.58 5.59L12 20l-8-8 8-8z",transform:"rotate(90 12 12)"})}):r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"24",height:"24",children:r.jsx("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm-1.2-9.1c0-.66.54-1.2 1.2-1.2s1.2.54 1.2 1.2V9c0 .66-.54 1.2-1.2 1.2s-1.2-.54-1.2-1.2V4.9zM17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"})})})]})]}),k&&r.jsx(Cw,{options:G8,children:r.jsx(G2,{onClose:()=>T(!1),patientData:I,tokenNumber:null,onAiSummaryChange:M})})]})},Y8=({})=>{const e=_t(),[n]=w.useState("patientSearch"),[t]=w.useState(!1),[i,a]=w.useState(null),[o,l]=w.useState(null);return w.useEffect(()=>{if(o){const d=setTimeout(()=>l(null),5e3);return()=>clearTimeout(d)}},[o]),t?r.jsxs("div",{className:"loading-animation-container",children:[" ",r.jsx("div",{className:"breathing-ball"}),r.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Admin Panel..."})]}):r.jsxs("div",{className:"admin-panel-container",children:[" ",o&&r.jsxs("div",{className:`alert-box ${o.type==="success"?"alert-box-success":"alert-box-error"} fixed top-4 right-4 z-[100]`,role:"alert",children:[r.jsx("div",{className:"alert-box-icon",children:o.type==="success"?r.jsx(cs,{size:18}):r.jsx(Hi,{size:18})}),r.jsx("div",{className:"alert-box-content",children:r.jsx("span",{children:o.message})}),r.jsx("button",{onClick:()=>l(null),className:"alert-box-close",children:r.jsx(Qn,{size:16})})]}),i&&r.jsxs("div",{className:"alert-box alert-box-error mb-4",role:"alert",children:[" ",r.jsx("div",{className:"alert-box-icon",children:r.jsx(Hi,{size:18})}),r.jsx("div",{className:"alert-box-content",children:r.jsx("span",{className:"block sm:inline flex-1",children:i})}),r.jsx("button",{onClick:()=>a(null),className:"alert-box-close",children:r.jsx(Qn,{size:16})})]}),r.jsxs("div",{className:"admin-nav-bar",children:[" ",r.jsxs("button",{onClick:()=>window.location.reload(),className:"admin-nav-button",title:"Refresh Page",children:[r.jsx(nk,{})," "]}),r.jsxs("button",{onClick:()=>e("/dashboard/clinic-hub"),className:"admin-nav-button",children:[r.jsx(rk,{})," Clinic Hub"]}),r.jsxs("button",{onClick:()=>e("/dashboard/inventory"),className:"admin-nav-button",children:[r.jsx(ig,{})," Inventory Management"]}),r.jsxs("button",{onClick:()=>e("/dashboard/analysis"),className:"admin-nav-button",children:[r.jsx(Z0,{})," Analysis Dashboard"]}),r.jsx("button",{onClick:()=>e("/lab-inventory"),className:"admin-nav-button hidden-button",children:"Lab Inventory"}),r.jsxs("button",{onClick:()=>e("/dashboard/subscriptions"),className:"admin-nav-button hidden-button",children:[r.jsx(OI,{})," Patient Subscriptions"]}),r.jsx("button",{onClick:()=>e("/refill-reminders"),className:"admin-nav-button",children:"Refill Reminders"}),r.jsxs("button",{onClick:()=>e("/create-lab-order"),className:"admin-nav-button",children:[r.jsx(Z0,{})," Lab Tests"]}),r.jsxs("button",{onClick:()=>e("/dashboard/patients"),className:"admin-nav-button",children:[r.jsx(zh,{})," All Patients"]})]}),r.jsxs("div",{className:"space-y-6",children:[" ",n==="patientSearch"&&r.jsx("div",{className:"admin-content-section",children:r.jsx(Sh,{})})]})]})},Zc=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},W8=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},hh=({title:e,icon:n,items:t,renderItemContent:i,isLoading:a,loadingText:o,noDataText:l})=>{const d=w.useMemo(()=>{const f={};t.forEach(p=>{if(isNaN(p.date.getTime())){f["Unknown Date"]||(f["Unknown Date"]=[]),f["Unknown Date"].push(p);return}const g=W8(p.originalDateString);f[g]||(f[g]=[]),f[g].push(p)});const u=Object.keys(f);return u.sort((p,g)=>{if(p==="Unknown Date")return 1;if(g==="Unknown Date")return-1;try{const b=k=>{const T=k.split(" ");if(T.length===3){const M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(T[1]);if(M!==-1)return new Date(parseInt(T[2]),M,parseInt(T[0]))}return new Date(k)},v=b(p),S=b(g);if(!isNaN(v.getTime())&&!isNaN(S.getTime()))return S.getTime()-v.getTime()}catch(b){console.error("Error parsing date for sorting:",b)}return g.localeCompare(p)}),u.map(p=>({date:p,items:f[p]}))},[t]);return r.jsxs("div",{className:"mb-2 p-2 bg-gray-50 rounded-md border border-gray-200",children:[r.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-1.5 border-b border-gray-300 pb-1 flex items-center",children:[" ",n&&r.jsx(n,{size:14,className:"mr-1.5 text-indigo-600"})," ",e]}),a&&r.jsx("p",{className:"text-gray-500 italic text-xs px-1",children:o}),!a&&t.length===0&&r.jsx("p",{className:"text-gray-500 italic text-xs px-1",children:l}),!a&&t.length>0&&r.jsxs("div",{className:"space-y-2",children:[" ",d.map(({date:f,items:u})=>r.jsxs("div",{className:"pl-0.5",children:[" ",r.jsxs("h5",{className:"text-[11px] font-medium text-indigo-700 mb-1 bg-indigo-50 px-1 py-0.5 rounded-sm inline-block",children:[" ",f]}),r.jsx("div",{className:"space-y-1 pl-1.5 border-l-2 border-indigo-200 ml-0.5",children:u.map((p,g)=>r.jsxs("div",{className:"text-xs py-0 flex items-start",children:[" ",r.jsx("div",{className:"flex-grow mr-1",children:i(p)})," "]},`${p.type}-${p.originalDateString}-${g}`))})]},f))]})]})},c0=()=>{var G,V;const[e,n]=w.useState({currentPatient:null,nextPatient:null,waitingCount:0}),[t,i]=w.useState(!0),[a,o]=w.useState(null),[l,d]=w.useState(null),[f,u]=w.useState(null),[p,g]=w.useState(null),[b,v]=w.useState({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),[S,k]=w.useState(!1),[T,P]=w.useState(null),{patientId:M}=Br(),I=_t(),U=w.useCallback(async W=>{g(null),d(null),u(null),k(!0),P(null),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]});try{const J=await me(`/api/patients/${W}`);if(!J.ok)throw new Error(`Patient details fetch failed (${J.status})`);const he=await J.json();d(he);const A=await me(`/api/queue/patient/${W}/latest`);if(!A.ok&&A.status!==404)throw new Error(`Queue entry fetch failed (${A.status})`);if(A.ok){const ce=await A.json();u(ce)}await L(W)}catch(J){console.error("Error fetching specific patient data:",J),g(J.message||"Failed to load patient data."),P(J.message||"Failed to load patient history.")}finally{k(!1)}},[]),L=w.useCallback(async W=>{k(!0),P(null);try{const[J,he,A,ce]=await Promise.all([me(`/api/queue/patient/${W}/complaints`),me(`/api/lab/patient/${W}`),me(`/api/lab/orders/patient/${W}?status=pending`),me(`/api/pharmacy-orders/patient/${W}`)]),se=J.ok?await J.json():[],D=he.ok?await he.json():[],oe=A.ok?await A.json():[],xe=ce.ok?await ce.json():[];v({pastComplaints:se||[],labReports:D||[],pendingLabOrders:oe||[],pharmacyOrders:xe||[]})}catch(J){console.error("Error fetching patient history:",J),P(J.message||"Failed to load patient history."),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]})}finally{k(!1)}},[]),$=w.useCallback(async()=>{i(!0),o(null);try{const W=await me("/api/queue/doctor");if(!W.ok){const he=await W.text();throw new Error(`API Error (${W.status}): ${he||W.statusText}`)}const J=await W.json();if(J===null||typeof J!="object"||typeof J.waitingCount!="number")throw console.error("Invalid queue data format:",J),new Error("Invalid queue data format received");n({currentPatient:J.currentPatient||null,nextPatient:J.nextPatient||null,waitingCount:J.waitingCount})}catch(W){console.error("Error fetching queue data:",W),o(W.message||"Failed to fetch queue data.")}finally{i(!1)}},[]);w.useEffect(()=>{let W=null;return M?(U(M),n({currentPatient:null,nextPatient:null,waitingCount:0})):($(),W=setInterval($,1e4),d(null),u(null)),()=>{W&&clearInterval(W)}},[M,U,$]),w.useEffect(()=>{var W;!M&&((W=e.currentPatient)!=null&&W.patientId)?L(e.currentPatient.patientId):!M&&!e.currentPatient&&(v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),P(null))},[M,(G=e.currentPatient)==null?void 0:G.patientId,L]);const z=((V=e.currentPatient)==null?void 0:V.patientId)||(M?parseInt(M,10):null),F=w.useMemo(()=>{if(!z||!b.pastComplaints)return[];const W=b.pastComplaints.map(J=>({date:new Date(J.createdAt),type:"Complaint",data:J,originalDateString:J.createdAt})).filter(J=>!isNaN(J.date.getTime()));return W.sort((J,he)=>he.date.getTime()-J.date.getTime()),W},[z,b.pastComplaints]),Q=w.useMemo(()=>{if(!z)return[];const W=[];return(b.pendingLabOrders??[]).forEach(J=>{const he=new Date(J.createdAt);isNaN(he.getTime())||W.push({date:he,type:"Lab Order (Pending)",data:J,originalDateString:J.createdAt})}),(b.labReports??[]).forEach(J=>{const he=J.reportCreatedAt?new Date(J.reportCreatedAt):null;he&&!isNaN(he.getTime())&&W.push({date:he,type:"Lab Report",data:J,originalDateString:J.reportCreatedAt})}),W.sort((J,he)=>he.date.getTime()-J.date.getTime()),W},[z,b.pendingLabOrders,b.labReports]),R=w.useMemo(()=>{if(!z||!b.pharmacyOrders)return[];const W=b.pharmacyOrders.map(J=>({date:new Date(J.date),type:"Pharmacy Order",data:J,originalDateString:J.date})).filter(J=>!isNaN(J.date.getTime()));return W.sort((J,he)=>he.date.getTime()-J.date.getTime()),W},[z,b.pharmacyOrders]),B=async()=>{i(!0),o(null);try{await me("/api/queue/doctor/next",{method:"POST"}),await $()}catch(W){console.error("Error calling next patient:",W),o(W.message||"Failed to call next patient.")}finally{i(!1)}},Y=async()=>{if(!(!e.currentPatient||M)){i(!0),o(null);try{await me(`/api/queue/doctor/complete/${e.currentPatient._id}`,{method:"POST"}),await $(),v({pastComplaints:[],labReports:[],pendingLabOrders:[],pharmacyOrders:[]}),k(!1),P(null)}catch(W){console.error("Error completing consultation:",W),o(W.message||"Failed to complete consultation.")}finally{i(!1)}}},re=W=>{switch(W){case"waiting":return"Waiting";case"consulting":return"Consulting";case"seen":return"Seen";case"cancelled":return"Cancelled";default:return W}};let ne=null;return e.currentPatient&&(ne=r.jsxs("div",{className:"patient-info-section bg-white rounded-lg shadow-md p-4 md:p-6 border-l-8 border-teal-500",children:[r.jsx("h2",{className:"text-xl text-teal-700 font-semibold mb-3",children:"NOW SEEING:"}),r.jsxs("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[r.jsxs("div",{className:"flex-grow md:w-1/2",children:[r.jsxs("div",{className:"flex justify-between items-start mb-3",children:[r.jsxs("div",{className:"flex-grow mr-4",children:[r.jsx("div",{className:"text-3xl md:text-4xl font-bold text-gray-800 mb-1",children:e.currentPatient.name}),r.jsxs("div",{className:"text-lg md:text-xl text-gray-600",children:[r.jsx("span",{className:"font-bold",children:e.currentPatient.age})," | ",r.jsx("span",{className:"font-bold",children:e.currentPatient.gender})]})]}),r.jsxs("div",{className:"text-right flex-shrink-0",children:[r.jsx("div",{className:"text-2xl md:text-3xl font-bold text-gray-700 mb-1",children:e.currentPatient.token}),r.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-sm md:text-base font-medium ${e.currentPatient.status==="consulting"?"bg-teal-100 text-teal-800":"bg-gray-100 text-gray-800"}`,children:re(e.currentPatient.status)})]})]}),r.jsxs("div",{className:"actions-section mt-4 md:mt-6 flex justify-end space-x-3 border-t pt-4",children:[r.jsx("button",{onClick:()=>{var J;const W=(J=e.currentPatient)==null?void 0:J._id;W&&I(`/dashboard/edit-complaint/${W}`)},disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:"Edit Complaint / AI"}),r.jsx("button",{onClick:Y,disabled:t||!e.currentPatient||e.currentPatient.status!=="consulting",className:"btn btn-success disabled:opacity-50 disabled:cursor-not-allowed",children:"Complete Consultation"})]})]})," ",r.jsxs("div",{className:"complaint-section md:w-1/2 mt-4 md:mt-0 border-t md:border-t-0 md:border-l md:pl-6 pt-4 md:pt-0",children:[r.jsx("h3",{className:"text-base font-semibold text-gray-800 mb-2",children:"Context & History:"}),T&&r.jsx("p",{className:"text-red-500 text-xs mb-2",children:T}),r.jsxs("div",{className:"space-y-2 pr-2",children:[r.jsx(hh,{title:"Complaints History",icon:su,items:F,isLoading:S,loadingText:"Loading complaints...",noDataText:"No past complaints found.",renderItemContent:W=>r.jsxs("span",{className:"block text-xs",children:[W.data.complaint,r.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Zc(W.originalDateString),")"]})]})}),r.jsx(hh,{title:"Lab History (Orders & Reports)",icon:Yl,items:Q,isLoading:S,loadingText:"Loading lab history...",noDataText:"No lab history found.",renderItemContent:W=>W.type==="Lab Order (Pending)"?r.jsxs("span",{className:"flex items-start text-xs",children:[r.jsx(Jx,{size:12,className:"mr-1.5 mt-0.5 text-blue-600 flex-shrink-0"}),r.jsxs("span",{className:"block",children:[r.jsx("span",{className:"font-medium text-blue-700",children:"Order:"})," ",W.data.tests.map(J=>J.name).join(", ")," ",r.jsxs("span",{className:"text-gray-600",children:["(",W.data.status,")"]}),r.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Zc(W.originalDateString),")"]})]})]}):r.jsxs("span",{className:"flex items-start text-xs",children:[r.jsx(OS,{size:12,className:"mr-1.5 mt-0.5 text-green-600 flex-shrink-0"}),r.jsxs("span",{className:"block",children:[r.jsx("span",{className:"font-medium text-green-700",children:"Report:"})," ",W.data.testName," - ",W.data.reportFindings.substring(0,50),W.data.reportFindings.length>50?"...":"",r.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Zc(W.originalDateString),")"]})]})]})}),r.jsx(hh,{title:"Pharmacy Order History",icon:Md,items:R,isLoading:S,loadingText:"Loading pharmacy orders...",noDataText:"No pharmacy order history found.",renderItemContent:W=>r.jsxs("span",{className:"block text-xs",children:[W.data.medications.map(J=>`${J.name} (Qty: ${J.quantity})`).join(", ")," ",r.jsxs("span",{className:"text-gray-600",children:["(",W.data.status,")"]}),r.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Zc(W.originalDateString),")"]})]})}),F.length===0&&Q.length===0&&R.length===0&&!S&&r.jsx("p",{className:"text-gray-500 italic text-xs mt-2 px-1",children:"No history found for this patient."})]})," "]})," "]})," "]})),r.jsx(r.Fragment,{children:r.jsxs("div",{className:"doctor-screen-container flex-grow flex flex-col space-y-6 md:space-y-8",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("button",{onClick:()=>I(-1),className:"back-button mr-4",children:r.jsx(rn,{size:24})}),r.jsx("h1",{className:"doctor-screen-header",children:"Doctor Consultation Panel"})]}),M?r.jsxs(r.Fragment,{children:[p&&r.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:p}),l&&r.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 border-l-8 border-purple-500",children:[r.jsxs("div",{className:"flex justify-between items-center mb-3",children:[r.jsx("h2",{className:"text-xl text-purple-700 font-semibold",children:"Patient Record:"}),r.jsx("button",{onClick:()=>I("/dashboard/doctor"),className:"text-sm text-blue-600 hover:underline",children:"Back to Queue"})]}),r.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-1 md:mb-2",children:l.name}),r.jsxs("div",{className:"text-lg md:text-xl text-gray-600 mb-3 md:mb-4",children:["Age: ",l.age??"N/A"," | ",l.gender??"N/A"]}),r.jsxs("div",{className:"mt-3 md:mt-4 p-3 bg-gray-50 rounded border border-gray-200",children:[r.jsx("label",{className:"font-medium block mb-1 text-sm text-gray-600",children:"Latest Queue Entry:"}),f?r.jsxs("div",{className:"space-y-2",children:[" ",r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("span",{className:"text-sm flex-1 break-words",children:[r.jsxs("span",{className:"font-medium text-gray-700",children:["(",f.age," / ",f.gender,")"]}),": ",f.complaint||r.jsx("span",{className:"text-gray-400 italic",children:"No complaint"}),r.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full text-xs font-medium ${f.status==="consulting"?"bg-teal-100 text-teal-800":f.status==="seen"?"bg-green-100 text-green-800":f.status==="waiting"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:re(f.status)})]}),f.status==="consulting"&&f._id&&r.jsx("button",{onClick:()=>I(`/dashboard/edit-complaint/${f._id}`),className:"ml-4 px-2 py-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 rounded flex-shrink-0",children:"Edit"})]}),f.case_summary&&r.jsxs("p",{className:"text-xs text-gray-700 bg-yellow-50 p-2 rounded border border-yellow-200",children:[r.jsx("span",{className:"font-semibold text-gray-800",children:"AI Summary:"})," ",f.case_summary]})]}):r.jsx("p",{className:"text-gray-500 italic text-sm",children:"No queue entry found for this patient today."})]}),r.jsxs("div",{className:"mt-4 border-t pt-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Patient History:"}),T&&r.jsx("p",{className:"text-red-500 text-xs mb-2",children:T}),r.jsx(hh,{title:"Complaints History",icon:su,items:F,isLoading:S,loadingText:"Loading complaints...",noDataText:"No past complaints found.",renderItemContent:W=>r.jsxs("span",{className:"block text-xs",children:[" ",W.data.complaint,r.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Zc(W.originalDateString),")"]})]})}),r.jsx(hh,{title:"Lab History (Orders & Reports)",icon:Yl,items:Q,isLoading:S,loadingText:"Loading lab history...",noDataText:"No lab history found.",renderItemContent:W=>W.type==="Lab Order (Pending)"?r.jsxs("span",{className:"flex items-start text-xs",children:[" ",r.jsx(Jx,{size:12,className:"mr-1.5 mt-0.5 text-blue-600 flex-shrink-0"})," ",r.jsxs("span",{className:"block",children:[r.jsx("span",{className:"font-medium text-blue-700",children:"Order:"})," ",W.data.tests.map(J=>J.name).join(", ")," ",r.jsxs("span",{className:"text-gray-600",children:["(",W.data.status,")"]}),r.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Zc(W.originalDateString),")"]})]})]}):r.jsxs("span",{className:"flex items-start text-xs",children:[" ",r.jsx(OS,{size:12,className:"mr-1.5 mt-0.5 text-green-600 flex-shrink-0"})," ",r.jsxs("span",{className:"block",children:[r.jsx("span",{className:"font-medium text-green-700",children:"Report:"})," ",W.data.testName," - ",W.data.reportFindings.substring(0,50),W.data.reportFindings.length>50?"...":"",r.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Zc(W.originalDateString),")"]})]})]})}),r.jsx(hh,{title:"Pharmacy Order History",icon:Md,items:R,isLoading:S,loadingText:"Loading pharmacy orders...",noDataText:"No pharmacy order history found.",renderItemContent:W=>r.jsxs("span",{className:"block text-xs",children:[" ",W.data.medications.map(J=>`${J.name} (Qty: ${J.quantity})`).join(", ")," ",r.jsxs("span",{className:"text-gray-600",children:["(",W.data.status,")"]}),r.jsxs("span",{className:"text-gray-500 ml-1.5 text-[10px] font-mono",children:["(",Zc(W.originalDateString),")"]})]})}),F.length===0&&Q.length===0&&R.length===0&&!S&&r.jsx("p",{className:"text-gray-500 italic text-sm mt-2",children:"No history found."})]})]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex justify-end space-x-3 mb-4",children:[r.jsxs("button",{onClick:()=>I("/dashboard/add-patient"),className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded shadow flex items-center",children:[r.jsx(lk,{size:18,className:"mr-2"})," Add Patient"]}),r.jsx("button",{onClick:()=>I("/search-patient"),className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded shadow",children:"Search Patient"})]}),a&&r.jsx("p",{className:"text-red-500 p-4 bg-red-50 rounded",children:a}),t&&!e.currentPatient&&r.jsx("p",{className:"text-gray-500 p-4 text-center",children:"Loading queue..."}),r.jsx("div",{className:"mb-6 md:mb-8",children:ne||r.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 text-center text-gray-500",children:"No patient currently being seen. Use 'Call Next' or search for a patient record."})}),r.jsxs("div",{className:"current-queue-section mb-6 md:mb-8",children:[r.jsx("h2",{className:"text-xl text-blue-700 font-semibold mb-3 md:mb-4",children:"NEXT IN QUEUE:"}),e.nextPatient?r.jsxs("div",{className:"patient-info-section bg-blue-50 rounded-lg shadow-md p-5 md:p-6 border-l-8 border-blue-500",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 md:mb-4",children:[r.jsxs("span",{className:"text-2xl md:text-3xl font-bold text-blue-800 mb-2 sm:mb-0",children:["Token #",e.nextPatient.token]}),r.jsx("span",{className:`px-3 py-1 rounded-full text-sm md:text-base font-medium ${e.nextPatient.status==="waiting"?"bg-blue-200 text-blue-900":"bg-gray-200 text-gray-800"}`,children:re(e.nextPatient.status)})]}),r.jsx("div",{className:"text-2xl md:text-3xl font-bold mb-2 md:mb-3",children:e.nextPatient.name}),r.jsxs("div",{className:"text-lg md:text-xl text-gray-700 mb-3 md:mb-4",children:["Age: ",e.nextPatient.age," | ",e.nextPatient.gender]}),(e.nextPatient.complaint||e.nextPatient.case_summary)&&r.jsxs("div",{className:"mt-3 md:mt-4 pt-3 border-t border-blue-200 space-y-2",children:[e.nextPatient.complaint&&r.jsxs("p",{className:"text-base md:text-lg text-gray-800",children:[r.jsx("span",{className:"font-semibold text-gray-900",children:"Complaint:"})," ",e.nextPatient.complaint]}),e.nextPatient.case_summary&&r.jsxs("p",{className:"text-sm text-gray-700 bg-yellow-50 p-2 rounded border border-yellow-200",children:[r.jsx("span",{className:"font-semibold text-gray-800",children:"AI Summary:"})," ",e.nextPatient.case_summary]})]})]}):r.jsx("div",{className:"bg-gray-50 rounded-lg shadow-inner p-6 text-center text-gray-600 border border-gray-200",children:"No patient waiting next in the queue."})]}),r.jsxs("div",{className:"actions-section mt-auto pt-4 md:pt-6 flex flex-col sm:flex-row justify-between items-center gap-4",children:[r.jsx("button",{onClick:B,disabled:t||!e.nextPatient||!!e.currentPatient,className:"btn btn-primary w-full sm:w-auto disabled:opacity-50 disabled:cursor-not-allowed order-1 sm:order-none",children:"Call Next Patient"}),r.jsx("div",{className:"bg-gray-200 inline-block px-4 py-2 rounded-full order-2 sm:order-none",children:r.jsxs("span",{className:"text-base md:text-lg font-medium",children:[e.waitingCount," patients waiting"]})})]})]})]})})},Y2=()=>{const[e,n]=w.useState(""),[t,i]=w.useState([]),[a,o]=w.useState(null),[l,d]=w.useState(null),[f,u]=w.useState(null),[p,g]=w.useState(null),[b,v]=w.useState(!1),[S,k]=w.useState(!1),[T,P]=w.useState(null),M=_t(),I=w.useCallback(b2.debounce(async R=>{if(R.trim().length<2){i([]),k(!1);return}k(!0),P(null);try{const B=new URLSearchParams({search:encodeURIComponent(R),page:"1",limit:"20",sortBy:"name",sortOrder:"asc"}),Y=await me(`/api/patients?${B.toString()}`);if(!Y.ok){const ne=await Y.text();throw new Error(`API Error (${Y.status}): ${ne||Y.statusText||"Failed to fetch patients"}`)}const re=await Y.json();i(re.patients)}catch(B){P(B instanceof Error?B.message:"An unknown error occurred while searching patients"),i([])}finally{k(!1)}},500),[]);w.useEffect(()=>(e?(k(!0),I(e)):(i([]),I.cancel()),()=>{I.cancel()}),[e,I]);const U=R=>{o(R),n(""),i([]),P(null),d(null),u(null),g(null),v(!1)},L=async()=>{if(!a){P("No patient selected.");return}P(null),k(!0);try{const R=await me(`/api/patients/${a.id}/admit`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!R.ok){const Y=await R.json().catch(()=>({message:"Failed to admit patient"}));throw new Error(Y.message||"Failed to admit patient")}const B=await R.json();alert(B.message||"Patient admitted successfully!"),B.bill&&B.bill.id?M(`/patient/${a.id}/admission-bill/${B.bill.id}`):(console.error("Admission successful, but bill ID missing in response."),P("Admission successful, but couldn't navigate to billing."),o(B.patient))}catch(R){P(R instanceof Error?R.message:"Failed to admit patient")}finally{k(!1)}};w.useEffect(()=>{(async()=>{if(!a||!a.admission_date||a.discharge_date){d(null),g(null);return}v(!0),u(null),d(null),g(null);try{const B=await me(`/api/patients/${a.id}/active-bill?type=admission`);if(!B.ok)throw B.status===404?new Error("No active admission bill found."):new Error("Failed to fetch active bill ID.");const Y=await B.json(),re=Y==null?void 0:Y.id;if(!re)throw new Error("Active admission bill ID not found in response.");d(re);const ne=await me(`/api/bills/${re}`);if(!ne.ok)throw new Error(`Failed to fetch bill details (ID: ${re}). Status: ${ne.status}`);const G=await ne.json();if(G&&G.calculated)g(G.calculated);else throw console.error("Fetched bill details missing 'calculated' object:",G),new Error("Fetched bill details are incomplete (missing calculated data).")}catch(B){u(B instanceof Error?B.message:"An unknown error occurred while fetching bill details."),d(null),g(null)}finally{v(!1)}})()},[a]);const $=async()=>{if(!a){P("No patient selected.");return}if(!a.admission_date||a.discharge_date){P("Patient is not currently admitted.");return}P(null),k(!0);try{const R=await me(`/api/patients/${a.id}/discharge`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!R.ok){const Y=await R.json().catch(()=>({message:"Failed to discharge patient"}));throw new Error(Y.message||"Failed to discharge patient")}const B=await R.json();alert(B.message||"Patient discharged successfully!"),B.patient?o(B.patient):(console.error("Discharge successful, but updated patient info missing in response."),o(null),P("Discharge successful, but couldn't update patient details locally."))}catch(R){P(R instanceof Error?R.message:"Failed to discharge patient")}finally{k(!1)}},z=()=>{if(!a||!l){P("Cannot navigate to billing: Patient or Bill ID missing.");return}M(`/patient/${a.id}/admission-bill/${l}`)};let F="",Q=null;if(a){const R=a.admission_date?new Date(a.admission_date).toLocaleDateString():null,B=a.discharge_date?new Date(a.discharge_date).toLocaleDateString():null;a.admission_date?a.admission_date&&!a.discharge_date?(F=`Patient admitted on: ${R}`,Q=r.jsxs("div",{className:"space-y-4",children:[" ",b&&r.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Loading billing details..."})," ",f&&r.jsx("p",{className:"text-sm text-red-500 text-center",children:f})," ",!b&&p&&r.jsxs("div",{className:"admission-card",children:[r.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),r.jsxs("div",{className:"admission-card-content",children:[r.jsxs("p",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Total Due:"}),r.jsxs("span",{children:["",(Number(p.totalDue)||0).toFixed(2)]})]}),r.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[" ",r.jsx("span",{children:"Total Paid:"}),r.jsxs("span",{children:["",(Number(p.totalPaid)||0).toFixed(2)]})]}),r.jsxs("p",{className:"flex justify-between text-sm font-bold mt-1 text-red-600",children:[" ",r.jsx("span",{children:"Balance Due:"}),r.jsxs("span",{children:["",(Number(p.balance)||0).toFixed(2)]})]})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsx("button",{onClick:z,disabled:S||b||!l,className:`admission-button admission-button-secondary ${S||b||!l?"opacity-50 cursor-not-allowed":""}`,children:b?"Loading Bill...":!l&&!f?"Finding Bill...":"Pay Bill / View Details"}),r.jsx("button",{onClick:$,disabled:S||b,className:`admission-button admission-button-danger ${S||b?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Discharge Patient"})]})]})):(F=`Patient admitted on ${R} and discharged on ${B}.`,Q=r.jsx("p",{className:"text-center text-gray-600 italic",children:"Patient has been discharged."})):(F="Patient is not admitted.",Q=r.jsx("button",{onClick:L,disabled:S,className:`admission-button ${S?"opacity-50 cursor-not-allowed":""}`,children:S?"Processing...":"Admit Patient"}))}return r.jsxs("div",{className:"admission-page-container",children:[r.jsxs("div",{className:"admission-header-container",children:[r.jsxs("button",{onClick:()=>M(-1),className:"back-button",children:[r.jsx(rn,{size:16}),"Back"]}),r.jsx("h1",{className:"admission-header",children:"Manage Admission/Discharge"})]}),r.jsxs("div",{className:"admission-section mb-6 relative",children:[r.jsx("label",{htmlFor:"patientSearch",className:"admission-label",children:"Search Patient (Name, Phone, or Token)"}),r.jsx("input",{type:"text",id:"patientSearch",value:e,onChange:R=>n(R.target.value),placeholder:"Start typing to search...",className:"admission-input"}),S&&!a&&r.jsx("div",{className:"absolute right-3 top-9 text-sm text-gray-500",children:"Loading..."})," ",t.length>0&&!a&&r.jsxs("ul",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[" ",t.map(R=>r.jsxs("li",{onClick:()=>U(R),className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",children:[" ",R.name," (Token: ",R.token,")",r.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[R.admission_date?`Admitted: ${new Date(R.admission_date).toLocaleDateString()}`:"Not Admitted",R.discharge_date?`, Discharged: ${new Date(R.discharge_date).toLocaleDateString()}`:""]})]},R.id))]}),t.length===0&&e&&!S&&!a&&r.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg p-4 text-gray-500",children:['No patients found matching "',e,'".']})]}),a&&r.jsxs("div",{className:"admission-section",children:[r.jsxs("div",{className:"flex justify-between items-center mb-3",children:[r.jsx("h2",{className:"admission-section-title",children:"Selected Patient"}),r.jsx("button",{onClick:()=>o(null),className:"admission-link",children:"Clear Selection"})]}),r.jsxs("div",{className:"admission-card-content mb-4 grid grid-cols-2 gap-2 text-sm",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Name:"})," ",a.name]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Token:"})," ",a.token]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Age:"})," ",a.age??"N/A"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Gender:"})," ",a.gender??"N/A"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Phone:"})," ",a.phone??"N/A"]}),r.jsxs("p",{className:"col-span-2",children:[r.jsx("strong",{children:"Address:"})," ",a.address??"N/A"]})]}),r.jsx("hr",{className:"my-4"}),r.jsx("p",{className:"text-sm text-gray-600 mb-3",children:F})," ",T&&r.jsx("p",{className:"text-red-500 text-sm mb-3",children:T})," ",Q]})]})},u0=15,C1=()=>{const e=_t(),[n,t]=w.useState([]),[i,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(""),[u,p]=w.useState(1),[g,b]=w.useState(1),[v,S]=w.useState(0),[k,T]=w.useState("created_at"),[P,M]=w.useState("desc"),[I,U]=w.useState(""),[L,$]=w.useState(!1),[z,F]=w.useState(null),[Q,R]=w.useState([]),[B,Y]=w.useState(""),[re,ne]=w.useState(!1),[G,V]=w.useState(null),[W,J]=w.useState(!0),[he,A]=w.useState(null),[ce,se]=w.useState(d);w.useEffect(()=>{const Ce=setTimeout(()=>{se(d),p(1)},500);return()=>{clearTimeout(Ce)}},[d]);const D=w.useCallback(async()=>{J(!0),A(null);try{const Ce=await me("/api/subscriptions");if(!Ce.ok){let De=`Failed to fetch subscription plans (${Ce.status})`;try{De=(await Ce.json()).message||De}catch{}throw new Error(De)}const Se=await Ce.json();R(Se)}catch(Ce){console.error("Error fetching subscription plans:",Ce),A(Ce.message||"An unknown error occurred while fetching plans."),R([])}finally{J(!1)}},[]),oe=w.useCallback(async(Ce,Se,De,Me,et)=>{a(!0),l(null);try{const ct=new URLSearchParams({page:Ce.toString(),limit:u0.toString(),sortBy:De,sortOrder:Me});Se&&ct.append("search",Se),et&&ct.append("gender",et);const ut=await me(`/api/patients?${ct.toString()}`);if(!ut.ok){const qt=await ut.json();throw new Error(qt.message||"Failed to fetch patients")}const at=await ut.json();t(at.patients),S(at.totalCount),p(at.currentPage),b(at.totalPages)}catch(ct){console.error("Error fetching patients:",ct),l(`Failed to load patients: ${ct.message}`),t([]),S(0),p(1),b(1)}finally{a(!1)}},[]);w.useEffect(()=>{oe(u,ce,k,P,I),D()},[u,ce,k,P,I,oe,D]);const xe=Ce=>{const Se=k===Ce&&P==="asc"?"desc":"asc";T(Ce),M(Se),p(1)},Z=Ce=>{try{return new Date(Ce).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},ue=()=>{$(!1),F(null),Y(""),V(null),ne(!1)},ae=async(Ce,Se)=>{t(De=>De.map(Me=>Me.id===Ce?{...Me,insurance_type:Se}:Me));try{const De=await me(`/api/patients/${Ce}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:Se})});if(!De.ok){const Me=await De.json();throw new Error(Me.message||"Failed to update insurance type")}}catch(De){console.error("Error updating insurance type:",De),oe(u,ce,k,P,I)}},Re=(Ce,Se)=>{const De=new Date(Ce),Me=Se.interval||1;switch(Se.period){case"daily":De.setDate(Ce.getDate()+Me);break;case"weekly":De.setDate(Ce.getDate()+Me*7);break;case"monthly":De.setMonth(Ce.getMonth()+Me);break;case"yearly":De.setFullYear(Ce.getFullYear()+Me);break;default:console.warn(`Unknown subscription period: ${Se.period}. Defaulting to 1 month.`),De.setMonth(Ce.getMonth()+1)}return De},Ae=async()=>{if(!z||!B){V("Please select a subscription plan.");return}const Ce=Q.find(Se=>Se.id===B);if(!Ce){V("Selected plan details not found.");return}ne(!0),V(null);try{const Se=new Date,De=Re(Se,Ce),Me={subscription_plan_id:B,subscription_status:"active",subscription_start_date:Se.toISOString(),subscription_end_date:De.toISOString(),subscription_payment_method:"manual"},et=await me(`/api/patients/${z.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Me)});if(!et.ok){const ct=await et.json();throw new Error(ct.message||"Failed to update patient subscription")}ue(),oe(u,ce,k,P,I)}catch(Se){console.error("Error starting subscription:",Se),V(`Failed to start subscription: ${Se.message}`)}finally{ne(!1)}};return r.jsxs("div",{className:"all-patients-container",children:[r.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[r.jsx(rn,{size:16}),"Back"]}),r.jsxs("h1",{className:"all-patients-title",children:[r.jsx(cu,{size:28}),"All Registered Patients"]}),o&&r.jsxs("div",{className:"error-alert",role:"alert",children:[r.jsx("strong",{children:"Error: "}),r.jsx("span",{children:o})]}),r.jsxs("div",{className:"subscription-plans-card",children:[r.jsx("h2",{className:"subscription-plans-title",children:"Available Subscription Plans"}),r.jsx("div",{children:W?r.jsx("p",{className:"loading-state",children:"Loading plans..."}):he?r.jsxs("p",{className:"error-message",children:["Error loading plans: ",he]}):Q.length===0?r.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):r.jsx("ul",{className:"subscription-plans-list",children:Q.map(Ce=>r.jsxs("li",{children:[r.jsx("strong",{children:Ce.name}),": ",Ce.price," / ",Ce.interval," ",Ce.period,Ce.interval>1?"s":"",Ce.description&&r.jsx("span",{className:"plan-description",children:Ce.description})]},Ce.id))})})]}),r.jsxs("div",{className:"controls-container",children:[r.jsxs("div",{className:"search-input-wrapper",children:[r.jsx("input",{type:"text",placeholder:"Search by name or phone...",className:"search-input",value:d,onChange:Ce=>f(Ce.target.value)}),r.jsx(os,{className:"search-input-icon",size:20})]}),r.jsxs("div",{className:"filter-dropdown-wrapper",children:[r.jsx("label",{htmlFor:"genderFilter",className:"sr-only",children:"Filter by Gender"}),r.jsxs("div",{className:"filter-select-container",children:[r.jsx(VI,{size:16,className:"filter-select-icon"}),r.jsxs("select",{id:"genderFilter",value:I,onChange:Ce=>U(Ce.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"All Genders"}),r.jsx("option",{value:"M",children:"Male"}),r.jsx("option",{value:"F",children:"Female"}),r.jsx("option",{value:"O",children:"Other"})]})]})]})]}),i?r.jsx("div",{className:"loading-state",children:"Loading patients..."}):n.length===0?r.jsx("div",{className:"empty-state",children:ce?"No patients found matching your search.":"No patients registered yet."}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"patients-table-wrapper",children:r.jsxs("table",{className:"patients-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Token"}),r.jsxs("th",{className:"sortable-header",onClick:()=>xe("name"),children:["Name",k==="name"&&(P==="asc"?r.jsx(X0,{size:14,className:"sort-icon"}):r.jsx(DS,{size:14,className:"sort-icon"}))]}),r.jsx("th",{children:"Age"}),r.jsx("th",{children:"Gender"}),r.jsx("th",{children:"Phone"}),r.jsx("th",{children:"Address"}),r.jsxs("th",{className:"sortable-header",onClick:()=>xe("created_at"),children:["Registered On",k==="created_at"&&(P==="asc"?r.jsx(X0,{size:14,className:"sort-icon"}):r.jsx(DS,{size:14,className:"sort-icon"}))]}),r.jsx("th",{children:"Subscription Status"}),r.jsx("th",{children:"Insurance Type"})," ",r.jsx("th",{children:"Action"})," "]})}),r.jsx("tbody",{children:n.map(Ce=>r.jsxs("tr",{children:[r.jsx("td",{children:Ce.token??"-"}),r.jsx("td",{className:"patient-name",children:Ce.name}),r.jsx("td",{children:Ce.age??"-"}),r.jsx("td",{children:Ce.gender??"-"}),r.jsx("td",{children:Ce.phone??"-"}),r.jsx("td",{children:Ce.address??"-"}),r.jsx("td",{children:Z(Ce.created_at)}),r.jsx("td",{children:r.jsx("span",{className:`status-badge ${Ce.subscription_status==="active"?"active":Ce.subscription_status==="cancelled"||Ce.subscription_status==="expired"?"inactive":"none"}`,children:Ce.subscription_status??"None"})}),r.jsx("td",{children:r.jsxs("select",{value:Ce.insurance_type,onChange:Se=>ae(Ce.id,Se.target.value),className:"form-select insurance-select",children:[r.jsx("option",{value:"cash",children:"Cash"}),r.jsx("option",{value:"insurance",children:"Insurance"}),r.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})}),r.jsx("td",{children:r.jsx("button",{onClick:()=>e(`/start-subscription/${Ce.id}`),className:"action-button",children:"Start Sub"})})]},Ce.id))})]})}),g>1&&r.jsxs("div",{className:"pagination-controls",children:[r.jsxs("div",{className:"pagination-info",children:["Showing"," ",r.jsx("span",{className:"font-medium",children:(u-1)*u0+1})," ","to"," ",r.jsx("span",{className:"font-medium",children:Math.min(u*u0,v)})," ","of"," ",r.jsx("span",{className:"font-medium",children:v})," results"]}),r.jsxs("div",{className:"pagination-buttons",children:[r.jsxs("button",{onClick:()=>p(Ce=>Math.max(Ce-1,1)),disabled:u===1||i,className:"pagination-button",children:[r.jsx(sw,{size:16,className:"prev-icon"}),"Previous"]}),r.jsxs("span",{className:"pagination-current-page",children:["Page ",r.jsx("span",{className:"font-medium",children:u})," of ",r.jsx("span",{className:"font-medium",children:g})]}),r.jsxs("button",{onClick:()=>p(Ce=>Math.min(Ce+1,g)),disabled:u===g||i,className:"pagination-button",children:["Next",r.jsx($h,{size:16,className:"next-icon"})]})]})]})]}),L&&z&&r.jsx("div",{className:"subscription-modal-overlay",children:r.jsxs("div",{className:"subscription-modal-content",children:[r.jsxs("div",{className:"subscription-modal-header",children:[r.jsxs("h2",{className:"subscription-modal-title",children:["Start Subscription for ",z.name]}),r.jsx("button",{onClick:ue,className:"subscription-modal-close-button",children:r.jsx(Qn,{size:24})})]}),G&&r.jsx("div",{className:"error-alert",role:"alert",children:r.jsx("span",{children:G})}),r.jsxs("div",{className:"subscription-modal-body",children:[r.jsx("label",{htmlFor:"subscriptionPlan",className:"form-label",children:"Select Plan:"}),r.jsxs("select",{id:"subscriptionPlan",value:B,onChange:Ce=>Y(Ce.target.value),className:"form-select",disabled:re||W||he!==null||Q.length===0,children:[r.jsx("option",{value:"",disabled:!0,children:"-- Select a Plan --"}),W?r.jsx("option",{value:"",disabled:!0,children:"Loading plans..."}):he?r.jsx("option",{value:"",disabled:!0,children:"Error loading plans"}):Q.length>0?Q.map(Ce=>r.jsxs("option",{value:Ce.id,children:[Ce.name," - ",Ce.price," (",Ce.interval," ",Ce.period,Ce.interval>1?"s":"",")"]},Ce.id)):r.jsx("option",{value:"",disabled:!0,children:"No active plans found"})]}),he&&r.jsx("p",{className:"error-message",children:he}),Q.length===0&&!W&&!he&&r.jsx("p",{className:"empty-state",children:"No active subscription plans available."})]}),r.jsxs("div",{className:"subscription-modal-footer",children:[r.jsx("button",{onClick:ue,disabled:re,className:"subscription-modal-button cancel",children:"Cancel"}),r.jsx("button",{onClick:Ae,disabled:!B||re,className:"subscription-modal-button submit",children:re?"Starting...":"Start Subscription"})]})]})})]})},W2=()=>{const e=_t(),[n]=w.useState(!0),[t,i]=w.useState(""),[a,o]=w.useState([]),[l,d]=w.useState(!1),[f,u]=w.useState(null),[p,g]=w.useState(!1),b=/^\+?[0-9\s\-().]{7,20}$/,v=w.useMemo(()=>wb(async P=>{if(P.trim().length<2){o([]),d(!1),u(null);return}d(!0),u(null);try{const M=new URLSearchParams({search:encodeURIComponent(P),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),I=await me(`/api/patients?${M.toString()}`);if(!I.ok){const L=await I.text();throw new Error(`API Error (${I.status}): ${L||I.statusText}`)}const U=await I.json();o(U.patients)}catch(M){console.error("Error searching patients:",M),u(M.message||"Failed to search patients."),o([])}finally{d(!1)}},300),[]),S=P=>{const M=P.target.value;i(M),g(b.test(M)),d(!0),v(M)},k=w.useCallback(P=>{e("/billing",{state:{patientId:P.id,patientName:P.name}})},[e]),T=w.useCallback(async()=>{if(!t||!p){u("Invalid phone number to create a new patient.");return}d(!0),u(null);try{const M=await me("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"direct pharmacy",phone:t,age:null,gender:null,token:null})});if(!M.ok){const U=await M.json();throw new Error(U.message||`Failed to create patient: ${M.statusText}`)}const I=await M.json();alert(`New patient "direct pharmacy" created with phone ${I.phone}.`),k(I)}catch(P){console.error("Error creating new patient:",P),u(P.message||"Failed to create new patient.")}finally{d(!1)}},[t,p,k]);return r.jsxs("div",{className:"create-custom-bill-page p-4 md:p-6 max-w-5xl mx-auto",children:[r.jsx("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:r.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[r.jsx("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:r.jsx(rn,{size:20})}),r.jsx("h2",{className:"text-2xl",children:"Create Custom Bill"})]})}),n&&r.jsxs("div",{className:"content-section",children:[r.jsx("h3",{className:"section-title",children:"Select Patient"}),r.jsxs("div",{className:"mb-3 relative",children:[r.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"}),r.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:t,onChange:S,className:"custom-text-input mt-1",autoFocus:!0}),l&&r.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),f&&r.jsx("div",{className:"ai-function-status error mb-3 p-3",children:f}),a.length>0&&r.jsx("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:r.jsx("ul",{children:a.map(P=>r.jsxs("li",{onClick:()=>k({id:P.id,name:P.name,token:P.token,age:P.age,gender:P.gender,phone:P.phone}),children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[r.jsxs("div",{className:"font-medium",children:[r.jsxs("span",{className:"patient-token mr-2",children:["#",P.token]}),P.name]}),r.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[P.age?`${P.age} yrs`:"Age N/A",P.gender?` / ${P.gender}`:" / Gender N/A",P.phone&&r.jsxs("span",{className:"hidden sm:inline",children:[" / ",P.phone]})]})]}),P.phone&&r.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",P.phone]})]},P.id))})}),t.length>=2&&!l&&a.length===0&&!f&&r.jsxs(r.Fragment,{children:[r.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',t,'".']}),p&&r.jsx("button",{type:"button",onClick:T,className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:l,children:'Create "direct pharmacy" Patient with this Phone'})]}),t.length<2&&!l&&r.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]})]})},Q2=({currentUser:e})=>{const n=_t(),[t,i]=w.useState("select_patient"),[a,o]=w.useState({name:"",age:void 0,gender:null,phone:"",address:""}),[l,d]=w.useState(null),[f,u]=w.useState([]),[p,g]=w.useState([]),[b,v]=w.useState(""),[S,k]=w.useState([]),[T,P]=w.useState(""),[M,I]=w.useState([]),[U,L]=w.useState(!1),[$,z]=w.useState(null),[F,Q]=w.useState(null),[R,B]=w.useState(null),[Y,re]=w.useState(!1),[ne,G]=w.useState(!1),[V,W]=w.useState(!1),J=/^\+?[0-9\s\-().]{7,20}$/,he=/^[a-zA-Z\s'-]{2,}$/,A=w.useCallback(async()=>{if(!(f.length>0)){re(!0),B(null);try{const Se=await me("/api/lab-tests");if(!Se.ok)throw new Error("Failed to fetch lab tests");const De=await Se.json();u(De)}catch(Se){console.error("Failed to fetch available lab tests:",Se),B("Could not load lab test list: "+Se.message),u([])}finally{re(!1)}}},[f.length]);w.useEffect(()=>{if(!b){k([]);return}const Se=b.toLowerCase();k(f.filter(De=>De.name.toLowerCase().includes(Se)||De.description&&De.description.toLowerCase().includes(Se)).slice(0,10))},[b,f]);const ce=w.useCallback(Se=>{const De={id:Se.id,name:Se.name,token:Se.token,age:Se.age,gender:Se.gender,phone:Se.phone};d(De),i("create_order"),g([]),v(""),k([]),B(null),A()},[A]),se=w.useMemo(()=>wb(async Se=>{if(Se.trim().length<2){I([]),L(!1),z(null);return}L(!0),z(null);try{const De=new URLSearchParams({search:encodeURIComponent(Se),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Me=await me(`/api/patients?${De.toString()}`);if(!Me.ok){const ct=await Me.text();throw new Error(`API Error (${Me.status}): ${ct||Me.statusText}`)}const et=await Me.json();I(et.patients)}catch(De){console.error("Error searching lab patients:",De),z(De.message||"Failed to search lab patients."),I([])}finally{L(!1)}},300),[J,he]),D=Se=>{const De=Se.target.value;P(De),G(J.test(De)),W(he.test(De)&&!J.test(De)),L(!0),se(De)},oe=w.useCallback(async Se=>{if(!T||Se==="phone"&&!ne||Se==="name"&&!V){z(`Invalid ${Se} to create a new patient.`);return}L(!0),z(null);try{const Me=await me("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Se==="name"?T:"direct lab",phone:Se==="phone"?T:null,age:null,gender:null,token:null})});if(!Me.ok){const ct=await Me.json();throw new Error(ct.message||`Failed to create patient: ${Me.statusText}`)}const et=await Me.json();alert(`New patient "${et.name}" created with ${Se==="phone"?`phone ${et.phone}`:`name ${et.name}`}.`),ce({id:et.id,name:et.name,token:et.token??null,age:et.age??null,gender:et.gender??null,phone:et.phone})}catch(De){console.error("Error creating new patient:",De),z(De.message||"Failed to create new patient.")}finally{L(!1)}},[T,ne,V,ce]),xe=()=>{o({name:"",age:void 0,gender:null,phone:"",address:""}),Q(null),i("create_patient"),d(null)},Z=()=>{i("select_patient"),d(null),P(""),I([]),z(null)},ue=Se=>{const{name:De,value:Me}=Se.target;o(et=>({...et,[De]:De==="age"?Me?parseInt(Me,10):void 0:Me}))},ae=async Se=>{if(Se.preventDefault(),Q(null),!a.name){Q("Patient Name is required.");return}const De={name:a.name,age:a.age,gender:a.gender,phone:a.phone,address:a.address};try{const Me=await me("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(De)});if(!Me.ok){const ct=await Me.json();throw new Error(ct.message||`Failed to create patient: ${Me.statusText}`)}const et=await Me.json();alert(`Patient "${et.name}" created successfully!`),ce({id:et.id,name:et.name,token:et.token??null,age:et.age??null,gender:et.gender??null,phone:et.phone})}catch(Me){console.error("Failed to create patient:",Me),Q(Me.message||"Failed to create patient. Please try again.")}},Re=Se=>{if(p.some(De=>De.id===Se.id)){B(`${Se.name} is already in the order.`),setTimeout(()=>B(null),3e3),v(""),k([]);return}g(De=>[...De,{...Se}]),v(""),k([])},Ae=Se=>{g(De=>De.filter(Me=>Me.id!==Se))},Ce=async Se=>{if(Se.preventDefault(),B(null),!l){B("No patient selected.");return}if(p.length===0){B("No lab tests selected.");return}const De={patient_id:l.id,tests:p.map(Me=>({id:Me.id,name:Me.name,price:Me.price}))};console.log("Submitting Lab Order:",De);try{const Me=await me("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(De)});if(!Me.ok){const ut=await Me.json();throw console.error("API Error Data:",ut),new Error(ut.message||`Failed to create lab order: ${Me.statusText}`)}const et=await Me.json();console.log("Lab Order Creation Result:",et);let ct=l.queueId;if(!ct){const ut=await me(`/api/queue/patient/${l.id}/latest`);if(ut.ok){const at=await ut.json();at!=null&&at._id&&(ct=at._id)}}if(!ct){const ut=await me("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:l.id})});if(!ut.ok){const qt=await ut.text();throw new Error(`Failed to create queue entry for redirection: ${qt||ut.statusText}`)}const at=await ut.json();if(at!=null&&at.id)ct=at.id;else throw new Error("Failed to get ID from new queue entry for redirection.")}alert(`Lab order created successfully for ${l.name}!`),(e==null?void 0:e.role)==="lab"?n("/dashboard"):n(`/dashboard/edit-complaint/${ct}`)}catch(Me){console.error("Failed to create lab order:",Me),B(Me.message||"Failed to create lab order.")}};return w.useEffect(()=>{A()},[A]),r.jsxs("div",{className:"lab-inventory-container",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[r.jsx(rn,{size:18,className:"mr-2"}),"Back"]}),r.jsx("h1",{className:"lab-inventory-header",children:"Create New Lab Order"}),r.jsx("div",{className:"w-16"})," "]}),(t==="select_patient"||t==="create_patient")&&r.jsxs("div",{className:"lab-inventory-card",children:[t==="select_patient"&&r.jsxs(r.Fragment,{children:[r.jsx("h2",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"1px solid #eee",marginBottom:"15px"},children:"Select Existing Patient"}),r.jsxs("div",{className:"lab-inventory-form-group",style:{position:"relative"},children:[r.jsx("label",{htmlFor:"lab-patient-search",children:"Search Patient (Name, Token, or Phone)"}),r.jsx("input",{type:"text",id:"lab-patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:T,onChange:D,className:"lab-inventory-input",autoFocus:!0}),U&&r.jsx("span",{className:"loading-text",style:{position:"absolute",right:"10px",top:"35px",fontSize:"0.8em"},children:"Searching..."})]}),$&&r.jsx("div",{className:"error-text",children:$}),M.length>0&&r.jsx("div",{className:"lab-inventory-card",style:{maxHeight:"300px",overflowY:"auto",padding:"0",marginTop:"10px"},children:r.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:M.map(Se=>r.jsxs("li",{onClick:()=>ce(Se),className:"lab-inventory-link",style:{padding:"10px 15px",borderBottom:"1px solid #eee",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{children:[r.jsxs("span",{style:{color:"#007bff",marginRight:"10px"},children:["[#",Se.token,"]"]}),Se.name]}),r.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:[Se.age?`${Se.age} yrs`:"",Se.age&&Se.gender?" / ":"",Se.gender||"N/A"]})]},Se.id))})}),T.length>=2&&!U&&M.length===0&&!$&&r.jsxs(r.Fragment,{children:[r.jsxs("p",{className:"no-data-message",children:['No patients found matching "',T,'".']}),ne&&r.jsx("button",{type:"button",onClick:()=>oe("phone"),className:"lab-inventory-button",style:{marginTop:"15px",marginRight:"10px"},disabled:U,children:'Create "direct lab" Patient with this Phone'}),V&&r.jsx("button",{type:"button",onClick:()=>oe("name"),className:"lab-inventory-button",style:{marginTop:"15px"},disabled:U,children:"Create Patient with this Name"})]}),T.length<2&&!U&&r.jsx("p",{className:"no-data-message",style:{backgroundColor:"transparent",border:"none",textAlign:"left",padding:"5px 0"},children:"Enter at least 2 characters to search."}),r.jsx("button",{onClick:xe,className:"lab-inventory-link",style:{marginTop:"15px",background:"none",border:"none",padding:"0",cursor:"pointer"},children:"Or, Register New Patient"})]}),t==="create_patient"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[r.jsx("h2",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"none",margin:"0"},children:"Register New Patient"}),r.jsx("button",{onClick:Z,className:"lab-inventory-link",style:{background:"none",border:"none",padding:"0",cursor:"pointer"},children:" Back to Search "})]}),F&&r.jsx("div",{className:"error-text",children:F}),r.jsxs("form",{onSubmit:ae,children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"15px"},children:[r.jsxs("div",{className:"lab-inventory-form-group",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{htmlFor:"lab-patient-name",children:"Name *"}),r.jsx("input",{type:"text",name:"name",id:"lab-patient-name",required:!0,value:a.name,onChange:ue,className:"lab-inventory-input"})]}),r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsx("label",{htmlFor:"lab-patient-age",children:"Age"}),r.jsx("input",{type:"number",name:"age",id:"lab-patient-age",value:a.age??"",onChange:ue,className:"lab-inventory-input"})]}),r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsx("label",{htmlFor:"lab-patient-gender",children:"Gender"}),r.jsxs("select",{name:"gender",id:"lab-patient-gender",value:a.gender??"",onChange:ue,className:"lab-inventory-select",children:[r.jsx("option",{value:"",children:"Select..."})," ",r.jsx("option",{value:"M",children:"Male"})," ",r.jsx("option",{value:"F",children:"Female"})," ",r.jsx("option",{value:"O",children:"Other"})]})]}),r.jsxs("div",{className:"lab-inventory-form-group",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{htmlFor:"lab-patient-phone",children:"Phone"}),r.jsx("input",{type:"tel",name:"phone",id:"lab-patient-phone",value:a.phone||"",onChange:ue,className:"lab-inventory-input"})]}),r.jsxs("div",{className:"lab-inventory-form-group",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{htmlFor:"lab-patient-address",children:"Address"}),r.jsx("textarea",{name:"address",id:"lab-patient-address",rows:2,value:a.address||"",onChange:ue,className:"lab-inventory-input"})]})]}),r.jsxs("div",{style:{marginTop:"20px",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[r.jsx("button",{type:"button",onClick:Z,className:"lab-inventory-button lab-inventory-button-secondary",children:" Cancel "}),r.jsx("button",{type:"submit",className:"lab-inventory-button",children:" Create Patient & Proceed "})]})]})]})]}),t==="create_order"&&l&&r.jsxs("div",{className:"lab-inventory-card",children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[r.jsxs("h2",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"none",margin:"0"},children:["Create Order for: ",l.name]}),r.jsx("button",{onClick:Z,className:"lab-inventory-link",style:{background:"none",border:"none",padding:"0",cursor:"pointer"},children:" Change Patient "})]}),r.jsxs("p",{style:{fontSize:"0.9em",color:"#555",marginBottom:"20px"},children:["ID: ",l.id.substring(0,8),"... ",l.age&&`| Age: ${l.age}`," ",l.gender&&`| Gender: ${l.gender}`]}),R&&r.jsx("div",{className:"error-text",children:R}),r.jsxs("form",{onSubmit:Ce,children:[r.jsxs("div",{className:"lab-inventory-form-group",style:{position:"relative"},children:[r.jsx("label",{htmlFor:"lab-test-search",children:"Add Lab Test"}),r.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search available lab tests...",value:b,onChange:Se=>v(Se.target.value),className:"lab-inventory-input",disabled:Y}),Y&&r.jsx("span",{className:"loading-text",style:{position:"absolute",right:"10px",top:"35px",fontSize:"0.8em"},children:"Loading tests..."}),b&&S.length>0&&r.jsx("div",{className:"lab-inventory-card",style:{maxHeight:"200px",overflowY:"auto",padding:"0",marginTop:"5px",position:"absolute",width:"100%",zIndex:10},children:r.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:S.map(Se=>r.jsxs("li",{onClick:()=>Re(Se),className:"lab-inventory-link",style:{padding:"10px 15px",borderBottom:"1px solid #eee",cursor:"pointer",display:"flex",justifyContent:"space-between"},children:[r.jsx("span",{children:Se.name}),r.jsxs("span",{style:{color:"#555",fontSize:"0.9em"},children:["(",parseFloat(Se.price).toFixed(2),")"]})]},Se.id))})}),b&&S.length===0&&!Y&&r.jsxs("div",{className:"no-data-message",style:{marginTop:"5px"},children:['No tests found matching "',b,'".']})]}),r.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"20px",maxHeight:"300px",overflowY:"auto"},children:[r.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.2em",borderBottom:"1px solid #eee",marginBottom:"10px"},children:"Selected Tests"}),p.length===0?r.jsx("p",{className:"no-data-message",style:{backgroundColor:"transparent",border:"none",textAlign:"left",padding:"0"},children:"No tests added yet."}):r.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:p.map(Se=>r.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid #f0f0f0"},children:[r.jsx("span",{style:{flex:1,marginRight:"10px"},children:Se.name}),r.jsxs("span",{style:{fontWeight:"500",marginRight:"15px"},children:["",parseFloat(Se.price).toFixed(2)]}),r.jsx("button",{type:"button",onClick:()=>Ae(Se.id),className:"lab-inventory-link",title:"Remove Test",style:{background:"none",border:"none",padding:"0",cursor:"pointer",color:"#dc3545"},children:r.jsx(or,{size:16})})]},Se.id))})]}),p.length>0&&r.jsxs("div",{style:{textAlign:"right",fontWeight:"bold",fontSize:"1.2em",marginTop:"20px",marginBottom:"20px"},children:["Total: ",p.reduce((Se,De)=>Se+parseFloat(De.price),0).toFixed(2)]}),r.jsxs("div",{style:{marginTop:"20px",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[r.jsx("button",{type:"button",onClick:Z,className:"lab-inventory-button lab-inventory-button-secondary",children:" Cancel Order "}),r.jsx("button",{type:"submit",disabled:p.length===0,className:`lab-inventory-button ${p.length===0?"opacity-50 cursor-not-allowed":""}`,children:" Create Lab Order "})]})]})]})]})},Q8=({currentUser:e})=>{const[n,t]=w.useState("newtons-ai"),[i,a]=w.useState(""),[o,l]=w.useState([]),[d,f]=w.useState(!0),[u,p]=w.useState([]),[g,b]=w.useState(!1),[v,S]=w.useState(null),[k,T]=w.useState(null),P=_t(),M=Gi(),I=async()=>{f(!0),T(null);let R=[];try{const B=await me("/api/queue");if(!B.ok){const ne=await B.json();throw new Error(ne.message||"Failed to fetch queue")}R=await B.json(),console.log("Fetched Initial Queue Data:",JSON.stringify(R,null,2));const Y=R.map(async ne=>{if(!ne.patient_id)return console.warn(`Queue entry ${ne.id} has no patient_id.`),ne;try{const G=await me(`/api/patients/${ne.patient_id}`);if(!G.ok)return console.error(`Failed to fetch patient details for ${ne.patient_id}: ${G.status}`),ne;const V=await G.json();return{...ne,Patient:{...ne.Patient??{},...V}}}catch(G){return console.error(`Error fetching patient details for ${ne.patient_id}:`,G),ne}}),re=await Promise.all(Y);console.log("Enriched Queue Data (Before Sort):",JSON.stringify(re,null,2)),re.sort((ne,G)=>{var A,ce;const V=((A=ne.Patient)==null?void 0:A.subscription_status)==="active",W=((ce=G.Patient)==null?void 0:ce.subscription_status)==="active";if(V&&!W)return-1;if(!V&&W)return 1;const J=ne.created_at?new Date(ne.created_at).getTime():0,he=G.created_at?new Date(G.created_at).getTime():0;return J-he}),console.log("Sorted Queue Data:",JSON.stringify(re,null,2)),l(re)}catch(B){console.error("Error in fetchQueue process:",B),T(`Failed to load queue: ${B.message}`),l(R)}finally{f(!1)}},U=async()=>{b(!0),T(null);try{const R=await me("/api/staff?role=doctor");if(!R.ok){const Y=await R.json();throw new Error(Y.message||"Failed to fetch doctors")}const B=await R.json();p(B.filter(Y=>Y.active))}catch(R){console.error("Error fetching doctors:",R),T(`Failed to fetch doctors: ${R.message}`)}finally{b(!1)}};w.useEffect(()=>{const B=new URLSearchParams(M.search).get("tab");B&&z.find(re=>re.id===B)&&t(B)},[M.search]),w.useEffect(()=>{n==="queue"&&(I(),U()),S(null)},[n]);const L=w.useCallback(async(R,B)=>{if(console.log(`Attempting to assign doctor ${B} to queue ${R}`),T(null),S(null),!B){console.log("No doctor ID provided, skipping assignment.");return}const Y=o.find(G=>G.id===R);if(!Y){console.error(`Queue entry ${R} not found in local state.`),T("Queue entry not found.");return}if(Y.doctor_id===B){console.log(`Queue ${R} already assigned to doctor ${B}. Skipping.`);return}const re=async G=>{if(!G||!G.id||!G.name){T("Cannot proceed: Patient ID or Name is missing."),console.error("assignAndNavigate called with invalid patientInfo",G);return}const V=async()=>{try{const W={status:"waiting",doctorId:B},J=await me(`/api/queue/${R}/status`,{method:"PATCH",body:JSON.stringify(W)}),he=await J.json();if(!J.ok)throw new Error(he.message||`HTTP error! status: ${J.status}`);const A=u.find(ce=>ce.id===B);return console.log(`Successfully assigned doctor ${A==null?void 0:A.name} to queue ${R}.`),l(ce=>ce.map(se=>se.id===R?{...se,doctor_id:B,status:he.status||se.status,User:A?{name:A.name}:null,Patient:G}:se)),!0}catch(W){return console.error(`Error assigning doctor for queue ${R}:`,W),T(`Failed to assign doctor: ${W.message}`),!1}};G.subscription_status==="active"?(console.log(`Patient ${G.name} (ID: ${G.id}) has active subscription. Assigning doctor directly.`),await V()):(console.log(`Patient ${G.name} (ID: ${G.id}) does not have active subscription (Status: ${G.subscription_status}). Assigning doctor and proceeding to billing.`),await V()?(console.log(`Navigating to billing for patient ${G.name} (ID: ${G.id}), queue ID: ${R}, doctor ID: ${B}`),P("/billing",{state:{patientId:G.id,queueId:R,patientName:G.name,doctorId:B,billType:"consultation"}})):console.log(`Assignment failed for patient ${G.name}, skipping navigation.`))},ne=Y.Patient;if(ne&&ne.id&&ne.name)console.log("Patient details found in state. Proceeding with assignment."),await re(ne);else{console.warn(`Patient details missing for queue entry ${R}. Fetching patient ${Y.patient_id}...`);try{const G=await me(`/api/patients/${Y.patient_id}`);if(!G.ok){const W=await G.json().catch(()=>({}));throw new Error(W.message||`Failed to fetch patient details (status ${G.status})`)}const V=await G.json();console.log("Successfully fetched patient details:",V),await re(V)}catch(G){console.error(`Failed to fetch patient details for patient ID ${Y.patient_id}:`,G),T(`Failed to fetch required patient details: ${G.message}`)}}},[u,o,P]),$=async(R,B)=>{T(null);const Y=B==="consulting"?"start consultation":"complete visit";try{const re=o.find(W=>W.id===R);if(!re&&B==="consulting")throw new Error("Queue entry not found to start consultation.");let ne={status:B};if(B==="consulting"){if(!(re!=null&&re.doctor_id))throw new Error("Cannot start consultation without an assigned doctor.");ne.doctorId=re.doctor_id}const G=await me(`/api/queue/${R}/status`,{method:"PATCH",body:JSON.stringify(ne)}),V=await G.json();if(!G.ok)throw new Error(V.message||`HTTP error! status: ${G.status}`);l(W=>W.map(J=>J.id===R?{...J,status:B}:J))}catch(re){console.error(`Error trying to ${Y}:`,re),T(`Failed to ${Y}: ${re.message}`)}},z=[{id:"queue",label:"Queue",icon:r.jsx(zh,{size:20})},{id:"newtons-ai",label:"Newtons AI",icon:r.jsx(os,{size:20})},{id:"manage-admission",label:"Manage Admission",icon:r.jsx(cI,{size:20})},{id:"all-patients",label:"All Patients",icon:r.jsx(ZI,{size:20})},{id:"lab",label:"Lab Tests",icon:r.jsx(Z0,{size:20})},{id:"custom-bill",label:"Custom Bill",icon:r.jsx(ss,{size:20})}],F=R=>{try{return new Date(R).toLocaleTimeString("en-IN",{hour:"numeric",minute:"2-digit",hour12:!0})}catch{return"Invalid Date"}},Q=o.filter(R=>{var B,Y;return(Y=(B=R.Patient)==null?void 0:B.name)==null?void 0:Y.toLowerCase().includes(i.toLowerCase())});return r.jsx("div",{className:"reception-dashboard-container",children:r.jsxs("main",{className:"flex-1 overflow-y-auto",children:[k&&r.jsxs("div",{className:"error-message-reception",role:"alert",children:[" ",r.jsx("strong",{children:"Error: "}),r.jsx("span",{children:k})]}),r.jsxs("div",{className:"reception-tab-nav",children:[" ",z.map(R=>r.jsxs("button",{className:`reception-tab-button ${n===R.id?"active":""}`,onClick:()=>t(R.id),children:[r.jsx("span",{children:R.icon}),R.label]},R.id))]}),n==="queue"&&r.jsxs("div",{className:"space-y-6",children:[" ",r.jsxs("div",{className:"queue-header",children:[" ",r.jsxs("div",{className:"queue-actions",children:[" ",r.jsxs("div",{className:"search-bar-container",children:[" ",r.jsx("input",{type:"text",placeholder:"Search patients in queue...",className:"search-input",value:i,onChange:R=>a(R.target.value)}),r.jsx(os,{className:"search-icon",size:18})]})]}),r.jsxs("div",{className:"summary-cards-grid",children:[" ",r.jsxs("div",{className:"summary-card card-waiting",children:[" ",r.jsx("div",{className:"summary-card-title",children:"Waiting"})," ",r.jsx("div",{className:"summary-card-value",children:o.filter(R=>R.status==="waiting").length})," "]}),r.jsxs("div",{className:"summary-card card-consulting",children:[" ",r.jsx("div",{className:"summary-card-title",children:"Consulting"})," ",r.jsx("div",{className:"summary-card-value",children:o.filter(R=>R.status==="consulting").length})," "]}),r.jsxs("div",{className:"summary-card card-completed",children:[" ",r.jsx("div",{className:"summary-card-title",children:"Completed"})," ",r.jsx("div",{className:"summary-card-value",children:o.filter(R=>R.status==="seen").length})," "]})]})]}),d?r.jsxs("div",{className:"loading-container",children:[" ",r.jsx("div",{className:"breathing-ball"})," ",r.jsx("span",{children:"Loading queue..."})]}):Q.length===0?r.jsx("div",{className:"empty-queue-message",children:i?"No patients found matching your search.":"Queue is empty."}):r.jsxs("div",{className:"queue-table-wrapper",children:[" ",r.jsxs("table",{className:"queue-table",children:[" ",r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Queue"}),r.jsx("th",{children:"Patient"}),r.jsx("th",{children:"Phone Number"}),r.jsx("th",{children:"Complaint"}),r.jsx("th",{children:"Subscription Status"}),r.jsx("th",{className:"hidden md:table-cell",children:"Time Added"})," ",r.jsx("th",{className:"text-center",children:"Action / Doctor"})," "]})}),r.jsx("tbody",{children:Q.map(R=>{var B,Y,re,ne,G,V,W,J,he,A,ce;return r.jsxs("tr",{onClick:()=>P(`/dashboard/edit-complaint/${R.id}`),className:"queue-row-clickable",children:[r.jsxs("td",{children:[" ",r.jsxs("span",{className:"queue-token",children:["#",R.token_no]})," "]}),r.jsxs("td",{children:[" ",r.jsx("div",{className:"patient-name",children:((B=R.Patient)==null?void 0:B.name)||"N/A"})," ",r.jsxs("div",{className:"patient-details",children:[(Y=R.Patient)!=null&&Y.age?`${R.Patient.age} yrs, `:"",((re=R.Patient)==null?void 0:re.gender)||""]})," "]}),r.jsxs("td",{children:[" ",r.jsx("div",{className:"patient-phone",children:((ne=R.Patient)==null?void 0:ne.phone)||"N/A"})," "]}),r.jsx("td",{className:"complaint-text",children:R.complaint||"-"}),r.jsxs("td",{children:[r.jsx("span",{className:`subscription-status-badge ${((G=R.Patient)==null?void 0:G.subscription_status)==="active"?"status-active":((V=R.Patient)==null?void 0:V.subscription_status)==="cancelled"||((W=R.Patient)==null?void 0:W.subscription_status)==="expired"?"status-inactive":"status-none"}`,children:((J=R.Patient)==null?void 0:J.subscription_status)??"None"}),R.Patient&&R.Patient.id&&R.Patient.subscription_status!=="active"&&r.jsx("button",{onClick:se=>{se.stopPropagation(),R.Patient&&P(`/start-subscription/${R.Patient.id}`)},className:"action-button btn-start-sub-queue mt-2",children:"Start Sub"})]}),r.jsx("td",{className:"hidden md:table-cell time-added",children:F(R.created_at)}),r.jsx("td",{className:"action-doctor-cell",children:v===R.id?r.jsx("div",{className:"relative inline-block text-left w-full",onClick:se=>se.stopPropagation(),children:r.jsxs("select",{value:"",onChange:se=>L(R.id,se.target.value),onBlur:()=>S(null),className:"doctor-select-dropdown",autoFocus:!0,children:[r.jsx("option",{value:"",disabled:!0,children:"Select Doctor..."}),g?r.jsx("option",{disabled:!0,children:"Loading..."}):u.length>0?u.map(se=>r.jsx("option",{value:se.id,children:se.name},se.id)):r.jsx("option",{disabled:!0,children:"No doctors available"})]})}):r.jsxs("div",{className:"action-doctor-content",onClick:se=>se.stopPropagation(),children:[" ",R.status==="waiting"&&r.jsx(r.Fragment,{children:(he=R.User)!=null&&he.name?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"doctor-name-display",children:R.User.name}),r.jsx("button",{onClick:()=>$(R.id,"consulting"),className:"action-button btn-start",children:"Start"})]}):g?r.jsx("span",{className:"status-text-italic",children:"Loading..."}):u.length===0?r.jsx("span",{className:"status-text-red",children:"No doctors"}):u.length===1?r.jsxs("button",{onClick:()=>L(R.id,u[0].id),className:"action-button btn-assign",children:["Assign ",u[0].name]}):r.jsx("button",{onClick:()=>S(R.id),className:"action-button btn-assign",children:"Assign"})}),R.status==="consulting"&&r.jsxs(r.Fragment,{children:[((A=R.User)==null?void 0:A.name)&&r.jsx("span",{className:"doctor-name-display",children:R.User.name}),r.jsx("button",{onClick:()=>$(R.id,"seen"),className:"action-button btn-complete",children:"Complete"})]}),R.status==="seen"&&r.jsxs(r.Fragment,{children:[((ce=R.User)==null?void 0:ce.name)&&r.jsx("span",{className:"doctor-name-display",children:R.User.name}),r.jsx("span",{className:"status-text-italic",children:"Completed"})]}),R.status==="cancelled"&&r.jsx("span",{className:"status-text-red",children:"Cancelled"})]})})]},R.id)})})]})]})]}),n==="lab"&&r.jsxs("div",{className:"lab-tab-content",children:[" ",r.jsx(Q2,{currentUser:e}),r.jsxs("button",{onClick:()=>P("/lab/search-report"),className:"lab-action-button btn-search-lab-reports",children:[r.jsx(os,{size:16}),"Search Lab Reports"]})]}),n==="newtons-ai"&&r.jsx("div",{className:"newtons-ai-tab-content",children:r.jsx(Sh,{})}),n==="manage-admission"&&r.jsx("div",{className:"manage-admission-tab-content",children:r.jsx(Y2,{})}),n==="all-patients"&&r.jsx("div",{className:"all-patients-tab-content",children:r.jsx(C1,{})}),n==="custom-bill"&&r.jsx("div",{className:"custom-bill-tab-content",children:r.jsx(W2,{})})]})})},J2=6048e5,J8=864e5,K2=6e4,X2=36e5,BC=Symbol.for("constructDateFrom");function qs(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&BC in e?e[BC](n):e instanceof Date?new e.constructor(n):new Date(n)}function jr(e,n){return qs(n||e,e)}function K8(e,n,t){const i=jr(e,t==null?void 0:t.in);if(isNaN(n))return qs(e,NaN);const a=i.getDate(),o=qs(e,i.getTime());o.setMonth(i.getMonth()+n+1,0);const l=o.getDate();return a>=l?o:(i.setFullYear(o.getFullYear(),o.getMonth(),a),i)}let X8={};function Fb(){return X8}function Km(e,n){var d,f,u,p;const t=Fb(),i=(n==null?void 0:n.weekStartsOn)??((f=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:f.weekStartsOn)??t.weekStartsOn??((p=(u=t.locale)==null?void 0:u.options)==null?void 0:p.weekStartsOn)??0,a=jr(e,n==null?void 0:n.in),o=a.getDay(),l=(o<i?7:0)+o-i;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function ub(e,n){return Km(e,{...n,weekStartsOn:1})}function Z2(e,n){const t=jr(e,n==null?void 0:n.in),i=t.getFullYear(),a=qs(t,0);a.setFullYear(i+1,0,4),a.setHours(0,0,0,0);const o=ub(a),l=qs(t,0);l.setFullYear(i,0,4),l.setHours(0,0,0,0);const d=ub(l);return t.getTime()>=o.getTime()?i+1:t.getTime()>=d.getTime()?i:i-1}function qC(e){const n=jr(e),t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),+e-+t}function Z8(e,...n){const t=qs.bind(null,n.find(i=>typeof i=="object"));return n.map(t)}function VC(e,n){const t=jr(e,n==null?void 0:n.in);return t.setHours(0,0,0,0),t}function eB(e,n,t){const[i,a]=Z8(t==null?void 0:t.in,e,n),o=VC(i),l=VC(a),d=+o-qC(o),f=+l-qC(l);return Math.round((d-f)/J8)}function tB(e,n){const t=Z2(e,n),i=qs(e,0);return i.setFullYear(t,0,4),i.setHours(0,0,0,0),ub(i)}function nB(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function j1(e){return!(!nB(e)&&typeof e!="number"||isNaN(+jr(e)))}function iB(e,n){const t=jr(e,n==null?void 0:n.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}const rB={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},aB=(e,n,t)=>{let i;const a=rB[e];return typeof a=="string"?i=a:n===1?i=a.one:i=a.other.replace("{{count}}",n.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+i:i+" ago":i};function d0(e){return(n={})=>{const t=n.width?String(n.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const sB={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},oB={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},lB={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},cB={date:d0({formats:sB,defaultWidth:"full"}),time:d0({formats:oB,defaultWidth:"full"}),dateTime:d0({formats:lB,defaultWidth:"full"})},uB={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},dB=(e,n,t,i)=>uB[e];function Tm(e){return(n,t)=>{const i=t!=null&&t.context?String(t.context):"standalone";let a;if(i==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,d=t!=null&&t.width?String(t.width):l;a=e.formattingValues[d]||e.formattingValues[l]}else{const l=e.defaultWidth,d=t!=null&&t.width?String(t.width):e.defaultWidth;a=e.values[d]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(n):n;return a[o]}}const fB={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},hB={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},pB={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},mB={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},gB={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},yB={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},xB=(e,n)=>{const t=Number(e),i=t%100;if(i>20||i<10)switch(i%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},bB={ordinalNumber:xB,era:Tm({values:fB,defaultWidth:"wide"}),quarter:Tm({values:hB,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Tm({values:pB,defaultWidth:"wide"}),day:Tm({values:mB,defaultWidth:"wide"}),dayPeriod:Tm({values:gB,defaultWidth:"wide",formattingValues:yB,defaultFormattingWidth:"wide"})};function Em(e){return(n,t={})=>{const i=t.width,a=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],o=n.match(a);if(!o)return null;const l=o[0],d=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(d)?wB(d,g=>g.test(l)):vB(d,g=>g.test(l));let u;u=e.valueCallback?e.valueCallback(f):f,u=t.valueCallback?t.valueCallback(u):u;const p=n.slice(l.length);return{value:u,rest:p}}}function vB(e,n){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(e[t]))return t}function wB(e,n){for(let t=0;t<e.length;t++)if(n(e[t]))return t}function SB(e){return(n,t={})=>{const i=n.match(e.matchPattern);if(!i)return null;const a=i[0],o=n.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=t.valueCallback?t.valueCallback(l):l;const d=n.slice(a.length);return{value:l,rest:d}}}const NB=/^(\d+)(th|st|nd|rd)?/i,CB=/\d+/i,jB={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},_B={any:[/^b/i,/^(a|c)/i]},kB={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},TB={any:[/1/i,/2/i,/3/i,/4/i]},EB={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},AB={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},PB={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},DB={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},IB={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},RB={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},MB={ordinalNumber:SB({matchPattern:NB,parsePattern:CB,valueCallback:e=>parseInt(e,10)}),era:Em({matchPatterns:jB,defaultMatchWidth:"wide",parsePatterns:_B,defaultParseWidth:"any"}),quarter:Em({matchPatterns:kB,defaultMatchWidth:"wide",parsePatterns:TB,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Em({matchPatterns:EB,defaultMatchWidth:"wide",parsePatterns:AB,defaultParseWidth:"any"}),day:Em({matchPatterns:PB,defaultMatchWidth:"wide",parsePatterns:DB,defaultParseWidth:"any"}),dayPeriod:Em({matchPatterns:IB,defaultMatchWidth:"any",parsePatterns:RB,defaultParseWidth:"any"})},OB={code:"en-US",formatDistance:aB,formatLong:cB,formatRelative:dB,localize:bB,match:MB,options:{weekStartsOn:0,firstWeekContainsDate:1}};function LB(e,n){const t=jr(e,n==null?void 0:n.in);return eB(t,iB(t))+1}function FB(e,n){const t=jr(e,n==null?void 0:n.in),i=+ub(t)-+tB(t);return Math.round(i/J2)+1}function eT(e,n){var p,g,b,v;const t=jr(e,n==null?void 0:n.in),i=t.getFullYear(),a=Fb(),o=(n==null?void 0:n.firstWeekContainsDate)??((g=(p=n==null?void 0:n.locale)==null?void 0:p.options)==null?void 0:g.firstWeekContainsDate)??a.firstWeekContainsDate??((v=(b=a.locale)==null?void 0:b.options)==null?void 0:v.firstWeekContainsDate)??1,l=qs((n==null?void 0:n.in)||e,0);l.setFullYear(i+1,0,o),l.setHours(0,0,0,0);const d=Km(l,n),f=qs((n==null?void 0:n.in)||e,0);f.setFullYear(i,0,o),f.setHours(0,0,0,0);const u=Km(f,n);return+t>=+d?i+1:+t>=+u?i:i-1}function $B(e,n){var d,f,u,p;const t=Fb(),i=(n==null?void 0:n.firstWeekContainsDate)??((f=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??t.firstWeekContainsDate??((p=(u=t.locale)==null?void 0:u.options)==null?void 0:p.firstWeekContainsDate)??1,a=eT(e,n),o=qs((n==null?void 0:n.in)||e,0);return o.setFullYear(a,0,i),o.setHours(0,0,0,0),Km(o,n)}function zB(e,n){const t=jr(e,n==null?void 0:n.in),i=+Km(t,n)-+$B(t,n);return Math.round(i/J2)+1}function $n(e,n){const t=e<0?"-":"",i=Math.abs(e).toString().padStart(n,"0");return t+i}const eu={y(e,n){const t=e.getFullYear(),i=t>0?t:1-t;return $n(n==="yy"?i%100:i,n.length)},M(e,n){const t=e.getMonth();return n==="M"?String(t+1):$n(t+1,2)},d(e,n){return $n(e.getDate(),n.length)},a(e,n){const t=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,n){return $n(e.getHours()%12||12,n.length)},H(e,n){return $n(e.getHours(),n.length)},m(e,n){return $n(e.getMinutes(),n.length)},s(e,n){return $n(e.getSeconds(),n.length)},S(e,n){const t=n.length,i=e.getMilliseconds(),a=Math.trunc(i*Math.pow(10,t-3));return $n(a,n.length)}},ph={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},HC={G:function(e,n,t){const i=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return t.era(i,{width:"abbreviated"});case"GGGGG":return t.era(i,{width:"narrow"});case"GGGG":default:return t.era(i,{width:"wide"})}},y:function(e,n,t){if(n==="yo"){const i=e.getFullYear(),a=i>0?i:1-i;return t.ordinalNumber(a,{unit:"year"})}return eu.y(e,n)},Y:function(e,n,t,i){const a=eT(e,i),o=a>0?a:1-a;if(n==="YY"){const l=o%100;return $n(l,2)}return n==="Yo"?t.ordinalNumber(o,{unit:"year"}):$n(o,n.length)},R:function(e,n){const t=Z2(e);return $n(t,n.length)},u:function(e,n){const t=e.getFullYear();return $n(t,n.length)},Q:function(e,n,t){const i=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(i);case"QQ":return $n(i,2);case"Qo":return t.ordinalNumber(i,{unit:"quarter"});case"QQQ":return t.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,n,t){const i=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(i);case"qq":return $n(i,2);case"qo":return t.ordinalNumber(i,{unit:"quarter"});case"qqq":return t.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,n,t){const i=e.getMonth();switch(n){case"M":case"MM":return eu.M(e,n);case"Mo":return t.ordinalNumber(i+1,{unit:"month"});case"MMM":return t.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(i,{width:"wide",context:"formatting"})}},L:function(e,n,t){const i=e.getMonth();switch(n){case"L":return String(i+1);case"LL":return $n(i+1,2);case"Lo":return t.ordinalNumber(i+1,{unit:"month"});case"LLL":return t.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(i,{width:"wide",context:"standalone"})}},w:function(e,n,t,i){const a=zB(e,i);return n==="wo"?t.ordinalNumber(a,{unit:"week"}):$n(a,n.length)},I:function(e,n,t){const i=FB(e);return n==="Io"?t.ordinalNumber(i,{unit:"week"}):$n(i,n.length)},d:function(e,n,t){return n==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):eu.d(e,n)},D:function(e,n,t){const i=LB(e);return n==="Do"?t.ordinalNumber(i,{unit:"dayOfYear"}):$n(i,n.length)},E:function(e,n,t){const i=e.getDay();switch(n){case"E":case"EE":case"EEE":return t.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(i,{width:"short",context:"formatting"});case"EEEE":default:return t.day(i,{width:"wide",context:"formatting"})}},e:function(e,n,t,i){const a=e.getDay(),o=(a-i.weekStartsOn+8)%7||7;switch(n){case"e":return String(o);case"ee":return $n(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,n,t,i){const a=e.getDay(),o=(a-i.weekStartsOn+8)%7||7;switch(n){case"c":return String(o);case"cc":return $n(o,n.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,n,t){const i=e.getDay(),a=i===0?7:i;switch(n){case"i":return String(a);case"ii":return $n(a,n.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(i,{width:"short",context:"formatting"});case"iiii":default:return t.day(i,{width:"wide",context:"formatting"})}},a:function(e,n,t){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,n,t){const i=e.getHours();let a;switch(i===12?a=ph.noon:i===0?a=ph.midnight:a=i/12>=1?"pm":"am",n){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,n,t){const i=e.getHours();let a;switch(i>=17?a=ph.evening:i>=12?a=ph.afternoon:i>=4?a=ph.morning:a=ph.night,n){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,n,t){if(n==="ho"){let i=e.getHours()%12;return i===0&&(i=12),t.ordinalNumber(i,{unit:"hour"})}return eu.h(e,n)},H:function(e,n,t){return n==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):eu.H(e,n)},K:function(e,n,t){const i=e.getHours()%12;return n==="Ko"?t.ordinalNumber(i,{unit:"hour"}):$n(i,n.length)},k:function(e,n,t){let i=e.getHours();return i===0&&(i=24),n==="ko"?t.ordinalNumber(i,{unit:"hour"}):$n(i,n.length)},m:function(e,n,t){return n==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):eu.m(e,n)},s:function(e,n,t){return n==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):eu.s(e,n)},S:function(e,n){return eu.S(e,n)},X:function(e,n,t){const i=e.getTimezoneOffset();if(i===0)return"Z";switch(n){case"X":return YC(i);case"XXXX":case"XX":return Pd(i);case"XXXXX":case"XXX":default:return Pd(i,":")}},x:function(e,n,t){const i=e.getTimezoneOffset();switch(n){case"x":return YC(i);case"xxxx":case"xx":return Pd(i);case"xxxxx":case"xxx":default:return Pd(i,":")}},O:function(e,n,t){const i=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+GC(i,":");case"OOOO":default:return"GMT"+Pd(i,":")}},z:function(e,n,t){const i=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+GC(i,":");case"zzzz":default:return"GMT"+Pd(i,":")}},t:function(e,n,t){const i=Math.trunc(+e/1e3);return $n(i,n.length)},T:function(e,n,t){return $n(+e,n.length)}};function GC(e,n=""){const t=e>0?"-":"+",i=Math.abs(e),a=Math.trunc(i/60),o=i%60;return o===0?t+String(a):t+String(a)+n+$n(o,2)}function YC(e,n){return e%60===0?(e>0?"-":"+")+$n(Math.abs(e)/60,2):Pd(e,n)}function Pd(e,n=""){const t=e>0?"-":"+",i=Math.abs(e),a=$n(Math.trunc(i/60),2),o=$n(i%60,2);return t+a+n+o}const WC=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},tT=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},UB=(e,n)=>{const t=e.match(/(P+)(p+)?/)||[],i=t[1],a=t[2];if(!a)return WC(e,n);let o;switch(i){case"P":o=n.dateTime({width:"short"});break;case"PP":o=n.dateTime({width:"medium"});break;case"PPP":o=n.dateTime({width:"long"});break;case"PPPP":default:o=n.dateTime({width:"full"});break}return o.replace("{{date}}",WC(i,n)).replace("{{time}}",tT(a,n))},BB={p:tT,P:UB},qB=/^D+$/,VB=/^Y+$/,HB=["D","DD","YY","YYYY"];function GB(e){return qB.test(e)}function YB(e){return VB.test(e)}function WB(e,n,t){const i=QB(e,n,t);if(console.warn(i),HB.includes(e))throw new RangeError(i)}function QB(e,n,t){const i=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${i} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const JB=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,KB=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,XB=/^'([^]*?)'?$/,ZB=/''/g,e9=/[a-zA-Z]/;function Rd(e,n,t){var p,g,b,v;const i=Fb(),a=i.locale??OB,o=i.firstWeekContainsDate??((g=(p=i.locale)==null?void 0:p.options)==null?void 0:g.firstWeekContainsDate)??1,l=i.weekStartsOn??((v=(b=i.locale)==null?void 0:b.options)==null?void 0:v.weekStartsOn)??0,d=jr(e,t==null?void 0:t.in);if(!j1(d))throw new RangeError("Invalid time value");let f=n.match(KB).map(S=>{const k=S[0];if(k==="p"||k==="P"){const T=BB[k];return T(S,a.formatLong)}return S}).join("").match(JB).map(S=>{if(S==="''")return{isToken:!1,value:"'"};const k=S[0];if(k==="'")return{isToken:!1,value:t9(S)};if(HC[k])return{isToken:!0,value:S};if(k.match(e9))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");return{isToken:!1,value:S}});a.localize.preprocessor&&(f=a.localize.preprocessor(d,f));const u={firstWeekContainsDate:o,weekStartsOn:l,locale:a};return f.map(S=>{if(!S.isToken)return S.value;const k=S.value;(YB(k)||GB(k))&&WB(k,n,String(e));const T=HC[k[0]];return T(d,k,a.localize,u)}).join("")}function t9(e){const n=e.match(XB);return n?n[1].replace(ZB,"'"):e}function f0(e,n){return+jr(e)<+jr(n)}function QC(e,n){const t=()=>qs(n==null?void 0:n.in,NaN),a=a9(e);let o;if(a.date){const u=s9(a.date,2);o=o9(u.restDateString,u.year)}if(!o||isNaN(+o))return t();const l=+o;let d=0,f;if(a.time&&(d=l9(a.time),isNaN(d)))return t();if(a.timezone){if(f=c9(a.timezone),isNaN(f))return t()}else{const u=new Date(l+d),p=jr(0,n==null?void 0:n.in);return p.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),p.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),p}return jr(l+d+f,n==null?void 0:n.in)}const bx={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},n9=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,i9=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,r9=/^([+-])(\d{2})(?::?(\d{2}))?$/;function a9(e){const n={},t=e.split(bx.dateTimeDelimiter);let i;if(t.length>2)return n;if(/:/.test(t[0])?i=t[0]:(n.date=t[0],i=t[1],bx.timeZoneDelimiter.test(n.date)&&(n.date=e.split(bx.timeZoneDelimiter)[0],i=e.substr(n.date.length,e.length))),i){const a=bx.timezone.exec(i);a?(n.time=i.replace(a[1],""),n.timezone=a[1]):n.time=i}return n}function s9(e,n){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),i=e.match(t);if(!i)return{year:NaN,restDateString:""};const a=i[1]?parseInt(i[1]):null,o=i[2]?parseInt(i[2]):null;return{year:o===null?a:o*100,restDateString:e.slice((i[1]||i[2]).length)}}function o9(e,n){if(n===null)return new Date(NaN);const t=e.match(n9);if(!t)return new Date(NaN);const i=!!t[4],a=Am(t[1]),o=Am(t[2])-1,l=Am(t[3]),d=Am(t[4]),f=Am(t[5])-1;if(i)return p9(n,d,f)?u9(n,d,f):new Date(NaN);{const u=new Date(0);return!f9(n,o,l)||!h9(n,a)?new Date(NaN):(u.setUTCFullYear(n,o,Math.max(a,l)),u)}}function Am(e){return e?parseInt(e):1}function l9(e){const n=e.match(i9);if(!n)return NaN;const t=h0(n[1]),i=h0(n[2]),a=h0(n[3]);return m9(t,i,a)?t*X2+i*K2+a*1e3:NaN}function h0(e){return e&&parseFloat(e.replace(",","."))||0}function c9(e){if(e==="Z")return 0;const n=e.match(r9);if(!n)return 0;const t=n[1]==="+"?-1:1,i=parseInt(n[2]),a=n[3]&&parseInt(n[3])||0;return g9(i,a)?t*(i*X2+a*K2):NaN}function u9(e,n,t){const i=new Date(0);i.setUTCFullYear(e,0,4);const a=i.getUTCDay()||7,o=(n-1)*7+t+1-a;return i.setUTCDate(i.getUTCDate()+o),i}const d9=[31,null,31,30,31,30,31,31,30,31,30,31];function nT(e){return e%400===0||e%4===0&&e%100!==0}function f9(e,n,t){return n>=0&&n<=11&&t>=1&&t<=(d9[n]||(nT(e)?29:28))}function h9(e,n){return n>=1&&n<=(nT(e)?366:365)}function p9(e,n,t){return n>=1&&n<=53&&t>=0&&t<=6}function m9(e,n,t){return e===24?n===0&&t===0:t>=0&&t<60&&n>=0&&n<60&&e>=0&&e<25}function g9(e,n){return n>=0&&n<=59}const jw=({isEmbedded:e=!1})=>{const[n,t]=w.useState([]),[i,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,p]=w.useState(null),g=w.useRef(null),[b,v]=w.useState(!1),[S,k]=w.useState(null),[T,P]=w.useState(!1),[M,I]=w.useState(!1),[U,L]=w.useState(null),[$,z]=w.useState({name:"",description:"",price:"",default_parameters:[]}),F=w.useCallback(async()=>{a(!0),l(null),p(null),k(null);try{const D=await me("/api/lab-tests");if(!D.ok)throw new Error(`HTTP error! status: ${D.status}`);const oe=await D.json();t(oe)}catch(D){console.error("Error fetching lab tests:",D),l(D.message||"Failed to fetch lab tests.")}finally{a(!1)}},[]);w.useEffect(()=>{F()},[F]);const Q=D=>{const{name:oe,value:xe}=D.target;z(Z=>({...Z,[oe]:xe}))},R=(D,oe,xe)=>{const Z=[...$.default_parameters],ue=Z[D];if(oe==="type")switch(ue.type=xe,xe){case"number":ue.defaultValue=0,ue.lower_limit=null,ue.upper_limit=null,ue.unit="";break;case"boolean":ue.defaultValue=!1,ue.lower_limit=void 0,ue.upper_limit=void 0,ue.unit=void 0;break;case"string":default:ue.defaultValue="",ue.lower_limit=void 0,ue.upper_limit=void 0,ue.unit=void 0;break}else oe==="defaultValue"?ue.type==="number"?ue.defaultValue=parseFloat(xe)||0:(ue.type,ue.defaultValue=xe):oe==="lower_limit"||oe==="upper_limit"?ue[oe]=xe===""?null:parseFloat(xe):ue[oe]=xe;z(ae=>({...ae,default_parameters:Z}))},B=()=>{z(D=>({...D,default_parameters:[...D.default_parameters,{name:"",type:"string",defaultValue:"",unit:"",lower_limit:null,upper_limit:null}]}))},Y=D=>{z(oe=>({...oe,default_parameters:oe.default_parameters.filter((xe,Z)=>Z!==D)}))},re=async D=>{D.preventDefault(),a(!0),l(null);const oe=U!==null,xe=oe?`/api/lab-tests/${U}`:"/api/lab-tests",Z=oe?"PUT":"POST";try{const ue=await me(xe,{method:Z,headers:{"Content-Type":"application/json"},body:JSON.stringify({name:$.name,description:$.description,price:parseFloat($.price),default_parameters:$.default_parameters})});if(!ue.ok){const ae=await ue.json();throw new Error(ae.message||`HTTP error! status: ${ue.status}`)}I(!1),L(null),z({name:"",description:"",price:"",default_parameters:[]}),F()}catch(ue){console.error(`Error ${oe?"updating":"adding"} lab test:`,ue),l(ue.message||`Failed to ${oe?"update":"add"} lab test.`)}finally{a(!1)}},ne=()=>{L(null),z({name:"",description:"",price:"",default_parameters:[]}),I(!0)},G=D=>{if(U===D.id)L(null);else{L(D.id);const oe=(D.default_parameters||[]).map(xe=>({...xe,unit:xe.unit||"",lower_limit:xe.lower_limit===void 0?null:xe.lower_limit,upper_limit:xe.upper_limit===void 0?null:xe.upper_limit}));z({name:D.name,description:D.description||"",price:D.price,default_parameters:oe}),I(!1)}},V=async D=>{if(window.confirm("Are you sure you want to delete this lab test?")){a(!0),l(null);try{const oe=await me(`/api/lab-tests/${D}`,{method:"DELETE"});if(!oe.ok){const xe=await oe.json();throw new Error(xe.message||`HTTP error! status: ${oe.status}`)}F()}catch(oe){console.error("Error deleting lab test:",oe),l(oe.message||"Failed to delete lab test.")}finally{a(!1)}}},W=()=>{I(!1),L(null),l(null),z({name:"",description:"",price:"",default_parameters:[]})},J=async D=>{if(!D){p("No file selected.");return}f(!0),p(null),l(null);const oe=new FormData;oe.append("file",D);try{const xe=await me("/api/lab-tests/import",{method:"POST",body:oe});if(!xe.ok){const Z=await xe.json();throw new Error(Z.message||`Import failed: ${xe.statusText}`)}F()}catch(xe){console.error("Error importing lab tests from Excel:",xe),p(xe.message||"Failed to import lab tests from Excel.")}finally{f(!1)}},he=async D=>{if(D.target.files&&D.target.files[0]){const oe=D.target.files[0];await J(oe),D.target&&(D.target.value="")}},A=async()=>{if(window.confirm("Are you sure you want to import default biochemistry and pathology tests? This will add new tests and may duplicate existing ones if names match.")){v(!0),k(null),l(null);try{const D=await me("/api/lab-tests/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"}});if(!D.ok){const oe=await D.json();throw new Error(oe.message||`Default import failed: ${D.statusText}`)}F()}catch(D){console.error("Error importing default lab tests:",D),k(D.message||"Failed to import default lab tests.")}finally{v(!1)}}},ce=async()=>{if(window.confirm("Are you sure you want to delete ALL lab tests? This action cannot be undone.")){P(!0),l(null),p(null),k(null);try{const D=await me("/api/lab-tests/all",{method:"DELETE"});if(!D.ok){const oe=await D.json();throw new Error(oe.message||`Delete all failed: ${D.statusText}`)}F()}catch(D){console.error("Error deleting all lab tests:",D),l(D.message||"Failed to delete all lab tests.")}finally{P(!1)}}},se=i||d||b||T;return r.jsxs("div",{className:`lab-inventory-card ${e?"embedded":""}`,style:e?{border:"none",boxShadow:"none",padding:0}:{},children:[!e&&r.jsx("h2",{className:"lab-inventory-header",children:"Available Lab Tests"}),r.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px"},children:[r.jsx("button",{onClick:ne,className:"lab-inventory-button",disabled:se,children:"Add New Test"}),r.jsx("button",{onClick:()=>{var D;return(D=g.current)==null?void 0:D.click()},className:"lab-inventory-button lab-inventory-button-secondary",disabled:se,children:d?"Importing...":"Import from Excel"}),r.jsx("input",{type:"file",ref:g,onChange:he,accept:".xlsx, .xls",style:{display:"none"},disabled:d}),r.jsx("button",{onClick:A,className:"lab-inventory-button lab-inventory-button-secondary",disabled:se,children:b?"Importing Defaults...":"Import Default Tests"}),r.jsx("button",{onClick:ce,className:"lab-inventory-button lab-inventory-button-danger",disabled:se,style:{backgroundColor:"#dc3545",borderColor:"#dc3545",color:"white"},children:T?"Deleting All...":"Delete All Tests"})]}),o&&r.jsx("div",{className:"error-text mb-4",children:o}),u&&r.jsxs("div",{className:"error-text mb-4",children:["Import Excel Error: ",u]}),S&&r.jsxs("div",{className:"error-text mb-4",children:["Import Default Error: ",S]}),M&&r.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"20px",marginBottom:"20px"},children:[" ",r.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.5em",borderBottom:"1px solid #eee",marginBottom:"15px"},children:"Add New Lab Test"}),r.jsxs("form",{onSubmit:re,children:[r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsxs("label",{htmlFor:"name",children:["Test Name ",r.jsx("span",{style:{color:"red"},children:"*"})]}),r.jsx("input",{type:"text",id:"name",name:"name",value:$.name,onChange:Q,className:"lab-inventory-input",required:!0,disabled:se})]}),r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsx("label",{htmlFor:"description",children:"Description"}),r.jsx("textarea",{id:"description",name:"description",value:$.description,onChange:Q,rows:3,className:"lab-inventory-input",disabled:se})]}),r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsxs("label",{htmlFor:"price",children:["Price ",r.jsx("span",{style:{color:"red"},children:"*"})]}),r.jsx("input",{type:"number",id:"price",name:"price",value:$.price,onChange:Q,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:se})]}),r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginTop:"20px",marginBottom:"10px"},children:"Default Parameters"}),$.default_parameters.map((D,oe)=>{var xe,Z;return r.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[r.jsx("input",{type:"text",placeholder:"Parameter Name",value:D.name,onChange:ue=>R(oe,"name",ue.target.value),className:"lab-inventory-input"}),r.jsxs("select",{value:D.type,onChange:ue=>R(oe,"type",ue.target.value),className:"lab-inventory-input",children:[r.jsx("option",{value:"string",children:"Text"}),r.jsx("option",{value:"number",children:"Number"}),r.jsx("option",{value:"boolean",children:"Yes/No"})]}),D.type==="boolean"?r.jsxs("select",{value:D.defaultValue.toString(),onChange:ue=>R(oe,"defaultValue",ue.target.value==="true"),className:"lab-inventory-input",children:[r.jsx("option",{value:"true",children:"Reactive"}),r.jsx("option",{value:"false",children:"Non-reactive"})]}):r.jsx("input",{type:D.type==="number"?"number":"text",placeholder:"Default Value",value:D.defaultValue.toString(),onChange:ue=>R(oe,"defaultValue",ue.target.value),className:"lab-inventory-input"}),D.type==="number"&&r.jsxs(r.Fragment,{children:[r.jsx("input",{type:"number",placeholder:"Lower Limit",value:D.lower_limit===null?"":((xe=D.lower_limit)==null?void 0:xe.toString())??"",onChange:ue=>R(oe,"lower_limit",ue.target.value),className:"lab-inventory-input"}),r.jsx("input",{type:"number",placeholder:"Upper Limit",value:D.upper_limit===null?"":((Z=D.upper_limit)==null?void 0:Z.toString())??"",onChange:ue=>R(oe,"upper_limit",ue.target.value),className:"lab-inventory-input"}),r.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:D.unit||"",onChange:ue=>R(oe,"unit",ue.target.value),className:"lab-inventory-input"})]}),r.jsx("button",{type:"button",onClick:()=>Y(oe),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},oe)}),r.jsx("button",{type:"button",onClick:B,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[r.jsx("button",{type:"button",onClick:W,className:"lab-inventory-button lab-inventory-button-secondary",disabled:se,children:"Cancel"}),r.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:se,children:i?"Saving...":"Add Test"})]})]})]}),se&&!M&&r.jsxs("p",{className:"loading-text",children:[" ",d?"Importing Excel data...":b?"Importing default data...":"Loading tests..."]}),!se&&n.length===0&&!o&&!u&&!S&&r.jsx("p",{className:"no-data-message",children:"No lab tests found. Add one or import from Excel to get started."}),!se&&n.length>0&&r.jsxs("div",{className:"overflow-x-auto",children:[" ",r.jsxs("table",{className:"lab-inventory-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Name"}),r.jsx("th",{className:"hidden md:table-cell",children:"Description"})," ",r.jsx("th",{children:"Price"}),r.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),r.jsx("tbody",{children:n.map(D=>{const oe=U===D.id,xe=D.price&&typeof D.price=="string"?parseFloat(D.price):NaN,Z=isNaN(xe)?"0.00":xe.toFixed(2);return r.jsxs(vn.Fragment,{children:[r.jsxs("tr",{onClick:()=>G(D),style:{cursor:"pointer"},children:[r.jsx("td",{children:D.name}),r.jsx("td",{className:"hidden md:table-cell",style:{whiteSpace:"pre-wrap"},children:D.description||"-"}),r.jsxs("td",{children:["",Z]}),r.jsx("td",{style:{textAlign:"right"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[r.jsx("button",{onClick:ue=>{ue.stopPropagation(),G(D)},className:"lab-inventory-link",disabled:se,style:{background:"none",border:"none",padding:"0",cursor:"pointer"},children:"Edit"}),r.jsx("button",{onClick:ue=>{ue.stopPropagation(),V(D.id)},className:"lab-inventory-link",disabled:se,style:{background:"none",border:"none",padding:"0",cursor:"pointer",color:"#dc3545"},children:"Delete"})]})})]}),oe&&r.jsx("tr",{children:r.jsx("td",{colSpan:4,children:r.jsxs("div",{className:"lab-inventory-card",style:{marginTop:"10px",marginBottom:"10px",border:"1px solid #ddd",padding:"15px"},children:[r.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em"},children:"Edit Lab Test"}),r.jsxs("form",{onSubmit:re,children:[r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsxs("label",{htmlFor:"name",children:["Test Name ",r.jsx("span",{style:{color:"red"},children:"*"})]}),r.jsx("input",{type:"text",id:"name",name:"name",value:$.name,onChange:Q,className:"lab-inventory-input",required:!0,disabled:se})]}),r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsx("label",{htmlFor:"description",children:"Description"}),r.jsx("textarea",{id:"description",name:"description",value:$.description,onChange:Q,rows:3,className:"lab-inventory-input",disabled:se})]}),r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsxs("label",{htmlFor:"price",children:["Price ",r.jsx("span",{style:{color:"red"},children:"*"})]}),r.jsx("input",{type:"number",id:"price",name:"price",value:$.price,onChange:Q,min:"0",step:"0.01",className:"lab-inventory-input",required:!0,disabled:se})]}),r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",marginTop:"15px"},children:"Default Parameters"}),$.default_parameters.map((ue,ae)=>{var Re,Ae;return r.jsxs("div",{className:"parameter-item",style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr auto",gap:"10px",alignItems:"center",marginBottom:"10px"},children:[r.jsx("input",{type:"text",placeholder:"Parameter Name",value:ue.name,onChange:Ce=>R(ae,"name",Ce.target.value),className:"lab-inventory-input"}),r.jsxs("select",{value:ue.type,onChange:Ce=>R(ae,"type",Ce.target.value),className:"lab-inventory-input",children:[r.jsx("option",{value:"string",children:"Text"}),r.jsx("option",{value:"number",children:"Number"}),r.jsx("option",{value:"boolean",children:"Yes/No"})]}),ue.type==="boolean"?r.jsxs("select",{value:ue.defaultValue.toString(),onChange:Ce=>R(ae,"defaultValue",Ce.target.value==="true"),className:"lab-inventory-input",children:[r.jsx("option",{value:"true",children:"Reactive"}),r.jsx("option",{value:"false",children:"Non-reactive"})]}):r.jsx("input",{type:ue.type==="number"?"number":"text",placeholder:"Default Value",value:ue.defaultValue.toString(),onChange:Ce=>R(ae,"defaultValue",Ce.target.value),className:"lab-inventory-input"}),ue.type==="number"&&r.jsxs(r.Fragment,{children:[r.jsx("input",{type:"number",placeholder:"Lower Limit",value:ue.lower_limit===null?"":((Re=ue.lower_limit)==null?void 0:Re.toString())??"",onChange:Ce=>R(ae,"lower_limit",Ce.target.value),className:"lab-inventory-input"}),r.jsx("input",{type:"number",placeholder:"Upper Limit",value:ue.upper_limit===null?"":((Ae=ue.upper_limit)==null?void 0:Ae.toString())??"",onChange:Ce=>R(ae,"upper_limit",Ce.target.value),className:"lab-inventory-input"}),r.jsx("input",{type:"text",placeholder:"Unit (e.g., mg/dL)",value:ue.unit||"",onChange:Ce=>R(ae,"unit",Ce.target.value),className:"lab-inventory-input"})]}),r.jsx("button",{type:"button",onClick:()=>Y(ae),className:"lab-inventory-button lab-inventory-button-danger",children:"Remove"})]},ae)}),r.jsx("button",{type:"button",onClick:B,className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"10px"},children:"Add Parameter"})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px"},children:[r.jsx("button",{type:"button",onClick:W,className:"lab-inventory-button lab-inventory-button-secondary",disabled:se,children:"Cancel"}),r.jsx("button",{type:"submit",className:"lab-inventory-button",disabled:se,children:i?"Saving...":"Update Test"})]})]})]})})})]},D.id)})})]})]})]})},y9=e=>{let n="";if(!e.report_content)return"No report content available.";n+=`*Report Date:* ${e.report_date?new Date(e.report_date).toLocaleDateString():"N/A"}

`;try{const t=JSON.parse(e.report_content);typeof t=="object"&&t!==null&&e.tests?e.tests.forEach((i,a)=>{n+=`*Test: ${i.name}*
`,t[i.id]?Object.entries(t[i.id]).forEach(([o,l])=>{var p;const d=(p=i.default_parameters)==null?void 0:p.find(g=>g.name===o);let f=String(l),u="";if(d){const g=d.unit?` _${d.unit}_`:"";if(d.type==="boolean"){const b=l===!0||l==="true";f=b?"*Reactive*":"Non-Reactive",b||(u="`Normal: Non-Reactive`")}else if(d.type==="number"){const b=typeof l=="string"?parseFloat(l):typeof l=="number"?l:NaN;if(d.lower_limit!=null||d.upper_limit!=null){let v=[];d.lower_limit!=null&&v.push(`${d.lower_limit}`),d.upper_limit!=null&&v.push(`${d.upper_limit}`),u=`\`Normal: ${v.join(" - ")}\`${g}`,!isNaN(b)&&(d.lower_limit!=null&&b<d.lower_limit||d.upper_limit!=null&&b>d.upper_limit)&&(f=`*${f}*`)}}d.unit&&(f+=g)}n+=`${o}: ${f}
`,u&&((d==null?void 0:d.type)==="boolean"&&(l===!0||l==="true")||(n+=`${u}
`))}):n+=`_No parameters reported for this test._
`,a<e.tests.length-1&&(n+=`
`)}):n+=e.report_content}catch{n+=e.report_content}return n},_w=e=>{var l;if(!((l=e==null?void 0:e.Patient)!=null&&l.phone)){alert("Cannot share report via WhatsApp: Patient phone number is not available.");return}if(!(e!=null&&e.report_content)){alert("Cannot share report: No report content is available to share.");return}const n=e.Patient.name||"Patient",t=y9(e),i=`Hello ${n},

Your lab report is ready.

${t}`,o=`https://wa.me/${x9(e.Patient.phone)}?text=${encodeURIComponent(i)}`;window.open(o,"_blank")},x9=e=>{let n=e.replace(/\D/g,"");const t=/^(?:\\+?91)?[\\s-]*?(\\d{10})$/,i=n.match(t);return i?n="91"+i[1]:n.startsWith("91")||(n="91"+n),n},b9=()=>{const[e,n]=w.useState([]),[t,i]=w.useState(""),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState("orders"),[p,g]=w.useState(1),[b]=w.useState(20),[v,S]=w.useState(0),k=w.useMemo(()=>Math.ceil(v/b),[v,b]),T=w.useCallback(async(F=1,Q="")=>{o(!0),d(null);try{const R=new URLSearchParams({page:String(F),limit:String(b)});Q&&R.append("search",Q);const B=await me(`/api/lab?${R.toString()}`);if(!B.ok)throw new Error(`HTTP error! status: ${B.status}`);const Y=await B.json(),re=Y.orders.map(ne=>{var G,V;return{id:ne.id,labTokenNumber:String(ne.lab_token_number??"N/A"),patientName:((G=ne.Patient)==null?void 0:G.name)||"N/A",patientId:ne.patient_id,patientTokenNumber:String(((V=ne.Patient)==null?void 0:V.patient_token_number)??"N/A"),tests:(ne.tests||[]).map(W=>W.name||"Unknown Test"),date:Rd(new Date(ne.createdAt),"yyyy-MM-dd"),status:ne.status,reportId:ne.reportId,billId:ne.billId}});n(re),S(Y.totalCount),g(F)}catch(R){console.error("Failed to fetch lab orders:",R),d(R instanceof Error?R.message:"An unknown error occurred"),n([]),S(0)}finally{o(!1)}},[b]);w.useEffect(()=>{console.log(`Fetch effect triggered. Current page: ${p}, Search term: "${t}"`),t.length===0||t.length>=2?(console.log(`Condition met (length ${t.length}). Fetching orders...`),T(p,t)):console.log(`Condition not met (length ${t.length}). Not fetching.`)},[T,p,t]),w.useEffect(()=>{const F=setTimeout(()=>{t.length>=2?p!==1&&g(1):t.length<2&&p!==1&&g(1)},1e3);return()=>{clearTimeout(F)}},[t]);const P=async(F,Q)=>{console.log(`Updating order ${F} to status ${Q}`);try{const R=await me(`/api/lab/${F}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:Q})});if(!R.ok){const B=await R.json();throw new Error(B.message||`Failed to update status: ${R.status}`)}if(Q==="completed"){const B=await me(`/api/lab/orders/${F}/report`);if(B.ok){const Y=await B.json();_w(Y)}}await T(p,t),console.log(`Order ${F} status updated to ${Q}, refetching page ${p}`)}catch(R){console.error("Error updating status:",R),alert(`Failed to update status: ${R instanceof Error?R.message:"Unknown error"}`)}},M=_t(),I=F=>{if(!F){console.error("Cannot navigate to billing: Order data is missing."),alert("Could not open billing page: Order information is missing.");return}F.billId?(console.log(`Navigating to existing bill for Bill ID: ${F.billId}, Patient: ${F.patientName}`),M("/billing",{state:{billId:F.billId,patientId:F.patientId,patientName:F.patientName,billType:"lab"}})):(console.log(`Navigating to LabBillingPage for Order ID: ${F.id}`),M(`/dashboard/lab-billing/${F.id}`))},U=F=>{F&&F.id?M(`/lab/report/${F.id}`):(console.error("Cannot navigate: Order or Order ID is missing."),alert("Could not open the report entry page: Order information is missing."))},L=F=>{switch(F){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:F,className:"status-badge"}}};if(a)return r.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:r.jsx("div",{className:"text-teal-600 text-xl animate-pulse",children:"Loading Lab Panel..."})});if(l)return r.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-red-50 text-red-700",children:[r.jsx(Hi,{size:48,className:"mb-4"}),r.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Error Loading Lab Data"}),r.jsx("p",{className:"mb-4",children:l}),r.jsx("button",{onClick:()=>T(1,""),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry Fetch"})]});const $=()=>{p>1&&g(F=>F-1)},z=()=>{p<k&&g(F=>F+1)};return r.jsxs("div",{className:"lab-inventory-container",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("button",{onClick:()=>M(-1),className:"back-button mr-4",children:r.jsx(rn,{size:24})}),r.jsx("h2",{className:"text-2xl font-semibold",children:"Lab Panel"})]}),r.jsxs("main",{className:"flex-1 overflow-y-auto",children:[r.jsxs("div",{className:"mb-4",style:{display:"flex",gap:"10px",borderBottom:"1px solid #ddd",paddingBottom:"10px"},children:[r.jsxs("button",{onClick:()=>u("orders"),className:`lab-inventory-button ${f==="orders"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[r.jsx(nk,{size:16,style:{marginRight:"8px"}}),"Orders"]}),r.jsx("button",{onClick:()=>M("/create-lab-order"),className:"lab-inventory-button",style:{display:"flex",alignItems:"center"},children:"Create New Lab Order"}),r.jsxs("button",{onClick:()=>u("inventory"),className:`lab-inventory-button ${f==="inventory"?"":"lab-inventory-button-secondary"}`,style:{display:"flex",alignItems:"center"},children:[r.jsx(oI,{size:16,style:{marginRight:"8px"}}),"Inventory"]})]}),f==="orders"&&r.jsxs("div",{className:"lab-orders-view",children:[" ",r.jsxs("div",{className:"lab-orders-header-controls",children:[r.jsx("h3",{className:"lab-orders-title",children:"Current Lab Orders"}),r.jsxs("div",{className:"lab-orders-search-container",children:[r.jsx("input",{type:"text",placeholder:"Search name, token, tests...",value:t,onChange:F=>i(F.target.value),className:"lab-inventory-input lab-orders-search-input"}),r.jsx(os,{size:18,className:"lab-orders-search-icon"})]})]}),r.jsx("div",{className:"lab-orders-table-container",children:r.jsxs("table",{className:"lab-inventory-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Patient (Token)"}),r.jsx("th",{children:"Tests"}),r.jsx("th",{className:"hidden md:table-cell",children:"Date"}),r.jsx("th",{children:"Status"}),r.jsx("th",{className:"lab-table-actions-header",children:"Actions"})]})}),r.jsxs("tbody",{children:[a&&!l&&e.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"text-center py-10",children:"Loading orders..."})}),!a&&!l&&e.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."})}),!a&&!l&&e.map(F=>{const Q=L(F.status);return r.jsxs("tr",{children:[r.jsxs("td",{children:[r.jsx("div",{children:F.patientName}),r.jsxs("div",{className:"lab-table-patient-token",children:["Token: ",F.patientTokenNumber]})]}),r.jsx("td",{children:F.tests.map((R,B)=>r.jsx("div",{children:R},B))}),r.jsx("td",{className:"hidden md:table-cell",children:F.date}),r.jsx("td",{children:r.jsx("span",{className:Q.className,children:Q.text})}),r.jsx("td",{children:r.jsxs("div",{className:"lab-table-actions",children:[F.status==="pending"&&r.jsx("button",{onClick:()=>I(F),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),F.status==="billed"&&r.jsx("button",{onClick:()=>P(F.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),F.status==="collected"&&r.jsx("button",{onClick:()=>P(F.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(F.status==="processing"||F.status==="report_ready"||F.status==="reported")&&r.jsx("button",{onClick:()=>U(F),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(F.status==="report_ready"||F.status==="reported")&&r.jsx("button",{onClick:()=>P(F.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(F.status==="completed"||F.status==="report_ready"||F.status==="reported")&&r.jsx("button",{onClick:()=>{F.id?M(`/lab/view-report/${F.id}`):(console.error("Attempted to view report for an order with no ID:",F),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})})]},F.id)})]})]})}),r.jsxs("div",{className:"lab-orders-card-container",children:[a&&!l&&e.length===0&&r.jsx("div",{className:"text-center py-10",children:"Loading orders..."}),!a&&!l&&e.length===0&&r.jsx("div",{className:"text-center py-10",children:t?`No lab orders found matching "${t}".`:"No lab orders available."}),!a&&!l&&e.map(F=>{const Q=L(F.status);return r.jsxs("div",{className:"lab-order-card",children:[r.jsxs("div",{className:"lab-card-header",children:[r.jsxs("div",{children:[r.jsx("div",{className:"lab-card-patient-name",children:F.patientName}),r.jsxs("div",{className:"lab-card-patient-token",children:["Token: ",F.patientTokenNumber]}),r.jsx("div",{className:"lab-card-date",children:F.date})]}),r.jsx("span",{className:`${Q.className} lab-card-status-pill`,children:Q.text})]}),r.jsxs("div",{className:"lab-card-section",children:[r.jsx("p",{className:"lab-card-section-title",children:"Tests:"}),F.tests.map((R,B)=>r.jsx("div",{className:"lab-card-test-item",children:R},B)),F.tests.length===0&&r.jsx("div",{className:"lab-card-no-tests",children:"No tests listed."})]}),r.jsxs("div",{className:"lab-card-actions",children:[F.status==="pending"&&r.jsx("button",{onClick:()=>I(F),className:"lab-action-button btn-bill",title:"Generate Bill",children:"Bill"}),F.status==="billed"&&r.jsx("button",{onClick:()=>P(F.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),F.status==="collected"&&r.jsx("button",{onClick:()=>P(F.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),(F.status==="processing"||F.status==="report_ready"||F.status==="reported")&&r.jsx("button",{onClick:()=>U(F),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(F.status==="report_ready"||F.status==="reported")&&r.jsx("button",{onClick:()=>P(F.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"}),(F.status==="completed"||F.status==="report_ready"||F.status==="reported")&&r.jsx("button",{onClick:()=>{F.id?M(`/lab/view-report/${F.id}`):(console.error("Attempted to view report for an order with no ID:",F),alert("Cannot view report: Order ID is missing."))},className:"lab-action-button btn-view-report",title:"View Report",children:"View"})]})]},F.id)})]}),!a&&v>0&&r.jsxs("div",{className:"lab-pagination-controls",children:[r.jsxs("div",{className:"lab-pagination-info",children:["Showing"," ",r.jsx("strong",{children:(p-1)*b+1})," ","to"," ",r.jsx("strong",{children:Math.min(p*b,v)})," ","of"," ",r.jsx("strong",{children:v})," ","results"]}),r.jsxs("div",{className:"lab-pagination-buttons",children:[r.jsx("button",{onClick:$,disabled:p===1,className:"lab-pagination-button","aria-label":"Previous page",children:r.jsx(sw,{size:18})}),r.jsxs("span",{children:["Page ",p," of ",k]}),r.jsx("button",{onClick:z,disabled:p===k,className:"lab-pagination-button","aria-label":"Next page",children:r.jsx($h,{size:18})})]})]})]}),f==="inventory"&&r.jsxs("div",{className:"lab-inventory-content-wrapper",children:[" ",r.jsx(jw,{})]})]})]})},v9=()=>{const[e,n]=w.useState([]),[t,i]=w.useState(""),[a,o]=w.useState(!0),[l,d]=w.useState(null),f=_t(),u=w.useRef(null),[p,g]=w.useState(1),[b,v]=w.useState(1),[S,k]=w.useState(0),T=10,P=w.useCallback(async(z,F,Q)=>{o(!0),d(null);try{let R=`/api/pharmacy-orders?page=${z}&limit=${F}`;Q&&Q.trim()!==""&&(R+=`&search=${encodeURIComponent(Q.trim())}`);const B=await me(R);if(!B.ok)throw new Error(`Failed to fetch orders: ${B.statusText} (${B.status})`);const Y=await B.json();if(Y&&Array.isArray(Y.orders)&&typeof Y.totalOrders=="number"&&typeof Y.totalPages=="number")console.log("Fetched pharmacy orders data:",Y.orders),n(Y.orders),k(Y.totalOrders),v(Y.totalPages),g(Y.currentPage||z);else throw console.error("Received data does not match expected paginated structure:",Y),new Error("Invalid data format received from API")}catch(R){console.error("Failed to fetch pharmacy orders:",R),d(R.message||"Failed to fetch orders. Please try again."),n([]),v(1),k(0)}finally{o(!1)}},[]);w.useEffect(()=>(u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{const z=t===""?p:1;t!==""&&p!==1&&g(1),P(z,T,t)},500),()=>{u.current&&clearTimeout(u.current)}),[t,p,P,T]);const M=z=>{f(`/dashboard/edit-pharmacy-order/${z}`)},I=z=>{d(null),console.log(`Preparing billing navigation for order: ${z}`);const F=e.find(Q=>Q.id===z);if(F){const Q=F.medications.map(R=>{const B=R.price??0;return(R.price===void 0||R.price===null)&&console.warn(`Medication "${R.name}" in order ${z} is missing a price. Defaulting to 0.`),{name:R.name,pack_quantity:R.pack_quantity,loose_quantity:R.loose_quantity,price:B,pack_price:R.pack_price,loose_price:R.loose_price,total_price:R.total_price,isLoose:R.isLoose,unit:R.unit,drug_id:R.drug_id?String(R.drug_id):null,tabletsPerDay:R.tabletsPerDay,numberOfDays:R.numberOfDays,directions_to_use:R.directions_to_use,discount_percentage:0,batch:R.batch,expiry_date:R.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:Q}),f(`/dashboard/pharmacy-billing/${z}`,{state:{initialItems:Q}})}else console.error(`Order with ID ${z} not found.`),d(`Order with ID ${z} not found.`),alert(`Error: Could not find order ${z} to bill.`)},U=async(z,F)=>{d(null);const Q=e.find(B=>B.id===z);if(!Q){d(`Order with ID ${z} not found.`);return}const R={status:F,medications:Q.medications};try{const B=await me(`/api/pharmacy-orders/${z}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)});if(!B.ok){const re=await B.text();throw new Error(`Failed to update status: ${B.statusText} (${B.status}) - ${re}`)}const Y=await B.json();n(re=>re.map(ne=>ne.id===Y.id?{...ne,status:Y.status}:ne))}catch(B){console.error("Failed to update order status:",B),d(B.message||`Failed to update status for order ${z}.`),alert(`Error updating status for order ${z}: ${B.message||"Please try again."}`)}},L=z=>{switch(z){case"pending":return"status-pill status-pill-pending";case"billed":return"status-pill status-pill-billed";case"dispensed":return"status-pill status-pill-dispensed";case"cancelled":return"status-pill status-pill-cancelled";default:return"status-pill status-pill-default"}},$=z=>{f(`/dashboard/orders/${z.id}`)};return a&&e.length===0&&!l?r.jsx("div",{className:"loading-pulse",children:"Loading Orders..."}):l&&e.length===0?r.jsxs("div",{className:"error-message-box",children:["Error loading orders: ",l]}):r.jsxs("div",{className:"pharmacy-queue-container",children:[r.jsxs("div",{className:"pharmacy-queue-header",children:[r.jsx("h3",{className:"pharmacy-queue-title",children:"Pharmacy Queue"}),r.jsxs("div",{className:"pharmacy-actions-container",children:[r.jsxs("div",{className:"pharmacy-buttons-group",children:[r.jsxs("button",{onClick:()=>f("/dashboard/add-order"),className:"pharmacy-action-button btn-add-order",children:[r.jsx(ss,{size:16}),"Add Order"]}),r.jsxs("button",{onClick:()=>f("/dashboard/inventory"),className:"pharmacy-action-button btn-inventory",title:"View Pharmacy Inventory",children:[r.jsx(Md,{size:16}),"Inventory"]}),r.jsxs("button",{onClick:()=>f("/dashboard/search-patient-records"),className:"pharmacy-action-button btn-ai-search",title:"Search Patient Records with Newton's AI",children:[r.jsx(tk,{size:16}),"Newton's AI"]}),r.jsxs("button",{onClick:()=>f("/dashboard/distributors"),className:"pharmacy-action-button btn-distributors",title:"Manage Distributors",children:[r.jsx(Md,{size:16}),"Distributors"]})]}),r.jsxs("div",{className:"pharmacy-search-input-container",children:[r.jsx("input",{type:"text",placeholder:"Search orders by patient name, token, or medication...",value:t,onChange:z=>i(z.target.value),className:"pharmacy-search-input"}),r.jsx(os,{size:18,className:"pharmacy-search-icon"})]})]})]}),r.jsxs("div",{className:"pharmacy-orders-scroll-container",children:[l&&e.length>0&&r.jsxs("div",{className:"error-message-box",children:["Error: ",l]}),a&&e.length>0&&r.jsx("div",{className:"loading-pulse",children:"Updating Orders..."}),!a&&e.length===0&&!l&&r.jsx("div",{className:"empty-state-message",children:t?`No pharmacy orders found matching "${t}".`:"There are currently no pharmacy orders."}),e.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"pharmacy-table-container",children:r.jsxs("table",{className:"pharmacy-queue-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Patient"}),r.jsx("th",{children:"Medications"}),r.jsx("th",{className:"hidden md:table-cell",children:"Date"}),r.jsx("th",{children:"Order Total"})," ",r.jsx("th",{children:"Status"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:e.map(z=>r.jsxs("tr",{onClick:()=>$(z),style:{cursor:"pointer"},children:[r.jsxs("td",{children:[r.jsx("div",{className:"patient-name",children:z.patientName}),r.jsx("div",{className:"patient-token",title:`Patient Token: ${z.patientTokenNumber}`,children:z.patientTokenNumber})]}),r.jsxs("td",{className:"medication-info",children:[z.medications.map((F,Q)=>r.jsxs("div",{className:"medication-item",children:[r.jsxs("span",{children:[F.name," (Packs: ",F.pack_quantity,", Loose: ",F.loose_quantity,", ",F.tabletsPerDay??"N/A","x",F.numberOfDays??"N/A","d)",F.box_number&&r.jsxs("span",{className:"medication-box-number",children:[" (Box: ",F.box_number,")"]})]}),F.directions_to_use&&r.jsxs("span",{className:"medication-directions",children:["Directions: ",F.directions_to_use]}),r.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[F.pack_price!==void 0&&`Pack Price: ${Number(F.pack_price).toFixed(2)}`,F.loose_price!==void 0&&` | Loose Price: ${Number(F.loose_price).toFixed(2)}`,F.total_price!==void 0&&` | Item Total: ${Number(F.total_price).toFixed(2)}`]})]},Q)),z.prescriptionForUnavailableDrugs&&r.jsxs("div",{className:"unavailable-drugs-note",children:[r.jsx("strong",{children:"Unavailable Drugs Note:"})," ",z.prescriptionForUnavailableDrugs]})]}),r.jsx("td",{className:"hidden md:table-cell date-info",children:new Date(z.date).toLocaleDateString()}),r.jsxs("td",{className:"order-total-cell font-semibold",children:["",Number(z.order_total??0).toFixed(2)]}),r.jsx("td",{children:r.jsx("span",{className:L(z.status),children:z.status})}),r.jsx("td",{children:r.jsxs("div",{className:"pharmacy-table-actions",children:[z.status==="pending"&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:F=>{F.stopPropagation(),M(z.id)},className:"pharmacy-table-action-button btn-edit-order",children:[r.jsx(lu,{size:14})," Edit"]}),r.jsxs("button",{onClick:F=>{F.stopPropagation(),I(z.id)},className:"pharmacy-table-action-button btn-bill-order",children:[r.jsx(Eh,{size:14})," Bill"]})]}),z.status==="billed"&&r.jsxs("button",{onClick:F=>{F.stopPropagation(),U(z.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[r.jsx(cs,{size:14})," Dispense"]}),(z.status==="pending"||z.status==="billed")&&r.jsx("button",{onClick:F=>{F.stopPropagation(),U(z.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),r.jsx("button",{onClick:F=>{F.stopPropagation(),$(z)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})})]},z.id))})]})}),r.jsx("div",{className:"pharmacy-card-view-container",children:e.map(z=>{const F=L(z.status);return r.jsxs("div",{className:"pharmacy-order-card",onClick:()=>$(z),children:[r.jsxs("div",{className:"pharmacy-card-header",children:[r.jsxs("div",{children:[r.jsx("div",{className:"pharmacy-card-patient-name",children:z.patientName||"N/A"}),r.jsxs("div",{className:"pharmacy-card-patient-token",title:`Patient Token: ${z.patientTokenNumber}`,children:["Token: ",z.patientTokenNumber||"N/A"]}),r.jsx("div",{className:"pharmacy-card-date",children:new Date(z.date).toLocaleDateString()})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:F,children:z.status}),z.order_total!==void 0&&r.jsxs("span",{className:"pharmacy-card-order-total font-semibold",children:["",Number(z.order_total).toFixed(2)]})]})]}),r.jsxs("div",{className:"pharmacy-card-medications",children:[r.jsx("p",{className:"pharmacy-card-medications-title",children:"Medications:"}),r.jsxs("div",{className:"space-y-0_5",children:[z.medications.slice(0,2).map((Q,R)=>r.jsxs("div",{className:"pharmacy-card-medication-item",children:[r.jsxs("span",{title:`${Q.name} (Packs: ${Q.pack_quantity}, Loose: ${Q.loose_quantity}, ${Q.tabletsPerDay??"N/A"}x${Q.numberOfDays??"N/A"}d)`,children:[Q.name," (Packs: ",Q.pack_quantity,", Loose: ",Q.loose_quantity,", ",Q.tabletsPerDay??"N/A","x",Q.numberOfDays??"N/A","d)",Q.box_number&&r.jsxs("span",{className:"medication-box-number",children:[" (Box: ",Q.box_number,")"]})]}),Q.directions_to_use&&r.jsxs("span",{className:"medication-directions",title:`Directions: ${Q.directions_to_use}`,children:["Directions: ",Q.directions_to_use]}),r.jsxs("div",{className:"medication-prices text-xs text-gray-500",children:[Q.pack_price!==void 0&&`Pack Price: ${Number(Q.pack_price).toFixed(2)}`,Q.loose_price!==void 0&&` | Loose Price: ${Number(Q.loose_price).toFixed(2)}`,Q.total_price!==void 0&&` | Item Total: ${Number(Q.total_price).toFixed(2)}`]})]},R)),z.medications.length>2&&r.jsxs("div",{className:"pharmacy-card-medications-more",children:["...and ",z.medications.length-2," more"]}),z.medications.length===0&&r.jsx("div",{className:"pharmacy-card-no-medications",children:"No medications listed."})]}),z.prescriptionForUnavailableDrugs&&r.jsxs("div",{className:"unavailable-drugs-note",children:[r.jsx("strong",{children:"Unavailable Drugs Note:"})," ",z.prescriptionForUnavailableDrugs]})]}),r.jsxs("div",{className:"pharmacy-card-actions",children:[z.status==="pending"&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:Q=>{Q.stopPropagation(),M(z.id)},className:"pharmacy-table-action-button btn-edit-order",children:[r.jsx(lu,{size:14})," Edit"]}),r.jsxs("button",{onClick:Q=>{Q.stopPropagation(),I(z.id)},className:"pharmacy-table-action-button btn-bill-order",children:[r.jsx(Eh,{size:14})," Bill"]})]}),z.status==="billed"&&r.jsxs("button",{onClick:Q=>{Q.stopPropagation(),U(z.id,"dispensed")},className:"pharmacy-table-action-button btn-dispense-order",children:[r.jsx(cs,{size:14})," Dispense"]}),(z.status==="pending"||z.status==="billed")&&r.jsx("button",{onClick:Q=>{Q.stopPropagation(),U(z.id,"cancelled")},className:"pharmacy-table-action-button btn-cancel-order",children:"Cancel"}),r.jsx("button",{onClick:Q=>{Q.stopPropagation(),$(z)},className:"pharmacy-table-action-button btn-details-order",children:"Details"})]})]},z.id)})})]}),!a&&b>1&&r.jsxs("div",{className:"pharmacy-pagination-container",children:[r.jsxs("div",{className:"pagination-mobile-controls",children:[r.jsx("button",{onClick:()=>g(z=>Math.max(z-1,1)),disabled:p===1,className:"pagination-button prev",children:"Previous"}),r.jsx("button",{onClick:()=>g(z=>Math.min(z+1,b)),disabled:p===b,className:"pagination-button next",children:"Next"})]}),r.jsxs("div",{className:"pagination-desktop-controls",children:[r.jsx("div",{className:"pagination-info",children:r.jsxs("p",{children:["Showing ",r.jsx("span",{className:"font-medium",children:(p-1)*T+1})," ","to ",r.jsx("span",{className:"font-medium",children:Math.min(p*T,S)})," ","of ",r.jsx("span",{className:"font-medium",children:S})," results"]})}),r.jsx("div",{children:r.jsxs("nav",{className:"pagination-nav","aria-label":"Pagination",children:[r.jsxs("button",{onClick:()=>g(z=>Math.max(z-1,1)),disabled:p===1,className:"pagination-nav-button prev",children:[r.jsx("span",{className:"sr-only",children:"Previous"}),r.jsx(sw,{"aria-hidden":"true"})]}),r.jsxs("span",{"aria-current":"page",className:"pagination-current-page",children:["Page ",p," of ",b]}),r.jsxs("button",{onClick:()=>g(z=>Math.min(z+1,b)),disabled:p===b,className:"pagination-nav-button next",children:[r.jsx("span",{className:"sr-only",children:"Next"}),r.jsx($h,{"aria-hidden":"true"})]})]})})]})]})]})," "]})},JC=10,w9=3,iT=({isEmbedded:e=!1})=>{const n=_t(),[t,i]=w.useState([]),[a,o]=w.useState([]),[l,d]=w.useState(""),[f,u]=w.useState(!0),[p,g]=w.useState(null),[b,v]=w.useState(new Set),[S,k]=w.useState("all"),T=async()=>{try{const be=await me("/api/inventory/download-csv");if(!be.ok)throw new Error(`Failed to download CSV: ${be.statusText}`);const ye=await be.blob(),Oe=window.URL.createObjectURL(ye),He=document.createElement("a");He.href=Oe,He.download="pharmacy_inventory.csv",document.body.appendChild(He),He.click(),He.remove(),window.URL.revokeObjectURL(Oe)}catch(be){console.error("Failed to download CSV:",be),g(be.message||"Failed to download inventory CSV. Please try again.")}},[P,M]=w.useState(!1),[I,U]=w.useState(!1),[L,$]=w.useState(null),[z,F]=w.useState(!1),[Q,R]=w.useState(new Set),[B,Y]=w.useState(1),re=8,[ne,G]=w.useState(null),[V,W]=w.useState(0),[J,he]=w.useState(!1),[A,ce]=w.useState(null),[se,D]=w.useState(1),[oe,xe]=w.useState(!1),Z=B*re,ue=Z-re,ae=a.slice(ue,Z),Re=Math.ceil(a.length/re);w.useEffect(()=>{Y(1)},[l,S]);const Ae=w.useCallback(async()=>{u(!0),g(null);try{const be=await me("/api/drugs");if(!be.ok)throw new Error(`Failed to fetch drugs: ${be.statusText} (${be.status})`);let ye=await be.json();ye=ye.map(Oe=>({...Oe,price:parseFloat(String(Oe.price))||0,buying_price:Oe.buying_price!==null&&Oe.buying_price!==void 0?parseFloat(String(Oe.buying_price)):null,quantity_in_stock:parseInt(String(Oe.quantity_in_stock),10)||0,gst:Oe.gst!==null&&Oe.gst!==void 0?parseFloat(String(Oe.gst)):null,margin:Oe.margin!==null&&Oe.margin!==void 0?parseFloat(String(Oe.margin)):null,discount:Oe.discount!==null&&Oe.discount!==void 0?parseFloat(String(Oe.discount)):null})),i(ye),o(ye)}catch(be){console.error("Failed to fetch drugs:",be),g(be.message||"Failed to load inventory. Please try again.")}finally{u(!1)}},[]);w.useEffect(()=>{Ae()},[Ae]),w.useEffect(()=>{const be=l.toLowerCase();let ye=t.filter(tt=>{var Vt,hi,gn,Dn,Bt;const rt=((Vt=tt.name)==null?void 0:Vt.toLowerCase())||"",Ft=((hi=tt.description)==null?void 0:hi.toLowerCase())||"",Kn=((gn=tt.supplier)==null?void 0:gn.toLowerCase())||"",Pn=((Dn=tt.box_number)==null?void 0:Dn.toLowerCase())||"",Et=((Bt=tt.brand_name)==null?void 0:Bt.toLowerCase())||"";return rt.includes(be)||Ft.includes(be)||Kn.includes(be)||Pn.includes(be)||Et.includes(be)});const Oe=new Date,He=K8(Oe,w9);S==="low-stock"?ye=ye.filter(tt=>tt.quantity_in_stock<=JC):S==="near-expiry"?ye=ye.filter(tt=>{if(!tt.expiry_date)return!1;const rt=QC(tt.expiry_date);return j1(rt)&&f0(rt,He)&&!f0(rt,Oe)}):S==="expired"&&(ye=ye.filter(tt=>{if(!tt.expiry_date)return!1;const rt=QC(tt.expiry_date);return j1(rt)&&f0(rt,Oe)})),o(ye)},[l,t,S]);const Ce=()=>{M(!1),G(null)},Se=be=>{W(parseInt(be.target.value,10)||0)},De=async be=>{if(be.preventDefault(),g(null),!ne||!ne.id||V===0){g("No drug selected or adjustment amount is zero.");return}try{const ye=await me(`/api/drugs/${ne.id}/adjust-stock`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({quantityChange:V})});if(!ye.ok){const He=await ye.json();throw new Error(He.message||`Failed to adjust stock: ${ye.statusText}`)}const Oe=await ye.json();i(He=>He.map(tt=>tt.id===Oe.id?Oe:tt)),Ce(),alert(`Stock for "${Oe.name}" adjusted successfully. New stock: ${Oe.quantity_in_stock}`)}catch(ye){console.error("Failed to adjust stock:",ye),g(ye.message||"Failed to adjust stock. Please try again.")}},Me=be=>{$(be),U(!0)},et=()=>{U(!1),$(null)},ct=async()=>{if(!L||!L.id){g("No drug selected for deletion.");return}u(!0),g(null);try{const be=await me(`/api/drugs/${L.id}`,{method:"DELETE"});if(!be.ok){const ye=await be.json();throw new Error(ye.message||`Failed to delete drug: ${be.statusText}`)}alert(`Drug "${L.name}" deleted successfully.`),Ae(),et()}catch(be){console.error("Failed to delete drug:",be),g(be.message||"Failed to delete drug. Please try again.")}finally{u(!1)}},ut=()=>{F(!0)},at=()=>{F(!1)},[qt,jt]=w.useState(!1),_e=()=>{Q.size>0&&jt(!0)},Fe=()=>{jt(!1)},Pe=async()=>{if(Q.size===0){g("No drugs selected for deletion.");return}u(!0),g(null);try{const be=await me("/api/drugs/batch-delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({drugIds:Array.from(Q)})});if(!be.ok){const ye=await be.json();throw new Error(ye.message||`Failed to delete selected drugs: ${be.statusText}`)}alert(`${Q.size} drug(s) deleted successfully.`),Ae(),R(new Set),Fe()}catch(be){console.error("Failed to delete selected drugs:",be),g(be.message||"Failed to delete selected drugs. Please try again.")}finally{u(!1)}},Ue=async()=>{u(!0),g(null);try{const be=await me("/api/drugs/all",{method:"DELETE"});if(!be.ok){const ye=await be.json();throw new Error(ye.message||`Failed to delete all drugs: ${be.statusText}`)}alert("All drugs deleted successfully."),Ae(),at()}catch(be){console.error("Failed to delete all drugs:",be),g(be.message||"Failed to delete all drugs. Please try again.")}finally{u(!1)}},ve=be=>{if(!be)return null;const ye=be.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return ye?parseInt(ye[1],10):null},ee=be=>{ce(be),D(1),he(!0)},fe=()=>{he(!1),ce(null),D(1)},qe=be=>{D(parseInt(be.target.value,10)||0)},nt=async be=>{if(be.preventDefault(),g(null),!A||!A.id||se<=0){g("No drug selected or invalid number of packs to convert.");return}const ye=ve(A.unit);if(!ye||ye<=0){g(`Cannot convert "${A.name}" to loose. Invalid pack unit: ${A.unit||"N/A"}.`);return}if(se>(A.quantity_in_stock??0)){g(`Cannot convert ${se} packs. Only ${A.quantity_in_stock??0} packs are in stock.`);return}try{const Oe=await me(`/api/drugs/${A.id}/convert-to-loose`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({packsToConvert:se,packSize:ye})});if(!Oe.ok){const tt=await Oe.json();throw new Error(tt.message||`Failed to convert to loose: ${Oe.statusText}`)}const He=await Oe.json();i(tt=>tt.map(rt=>rt.id===He.id?He:rt)),fe(),alert(`Converted ${se} pack(s) of "${He.name}" to loose. New stock: ${He.quantity_in_stock} packs, ${He.loose??0} loose units.`)}catch(Oe){console.error("Failed to convert to loose:",Oe),g(Oe.message||"Failed to convert to loose. Please try again.")}finally{u(!1)}},lt=()=>{xe(!0)},wt=()=>{xe(!1)},Ve=async()=>{u(!0),g(null);try{const be=await me("/api/drugs/import-defaults",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!be.ok){const ye=await be.json();throw new Error(ye.message||`Failed to add default medications: ${be.statusText}`)}alert("Default medications added successfully."),Ae(),wt()}catch(be){console.error("Failed to add default medications:",be),g(be.message||"Failed to add default medications. Please try again.")}finally{u(!1)}};return f?r.jsx("div",{className:"loading-indicator",children:"Loading Inventory..."}):p?r.jsxs("div",{className:"error-indicator",children:["Error: ",p]}):r.jsxs("div",{className:`pharmacy-inventory-page ${e?"embedded":""}`,style:e?{minHeight:"auto",padding:"0",background:"transparent"}:{},children:[r.jsx("div",{className:"inventory-header-controls",style:{padding:"20px 20px 0 20px"},children:r.jsxs("div",{className:"inventory-actions-group",children:[r.jsxs("div",{className:"action-group-left",style:{display:"flex",gap:"12px"},children:[r.jsxs("button",{onClick:()=>n("/dashboard/inventory/add"),className:"action-button-outline add-drug-button",children:[r.jsx(ss,{size:18}),"Add New Drug"]}),r.jsxs("button",{onClick:()=>n("/dashboard/purchase"),className:"action-button-outline",children:[r.jsx(ss,{size:18}),"Purchase Page"]}),r.jsxs("button",{onClick:()=>n("/dashboard/distributors"),className:"action-button-outline",children:[r.jsx(ss,{size:18}),"Distributors"]})]}),r.jsxs("div",{className:"action-group-right",style:{display:"flex",gap:"12px"},children:[r.jsx("button",{onClick:T,className:"action-button-outline",children:"Download CSV"}),r.jsxs("button",{onClick:lt,className:"action-button-outline",children:[r.jsx(ss,{size:18}),"Import Defaults"]}),r.jsxs("button",{onClick:_e,className:"action-button-outline delete-button-outline",disabled:Q.size===0,children:[r.jsx(or,{size:18}),"Delete (",Q.size,")"]}),r.jsxs("button",{onClick:ut,className:"action-button-outline delete-all-button-outline",children:[r.jsx(or,{size:18}),"Delete All"]})]})]})}),r.jsxs("div",{className:"search-bar-container",style:{padding:"0 20px 20px 20px",borderBottom:"1px solid var(--border-color)",marginBottom:"0"},children:[r.jsxs("div",{className:"search-input-wrapper",style:{maxWidth:"600px"},children:[r.jsx(os,{size:20,className:"search-input-icon"}),r.jsx("input",{type:"text",placeholder:"Search drugs...",value:l,onChange:be=>d(be.target.value),className:"inventory-search-input"})]}),r.jsx("div",{className:"filter-dropdown-wrapper",children:r.jsxs("select",{value:S,onChange:be=>k(be.target.value),className:"inventory-filter-select",children:[r.jsx("option",{value:"all",children:"All Drugs"}),r.jsx("option",{value:"low-stock",children:"Low Stock"}),r.jsx("option",{value:"near-expiry",children:"Near Expiry"}),r.jsx("option",{value:"expired",children:"Expired"})]})})]}),r.jsx("div",{className:"inventory-table-container",children:r.jsxs("table",{className:"inventory-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:"checkbox-header",children:r.jsx("input",{type:"checkbox",onChange:be=>{if(be.target.checked){const ye=new Set(a.map(Oe=>Oe.id));R(ye)}else R(new Set)},checked:Q.size===a.length&&a.length>0,disabled:a.length===0})}),r.jsx("th",{className:"drug-name-header",children:"DRUG NAME"}),r.jsx("th",{className:"brand-name-header",children:"BRAND"}),r.jsx("th",{className:"pack-header",children:"PACK"}),r.jsx("th",{className:"expiry-header",children:"EXPIRY"}),r.jsx("th",{className:"text-stock qty-header",children:"STOCK"}),r.jsx("th",{className:"text-price mrp-header",children:"MRP"}),r.jsx("th",{className:"text-cost rate-header",children:"RATE"}),r.jsx("th",{className:"box-number-header",children:"BOX"}),r.jsx("th",{className:"discount-header",children:"DISC %"}),r.jsx("th",{className:"margin-header",children:"MARGIN"}),r.jsx("th",{className:"actions-cell",children:"ACTIONS"})]})}),r.jsxs("tbody",{children:[a.length===0&&r.jsx("tr",{className:"no-results-message",children:r.jsx("td",{colSpan:12,children:"No drugs found matching your search."})}),ae.map(be=>r.jsxs(vn.Fragment,{children:[r.jsxs("tr",{className:"drug-row",onClick:()=>{const ye=new Set(b);ye.has(be.id)&&be.id!==void 0?ye.delete(be.id):be.id!==void 0&&ye.add(be.id),v(ye)},children:[r.jsx("td",{className:"checkbox-cell",children:r.jsx("input",{type:"checkbox",onClick:ye=>ye.stopPropagation(),checked:Q.has(be.id),onChange:()=>{const ye=new Set(Q);ye.has(be.id)?ye.delete(be.id):ye.add(be.id),R(ye)}})}),r.jsx("td",{className:"drug-name-cell",children:be.name||"-"}),r.jsx("td",{className:"brand-name-cell",children:be.brand_name||"-"}),r.jsx("td",{className:"text-muted pack-cell",children:be.unit||"-"}),r.jsx("td",{className:"text-muted",children:be.expiry_date?new Date(be.expiry_date).toLocaleDateString("en-GB"):"-"}),r.jsxs("td",{className:`text-stock ${be.quantity_in_stock<=JC?"low-stock":""}`,children:[r.jsx("div",{style:{fontWeight:"bold"},children:be.quantity_in_stock}),r.jsx("div",{className:"loose-quantity",children:be.loose!==null&&be.loose!==void 0?`${be.loose} loose`:"0 loose"})]}),r.jsxs("td",{className:"text-muted text-price",children:["",typeof be.price=="number"?be.price.toFixed(2):"N/A"]}),r.jsx("td",{className:"text-muted text-cost",children:be.buying_price!==null&&be.buying_price!==void 0?`${be.buying_price.toFixed(2)}`:"-"}),r.jsx("td",{className:"text-muted",children:be.box_number||"-"}),r.jsx("td",{className:"text-muted",children:be.discount!==null&&be.discount!==void 0?`${be.discount.toFixed(2)}%`:"0.00%"}),r.jsx("td",{className:"text-muted",children:(()=>{const ye=be.price||0,Oe=be.buying_price||0,He=be.discount||0,tt=be.gst||0,Ft=Oe*(1-He/100)*(1+tt/100),Kn=ye-Ft;return`${(ye>0?Kn/ye*100:0).toFixed(2)}%`})()}),r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"actions-buttons-group",children:[r.jsx("button",{onClick:ye=>{ye.stopPropagation(),n(`/dashboard/inventory/edit/${be.id}`)},className:"action-icon-button",title:"Edit Drug",children:r.jsx(lu,{size:16})}),r.jsx("button",{onClick:ye=>{ye.stopPropagation(),Me(be)},className:"action-icon-button delete-button",title:"Delete Drug",children:r.jsx(or,{size:16})}),r.jsx("button",{onClick:ye=>{ye.stopPropagation(),G(be),M(!0)},className:"action-icon-button adjust-stock-button",title:"Adjust Stock",children:r.jsx(kI,{size:16})}),r.jsx("button",{onClick:ye=>{ye.stopPropagation(),ee(be)},className:"action-icon-button convert-to-loose-button",title:"Convert to Loose",disabled:!be.unit||ve(be.unit)===null,children:r.jsx(uR,{size:16})})]})})]}),b.has(be.id)&&r.jsx("tr",{className:"collapsible-row",children:r.jsx("td",{colSpan:12,children:r.jsxs("div",{className:"collapsible-content",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Description:"})," ",be.description||"-"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Supplier:"})," ",be.supplier||"-"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Batch:"})," ",be.batch||"-"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"HSN Code:"})," ",be.hsn_code||"-"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"MFG:"})," ",be.mfg||"-"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Loose Price:"}),(()=>{const ye=ve(be.unit);return ye&&ye>0&&typeof be.price=="number"?`${(be.price/ye).toFixed(2)}`:"N/A"})()]}),r.jsxs("p",{children:[r.jsx("strong",{children:"GST:"})," ",be.gst!==null&&be.gst!==void 0?`${be.gst.toFixed(2)}%`:"-"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Last Updated:"})," ",new Date(be.last_updated).toLocaleString()]})]})})})]},be.id))]})]})}),Re>1&&r.jsxs("div",{className:"pagination-controls",style:{padding:"20px",display:"flex",justifyContent:"center",alignItems:"center",gap:"20px",backgroundColor:"var(--card-bg, #fff)",borderTop:"1px solid var(--border-color)"},children:[r.jsx("button",{onClick:()=>Y(be=>Math.max(be-1,1)),disabled:B===1,className:"pagination-button",children:"Previous"}),r.jsxs("span",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:["Page ",B," of ",Re]}),r.jsx("button",{onClick:()=>Y(be=>Math.min(be+1,Re)),disabled:B===Re,className:"pagination-button",children:"Next"})]}),I&&L&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:et,className:"modal-close-button",children:r.jsx(Qn,{size:20})}),r.jsx("h3",{className:"modal-title",children:"Confirm Deletion"}),r.jsxs("p",{className:"modal-description",children:['Are you sure you want to delete "',r.jsx("span",{className:"drug-name",children:L.name||"Unnamed Drug"}),'"? This action cannot be undone.']}),p&&r.jsx("div",{className:"modal-error-message",children:p}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:et,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"button",onClick:ct,className:"button-delete",children:"Delete"})]})]})}),P&&ne&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:Ce,className:"modal-close-button",children:r.jsx(Qn,{size:20})}),r.jsx("h3",{className:"modal-title",children:"Adjust Stock"}),r.jsxs("p",{className:"modal-description",children:["Drug: ",r.jsx("span",{className:"drug-name",children:ne.name||"Unnamed Drug"}),r.jsx("br",{}),"Current Stock: ",ne.quantity_in_stock]}),p&&r.jsx("div",{className:"modal-error-message",children:p}),r.jsxs("form",{onSubmit:De,children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"adjustment",className:"form-label",children:"Adjustment Amount"}),r.jsx("input",{type:"number",name:"adjustment",id:"adjustment",required:!0,step:"1",value:V,onChange:Se,placeholder:"e.g., 10 or -5",className:"form-input"}),r.jsx("p",{className:"form-help-text",children:"Enter a positive number to add stock, negative to remove."})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:Ce,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"submit",className:"button-submit",children:"Adjust Stock"})]})]})]})}),z&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:at,className:"modal-close-button",children:r.jsx(Qn,{size:20})}),r.jsx("h3",{className:"modal-title",children:"Confirm Deletion of All Drugs"}),r.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",r.jsx("span",{className:"drug-name",children:"ALL"})," drugs from the inventory? This action cannot be undone."]}),p&&r.jsx("div",{className:"modal-error-message",children:p}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:at,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"button",onClick:Ue,className:"button-delete",children:"Delete All"})]})]})}),qt&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:Fe,className:"modal-close-button",children:r.jsx(Qn,{size:20})}),r.jsx("h3",{className:"modal-title",children:"Confirm Deletion of Selected Drugs"}),r.jsxs("p",{className:"modal-description",children:["Are you sure you want to delete ",r.jsx("span",{className:"drug-name",children:Q.size})," selected drug(s)? This action cannot be undone."]}),p&&r.jsx("div",{className:"modal-error-message",children:p}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:Fe,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"button",onClick:Pe,className:"button-delete",children:"Delete Selected"})]})]})}),J&&A&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:fe,className:"modal-close-button",children:r.jsx(Qn,{size:20})}),r.jsx("h3",{className:"modal-title",children:"Convert Pack to Loose"}),r.jsxs("p",{className:"modal-description",children:["Drug: ",r.jsx("span",{className:"drug-name",children:A.name||"Unnamed Drug"}),r.jsx("br",{}),"Current Packs in Stock: ",A.quantity_in_stock??0,r.jsx("br",{}),"Current Loose Units: ",A.loose??0,r.jsx("br",{}),"Pack Size: ",ve(A.unit)||"N/A"," units per pack"]}),p&&r.jsx("div",{className:"modal-error-message",children:p}),r.jsxs("form",{onSubmit:nt,children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"packs-to-convert",className:"form-label",children:"Number of Packs to Convert"}),r.jsx("input",{type:"number",name:"packs-to-convert",id:"packs-to-convert",required:!0,min:"1",step:"1",value:se,onChange:qe,placeholder:"e.g., 1",className:"form-input"}),r.jsxs("p",{className:"form-help-text",children:["This will reduce pack quantity by ",se," and add ",se*(ve(A.unit)||0)," to loose quantity."]})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:fe,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"submit",className:"button-submit",children:"Convert to Loose"})]})]})]})}),oe&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:wt,className:"modal-close-button",children:r.jsx(Qn,{size:20})}),r.jsx("h3",{className:"modal-title",children:"Confirm Add Default Medications"}),r.jsx("p",{className:"modal-description",children:"Are you sure you want to add default medications to the inventory? This will add a predefined set of common medications."}),p&&r.jsx("div",{className:"modal-error-message",children:p}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:wt,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"button",onClick:Ve,className:"button-submit",children:"Add Defaults"})]})]})})]})},S9=()=>{const e=_t();return r.jsxs("div",{className:"bg-white p-3 md:p-6 rounded-lg shadow",children:[r.jsx("button",{onClick:()=>e(-1),className:"mb-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Back"}),r.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Settings"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"Pharmacy settings will be configured here."})]})},rT=()=>{const{id:e}=Br(),n=_t(),[t,i]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),[p,g]=w.useState(!1),b=w.useRef(null),v=w.useRef(null),S=w.useRef(null),k=w.useCallback(async()=>{if(!e){d("Drug ID is missing."),o(!1);return}o(!0),d(null);try{const I=await me(`/api/drugs/${e}`);if(!I.ok){const L=await I.json();throw new Error(L.message||`Failed to fetch drug: ${I.statusText}`)}let U=await I.json();U={...U,name:U.name||"",brand_name:U.brand_name||"",price:parseFloat(String(U.price))||0,buying_price:U.buying_price!==null&&U.buying_price!==void 0?parseFloat(String(U.buying_price)):null,quantity_in_stock:parseInt(String(U.quantity_in_stock),10)||0,gst:U.gst!==null&&U.gst!==void 0?parseFloat(String(U.gst)):null,margin:U.margin!==null&&U.margin!==void 0?parseFloat(String(U.margin)):null,discount:U.discount!==null&&U.discount!==void 0?parseFloat(String(U.discount)):null,batch:U.batch||"",hsn_code:U.hsn_code||"",mfg:U.mfg||"",loose:U.loose!==null&&U.loose!==void 0?parseInt(String(U.loose),10):null},i(U)}catch(I){console.error("Failed to fetch drug:",I),d(I.message||"Failed to load drug data. Please try again.")}finally{o(!1)}},[e]);w.useEffect(()=>{k()},[k]),w.useEffect(()=>{const I=L=>{L.key==="Tab"&&v.current===document.activeElement&&(p||(g(!0),setTimeout(()=>{var $;($=S.current)==null||$.focus()},0),L.preventDefault()))},U=L=>{b.current&&!b.current.contains(L.target)&&g(!1)};return document.addEventListener("keydown",I),document.addEventListener("mousedown",U),()=>{document.removeEventListener("keydown",I),document.removeEventListener("mousedown",U)}},[p]);const T=I=>{const{name:U,value:L,type:$}=I.target;i(z=>z?{...z,[U]:$==="number"?parseFloat(L)||null:L}:null)},P=()=>{n(-1)},M=async I=>{if(I.preventDefault(),d(null),u(!0),!t||!t.id){d("Cannot edit drug: No drug data available."),u(!1);return}if(t.price===void 0||t.quantity_in_stock===void 0){d("Price and Stock Quantity are required."),u(!1);return}const U={...t,name:t.name===""?null:t.name,brand_name:t.brand_name===""?null:t.brand_name,buying_price:t.buying_price===0?null:t.buying_price,expiry_date:t.expiry_date===""?null:t.expiry_date,gst:t.gst===0?null:t.gst,margin:t.margin===0?null:t.margin,discount:t.discount===0?null:t.discount,batch:t.batch===""?null:t.batch,hsn_code:t.hsn_code===""?null:t.hsn_code,mfg:t.mfg===""?null:t.mfg,loose:t.loose===0?null:t.loose};try{const L=await me(`/api/drugs/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(U)});if(!L.ok){const z=await L.json();throw new Error(z.message||`Failed to update drug: ${L.statusText}`)}const $=await L.json();alert(`Drug "${$.name}" updated successfully!`),n(-1)}catch(L){console.error("Failed to update drug:",L),d(L.message||"Failed to update drug. Please try again.")}finally{u(!1)}};return a?r.jsx("div",{className:"edit-drug-form-page",children:r.jsx("div",{className:"loading-message",children:"Loading drug data..."})}):l&&!t?r.jsx("div",{className:"edit-drug-form-page",children:r.jsxs("div",{className:"error-message-load",children:["Error: ",l]})}):t?r.jsx("div",{className:"edit-drug-form-page",children:r.jsxs("div",{className:"edit-drug-form-container",children:[r.jsxs("div",{className:"edit-drug-form-header",children:[r.jsxs("h2",{children:["Edit Drug: ",t.name]}),r.jsx("button",{onClick:P,className:"cancel-button",title:"Go Back",children:r.jsx(Qn,{size:24})})]}),l&&r.jsx("div",{className:"error-message-submit",children:l}),r.jsxs("form",{onSubmit:M,className:"edit-drug-form",children:[r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"sm-col-span-2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("label",{htmlFor:"edit-name",className:"form-label",children:"Composition Name"})," ",r.jsxs("div",{className:"relative ml-2 group",children:[r.jsx(Qo,{size:16,className:"text-gray-400"}),r.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),r.jsx("input",{type:"text",name:"name",id:"edit-name",value:t.name||"",onChange:T,className:"custom-text-input",placeholder:"e.g., Paracetamol",tabIndex:1})," "]}),r.jsxs("div",{className:"sm-col-span-2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("label",{htmlFor:"edit-brand_name",className:"form-label",children:"Brand Name"})," ",r.jsxs("div",{className:"relative ml-2 group",children:[r.jsx(Qo,{size:16,className:"text-gray-400"}),r.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),r.jsx("input",{type:"text",name:"brand_name",id:"edit-brand_name",value:t.brand_name||"",onChange:T,className:"custom-text-input",placeholder:"e.g., Calpol",tabIndex:2})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("label",{htmlFor:"edit-price",className:"form-label",children:"MRP () *"}),r.jsxs("div",{className:"relative ml-2 group",children:[r.jsx(Qo,{size:16,className:"text-gray-400"}),r.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),r.jsx("input",{type:"number",name:"price",id:"edit-price",required:!0,step:"0.01",min:"0",value:t.price,onChange:T,className:"custom-text-input",placeholder:"e.g., 500",tabIndex:3})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("label",{htmlFor:"edit-quantity_in_stock",className:"form-label",children:"Stock Quantity *"}),r.jsxs("div",{className:"relative ml-2 group",children:[r.jsx(Qo,{size:16,className:"text-gray-400"}),r.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),r.jsx("input",{type:"number",name:"quantity_in_stock",id:"edit-quantity_in_stock",required:!0,step:"1",min:"0",value:t.quantity_in_stock,onChange:T,className:"custom-text-input",placeholder:"e.g., 5",tabIndex:4})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-unit",className:"form-label",children:"Pack (e.g., strip, bottle)"}),r.jsx("input",{type:"text",name:"unit",id:"edit-unit",value:t.unit||"",onChange:T,className:"custom-text-input",placeholder:"e.g., strip, bottle",tabIndex:5})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-expiry_date",className:"form-label",children:"Expiry Date"}),r.jsx("input",{type:"date",name:"expiry_date",id:"edit-expiry_date",value:t.expiry_date||"",onChange:T,className:"custom-text-input",tabIndex:6})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-box_number",className:"form-label",children:"Box Number"}),r.jsx("input",{type:"text",name:"box_number",id:"edit-box_number",value:t.box_number||"",onChange:T,className:"custom-text-input",tabIndex:7})]}),r.jsxs("div",{className:"relative sm-col-span-2",ref:b,children:[r.jsx("button",{type:"button",onClick:()=>g(!p),className:"form-button w-full text-left",tabIndex:8,ref:v,children:"Others"}),p&&r.jsxs("div",{className:"others-fields-grid",children:[" ",r.jsxs("div",{className:"sm-col-span-2",children:[r.jsx("label",{htmlFor:"edit-description",className:"form-label",children:"Description"}),r.jsx("textarea",{name:"description",id:"edit-description",rows:3,value:t.description||"",onChange:T,className:"custom-text-input",tabIndex:9})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-supplier",className:"form-label",children:"Supplier"}),r.jsx("input",{type:"text",name:"supplier",id:"edit-supplier",value:t.supplier||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:10})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-buying_price",className:"form-label",children:"Rate ()"}),r.jsx("input",{type:"number",name:"buying_price",id:"edit-buying_price",step:"0.01",min:"0",value:t.buying_price??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:11,ref:S})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-gst",className:"form-label",children:"GST (%)"}),r.jsx("input",{type:"number",name:"gst",id:"edit-gst",step:"0.01",min:"0",max:"100",value:t.gst??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:12})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-margin",className:"form-label",children:"Margin (%)"}),r.jsx("input",{type:"number",name:"margin",id:"edit-margin",step:"0.01",min:"0",max:"100",value:t.margin??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:13})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-discount",className:"form-label",children:"Discount (%)"}),r.jsx("input",{type:"number",name:"discount",id:"edit-discount",step:"0.01",min:"0",max:"100",value:t.discount??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:14})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-batch",className:"form-label",children:"Batch"}),r.jsx("input",{type:"text",name:"batch",id:"edit-batch",value:t.batch||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:15})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-hsn_code",className:"form-label",children:"HSN Code"}),r.jsx("input",{type:"text",name:"hsn_code",id:"edit-hsn_code",value:t.hsn_code||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:16})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-mfg",className:"form-label",children:"MFG"}),r.jsx("input",{type:"text",name:"mfg",id:"edit-mfg",value:t.mfg||"",onChange:T,className:"custom-text-input",placeholder:"Optional",tabIndex:17})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"edit-loose",className:"form-label",children:"Loose"}),r.jsx("input",{type:"number",name:"loose",id:"edit-loose",step:"1",min:"0",value:t.loose??"",onChange:T,placeholder:"Optional",className:"custom-text-input",tabIndex:18})]})]})]})]}),r.jsxs("div",{className:"form-actions",children:[r.jsx("button",{type:"button",onClick:P,disabled:f,className:"form-button cancel-form-button",tabIndex:19,children:"Back"}),r.jsx("button",{type:"submit",disabled:f,className:"form-button submit-form-button",tabIndex:20,children:f?"Saving...":"Save Changes"})]})]})]})}):r.jsx("div",{className:"edit-drug-form-page",children:r.jsx("div",{className:"not-found-message",children:"Drug not found."})})},aT=({isOpen:e,onClose:n,onDrugAddedToPurchase:t})=>{const[i,a]=w.useState({name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",expiry_date:"",buying_price:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,p]=w.useState(!1),g=w.useRef(null),b=w.useRef(null),v=w.useRef(null);w.useEffect(()=>{e&&(a({name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",expiry_date:"",buying_price:null,box_number:"",gst:5,margin:null,discount:null,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:null}),l(null),f(!1),p(!1))},[e]),w.useEffect(()=>{const T=M=>{M.key==="Tab"&&b.current===document.activeElement&&(u||(p(!0),setTimeout(()=>{var I;(I=v.current)==null||I.focus()},0),M.preventDefault()))},P=M=>{g.current&&!g.current.contains(M.target)&&p(!1)};return document.addEventListener("keydown",T),document.addEventListener("mousedown",P),()=>{document.removeEventListener("keydown",T),document.removeEventListener("mousedown",P)}},[u]);const S=T=>{const{name:P,value:M,type:I}=T.target;a(U=>({...U,[P]:I==="number"?parseFloat(M)||null:M}))},k=T=>{if(T.preventDefault(),l(null),f(!0),i.price===void 0||i.quantity_in_stock===void 0){l("MRP and Stock Quantity are required."),f(!1);return}const P={...i,name:i.name===""?null:i.name,composition:i.composition===""?null:i.composition,buying_price:i.buying_price===0?null:i.buying_price,expiry_date:i.expiry_date===""?null:i.expiry_date,gst:i.gst===0?null:i.gst,margin:i.margin===0?null:i.margin,discount:i.discount===0?null:i.discount,brand_name:i.brand_name===""?null:i.brand_name,batch:i.batch===""?null:i.batch,hsn_code:i.hsn_code===""?null:i.hsn_code,mfg:i.mfg===""?null:i.mfg,loose:i.loose===0?null:i.loose};t(P),f(!1),n()};return e?r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content add-drug-form-container max-w-2xl mx-auto",children:[r.jsxs("div",{className:"add-drug-form-header",children:[r.jsx("h2",{children:"Add New Drug"}),r.jsx("button",{onClick:n,className:"cancel-button",title:"Close",children:r.jsx(Qn,{size:24})})]}),o&&r.jsx("div",{className:"error-message",children:o}),r.jsxs("form",{onSubmit:k,className:"add-drug-form",children:[r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"sm-col-span-2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("label",{htmlFor:"name",className:"form-label",children:"Composition Name"}),r.jsxs("div",{className:"relative ml-2 group",children:[r.jsx(Qo,{size:16,className:"text-gray-400"}),r.jsx("div",{className:"tooltip",children:"Enter the drug's composition. This field is optional."})]})]}),r.jsx("input",{type:"text",name:"name",id:"name",value:i.name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Paracetamol",tabIndex:1})]}),r.jsxs("div",{className:"sm-col-span-2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("label",{htmlFor:"brand_name",className:"form-label",children:"Brand Name"}),r.jsxs("div",{className:"relative ml-2 group",children:[r.jsx(Qo,{size:16,className:"text-gray-400"}),r.jsx("div",{className:"tooltip",children:"Enter the drug's brand name. This field is optional."})]})]}),r.jsx("input",{type:"text",name:"brand_name",id:"brand_name",value:i.brand_name||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., Calpol",tabIndex:2})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("label",{htmlFor:"price",className:"form-label",children:"MRP () *"}),r.jsxs("div",{className:"relative ml-2 group",children:[r.jsx(Qo,{size:16,className:"text-gray-400"}),r.jsx("div",{className:"tooltip",children:"Enter the price for the pack size mentioned above. For example, if the pack is 10 tablets, enter the price for all 10 tablets."})]})]}),r.jsx("input",{type:"number",name:"price",id:"price",required:!0,step:"0.01",min:"0",value:i.price,onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., 500",tabIndex:3})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("label",{htmlFor:"quantity_in_stock",className:"form-label",children:"Stock Quantity *"}),r.jsxs("div",{className:"relative ml-2 group",children:[r.jsx(Qo,{size:16,className:"text-gray-400"}),r.jsx("div",{className:"tooltip",children:"Enter the number of packs you have in stock. For example, if you have 5 strips of 10 tablets each, enter 5."})]})]}),r.jsx("input",{type:"number",name:"quantity_in_stock",id:"quantity_in_stock",required:!0,step:"1",min:"0",value:i.quantity_in_stock,onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., 5",tabIndex:4})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"unit",className:"form-label",children:"Pack (e.g., strip, bottle)"}),r.jsx("input",{type:"text",name:"unit",id:"unit",value:i.unit||"",onChange:S,className:"custom-text-input mt-1",placeholder:"e.g., strip, bottle",tabIndex:5})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"expiry_date",className:"form-label",children:"Expiry Date"}),r.jsx("input",{type:"date",name:"expiry_date",id:"expiry_date",value:i.expiry_date||"",onChange:S,className:"custom-text-input mt-1",tabIndex:6})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"box_number",className:"form-label",children:"Box Number"}),r.jsx("input",{type:"text",name:"box_number",id:"box_number",value:i.box_number||"",onChange:S,className:"custom-text-input mt-1",tabIndex:7})]}),r.jsxs("div",{className:"relative sm-col-span-2",ref:g,children:[r.jsx("button",{type:"button",onClick:()=>p(!u),className:"form-button w-full text-left",tabIndex:8,ref:b,children:"Others"}),u&&r.jsxs("div",{className:"others-fields-grid",children:[" ",r.jsxs("div",{className:"sm-col-span-2",children:[r.jsx("label",{htmlFor:"description",className:"form-label",children:"Description"}),r.jsx("textarea",{name:"description",id:"description",rows:3,value:i.description||"",onChange:S,className:"custom-text-input mt-1",tabIndex:9})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"buying_price",className:"form-label",children:"Rate ()"}),r.jsx("input",{type:"number",name:"buying_price",id:"buying_price",step:"0.01",min:"0",value:i.buying_price??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:10,ref:v})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"gst",className:"form-label",children:"GST (%)"}),r.jsx("input",{type:"number",name:"gst",id:"gst",step:"0.01",min:"0",max:"100",value:i.gst??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:11})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"margin",className:"form-label",children:"Margin (%)"}),r.jsx("input",{type:"number",name:"margin",id:"margin",step:"0.01",min:"0",max:"100",value:i.margin??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:12})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"discount",className:"form-label",children:"Discount (%)"}),r.jsx("input",{type:"number",name:"discount",id:"discount",step:"0.01",min:"0",max:"100",value:i.discount??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:13})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"batch",className:"form-label",children:"Batch"}),r.jsx("input",{type:"text",name:"batch",id:"batch",value:i.batch||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:14})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"hsn_code",className:"form-label",children:"HSN Code"}),r.jsx("input",{type:"text",name:"hsn_code",id:"hsn_code",value:i.hsn_code||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:15})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"mfg",className:"form-label",children:"MFG"}),r.jsx("input",{type:"text",name:"mfg",id:"mfg",value:i.mfg||"",onChange:S,className:"custom-text-input mt-1",placeholder:"Optional",tabIndex:16})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"loose",className:"form-label",children:"Loose Quantity"}),r.jsx("input",{type:"number",name:"loose",id:"loose",step:"1",min:"0",value:i.loose??"",onChange:S,placeholder:"Optional",className:"custom-text-input mt-1",tabIndex:17})]})]})]})]}),r.jsxs("div",{className:"form-actions",children:[r.jsx("button",{type:"button",onClick:n,disabled:d,className:"form-button cancel-form-button",tabIndex:18,children:"Cancel"}),r.jsx("button",{type:"submit",disabled:d,className:"form-button submit-form-button inline-flex justify-center",tabIndex:19,children:d?"Adding...":"Add Drug"})]})]})]})}):null},N9=()=>{const e=_t(),n=async t=>{try{const i=await me("/api/drugs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!i.ok){const a=await i.json();throw new Error(a.message||"Failed to add drug")}e(-1)}catch(i){console.error("Error adding drug:",i),alert(`Failed to add drug: ${i.message}`)}};return r.jsx("div",{className:"add-drug-page-wrapper",style:{paddingTop:"2rem"},children:r.jsx(aT,{isOpen:!0,onClose:()=>e(-1),onDrugAddedToPurchase:n})})},_1=()=>{const e=_t(),[n,t]=w.useState({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),[i,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),[u,p]=w.useState(""),[g,b]=w.useState([]),[v,S]=w.useState(null),[k,T]=w.useState(!1),[P,M]=w.useState([]),[I,U]=w.useState(!0);w.useEffect(()=>{(async()=>{U(!0);try{const B=await me("/api/staff?role=doctor");if(!B.ok)throw new Error("Failed to fetch doctors");const Y=await B.json();M(Y),Y.length>0&&t(re=>({...re,doctorId:""}))}catch(B){console.error("Error fetching doctors:",B),l(`Failed to load doctors: ${B.message}`)}finally{U(!1)}})()},[]);const L=w.useCallback(async()=>{if(u.trim()){T(!0),l(null),b([]);try{const R=encodeURIComponent(u.trim()),B=await me(`/api/patients?search=${R}&limit=10`);if(!B.ok){const re=await B.json().catch(()=>({message:"Failed to search patients"}));throw new Error(re.message||"Failed to search patients")}const Y=await B.json();Y&&Array.isArray(Y.patients)?b(Y.patients):(console.error("Unexpected response format from patient search:",Y),b([]))}catch(R){console.error("Error searching patients:",R),l(`Search failed: ${R.message}`)}finally{T(!1)}}},[u]);w.useEffect(()=>{if(u.trim().length<2){b([]),l(null);return}const R=setTimeout(()=>{L()},300);return()=>clearTimeout(R)},[u,L]);const $=R=>{S(R),p(""),b([]),l(null),t(B=>({...B,name:"",age:"",gender:"",phone:""}))},z=()=>{S(null),p(""),b([]),l(null),t(R=>({...R,name:"",age:"",gender:"",phone:""}))},F=R=>{const{name:B,value:Y}=R.target;t(re=>({...re,[B]:Y}))},Q=async R=>{var B;R.preventDefault(),l(null),f(null),a(!0);try{let Y,re;if(v)Y=v.id,re=v.name,console.log(`Adding existing patient ${Y} to queue.`);else{console.log("Registering new patient...");const W=await me("/api/patients",{method:"POST",body:JSON.stringify({name:n.name,age:n.age?parseInt(n.age,10):null,gender:n.gender||null,phone:n.phone||null})});if(!W.ok){const he=await W.json();if(W.status===403&&he.message.includes("Patient limit")){e("/start-clinic-subscription",{state:{errorMessage:he.message}});return}throw new Error(he.message||"Failed to register patient")}const J=await W.json();Y=J.id,re=J.name,console.log(`New patient ${Y} registered.`)}const ne=n.doctorId||null;console.log(`Adding patient ${Y} to queue for doctor ${ne||"Unassigned"}`);const G=await me("/api/queue",{method:"POST",body:JSON.stringify({patientId:Y,complaint:n.complaint||null,doctorId:ne})});if(!G.ok){const W=await G.json();throw new Error(W.message||"Failed to add patient to queue")}const V=await G.json();if(console.log(`Patient added to queue, entry ID: ${V.id}`),S(null),p(""),b([]),t({name:"",age:"",gender:"",phone:"",complaint:"",doctorId:""}),ne){const W=((B=P.find(he=>he.id===ne))==null?void 0:B.name)||"Selected Doctor",J=v?`Existing patient "${re}" added to queue for Dr. ${W}. Redirecting to billing...`:`Patient "${re}" registered and added to queue for Dr. ${W}. Redirecting to billing...`;f(J),e("/billing",{state:{patientId:Y,queueId:V.id,patientName:re,doctorId:ne,billType:"consultation"}})}else{const W=v?`Existing patient "${re}" added to the general queue.`:`Patient "${re}" registered and added to the general queue.`;f(W)}}catch(Y){console.error("Error in add/queue process:",Y),Y.message.includes("Patient limit")?(l(`Operation failed: ${Y.message}. Please upgrade your plan.`),e("/start-clinic-subscription")):l(`Operation failed: ${Y.message}`)}finally{a(!1)}};return r.jsxs("div",{className:"add-patient-page-container flex flex-col items-center justify-start",children:[r.jsxs("div",{className:"w-full max-w-3xl mb-2 flex justify-start",children:[" ",r.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Back to Previous Page",children:[r.jsx(rn,{size:20,className:"btn-icon"})," Back"]})]}),r.jsxs("div",{className:"add-patient-card",children:[r.jsxs("h3",{className:"add-patient-title",children:[r.jsx(lk,{size:28})," ",v?"Add Existing Patient to Queue":"Register New Patient & Add to Queue"]}),r.jsxs("div",{className:"search-section",children:[r.jsx("legend",{className:"form-fieldset legend",children:"Find Existing Patient"})," ",r.jsxs("div",{className:"flex items-center space-x-2",children:[" ",r.jsxs("div",{className:"search-input-wrapper",children:[r.jsx("input",{type:"text",placeholder:"Search by Name or Phone...",value:u,onChange:R=>p(R.target.value),className:"form-input",disabled:i||!!v}),r.jsx(os,{size:18,className:`${k?"text-primary animate-pulse":""}`})," "]}),v&&r.jsxs("button",{type:"button",onClick:z,className:"btn btn-danger",title:"Clear Selection",children:[r.jsx(Qn,{size:16,className:"btn-icon"})," Clear"]})]}),g.length>0&&!v&&r.jsx("ul",{className:"search-results-list",children:g.map(R=>r.jsxs("li",{onClick:()=>$(R),children:[R.name," (ID: ",R.id,", Phone: ",R.phone||"N/A",")"]},R.id))}),u.length>=2&&g.length===0&&!k&&!v&&r.jsxs("p",{className:"search-info-text",children:['No patients found matching "',u,'". You can register them below.']}),k&&u.length>=2&&r.jsx("p",{className:"search-info-text searching",children:"Searching..."})]}),o&&r.jsxs("div",{className:"alert alert-danger",role:"alert",children:[r.jsx("strong",{children:"Error: "}),r.jsx("span",{children:o})]}),d&&r.jsxs("div",{className:"alert alert-success",role:"alert",children:[r.jsx("strong",{children:"Success: "}),r.jsx("span",{children:d})]}),r.jsxs("form",{onSubmit:Q,className:"space-y-5",children:[" ",r.jsxs("fieldset",{className:`form-fieldset ${v?"fieldset-disabled":""}`,children:[r.jsx("legend",{children:v?`Selected Patient: ${v.name}`:"New Patient Details"}),r.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",r.jsxs("div",{children:[r.jsx("label",{className:"form-label",children:"Full Name *"}),r.jsx("input",{type:"text",name:"name",value:v?v.name:n.name,onChange:F,className:"form-input",required:!v,disabled:i||!!v})]}),r.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",r.jsxs("div",{children:[r.jsx("label",{className:"form-label",children:"Age"}),r.jsx("input",{type:"number",name:"age",value:v?v.age??"":n.age,onChange:F,className:"form-input",min:"0",disabled:i||!!v})]}),r.jsxs("div",{children:[r.jsx("label",{className:"form-label",children:"Gender"}),r.jsxs("select",{name:"gender",value:v?v.gender??"":n.gender,onChange:F,className:"form-select",disabled:i||!!v,children:[r.jsx("option",{value:"",children:"Select"}),r.jsx("option",{value:"M",children:"Male"}),r.jsx("option",{value:"F",children:"Female"}),r.jsx("option",{value:"O",children:"Other"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"form-label",children:"Phone"}),r.jsx("input",{type:"tel",name:"phone",value:v?v.phone??"":n.phone,onChange:F,className:"form-input",disabled:i||!!v})]})]})]}),r.jsxs("fieldset",{className:"form-fieldset",children:[r.jsx("legend",{children:"Visit Details"}),r.jsxs("div",{className:"form-grid form-grid-cols-2",children:[" ",r.jsxs("div",{children:[r.jsx("label",{className:"form-label",children:"Assign Doctor (Optional)"}),r.jsxs("select",{name:"doctorId",value:n.doctorId,onChange:F,className:`form-select ${I?"opacity-50":""}`,disabled:i||I,children:[r.jsx("option",{value:"",children:I?"Loading doctors...":P.length===0?"No doctors available":"-- No Doctor (Add to General Queue) --"}),P.map(R=>r.jsx("option",{value:R.id,children:R.name},R.id))]}),P.length===0&&!I&&r.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Please add doctors via the Admin Panel."})]}),r.jsxs("div",{className:"form-grid-col-span-2",children:[" ",r.jsx("label",{className:"form-label",children:"Patient Data / Reason"}),r.jsx("textarea",{name:"complaint",value:n.complaint,onChange:F,rows:2,className:"form-textarea",disabled:i})]})]})]}),r.jsxs("div",{className:"flex justify-end pt-2",children:[" ",r.jsxs("button",{type:"submit",className:`btn btn-primary ${i||I?"disabled":""}`,disabled:i||I,children:[r.jsx(ow,{size:18,className:"btn-icon"}),i?"Processing...":v?"Add Existing to Queue":"Register & Add to Queue"]})]})]})]})]})},C9=({clinicId:e})=>{const n=_t(),[t,i]=w.useState({name:"",email:"",role:"receptionist",password:"",opd_fee:""}),[a,o]=w.useState(null),[l,d]=w.useState(!1);w.useEffect(()=>{o(e?null:"Clinic information is missing. Cannot add staff. Please ensure you are logged in correctly.")},[e]);const f=g=>{const{name:b,value:v}=g.target;i(S=>{const k={...S,[b]:v};return b==="role"&&v!=="doctor"&&(k.opd_fee=""),k})},u=async g=>{if(g.preventDefault(),o(null),!t.name||!t.email||!t.role||!t.password){o("Name, Email, Role, and Password are required.");return}if(!e){o("Clinic information is missing. Cannot add staff.");return}const b={...t,clinic_id:e,opd_fee:t.role==="doctor"&&t.opd_fee?parseFloat(String(t.opd_fee)):null};if(b.role==="doctor"&&t.opd_fee&&isNaN(b.opd_fee)){o("Invalid OPD Fee format. Please enter a number.");return}d(!0);try{const v=await me("/api/staff",{method:"POST",body:JSON.stringify(b)});if(!v.ok){const S=await v.json();throw new Error(S.message||"Server responded with an error")}n(-1)}catch(v){o(`Failed to add staff: ${v.message}`)}finally{d(!1)}},p=()=>{n(-1)};return r.jsxs("div",{className:"staff-page-container",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("button",{onClick:p,className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[r.jsx(rn,{size:18,className:"mr-2"}),"Back"]}),r.jsx("h1",{children:"Add New Staff Member"}),r.jsx("div",{className:"w-16"})," "]}),a&&r.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[r.jsx(Hi,{size:18,className:"mr-2 text-red-500"}),a]}),r.jsxs("form",{onSubmit:u,className:`staff-form ${e?"":"opacity-50 pointer-events-none"}`,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"name",children:"Full Name"}),r.jsx("input",{id:"name",type:"text",name:"name",value:t.name||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Enter full name"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email Address"}),r.jsx("input",{id:"email",type:"email",name:"email",value:t.email||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Enter email address"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"role",children:"Assign Role"}),r.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:f,required:!0,disabled:l||!e,children:[r.jsx("option",{value:"receptionist",children:"Receptionist"}),r.jsx("option",{value:"doctor",children:"Doctor"}),r.jsx("option",{value:"pharmacy",children:"Pharmacist"}),r.jsx("option",{value:"lab",children:"Lab Technician"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Set Initial Password"}),r.jsx("input",{id:"password",type:"password",name:"password",value:t.password||"",onChange:f,required:!0,disabled:l||!e,placeholder:"Create a password"})]}),t.role==="doctor"&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"opd_fee",children:"OPD Consultation Fee () (Optional)"}),r.jsx("input",{id:"opd_fee",type:"number",name:"opd_fee",value:t.opd_fee||"",onChange:f,step:"0.01",min:"0",placeholder:"e.g., 150.00",disabled:l||!e}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank if no specific fee is set for this doctor."})]}),r.jsxs("button",{type:"submit",disabled:l||!e,children:[l?r.jsx(Ah,{size:18,className:"animate-spin mr-2"}):r.jsx(ou,{size:18,className:"mr-2"}),l?"Adding...":"Add Staff Member"]})]})]})},j9=()=>{const{id:e}=Br(),n=_t(),[t,i]=w.useState({name:"",email:"",role:"receptionist",opd_fee:"",active:!0}),[a,o]=w.useState(""),[l,d]=w.useState(!0),[f,u]=w.useState(!1),[p,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Staff ID is missing."),d(!1);return}d(!0),g(null),v(null);try{const M=await me(`/staff/${e}`);if(!M.ok){const U=await M.json();throw new Error(U.message||`HTTP error! status: ${M.status}`)}const I=await M.json();i({name:I.name,email:I.email,role:I.role,opd_fee:I.opd_fee??"",active:I.active})}catch(M){g(`Failed to load staff details: ${M.message}`)}finally{d(!1)}},[e]);w.useEffect(()=>{S()},[S]);const k=M=>{const{name:I,value:U,type:L}=M.target;if(L==="checkbox"){const{checked:$}=M.target;i(z=>({...z,[I]:$}))}else i($=>({...$,[I]:U}))},T=M=>{o(M.target.value)},P=async M=>{if(M.preventDefault(),!e){g("Staff ID is missing.");return}u(!0),g(null),v(null);const I={name:t.name,email:t.email,role:t.role,active:t.active};if(t.role==="doctor"){const U=t.opd_fee?parseFloat(String(t.opd_fee)):null;if(U!==null&&isNaN(U)){g("OPD Fee must be a valid number."),u(!1);return}I.opd_fee=U}else I.opd_fee=null;a.trim()!==""&&(I.password=a.trim());try{const U=await me(`/staff/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)});if(!U.ok){const L=await U.json();throw new Error(L.message||`HTTP error! status: ${U.status}`)}v("Staff details updated successfully!"),o(""),setTimeout(()=>n(-1),1500)}catch(U){g(`Failed to update staff: ${U.message}`)}finally{u(!1)}};return l?r.jsxs("div",{className:"flex justify-center items-center h-screen",children:[r.jsx(Ah,{className:"h-12 w-12 animate-spin text-teal-600"}),r.jsx("span",{className:"ml-4 text-xl text-gray-700",children:"Loading Staff Details..."})]}):r.jsxs("div",{className:"staff-page-container",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-800 transition-colors","aria-label":"Go back",children:[r.jsx(rn,{size:18,className:"mr-2"}),"Back"]}),r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Edit Staff Member"}),r.jsx("div",{className:"w-16"})," "]}),p&&r.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",children:[r.jsx(Hi,{size:18,className:"mr-2 text-red-500"}),p,r.jsx("button",{onClick:()=>g(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),b&&r.jsxs("div",{className:"success-message mb-4 p-3 bg-green-100 border border-green-400 rounded-md flex items-center",children:[r.jsx(cs,{size:18,className:"mr-2 text-green-500"}),b,r.jsx("button",{onClick:()=>v(null),className:"ml-auto text-green-600 hover:text-green-800 text-xl font-bold",children:""})]}),r.jsxs("form",{onSubmit:P,className:"staff-form",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"name",children:["Full Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",id:"name",name:"name",value:t.name||"",onChange:k,required:!0,placeholder:"Enter full name"})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"email",children:["Email Address ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"email",id:"email",name:"email",value:t.email||"",onChange:k,required:!0,placeholder:"Enter email address"})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"role",children:["Role ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{id:"role",name:"role",value:t.role||"receptionist",onChange:k,required:!0,children:[r.jsx("option",{value:"doctor",children:"Doctor"}),r.jsx("option",{value:"receptionist",children:"Receptionist"}),r.jsx("option",{value:"lab",children:"Lab Technician"}),r.jsx("option",{value:"pharmacy",children:"Pharmacist"})]})]}),t.role==="doctor"&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"opd_fee",children:"OPD Fee ()"}),r.jsx("input",{type:"number",id:"opd_fee",name:"opd_fee",value:t.opd_fee||"",onChange:k,min:"0",step:"0.01",placeholder:"Enter OPD consultation fee (optional)"})]}),r.jsxs("div",{className:"form-group checkbox-group",children:[r.jsx("input",{id:"active",name:"active",type:"checkbox",checked:t.active??!0,onChange:k}),r.jsxs("label",{htmlFor:"active",className:"mb-0",children:[" ","Account Active"]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"New Password (optional)"}),r.jsx("input",{type:"password",id:"password",name:"password",value:a,onChange:T,placeholder:"Leave blank to keep current password",autoComplete:"new-password"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter a new password only if you want to change it. Minimum 6 characters."})]}),r.jsx("button",{type:"submit",disabled:f,children:f?r.jsxs(r.Fragment,{children:[r.jsx(Ah,{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white"}),"Saving..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Od,{size:16,className:"mr-2"}),"Save Changes"]})})]})]})};function _9(e,n){const t={};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const k9=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,T9=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,E9={};function KC(e,n){return(E9.jsx?T9:k9).test(e)}const A9=/[ \t\n\f\r]/g;function P9(e){return typeof e=="object"?e.type==="text"?XC(e.value):!1:XC(e)}function XC(e){return e.replace(A9,"")===""}let lg=class{constructor(n,t,i){this.normal=t,this.property=n,i&&(this.space=i)}};lg.prototype.normal={};lg.prototype.property={};lg.prototype.space=void 0;function sT(e,n){const t={},i={};for(const a of e)Object.assign(t,a.property),Object.assign(i,a.normal);return new lg(t,i,n)}function k1(e){return e.toLowerCase()}let ua=class{constructor(n,t){this.attribute=t,this.property=n}};ua.prototype.attribute="";ua.prototype.booleanish=!1;ua.prototype.boolean=!1;ua.prototype.commaOrSpaceSeparated=!1;ua.prototype.commaSeparated=!1;ua.prototype.defined=!1;ua.prototype.mustUseProperty=!1;ua.prototype.number=!1;ua.prototype.overloadedBoolean=!1;ua.prototype.property="";ua.prototype.spaceSeparated=!1;ua.prototype.space=void 0;let D9=0;const Yt=Bd(),Pi=Bd(),oT=Bd(),st=Bd(),ni=Bd(),jh=Bd(),Ta=Bd();function Bd(){return 2**++D9}const T1=Object.freeze(Object.defineProperty({__proto__:null,boolean:Yt,booleanish:Pi,commaOrSpaceSeparated:Ta,commaSeparated:jh,number:st,overloadedBoolean:oT,spaceSeparated:ni},Symbol.toStringTag,{value:"Module"})),p0=Object.keys(T1);let kw=class extends ua{constructor(n,t,i,a){let o=-1;if(super(n,t),ZC(this,"space",a),typeof i=="number")for(;++o<p0.length;){const l=p0[o];ZC(this,p0[o],(i&T1[l])===T1[l])}}};kw.prototype.defined=!0;function ZC(e,n,t){t&&(e[n]=t)}function Hh(e){const n={},t={};for(const[i,a]of Object.entries(e.properties)){const o=new kw(i,e.transform(e.attributes||{},i),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(i)&&(o.mustUseProperty=!0),n[i]=o,t[k1(i)]=i,t[k1(o.attribute)]=i}return new lg(n,t,e.space)}const lT=Hh({properties:{ariaActiveDescendant:null,ariaAtomic:Pi,ariaAutoComplete:null,ariaBusy:Pi,ariaChecked:Pi,ariaColCount:st,ariaColIndex:st,ariaColSpan:st,ariaControls:ni,ariaCurrent:null,ariaDescribedBy:ni,ariaDetails:null,ariaDisabled:Pi,ariaDropEffect:ni,ariaErrorMessage:null,ariaExpanded:Pi,ariaFlowTo:ni,ariaGrabbed:Pi,ariaHasPopup:null,ariaHidden:Pi,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:ni,ariaLevel:st,ariaLive:null,ariaModal:Pi,ariaMultiLine:Pi,ariaMultiSelectable:Pi,ariaOrientation:null,ariaOwns:ni,ariaPlaceholder:null,ariaPosInSet:st,ariaPressed:Pi,ariaReadOnly:Pi,ariaRelevant:null,ariaRequired:Pi,ariaRoleDescription:ni,ariaRowCount:st,ariaRowIndex:st,ariaRowSpan:st,ariaSelected:Pi,ariaSetSize:st,ariaSort:null,ariaValueMax:st,ariaValueMin:st,ariaValueNow:st,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function cT(e,n){return n in e?e[n]:n}function uT(e,n){return cT(e,n.toLowerCase())}const I9=Hh({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:jh,acceptCharset:ni,accessKey:ni,action:null,allow:null,allowFullScreen:Yt,allowPaymentRequest:Yt,allowUserMedia:Yt,alt:null,as:null,async:Yt,autoCapitalize:null,autoComplete:ni,autoFocus:Yt,autoPlay:Yt,blocking:ni,capture:null,charSet:null,checked:Yt,cite:null,className:ni,cols:st,colSpan:null,content:null,contentEditable:Pi,controls:Yt,controlsList:ni,coords:st|jh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Yt,defer:Yt,dir:null,dirName:null,disabled:Yt,download:oT,draggable:Pi,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Yt,formTarget:null,headers:ni,height:st,hidden:Yt,high:st,href:null,hrefLang:null,htmlFor:ni,httpEquiv:ni,id:null,imageSizes:null,imageSrcSet:null,inert:Yt,inputMode:null,integrity:null,is:null,isMap:Yt,itemId:null,itemProp:ni,itemRef:ni,itemScope:Yt,itemType:ni,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Yt,low:st,manifest:null,max:null,maxLength:st,media:null,method:null,min:null,minLength:st,multiple:Yt,muted:Yt,name:null,nonce:null,noModule:Yt,noValidate:Yt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Yt,optimum:st,pattern:null,ping:ni,placeholder:null,playsInline:Yt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Yt,referrerPolicy:null,rel:ni,required:Yt,reversed:Yt,rows:st,rowSpan:st,sandbox:ni,scope:null,scoped:Yt,seamless:Yt,selected:Yt,shadowRootClonable:Yt,shadowRootDelegatesFocus:Yt,shadowRootMode:null,shape:null,size:st,sizes:null,slot:null,span:st,spellCheck:Pi,src:null,srcDoc:null,srcLang:null,srcSet:null,start:st,step:null,style:null,tabIndex:st,target:null,title:null,translate:null,type:null,typeMustMatch:Yt,useMap:null,value:Pi,width:st,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:ni,axis:null,background:null,bgColor:null,border:st,borderColor:null,bottomMargin:st,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Yt,declare:Yt,event:null,face:null,frame:null,frameBorder:null,hSpace:st,leftMargin:st,link:null,longDesc:null,lowSrc:null,marginHeight:st,marginWidth:st,noResize:Yt,noHref:Yt,noShade:Yt,noWrap:Yt,object:null,profile:null,prompt:null,rev:null,rightMargin:st,rules:null,scheme:null,scrolling:Pi,standby:null,summary:null,text:null,topMargin:st,valueType:null,version:null,vAlign:null,vLink:null,vSpace:st,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Yt,disableRemotePlayback:Yt,prefix:null,property:null,results:st,security:null,unselectable:null},space:"html",transform:uT}),R9=Hh({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ta,accentHeight:st,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:st,amplitude:st,arabicForm:null,ascent:st,attributeName:null,attributeType:null,azimuth:st,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:st,by:null,calcMode:null,capHeight:st,className:ni,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:st,diffuseConstant:st,direction:null,display:null,dur:null,divisor:st,dominantBaseline:null,download:Yt,dx:null,dy:null,edgeMode:null,editable:null,elevation:st,enableBackground:null,end:null,event:null,exponent:st,externalResourcesRequired:null,fill:null,fillOpacity:st,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:jh,g2:jh,glyphName:jh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:st,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:st,horizOriginX:st,horizOriginY:st,id:null,ideographic:st,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:st,k:st,k1:st,k2:st,k3:st,k4:st,kernelMatrix:Ta,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:st,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:st,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:st,overlineThickness:st,paintOrder:null,panose1:null,path:null,pathLength:st,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:ni,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:st,pointsAtY:st,pointsAtZ:st,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ta,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ta,rev:Ta,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ta,requiredFeatures:Ta,requiredFonts:Ta,requiredFormats:Ta,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:st,specularExponent:st,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:st,strikethroughThickness:st,string:null,stroke:null,strokeDashArray:Ta,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:st,strokeOpacity:st,strokeWidth:null,style:null,surfaceScale:st,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ta,tabIndex:st,tableValues:null,target:null,targetX:st,targetY:st,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ta,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:st,underlineThickness:st,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:st,values:null,vAlphabetic:st,vMathematical:st,vectorEffect:null,vHanging:st,vIdeographic:st,version:null,vertAdvY:st,vertOriginX:st,vertOriginY:st,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:st,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:cT}),dT=Hh({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),fT=Hh({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:uT}),hT=Hh({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),M9={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},O9=/[A-Z]/g,ej=/-[a-z]/g,L9=/^data[-\w.:]+$/i;function F9(e,n){const t=k1(n);let i=n,a=ua;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&L9.test(n)){if(n.charAt(4)==="-"){const o=n.slice(5).replace(ej,z9);i="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=n.slice(4);if(!ej.test(o)){let l=o.replace(O9,$9);l.charAt(0)!=="-"&&(l="-"+l),n="data"+l}}a=kw}return new a(i,n)}function $9(e){return"-"+e.toLowerCase()}function z9(e){return e.charAt(1).toUpperCase()}const U9=sT([lT,I9,dT,fT,hT],"html"),Tw=sT([lT,R9,dT,fT,hT],"svg");function B9(e){return e.join(" ").trim()}var mh={},m0,tj;function q9(){if(tj)return m0;tj=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=/\n/g,t=/^\s*/,i=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,a=/^:\s*/,o=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,l=/^[;\s]*/,d=/^\s+|\s+$/g,f=`
`,u="/",p="*",g="",b="comment",v="declaration";m0=function(k,T){if(typeof k!="string")throw new TypeError("First argument must be a string");if(!k)return[];T=T||{};var P=1,M=1;function I(re){var ne=re.match(n);ne&&(P+=ne.length);var G=re.lastIndexOf(f);M=~G?re.length-G:M+re.length}function U(){var re={line:P,column:M};return function(ne){return ne.position=new L(re),F(),ne}}function L(re){this.start=re,this.end={line:P,column:M},this.source=T.source}L.prototype.content=k;function $(re){var ne=new Error(T.source+":"+P+":"+M+": "+re);if(ne.reason=re,ne.filename=T.source,ne.line=P,ne.column=M,ne.source=k,!T.silent)throw ne}function z(re){var ne=re.exec(k);if(ne){var G=ne[0];return I(G),k=k.slice(G.length),ne}}function F(){z(t)}function Q(re){var ne;for(re=re||[];ne=R();)ne!==!1&&re.push(ne);return re}function R(){var re=U();if(!(u!=k.charAt(0)||p!=k.charAt(1))){for(var ne=2;g!=k.charAt(ne)&&(p!=k.charAt(ne)||u!=k.charAt(ne+1));)++ne;if(ne+=2,g===k.charAt(ne-1))return $("End of comment missing");var G=k.slice(2,ne-2);return M+=2,I(G),k=k.slice(ne),M+=2,re({type:b,comment:G})}}function B(){var re=U(),ne=z(i);if(ne){if(R(),!z(a))return $("property missing ':'");var G=z(o),V=re({type:v,property:S(ne[0].replace(e,g)),value:G?S(G[0].replace(e,g)):g});return z(l),V}}function Y(){var re=[];Q(re);for(var ne;ne=B();)ne!==!1&&(re.push(ne),Q(re));return re}return F(),Y()};function S(k){return k?k.replace(d,g):g}return m0}var nj;function V9(){if(nj)return mh;nj=1;var e=mh&&mh.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(mh,"__esModule",{value:!0}),mh.default=t;var n=e(q9());function t(i,a){var o=null;if(!i||typeof i!="string")return o;var l=(0,n.default)(i),d=typeof a=="function";return l.forEach(function(f){if(f.type==="declaration"){var u=f.property,p=f.value;d?a(u,p,f):p&&(o=o||{},o[u]=p)}}),o}return mh}var Pm={},ij;function H9(){if(ij)return Pm;ij=1,Object.defineProperty(Pm,"__esModule",{value:!0}),Pm.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,n=/-([a-z])/g,t=/^[^-]+$/,i=/^-(webkit|moz|ms|o|khtml)-/,a=/^-(ms)-/,o=function(u){return!u||t.test(u)||e.test(u)},l=function(u,p){return p.toUpperCase()},d=function(u,p){return"".concat(p,"-")},f=function(u,p){return p===void 0&&(p={}),o(u)?u:(u=u.toLowerCase(),p.reactCompat?u=u.replace(a,d):u=u.replace(i,d),u.replace(n,l))};return Pm.camelCase=f,Pm}var Dm,rj;function G9(){if(rj)return Dm;rj=1;var e=Dm&&Dm.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},n=e(V9()),t=H9();function i(a,o){var l={};return!a||typeof a!="string"||(0,n.default)(a,function(d,f){d&&f&&(l[(0,t.camelCase)(d,o)]=f)}),l}return i.default=i,Dm=i,Dm}var Y9=G9();const W9=Ud(Y9),pT=mT("end"),Ew=mT("start");function mT(e){return n;function n(t){const i=t&&t.position&&t.position[e]||{};if(typeof i.line=="number"&&i.line>0&&typeof i.column=="number"&&i.column>0)return{line:i.line,column:i.column,offset:typeof i.offset=="number"&&i.offset>-1?i.offset:void 0}}}function Q9(e){const n=Ew(e),t=pT(e);if(n&&t)return{start:n,end:t}}function $m(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?aj(e.position):"start"in e||"end"in e?aj(e):"line"in e||"column"in e?E1(e):""}function E1(e){return sj(e&&e.line)+":"+sj(e&&e.column)}function aj(e){return E1(e&&e.start)+"-"+E1(e&&e.end)}function sj(e){return e&&typeof e=="number"?e:1}let _r=class extends Error{constructor(n,t,i){super(),typeof t=="string"&&(i=t,t=void 0);let a="",o={},l=!1;if(t&&("line"in t&&"column"in t?o={place:t}:"start"in t&&"end"in t?o={place:t}:"type"in t?o={ancestors:[t],place:t.position}:o={...t}),typeof n=="string"?a=n:!o.cause&&n&&(l=!0,a=n.message,o.cause=n),!o.ruleId&&!o.source&&typeof i=="string"){const f=i.indexOf(":");f===-1?o.ruleId=i:(o.source=i.slice(0,f),o.ruleId=i.slice(f+1))}if(!o.place&&o.ancestors&&o.ancestors){const f=o.ancestors[o.ancestors.length-1];f&&(o.place=f.position)}const d=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=d?d.column:void 0,this.fatal=void 0,this.file,this.message=a,this.line=d?d.line:void 0,this.name=$m(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=l&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual,this.expected,this.note,this.url}};_r.prototype.file="";_r.prototype.name="";_r.prototype.reason="";_r.prototype.message="";_r.prototype.stack="";_r.prototype.column=void 0;_r.prototype.line=void 0;_r.prototype.ancestors=void 0;_r.prototype.cause=void 0;_r.prototype.fatal=void 0;_r.prototype.place=void 0;_r.prototype.ruleId=void 0;_r.prototype.source=void 0;const Aw={}.hasOwnProperty,J9=new Map,K9=/[A-Z]/g,X9=new Set(["table","tbody","thead","tfoot","tr"]),Z9=new Set(["td","th"]),gT="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function eq(e,n){if(!n||n.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=n.filePath||void 0;let i;if(n.development){if(typeof n.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");i=lq(t,n.jsxDEV)}else{if(typeof n.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof n.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");i=oq(t,n.jsx,n.jsxs)}const a={Fragment:n.Fragment,ancestors:[],components:n.components||{},create:i,elementAttributeNameCase:n.elementAttributeNameCase||"react",evaluater:n.createEvaluater?n.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:n.ignoreInvalidStyle||!1,passKeys:n.passKeys!==!1,passNode:n.passNode||!1,schema:n.space==="svg"?Tw:U9,stylePropertyNameCase:n.stylePropertyNameCase||"dom",tableCellAlignToStyle:n.tableCellAlignToStyle!==!1},o=yT(a,e,void 0);return o&&typeof o!="string"?o:a.create(e,a.Fragment,{children:o||void 0},void 0)}function yT(e,n,t){if(n.type==="element")return tq(e,n,t);if(n.type==="mdxFlowExpression"||n.type==="mdxTextExpression")return nq(e,n);if(n.type==="mdxJsxFlowElement"||n.type==="mdxJsxTextElement")return rq(e,n,t);if(n.type==="mdxjsEsm")return iq(e,n);if(n.type==="root")return aq(e,n,t);if(n.type==="text")return sq(e,n)}function tq(e,n,t){const i=e.schema;let a=i;n.tagName.toLowerCase()==="svg"&&i.space==="html"&&(a=Tw,e.schema=a),e.ancestors.push(n);const o=bT(e,n.tagName,!1),l=cq(e,n);let d=Dw(e,n);return X9.has(n.tagName)&&(d=d.filter(function(f){return typeof f=="string"?!P9(f):!0})),xT(e,l,o,n),Pw(l,d),e.ancestors.pop(),e.schema=i,e.create(n,o,l,t)}function nq(e,n){if(n.data&&n.data.estree&&e.evaluater){const i=n.data.estree.body[0];return i.type,e.evaluater.evaluateExpression(i.expression)}Xm(e,n.position)}function iq(e,n){if(n.data&&n.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(n.data.estree);Xm(e,n.position)}function rq(e,n,t){const i=e.schema;let a=i;n.name==="svg"&&i.space==="html"&&(a=Tw,e.schema=a),e.ancestors.push(n);const o=n.name===null?e.Fragment:bT(e,n.name,!0),l=uq(e,n),d=Dw(e,n);return xT(e,l,o,n),Pw(l,d),e.ancestors.pop(),e.schema=i,e.create(n,o,l,t)}function aq(e,n,t){const i={};return Pw(i,Dw(e,n)),e.create(n,e.Fragment,i,t)}function sq(e,n){return n.value}function xT(e,n,t,i){typeof t!="string"&&t!==e.Fragment&&e.passNode&&(n.node=i)}function Pw(e,n){if(n.length>0){const t=n.length>1?n:n[0];t&&(e.children=t)}}function oq(e,n,t){return i;function i(a,o,l,d){const u=Array.isArray(l.children)?t:n;return d?u(o,l,d):u(o,l)}}function lq(e,n){return t;function t(i,a,o,l){const d=Array.isArray(o.children),f=Ew(i);return n(a,o,l,d,{columnNumber:f?f.column-1:void 0,fileName:e,lineNumber:f?f.line:void 0},void 0)}}function cq(e,n){const t={};let i,a;for(a in n.properties)if(a!=="children"&&Aw.call(n.properties,a)){const o=dq(e,a,n.properties[a]);if(o){const[l,d]=o;e.tableCellAlignToStyle&&l==="align"&&typeof d=="string"&&Z9.has(n.tagName)?i=d:t[l]=d}}if(i){const o=t.style||(t.style={});o[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=i}return t}function uq(e,n){const t={};for(const i of n.attributes)if(i.type==="mdxJsxExpressionAttribute")if(i.data&&i.data.estree&&e.evaluater){const o=i.data.estree.body[0];o.type;const l=o.expression;l.type;const d=l.properties[0];d.type,Object.assign(t,e.evaluater.evaluateExpression(d.argument))}else Xm(e,n.position);else{const a=i.name;let o;if(i.value&&typeof i.value=="object")if(i.value.data&&i.value.data.estree&&e.evaluater){const d=i.value.data.estree.body[0];d.type,o=e.evaluater.evaluateExpression(d.expression)}else Xm(e,n.position);else o=i.value===null?!0:i.value;t[a]=o}return t}function Dw(e,n){const t=[];let i=-1;const a=e.passKeys?new Map:J9;for(;++i<n.children.length;){const o=n.children[i];let l;if(e.passKeys){const f=o.type==="element"?o.tagName:o.type==="mdxJsxFlowElement"||o.type==="mdxJsxTextElement"?o.name:void 0;if(f){const u=a.get(f)||0;l=f+"-"+u,a.set(f,u+1)}}const d=yT(e,o,l);d!==void 0&&t.push(d)}return t}function dq(e,n,t){const i=F9(e.schema,n);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=i.commaSeparated?_9(t):B9(t)),i.property==="style"){let a=typeof t=="object"?t:fq(e,String(t));return e.stylePropertyNameCase==="css"&&(a=hq(a)),["style",a]}return[e.elementAttributeNameCase==="react"&&i.space?M9[i.property]||i.property:i.attribute,t]}}function fq(e,n){try{return W9(n,{reactCompat:!0})}catch(t){if(e.ignoreInvalidStyle)return{};const i=t,a=new _r("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:i,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=e.filePath||void 0,a.url=gT+"#cannot-parse-style-attribute",a}}function bT(e,n,t){let i;if(!t)i={type:"Literal",value:n};else if(n.includes(".")){const a=n.split(".");let o=-1,l;for(;++o<a.length;){const d=KC(a[o])?{type:"Identifier",name:a[o]}:{type:"Literal",value:a[o]};l=l?{type:"MemberExpression",object:l,property:d,computed:!!(o&&d.type==="Literal"),optional:!1}:d}i=l}else i=KC(n)&&!/^[a-z]/.test(n)?{type:"Identifier",name:n}:{type:"Literal",value:n};if(i.type==="Literal"){const a=i.value;return Aw.call(e.components,a)?e.components[a]:a}if(e.evaluater)return e.evaluater.evaluateExpression(i);Xm(e)}function Xm(e,n){const t=new _r("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:n,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=e.filePath||void 0,t.url=gT+"#cannot-handle-mdx-estrees-without-createevaluater",t}function hq(e){const n={};let t;for(t in e)Aw.call(e,t)&&(n[pq(t)]=e[t]);return n}function pq(e){let n=e.replace(K9,mq);return n.slice(0,3)==="ms-"&&(n="-"+n),n}function mq(e){return"-"+e.toLowerCase()}const g0={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},gq={};function Iw(e,n){const t=gq,i=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return vT(e,i,a)}function vT(e,n,t){if(yq(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return oj(e.children,n,t)}return Array.isArray(e)?oj(e,n,t):""}function oj(e,n,t){const i=[];let a=-1;for(;++a<e.length;)i[a]=vT(e[a],n,t);return i.join("")}function yq(e){return!!(e&&typeof e=="object")}const lj=document.createElement("i");function Rw(e){const n="&"+e+";";lj.innerHTML=n;const t=lj.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function Ia(e,n,t,i){const a=e.length;let o=0,l;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,i.length<1e4)l=Array.from(i),l.unshift(n,t),e.splice(...l);else for(t&&e.splice(n,t);o<i.length;)l=i.slice(o,o+1e4),l.unshift(n,0),e.splice(...l),o+=1e4,n+=1e4}function rs(e,n){return e.length>0?(Ia(e,e.length,0,n),e):n}const cj={}.hasOwnProperty;function wT(e){const n={};let t=-1;for(;++t<e.length;)xq(n,e[t]);return n}function xq(e,n){let t;for(t in n){const a=(cj.call(e,t)?e[t]:void 0)||(e[t]={}),o=n[t];let l;if(o)for(l in o){cj.call(a,l)||(a[l]=[]);const d=o[l];bq(a[l],Array.isArray(d)?d:d?[d]:[])}}}function bq(e,n){let t=-1;const i=[];for(;++t<n.length;)(n[t].add==="after"?e:i).push(n[t]);Ia(e,0,0,i)}function ST(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function Us(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Ur=gu(/[A-Za-z]/),Cr=gu(/[\dA-Za-z]/),vq=gu(/[#-'*+\--9=?A-Z^-~]/);function db(e){return e!==null&&(e<32||e===127)}const A1=gu(/\d/),wq=gu(/[\dA-Fa-f]/),Sq=gu(/[!-/:-@[-`{-~]/);function It(e){return e!==null&&e<-2}function Jn(e){return e!==null&&(e<0||e===32)}function fn(e){return e===-2||e===-1||e===32}const $b=gu(new RegExp("\\p{P}|\\p{S}","u")),$d=gu(/\s/);function gu(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function Gh(e){const n=[];let t=-1,i=0,a=0;for(;++t<e.length;){const o=e.charCodeAt(t);let l="";if(o===37&&Cr(e.charCodeAt(t+1))&&Cr(e.charCodeAt(t+2)))a=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(l=String.fromCharCode(o));else if(o>55295&&o<57344){const d=e.charCodeAt(t+1);o<56320&&d>56319&&d<57344?(l=String.fromCharCode(o,d),a=1):l=""}else l=String.fromCharCode(o);l&&(n.push(e.slice(i,t),encodeURIComponent(l)),i=t+a+1,l=""),a&&(t+=a,a=0)}return n.join("")+e.slice(i)}function wn(e,n,t,i){const a=i?i-1:Number.POSITIVE_INFINITY;let o=0;return l;function l(f){return fn(f)?(e.enter(t),d(f)):n(f)}function d(f){return fn(f)&&o++<a?(e.consume(f),d):(e.exit(t),n(f))}}const Nq={tokenize:Cq};function Cq(e){const n=e.attempt(this.parser.constructs.contentInitial,i,a);let t;return n;function i(d){if(d===null){e.consume(d);return}return e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),wn(e,n,"linePrefix")}function a(d){return e.enter("paragraph"),o(d)}function o(d){const f=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=f),t=f,l(d)}function l(d){if(d===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(d);return}return It(d)?(e.consume(d),e.exit("chunkText"),o):(e.consume(d),l)}}const jq={tokenize:_q},uj={tokenize:kq};function _q(e){const n=this,t=[];let i=0,a,o,l;return d;function d(I){if(i<t.length){const U=t[i];return n.containerState=U[1],e.attempt(U[0].continuation,f,u)(I)}return u(I)}function f(I){if(i++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&M();const U=n.events.length;let L=U,$;for(;L--;)if(n.events[L][0]==="exit"&&n.events[L][1].type==="chunkFlow"){$=n.events[L][1].end;break}P(i);let z=U;for(;z<n.events.length;)n.events[z][1].end={...$},z++;return Ia(n.events,L+1,0,n.events.slice(U)),n.events.length=z,u(I)}return d(I)}function u(I){if(i===t.length){if(!a)return b(I);if(a.currentConstruct&&a.currentConstruct.concrete)return S(I);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(uj,p,g)(I)}function p(I){return a&&M(),P(i),b(I)}function g(I){return n.parser.lazy[n.now().line]=i!==t.length,l=n.now().offset,S(I)}function b(I){return n.containerState={},e.attempt(uj,v,S)(I)}function v(I){return i++,t.push([n.currentConstruct,n.containerState]),b(I)}function S(I){if(I===null){a&&M(),P(0),e.consume(I);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:o}),k(I)}function k(I){if(I===null){T(e.exit("chunkFlow"),!0),P(0),e.consume(I);return}return It(I)?(e.consume(I),T(e.exit("chunkFlow")),i=0,n.interrupt=void 0,d):(e.consume(I),k)}function T(I,U){const L=n.sliceStream(I);if(U&&L.push(null),I.previous=o,o&&(o.next=I),o=I,a.defineSkip(I.start),a.write(L),n.parser.lazy[I.start.line]){let $=a.events.length;for(;$--;)if(a.events[$][1].start.offset<l&&(!a.events[$][1].end||a.events[$][1].end.offset>l))return;const z=n.events.length;let F=z,Q,R;for(;F--;)if(n.events[F][0]==="exit"&&n.events[F][1].type==="chunkFlow"){if(Q){R=n.events[F][1].end;break}Q=!0}for(P(i),$=z;$<n.events.length;)n.events[$][1].end={...R},$++;Ia(n.events,F+1,0,n.events.slice(z)),n.events.length=$}}function P(I){let U=t.length;for(;U-- >I;){const L=t[U];n.containerState=L[1],L[0].exit.call(n,e)}t.length=I}function M(){a.write([null]),o=void 0,a=void 0,n.containerState._closeFlow=void 0}}function kq(e,n,t){return wn(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Rh(e){if(e===null||Jn(e)||$d(e))return 1;if($b(e))return 2}function zb(e,n,t){const i=[];let a=-1;for(;++a<e.length;){const o=e[a].resolveAll;o&&!i.includes(o)&&(n=o(n,t),i.push(o))}return n}const P1={name:"attention",resolveAll:Tq,tokenize:Eq};function Tq(e,n){let t=-1,i,a,o,l,d,f,u,p;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(i=t;i--;)if(e[i][0]==="exit"&&e[i][1].type==="attentionSequence"&&e[i][1]._open&&n.sliceSerialize(e[i][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[i][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[i][1].end.offset-e[i][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;f=e[i][1].end.offset-e[i][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[i][1].end},b={...e[t][1].start};dj(g,-f),dj(b,f),l={type:f>1?"strongSequence":"emphasisSequence",start:g,end:{...e[i][1].end}},d={type:f>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},o={type:f>1?"strongText":"emphasisText",start:{...e[i][1].end},end:{...e[t][1].start}},a={type:f>1?"strong":"emphasis",start:{...l.start},end:{...d.end}},e[i][1].end={...l.start},e[t][1].start={...d.end},u=[],e[i][1].end.offset-e[i][1].start.offset&&(u=rs(u,[["enter",e[i][1],n],["exit",e[i][1],n]])),u=rs(u,[["enter",a,n],["enter",l,n],["exit",l,n],["enter",o,n]]),u=rs(u,zb(n.parser.constructs.insideSpan.null,e.slice(i+1,t),n)),u=rs(u,[["exit",o,n],["enter",d,n],["exit",d,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(p=2,u=rs(u,[["enter",e[t][1],n],["exit",e[t][1],n]])):p=0,Ia(e,i-1,t-i+3,u),t=i+u.length-p-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function Eq(e,n){const t=this.parser.constructs.attentionMarkers.null,i=this.previous,a=Rh(i);let o;return l;function l(f){return o=f,e.enter("attentionSequence"),d(f)}function d(f){if(f===o)return e.consume(f),d;const u=e.exit("attentionSequence"),p=Rh(f),g=!p||p===2&&a||t.includes(f),b=!a||a===2&&p||t.includes(i);return u._open=!!(o===42?g:g&&(a||!b)),u._close=!!(o===42?b:b&&(p||!g)),n(f)}}function dj(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const Aq={name:"autolink",tokenize:Pq};function Pq(e,n,t){let i=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o}function o(v){return Ur(v)?(e.consume(v),l):v===64?t(v):u(v)}function l(v){return v===43||v===45||v===46||Cr(v)?(i=1,d(v)):u(v)}function d(v){return v===58?(e.consume(v),i=0,f):(v===43||v===45||v===46||Cr(v))&&i++<32?(e.consume(v),d):(i=0,u(v))}function f(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||db(v)?t(v):(e.consume(v),f)}function u(v){return v===64?(e.consume(v),p):vq(v)?(e.consume(v),u):t(v)}function p(v){return Cr(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),i=0,p):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||Cr(v))&&i++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const cg={partial:!0,tokenize:Dq};function Dq(e,n,t){return i;function i(o){return fn(o)?wn(e,a,"linePrefix")(o):a(o)}function a(o){return o===null||It(o)?n(o):t(o)}}const NT={continuation:{tokenize:Rq},exit:Mq,name:"blockQuote",tokenize:Iq};function Iq(e,n,t){const i=this;return a;function a(l){if(l===62){const d=i.containerState;return d.open||(e.enter("blockQuote",{_container:!0}),d.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),o}return t(l)}function o(l){return fn(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(l))}}function Rq(e,n,t){const i=this;return a;function a(l){return fn(l)?wn(e,o,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):o(l)}function o(l){return e.attempt(NT,n,t)(l)}}function Mq(e){e.exit("blockQuote")}const CT={name:"characterEscape",tokenize:Oq};function Oq(e,n,t){return i;function i(o){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(o),e.exit("escapeMarker"),a}function a(o){return Sq(o)?(e.enter("characterEscapeValue"),e.consume(o),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(o)}}const jT={name:"characterReference",tokenize:Lq};function Lq(e,n,t){const i=this;let a=0,o,l;return d;function d(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),f}function f(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),o=31,l=Cr,p(g))}function u(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,l=wq,p):(e.enter("characterReferenceValue"),o=7,l=A1,p(g))}function p(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return l===Cr&&!Rw(i.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return l(g)&&a++<o?(e.consume(g),p):t(g)}}const fj={partial:!0,tokenize:$q},hj={concrete:!0,name:"codeFenced",tokenize:Fq};function Fq(e,n,t){const i=this,a={partial:!0,tokenize:L};let o=0,l=0,d;return f;function f($){return u($)}function u($){const z=i.events[i.events.length-1];return o=z&&z[1].type==="linePrefix"?z[2].sliceSerialize(z[1],!0).length:0,d=$,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),p($)}function p($){return $===d?(l++,e.consume($),p):l<3?t($):(e.exit("codeFencedFenceSequence"),fn($)?wn(e,g,"whitespace")($):g($))}function g($){return $===null||It($)?(e.exit("codeFencedFence"),i.interrupt?n($):e.check(fj,k,U)($)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b($))}function b($){return $===null||It($)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g($)):fn($)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),wn(e,v,"whitespace")($)):$===96&&$===d?t($):(e.consume($),b)}function v($){return $===null||It($)?g($):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S($))}function S($){return $===null||It($)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g($)):$===96&&$===d?t($):(e.consume($),S)}function k($){return e.attempt(a,U,T)($)}function T($){return e.enter("lineEnding"),e.consume($),e.exit("lineEnding"),P}function P($){return o>0&&fn($)?wn(e,M,"linePrefix",o+1)($):M($)}function M($){return $===null||It($)?e.check(fj,k,U)($):(e.enter("codeFlowValue"),I($))}function I($){return $===null||It($)?(e.exit("codeFlowValue"),M($)):(e.consume($),I)}function U($){return e.exit("codeFenced"),n($)}function L($,z,F){let Q=0;return R;function R(G){return $.enter("lineEnding"),$.consume(G),$.exit("lineEnding"),B}function B(G){return $.enter("codeFencedFence"),fn(G)?wn($,Y,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(G):Y(G)}function Y(G){return G===d?($.enter("codeFencedFenceSequence"),re(G)):F(G)}function re(G){return G===d?(Q++,$.consume(G),re):Q>=l?($.exit("codeFencedFenceSequence"),fn(G)?wn($,ne,"whitespace")(G):ne(G)):F(G)}function ne(G){return G===null||It(G)?($.exit("codeFencedFence"),z(G)):F(G)}}}function $q(e,n,t){const i=this;return a;function a(l){return l===null?t(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o)}function o(l){return i.parser.lazy[i.now().line]?t(l):n(l)}}const y0={name:"codeIndented",tokenize:Uq},zq={partial:!0,tokenize:Bq};function Uq(e,n,t){const i=this;return a;function a(u){return e.enter("codeIndented"),wn(e,o,"linePrefix",5)(u)}function o(u){const p=i.events[i.events.length-1];return p&&p[1].type==="linePrefix"&&p[2].sliceSerialize(p[1],!0).length>=4?l(u):t(u)}function l(u){return u===null?f(u):It(u)?e.attempt(zq,l,f)(u):(e.enter("codeFlowValue"),d(u))}function d(u){return u===null||It(u)?(e.exit("codeFlowValue"),l(u)):(e.consume(u),d)}function f(u){return e.exit("codeIndented"),n(u)}}function Bq(e,n,t){const i=this;return a;function a(l){return i.parser.lazy[i.now().line]?t(l):It(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):wn(e,o,"linePrefix",5)(l)}function o(l){const d=i.events[i.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):It(l)?a(l):t(l)}}const qq={name:"codeText",previous:Hq,resolve:Vq,tokenize:Gq};function Vq(e){let n=e.length-4,t=3,i,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(i=t;++i<n;)if(e[i][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(i=t-1,n++;++i<=n;)a===void 0?i!==n&&e[i][1].type!=="lineEnding"&&(a=i):(i===n||e[i][1].type==="lineEnding")&&(e[a][1].type="codeTextData",i!==a+2&&(e[a][1].end=e[i-1][1].end,e.splice(a+2,i-a-2),n-=i-a-2,i=a+2),a=void 0);return e}function Hq(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function Gq(e,n,t){let i=0,a,o;return l;function l(g){return e.enter("codeText"),e.enter("codeTextSequence"),d(g)}function d(g){return g===96?(e.consume(g),i++,d):(e.exit("codeTextSequence"),f(g))}function f(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),f):g===96?(o=e.enter("codeTextSequence"),a=0,p(g)):It(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),f):(e.enter("codeTextData"),u(g))}function u(g){return g===null||g===32||g===96||It(g)?(e.exit("codeTextData"),f(g)):(e.consume(g),u)}function p(g){return g===96?(e.consume(g),a++,p):a===i?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(o.type="codeTextData",u(g))}}let Yq=class{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const i=t??Number.POSITIVE_INFINITY;return i<this.left.length?this.left.slice(n,i):n>this.left.length?this.right.slice(this.right.length-i+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-i+this.left.length).reverse())}splice(n,t,i){const a=t||0;this.setCursor(Math.trunc(n));const o=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return i&&Im(this.left,i),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Im(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Im(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Im(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Im(this.left,t.reverse())}}};function Im(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function _T(e){const n={};let t=-1,i,a,o,l,d,f,u;const p=new Yq(e);for(;++t<p.length;){for(;t in n;)t=n[t];if(i=p.get(t),t&&i[1].type==="chunkFlow"&&p.get(t-1)[1].type==="listItemPrefix"&&(f=i[1]._tokenizer.events,o=0,o<f.length&&f[o][1].type==="lineEndingBlank"&&(o+=2),o<f.length&&f[o][1].type==="content"))for(;++o<f.length&&f[o][1].type!=="content";)f[o][1].type==="chunkText"&&(f[o][1]._isInFirstContentOfListItem=!0,o++);if(i[0]==="enter")i[1].contentType&&(Object.assign(n,Wq(p,t)),t=n[t],u=!0);else if(i[1]._container){for(o=t,a=void 0;o--;)if(l=p.get(o),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(p.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=o);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(i[1].end={...p.get(a)[1].start},d=p.slice(a,t),d.unshift(i),p.splice(a,t-a+1,d))}}return Ia(e,0,Number.POSITIVE_INFINITY,p.slice(0)),!u}function Wq(e,n){const t=e.get(n)[1],i=e.get(n)[2];let a=n-1;const o=[];let l=t._tokenizer;l||(l=i.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const d=l.events,f=[],u={};let p,g,b=-1,v=t,S=0,k=0;const T=[k];for(;v;){for(;e.get(++a)[1]!==v;);o.push(a),v._tokenizer||(p=i.sliceStream(v),v.next||p.push(null),g&&l.defineSkip(v.start),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(p),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<d.length;)d[b][0]==="exit"&&d[b-1][0]==="enter"&&d[b][1].type===d[b-1][1].type&&d[b][1].start.line!==d[b][1].end.line&&(k=b+1,T.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(l.events=[],v?(v._tokenizer=void 0,v.previous=void 0):T.pop(),b=T.length;b--;){const P=d.slice(T[b],T[b+1]),M=o.pop();f.push([M,M+P.length-1]),e.splice(M,2,P)}for(f.reverse(),b=-1;++b<f.length;)u[S+f[b][0]]=S+f[b][1],S+=f[b][1]-f[b][0]-1;return u}const Qq={resolve:Kq,tokenize:Xq},Jq={partial:!0,tokenize:Zq};function Kq(e){return _T(e),e}function Xq(e,n){let t;return i;function i(d){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(d)}function a(d){return d===null?o(d):It(d)?e.check(Jq,l,o)(d):(e.consume(d),a)}function o(d){return e.exit("chunkContent"),e.exit("content"),n(d)}function l(d){return e.consume(d),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function Zq(e,n,t){const i=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),wn(e,o,"linePrefix")}function o(l){if(l===null||It(l))return t(l);const d=i.events[i.events.length-1];return!i.parser.constructs.disable.null.includes("codeIndented")&&d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):e.interrupt(i.parser.constructs.flow,t,n)(l)}}function kT(e,n,t,i,a,o,l,d,f){const u=f||Number.POSITIVE_INFINITY;let p=0;return g;function g(P){return P===60?(e.enter(i),e.enter(a),e.enter(o),e.consume(P),e.exit(o),b):P===null||P===32||P===41||db(P)?t(P):(e.enter(i),e.enter(l),e.enter(d),e.enter("chunkString",{contentType:"string"}),k(P))}function b(P){return P===62?(e.enter(o),e.consume(P),e.exit(o),e.exit(a),e.exit(i),n):(e.enter(d),e.enter("chunkString",{contentType:"string"}),v(P))}function v(P){return P===62?(e.exit("chunkString"),e.exit(d),b(P)):P===null||P===60||It(P)?t(P):(e.consume(P),P===92?S:v)}function S(P){return P===60||P===62||P===92?(e.consume(P),v):v(P)}function k(P){return!p&&(P===null||P===41||Jn(P))?(e.exit("chunkString"),e.exit(d),e.exit(l),e.exit(i),n(P)):p<u&&P===40?(e.consume(P),p++,k):P===41?(e.consume(P),p--,k):P===null||P===32||P===40||db(P)?t(P):(e.consume(P),P===92?T:k)}function T(P){return P===40||P===41||P===92?(e.consume(P),k):k(P)}}function TT(e,n,t,i,a,o){const l=this;let d=0,f;return u;function u(v){return e.enter(i),e.enter(a),e.consume(v),e.exit(a),e.enter(o),p}function p(v){return d>999||v===null||v===91||v===93&&!f||v===94&&!d&&"_hiddenFootnoteSupport"in l.parser.constructs?t(v):v===93?(e.exit(o),e.enter(a),e.consume(v),e.exit(a),e.exit(i),n):It(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),p):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||It(v)||d++>999?(e.exit("chunkString"),p(v)):(e.consume(v),f||(f=!fn(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),d++,g):g(v)}}function ET(e,n,t,i,a,o){let l;return d;function d(b){return b===34||b===39||b===40?(e.enter(i),e.enter(a),e.consume(b),e.exit(a),l=b===40?41:b,f):t(b)}function f(b){return b===l?(e.enter(a),e.consume(b),e.exit(a),e.exit(i),n):(e.enter(o),u(b))}function u(b){return b===l?(e.exit(o),f(l)):b===null?t(b):It(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),wn(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),p(b))}function p(b){return b===l||b===null||It(b)?(e.exit("chunkString"),u(b)):(e.consume(b),b===92?g:p)}function g(b){return b===l||b===92?(e.consume(b),p):p(b)}}function zm(e,n){let t;return i;function i(a){return It(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,i):fn(a)?wn(e,i,t?"linePrefix":"lineSuffix")(a):n(a)}}const e7={name:"definition",tokenize:n7},t7={partial:!0,tokenize:i7};function n7(e,n,t){const i=this;let a;return o;function o(v){return e.enter("definition"),l(v)}function l(v){return TT.call(i,e,d,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function d(v){return a=Us(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),f):t(v)}function f(v){return Jn(v)?zm(e,u)(v):u(v)}function u(v){return kT(e,p,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function p(v){return e.attempt(t7,g,g)(v)}function g(v){return fn(v)?wn(e,b,"whitespace")(v):b(v)}function b(v){return v===null||It(v)?(e.exit("definition"),i.parser.defined.push(a),n(v)):t(v)}}function i7(e,n,t){return i;function i(d){return Jn(d)?zm(e,a)(d):t(d)}function a(d){return ET(e,o,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(d)}function o(d){return fn(d)?wn(e,l,"whitespace")(d):l(d)}function l(d){return d===null||It(d)?n(d):t(d)}}const r7={name:"hardBreakEscape",tokenize:a7};function a7(e,n,t){return i;function i(o){return e.enter("hardBreakEscape"),e.consume(o),a}function a(o){return It(o)?(e.exit("hardBreakEscape"),n(o)):t(o)}}const s7={name:"headingAtx",resolve:o7,tokenize:l7};function o7(e,n){let t=e.length-2,i=3,a,o;return e[i][1].type==="whitespace"&&(i+=2),t-2>i&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(i===t-1||t-4>i&&e[t-2][1].type==="whitespace")&&(t-=i+1===t?2:4),t>i&&(a={type:"atxHeadingText",start:e[i][1].start,end:e[t][1].end},o={type:"chunkText",start:e[i][1].start,end:e[t][1].end,contentType:"text"},Ia(e,i,t-i+1,[["enter",a,n],["enter",o,n],["exit",o,n],["exit",a,n]])),e}function l7(e,n,t){let i=0;return a;function a(p){return e.enter("atxHeading"),o(p)}function o(p){return e.enter("atxHeadingSequence"),l(p)}function l(p){return p===35&&i++<6?(e.consume(p),l):p===null||Jn(p)?(e.exit("atxHeadingSequence"),d(p)):t(p)}function d(p){return p===35?(e.enter("atxHeadingSequence"),f(p)):p===null||It(p)?(e.exit("atxHeading"),n(p)):fn(p)?wn(e,d,"whitespace")(p):(e.enter("atxHeadingText"),u(p))}function f(p){return p===35?(e.consume(p),f):(e.exit("atxHeadingSequence"),d(p))}function u(p){return p===null||p===35||Jn(p)?(e.exit("atxHeadingText"),d(p)):(e.consume(p),u)}}const c7=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],pj=["pre","script","style","textarea"],u7={concrete:!0,name:"htmlFlow",resolveTo:h7,tokenize:p7},d7={partial:!0,tokenize:g7},f7={partial:!0,tokenize:m7};function h7(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function p7(e,n,t){const i=this;let a,o,l,d,f;return u;function u(D){return p(D)}function p(D){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(D),g}function g(D){return D===33?(e.consume(D),b):D===47?(e.consume(D),o=!0,k):D===63?(e.consume(D),a=3,i.interrupt?n:A):Ur(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function b(D){return D===45?(e.consume(D),a=2,v):D===91?(e.consume(D),a=5,d=0,S):Ur(D)?(e.consume(D),a=4,i.interrupt?n:A):t(D)}function v(D){return D===45?(e.consume(D),i.interrupt?n:A):t(D)}function S(D){const oe="CDATA[";return D===oe.charCodeAt(d++)?(e.consume(D),d===oe.length?i.interrupt?n:Y:S):t(D)}function k(D){return Ur(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function T(D){if(D===null||D===47||D===62||Jn(D)){const oe=D===47,xe=l.toLowerCase();return!oe&&!o&&pj.includes(xe)?(a=1,i.interrupt?n(D):Y(D)):c7.includes(l.toLowerCase())?(a=6,oe?(e.consume(D),P):i.interrupt?n(D):Y(D)):(a=7,i.interrupt&&!i.parser.lazy[i.now().line]?t(D):o?M(D):I(D))}return D===45||Cr(D)?(e.consume(D),l+=String.fromCharCode(D),T):t(D)}function P(D){return D===62?(e.consume(D),i.interrupt?n:Y):t(D)}function M(D){return fn(D)?(e.consume(D),M):R(D)}function I(D){return D===47?(e.consume(D),R):D===58||D===95||Ur(D)?(e.consume(D),U):fn(D)?(e.consume(D),I):R(D)}function U(D){return D===45||D===46||D===58||D===95||Cr(D)?(e.consume(D),U):L(D)}function L(D){return D===61?(e.consume(D),$):fn(D)?(e.consume(D),L):I(D)}function $(D){return D===null||D===60||D===61||D===62||D===96?t(D):D===34||D===39?(e.consume(D),f=D,z):fn(D)?(e.consume(D),$):F(D)}function z(D){return D===f?(e.consume(D),f=null,Q):D===null||It(D)?t(D):(e.consume(D),z)}function F(D){return D===null||D===34||D===39||D===47||D===60||D===61||D===62||D===96||Jn(D)?L(D):(e.consume(D),F)}function Q(D){return D===47||D===62||fn(D)?I(D):t(D)}function R(D){return D===62?(e.consume(D),B):t(D)}function B(D){return D===null||It(D)?Y(D):fn(D)?(e.consume(D),B):t(D)}function Y(D){return D===45&&a===2?(e.consume(D),V):D===60&&a===1?(e.consume(D),W):D===62&&a===4?(e.consume(D),ce):D===63&&a===3?(e.consume(D),A):D===93&&a===5?(e.consume(D),he):It(D)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(d7,se,re)(D)):D===null||It(D)?(e.exit("htmlFlowData"),re(D)):(e.consume(D),Y)}function re(D){return e.check(f7,ne,se)(D)}function ne(D){return e.enter("lineEnding"),e.consume(D),e.exit("lineEnding"),G}function G(D){return D===null||It(D)?re(D):(e.enter("htmlFlowData"),Y(D))}function V(D){return D===45?(e.consume(D),A):Y(D)}function W(D){return D===47?(e.consume(D),l="",J):Y(D)}function J(D){if(D===62){const oe=l.toLowerCase();return pj.includes(oe)?(e.consume(D),ce):Y(D)}return Ur(D)&&l.length<8?(e.consume(D),l+=String.fromCharCode(D),J):Y(D)}function he(D){return D===93?(e.consume(D),A):Y(D)}function A(D){return D===62?(e.consume(D),ce):D===45&&a===2?(e.consume(D),A):Y(D)}function ce(D){return D===null||It(D)?(e.exit("htmlFlowData"),se(D)):(e.consume(D),ce)}function se(D){return e.exit("htmlFlow"),n(D)}}function m7(e,n,t){const i=this;return a;function a(l){return It(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o):t(l)}function o(l){return i.parser.lazy[i.now().line]?t(l):n(l)}}function g7(e,n,t){return i;function i(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(cg,n,t)}}const y7={name:"htmlText",tokenize:x7};function x7(e,n,t){const i=this;let a,o,l;return d;function d(A){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(A),f}function f(A){return A===33?(e.consume(A),u):A===47?(e.consume(A),L):A===63?(e.consume(A),I):Ur(A)?(e.consume(A),F):t(A)}function u(A){return A===45?(e.consume(A),p):A===91?(e.consume(A),o=0,S):Ur(A)?(e.consume(A),M):t(A)}function p(A){return A===45?(e.consume(A),v):t(A)}function g(A){return A===null?t(A):A===45?(e.consume(A),b):It(A)?(l=g,W(A)):(e.consume(A),g)}function b(A){return A===45?(e.consume(A),v):g(A)}function v(A){return A===62?V(A):A===45?b(A):g(A)}function S(A){const ce="CDATA[";return A===ce.charCodeAt(o++)?(e.consume(A),o===ce.length?k:S):t(A)}function k(A){return A===null?t(A):A===93?(e.consume(A),T):It(A)?(l=k,W(A)):(e.consume(A),k)}function T(A){return A===93?(e.consume(A),P):k(A)}function P(A){return A===62?V(A):A===93?(e.consume(A),P):k(A)}function M(A){return A===null||A===62?V(A):It(A)?(l=M,W(A)):(e.consume(A),M)}function I(A){return A===null?t(A):A===63?(e.consume(A),U):It(A)?(l=I,W(A)):(e.consume(A),I)}function U(A){return A===62?V(A):I(A)}function L(A){return Ur(A)?(e.consume(A),$):t(A)}function $(A){return A===45||Cr(A)?(e.consume(A),$):z(A)}function z(A){return It(A)?(l=z,W(A)):fn(A)?(e.consume(A),z):V(A)}function F(A){return A===45||Cr(A)?(e.consume(A),F):A===47||A===62||Jn(A)?Q(A):t(A)}function Q(A){return A===47?(e.consume(A),V):A===58||A===95||Ur(A)?(e.consume(A),R):It(A)?(l=Q,W(A)):fn(A)?(e.consume(A),Q):V(A)}function R(A){return A===45||A===46||A===58||A===95||Cr(A)?(e.consume(A),R):B(A)}function B(A){return A===61?(e.consume(A),Y):It(A)?(l=B,W(A)):fn(A)?(e.consume(A),B):Q(A)}function Y(A){return A===null||A===60||A===61||A===62||A===96?t(A):A===34||A===39?(e.consume(A),a=A,re):It(A)?(l=Y,W(A)):fn(A)?(e.consume(A),Y):(e.consume(A),ne)}function re(A){return A===a?(e.consume(A),a=void 0,G):A===null?t(A):It(A)?(l=re,W(A)):(e.consume(A),re)}function ne(A){return A===null||A===34||A===39||A===60||A===61||A===96?t(A):A===47||A===62||Jn(A)?Q(A):(e.consume(A),ne)}function G(A){return A===47||A===62||Jn(A)?Q(A):t(A)}function V(A){return A===62?(e.consume(A),e.exit("htmlTextData"),e.exit("htmlText"),n):t(A)}function W(A){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(A),e.exit("lineEnding"),J}function J(A){return fn(A)?wn(e,he,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(A):he(A)}function he(A){return e.enter("htmlTextData"),l(A)}}const Mw={name:"labelEnd",resolveAll:S7,resolveTo:N7,tokenize:C7},b7={tokenize:j7},v7={tokenize:_7},w7={tokenize:k7};function S7(e){let n=-1;const t=[];for(;++n<e.length;){const i=e[n][1];if(t.push(e[n]),i.type==="labelImage"||i.type==="labelLink"||i.type==="labelEnd"){const a=i.type==="labelImage"?4:2;i.type="data",n+=a}}return e.length!==t.length&&Ia(e,0,e.length,t),e}function N7(e,n){let t=e.length,i=0,a,o,l,d;for(;t--;)if(a=e[t][1],o){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(o=t,a.type!=="labelLink")){i=2;break}}else a.type==="labelEnd"&&(l=t);const f={type:e[o][1].type==="labelLink"?"link":"image",start:{...e[o][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[o][1].start},end:{...e[l][1].end}},p={type:"labelText",start:{...e[o+i+2][1].end},end:{...e[l-2][1].start}};return d=[["enter",f,n],["enter",u,n]],d=rs(d,e.slice(o+1,o+i+3)),d=rs(d,[["enter",p,n]]),d=rs(d,zb(n.parser.constructs.insideSpan.null,e.slice(o+i+4,l-3),n)),d=rs(d,[["exit",p,n],e[l-2],e[l-1],["exit",u,n]]),d=rs(d,e.slice(l+1)),d=rs(d,[["exit",f,n]]),Ia(e,o,e.length,d),e}function C7(e,n,t){const i=this;let a=i.events.length,o,l;for(;a--;)if((i.events[a][1].type==="labelImage"||i.events[a][1].type==="labelLink")&&!i.events[a][1]._balanced){o=i.events[a][1];break}return d;function d(b){return o?o._inactive?g(b):(l=i.parser.defined.includes(Us(i.sliceSerialize({start:o.end,end:i.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),f):t(b)}function f(b){return b===40?e.attempt(b7,p,l?p:g)(b):b===91?e.attempt(v7,p,l?u:g)(b):l?p(b):g(b)}function u(b){return e.attempt(w7,p,g)(b)}function p(b){return n(b)}function g(b){return o._balanced=!0,t(b)}}function j7(e,n,t){return i;function i(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return Jn(g)?zm(e,o)(g):o(g)}function o(g){return g===41?p(g):kT(e,l,d,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function l(g){return Jn(g)?zm(e,f)(g):p(g)}function d(g){return t(g)}function f(g){return g===34||g===39||g===40?ET(e,u,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):p(g)}function u(g){return Jn(g)?zm(e,p)(g):p(g)}function p(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function _7(e,n,t){const i=this;return a;function a(d){return TT.call(i,e,o,l,"reference","referenceMarker","referenceString")(d)}function o(d){return i.parser.defined.includes(Us(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)))?n(d):t(d)}function l(d){return t(d)}}function k7(e,n,t){return i;function i(o){return e.enter("reference"),e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),a}function a(o){return o===93?(e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),e.exit("reference"),n):t(o)}}const T7={name:"labelStartImage",resolveAll:Mw.resolveAll,tokenize:E7};function E7(e,n,t){const i=this;return a;function a(d){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(d),e.exit("labelImageMarker"),o}function o(d){return d===91?(e.enter("labelMarker"),e.consume(d),e.exit("labelMarker"),e.exit("labelImage"),l):t(d)}function l(d){return d===94&&"_hiddenFootnoteSupport"in i.parser.constructs?t(d):n(d)}}const A7={name:"labelStartLink",resolveAll:Mw.resolveAll,tokenize:P7};function P7(e,n,t){const i=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),o}function o(l){return l===94&&"_hiddenFootnoteSupport"in i.parser.constructs?t(l):n(l)}}const x0={name:"lineEnding",tokenize:D7};function D7(e,n){return t;function t(i){return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),wn(e,n,"linePrefix")}}const Bx={name:"thematicBreak",tokenize:I7};function I7(e,n,t){let i=0,a;return o;function o(u){return e.enter("thematicBreak"),l(u)}function l(u){return a=u,d(u)}function d(u){return u===a?(e.enter("thematicBreakSequence"),f(u)):i>=3&&(u===null||It(u))?(e.exit("thematicBreak"),n(u)):t(u)}function f(u){return u===a?(e.consume(u),i++,f):(e.exit("thematicBreakSequence"),fn(u)?wn(e,d,"whitespace")(u):d(u))}}const ra={continuation:{tokenize:L7},exit:$7,name:"list",tokenize:O7},R7={partial:!0,tokenize:z7},M7={partial:!0,tokenize:F7};function O7(e,n,t){const i=this,a=i.events[i.events.length-1];let o=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return d;function d(v){const S=i.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!i.containerState.marker||v===i.containerState.marker:A1(v)){if(i.containerState.type||(i.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(Bx,t,u)(v):u(v);if(!i.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),f(v)}return t(v)}function f(v){return A1(v)&&++l<10?(e.consume(v),f):(!i.interrupt||l<2)&&(i.containerState.marker?v===i.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),u(v)):t(v)}function u(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),i.containerState.marker=i.containerState.marker||v,e.check(cg,i.interrupt?t:p,e.attempt(R7,b,g))}function p(v){return i.containerState.initialBlankLine=!0,o++,b(v)}function g(v){return fn(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return i.containerState.size=o+i.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function L7(e,n,t){const i=this;return i.containerState._closeFlow=void 0,e.check(cg,a,o);function a(d){return i.containerState.furtherBlankLines=i.containerState.furtherBlankLines||i.containerState.initialBlankLine,wn(e,n,"listItemIndent",i.containerState.size+1)(d)}function o(d){return i.containerState.furtherBlankLines||!fn(d)?(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,l(d)):(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,e.attempt(M7,n,l)(d))}function l(d){return i.containerState._closeFlow=!0,i.interrupt=void 0,wn(e,e.attempt(ra,n,t),"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(d)}}function F7(e,n,t){const i=this;return wn(e,a,"listItemIndent",i.containerState.size+1);function a(o){const l=i.events[i.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===i.containerState.size?n(o):t(o)}}function $7(e){e.exit(this.containerState.type)}function z7(e,n,t){const i=this;return wn(e,a,"listItemPrefixWhitespace",i.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(o){const l=i.events[i.events.length-1];return!fn(o)&&l&&l[1].type==="listItemPrefixWhitespace"?n(o):t(o)}}const mj={name:"setextUnderline",resolveTo:U7,tokenize:B7};function U7(e,n){let t=e.length,i,a,o;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){i=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!o&&e[t][1].type==="definition"&&(o=t);const l={type:"setextHeading",start:{...e[i][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",o?(e.splice(a,0,["enter",l,n]),e.splice(o+1,0,["exit",e[i][1],n]),e[i][1].end={...e[o][1].end}):e[i][1]=l,e.push(["exit",l,n]),e}function B7(e,n,t){const i=this;let a;return o;function o(u){let p=i.events.length,g;for(;p--;)if(i.events[p][1].type!=="lineEnding"&&i.events[p][1].type!=="linePrefix"&&i.events[p][1].type!=="content"){g=i.events[p][1].type==="paragraph";break}return!i.parser.lazy[i.now().line]&&(i.interrupt||g)?(e.enter("setextHeadingLine"),a=u,l(u)):t(u)}function l(u){return e.enter("setextHeadingLineSequence"),d(u)}function d(u){return u===a?(e.consume(u),d):(e.exit("setextHeadingLineSequence"),fn(u)?wn(e,f,"lineSuffix")(u):f(u))}function f(u){return u===null||It(u)?(e.exit("setextHeadingLine"),n(u)):t(u)}}const q7={tokenize:V7};function V7(e){const n=this,t=e.attempt(cg,i,e.attempt(this.parser.constructs.flowInitial,a,wn(e,e.attempt(this.parser.constructs.flow,a,e.attempt(Qq,a)),"linePrefix")));return t;function i(o){if(o===null){e.consume(o);return}return e.enter("lineEndingBlank"),e.consume(o),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const H7={resolveAll:PT()},G7=AT("string"),Y7=AT("text");function AT(e){return{resolveAll:PT(e==="text"?W7:void 0),tokenize:n};function n(t){const i=this,a=this.parser.constructs[e],o=t.attempt(a,l,d);return l;function l(p){return u(p)?o(p):d(p)}function d(p){if(p===null){t.consume(p);return}return t.enter("data"),t.consume(p),f}function f(p){return u(p)?(t.exit("data"),o(p)):(t.consume(p),f)}function u(p){if(p===null)return!0;const g=a[p];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(i,i.previous))return!0}return!1}}}function PT(e){return n;function n(t,i){let a=-1,o;for(;++a<=t.length;)o===void 0?t[a]&&t[a][1].type==="data"&&(o=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==o+2&&(t[o][1].end=t[a-1][1].end,t.splice(o+2,a-o-2),a=o+2),o=void 0);return e?e(t,i):t}}function W7(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const i=e[t-1][1],a=n.sliceStream(i);let o=a.length,l=-1,d=0,f;for(;o--;){const u=a[o];if(typeof u=="string"){for(l=u.length;u.charCodeAt(l-1)===32;)d++,l--;if(l)break;l=-1}else if(u===-2)f=!0,d++;else if(u!==-1){o++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(d=0),d){const u={type:t===e.length||f||d<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?l:i.start._bufferIndex+l,_index:i.start._index+o,line:i.end.line,column:i.end.column-d,offset:i.end.offset-d},end:{...i.end}};i.end={...u.start},i.start.offset===i.end.offset?Object.assign(i,u):(e.splice(t,0,["enter",u,n],["exit",u,n]),t+=2)}t++}return e}const Q7={42:ra,43:ra,45:ra,48:ra,49:ra,50:ra,51:ra,52:ra,53:ra,54:ra,55:ra,56:ra,57:ra,62:NT},J7={91:e7},K7={[-2]:y0,[-1]:y0,32:y0},X7={35:s7,42:Bx,45:[mj,Bx],60:u7,61:mj,95:Bx,96:hj,126:hj},Z7={38:jT,92:CT},eV={[-5]:x0,[-4]:x0,[-3]:x0,33:T7,38:jT,42:P1,60:[Aq,y7],91:A7,92:[r7,CT],93:Mw,95:P1,96:qq},tV={null:[P1,H7]},nV={null:[42,95]},iV={null:[]},rV=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:nV,contentInitial:J7,disable:iV,document:Q7,flow:X7,flowInitial:K7,insideSpan:tV,string:Z7,text:eV},Symbol.toStringTag,{value:"Module"}));function aV(e,n,t){let i={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},o=[];let l=[],d=[];const f={attempt:z(L),check:z($),consume:M,enter:I,exit:U,interrupt:z($,{interrupt:!0})},u={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let p=n.tokenize.call(u,f);return n.resolveAll&&o.push(n),u;function g(B){return l=rs(l,B),T(),l[l.length-1]!==null?[]:(F(n,0),u.events=zb(o,u.events,u),u.events)}function b(B,Y){return oV(v(B),Y)}function v(B){return sV(l,B)}function S(){const{_bufferIndex:B,_index:Y,line:re,column:ne,offset:G}=i;return{_bufferIndex:B,_index:Y,line:re,column:ne,offset:G}}function k(B){a[B.line]=B.column,R()}function T(){let B;for(;i._index<l.length;){const Y=l[i._index];if(typeof Y=="string")for(B=i._index,i._bufferIndex<0&&(i._bufferIndex=0);i._index===B&&i._bufferIndex<Y.length;)P(Y.charCodeAt(i._bufferIndex));else P(Y)}}function P(B){p=p(B)}function M(B){It(B)?(i.line++,i.column=1,i.offset+=B===-3?2:1,R()):B!==-1&&(i.column++,i.offset++),i._bufferIndex<0?i._index++:(i._bufferIndex++,i._bufferIndex===l[i._index].length&&(i._bufferIndex=-1,i._index++)),u.previous=B}function I(B,Y){const re=Y||{};return re.type=B,re.start=S(),u.events.push(["enter",re,u]),d.push(re),re}function U(B){const Y=d.pop();return Y.end=S(),u.events.push(["exit",Y,u]),Y}function L(B,Y){F(B,Y.from)}function $(B,Y){Y.restore()}function z(B,Y){return re;function re(ne,G,V){let W,J,he,A;return Array.isArray(ne)?se(ne):"tokenize"in ne?se([ne]):ce(ne);function ce(Z){return ue;function ue(ae){const Re=ae!==null&&Z[ae],Ae=ae!==null&&Z.null,Ce=[...Array.isArray(Re)?Re:Re?[Re]:[],...Array.isArray(Ae)?Ae:Ae?[Ae]:[]];return se(Ce)(ae)}}function se(Z){return W=Z,J=0,Z.length===0?V:D(Z[J])}function D(Z){return ue;function ue(ae){return A=Q(),he=Z,Z.partial||(u.currentConstruct=Z),Z.name&&u.parser.constructs.disable.null.includes(Z.name)?xe():Z.tokenize.call(Y?Object.assign(Object.create(u),Y):u,f,oe,xe)(ae)}}function oe(Z){return B(he,A),G}function xe(Z){return A.restore(),++J<W.length?D(W[J]):V}}}function F(B,Y){B.resolveAll&&!o.includes(B)&&o.push(B),B.resolve&&Ia(u.events,Y,u.events.length-Y,B.resolve(u.events.slice(Y),u)),B.resolveTo&&(u.events=B.resolveTo(u.events,u))}function Q(){const B=S(),Y=u.previous,re=u.currentConstruct,ne=u.events.length,G=Array.from(d);return{from:ne,restore:V};function V(){i=B,u.previous=Y,u.currentConstruct=re,u.events.length=ne,d=G,R()}}function R(){i.line in a&&i.column<2&&(i.column=a[i.line],i.offset+=a[i.line]-1)}}function sV(e,n){const t=n.start._index,i=n.start._bufferIndex,a=n.end._index,o=n.end._bufferIndex;let l;if(t===a)l=[e[t].slice(i,o)];else{if(l=e.slice(t,a),i>-1){const d=l[0];typeof d=="string"?l[0]=d.slice(i):l.shift()}o>0&&l.push(e[a].slice(0,o))}return l}function oV(e,n){let t=-1;const i=[];let a;for(;++t<e.length;){const o=e[t];let l;if(typeof o=="string")l=o;else switch(o){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=n?" ":"	";break}case-1:{if(!n&&a)continue;l=" ";break}default:l=String.fromCharCode(o)}a=o===-2,i.push(l)}return i.join("")}function lV(e){const i={constructs:wT([rV,...(e||{}).extensions||[]]),content:a(Nq),defined:[],document:a(jq),flow:a(q7),lazy:{},string:a(G7),text:a(Y7)};return i;function a(o){return l;function l(d){return aV(i,o,d)}}}function cV(e){for(;!_T(e););return e}const gj=/[\0\t\n\r]/g;function uV(){let e=1,n="",t=!0,i;return a;function a(o,l,d){const f=[];let u,p,g,b,v;for(o=n+(typeof o=="string"?o.toString():new TextDecoder(l||void 0).decode(o)),g=0,n="",t&&(o.charCodeAt(0)===65279&&g++,t=void 0);g<o.length;){if(gj.lastIndex=g,u=gj.exec(o),b=u&&u.index!==void 0?u.index:o.length,v=o.charCodeAt(b),!u){n=o.slice(g);break}if(v===10&&g===b&&i)f.push(-3),i=void 0;else switch(i&&(f.push(-5),i=void 0),g<b&&(f.push(o.slice(g,b)),e+=b-g),v){case 0:{f.push(65533),e++;break}case 9:{for(p=Math.ceil(e/4)*4,f.push(-2);e++<p;)f.push(-1);break}case 10:{f.push(-4),e=1;break}default:i=!0,e=1}g=b+1}return d&&(i&&f.push(-5),n&&f.push(n),f.push(null)),f}}const dV=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function fV(e){return e.replace(dV,hV)}function hV(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),o=a===120||a===88;return ST(t.slice(o?2:1),o?16:10)}return Rw(t)||e}const DT={}.hasOwnProperty;function pV(e,n,t){return typeof n!="string"&&(t=n,n=void 0),mV(t)(cV(lV(t).document().write(uV()(e,n,!0))))}function mV(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(qt),autolinkProtocol:Q,autolinkEmail:Q,atxHeading:o(et),blockQuote:o(Ae),characterEscape:Q,characterReference:Q,codeFenced:o(Ce),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:o(Ce,l),codeText:o(Se,l),codeTextData:Q,data:Q,codeFlowValue:Q,definition:o(De),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:o(Me),hardBreakEscape:o(ct),hardBreakTrailing:o(ct),htmlFlow:o(ut,l),htmlFlowData:Q,htmlText:o(ut,l),htmlTextData:Q,image:o(at),label:l,link:o(qt),listItem:o(_e),listItemValue:b,listOrdered:o(jt,g),listUnordered:o(jt),paragraph:o(Fe),reference:D,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:o(et),strong:o(Pe),thematicBreak:o(ve)},exit:{atxHeading:f(),atxHeadingSequence:L,autolink:f(),autolinkEmail:Re,autolinkProtocol:ae,blockQuote:f(),characterEscapeValue:R,characterReferenceMarkerHexadecimal:xe,characterReferenceMarkerNumeric:xe,characterReferenceValue:Z,characterReference:ue,codeFenced:f(T),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:R,codeIndented:f(P),codeText:f(G),codeTextData:R,data:R,definition:f(),definitionDestinationString:U,definitionLabelString:M,definitionTitleString:I,emphasis:f(),hardBreakEscape:f(Y),hardBreakTrailing:f(Y),htmlFlow:f(re),htmlFlowData:R,htmlText:f(ne),htmlTextData:R,image:f(W),label:he,labelText:J,lineEnding:B,link:f(V),listItem:f(),listOrdered:f(),listUnordered:f(),paragraph:f(),referenceString:oe,resourceDestinationString:A,resourceTitleString:ce,resource:se,setextHeading:f(F),setextHeadingLineSequence:z,setextHeadingText:$,strong:f(),thematicBreak:f()}};IT(n,(e||{}).mdastExtensions||[]);const t={};return i;function i(ee){let fe={type:"root",children:[]};const qe={stack:[fe],tokenStack:[],config:n,enter:d,exit:u,buffer:l,resume:p,data:t},nt=[];let lt=-1;for(;++lt<ee.length;)if(ee[lt][1].type==="listOrdered"||ee[lt][1].type==="listUnordered")if(ee[lt][0]==="enter")nt.push(lt);else{const wt=nt.pop();lt=a(ee,wt,lt)}for(lt=-1;++lt<ee.length;){const wt=n[ee[lt][0]];DT.call(wt,ee[lt][1].type)&&wt[ee[lt][1].type].call(Object.assign({sliceSerialize:ee[lt][2].sliceSerialize},qe),ee[lt][1])}if(qe.tokenStack.length>0){const wt=qe.tokenStack[qe.tokenStack.length-1];(wt[1]||yj).call(qe,void 0,wt[0])}for(fe.position={start:tu(ee.length>0?ee[0][1].start:{line:1,column:1,offset:0}),end:tu(ee.length>0?ee[ee.length-2][1].end:{line:1,column:1,offset:0})},lt=-1;++lt<n.transforms.length;)fe=n.transforms[lt](fe)||fe;return fe}function a(ee,fe,qe){let nt=fe-1,lt=-1,wt=!1,Ve,be,ye,Oe;for(;++nt<=qe;){const He=ee[nt];switch(He[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{He[0]==="enter"?lt++:lt--,Oe=void 0;break}case"lineEndingBlank":{He[0]==="enter"&&(Ve&&!Oe&&!lt&&!ye&&(ye=nt),Oe=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Oe=void 0}if(!lt&&He[0]==="enter"&&He[1].type==="listItemPrefix"||lt===-1&&He[0]==="exit"&&(He[1].type==="listUnordered"||He[1].type==="listOrdered")){if(Ve){let tt=nt;for(be=void 0;tt--;){const rt=ee[tt];if(rt[1].type==="lineEnding"||rt[1].type==="lineEndingBlank"){if(rt[0]==="exit")continue;be&&(ee[be][1].type="lineEndingBlank",wt=!0),rt[1].type="lineEnding",be=tt}else if(!(rt[1].type==="linePrefix"||rt[1].type==="blockQuotePrefix"||rt[1].type==="blockQuotePrefixWhitespace"||rt[1].type==="blockQuoteMarker"||rt[1].type==="listItemIndent"))break}ye&&(!be||ye<be)&&(Ve._spread=!0),Ve.end=Object.assign({},be?ee[be][1].start:He[1].end),ee.splice(be||nt,0,["exit",Ve,He[2]]),nt++,qe++}if(He[1].type==="listItemPrefix"){const tt={type:"listItem",_spread:!1,start:Object.assign({},He[1].start),end:void 0};Ve=tt,ee.splice(nt,0,["enter",tt,He[2]]),nt++,qe++,ye=void 0,Oe=!0}}}return ee[fe][1]._spread=wt,qe}function o(ee,fe){return qe;function qe(nt){d.call(this,ee(nt),nt),fe&&fe.call(this,nt)}}function l(){this.stack.push({type:"fragment",children:[]})}function d(ee,fe,qe){this.stack[this.stack.length-1].children.push(ee),this.stack.push(ee),this.tokenStack.push([fe,qe||void 0]),ee.position={start:tu(fe.start),end:void 0}}function f(ee){return fe;function fe(qe){ee&&ee.call(this,qe),u.call(this,qe)}}function u(ee,fe){const qe=this.stack.pop(),nt=this.tokenStack.pop();if(nt)nt[0].type!==ee.type&&(fe?fe.call(this,ee,nt[0]):(nt[1]||yj).call(this,ee,nt[0]));else throw new Error("Cannot close `"+ee.type+"` ("+$m({start:ee.start,end:ee.end})+"): its not open");qe.position.end=tu(ee.end)}function p(){return Iw(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(ee){if(this.data.expectingFirstListItemValue){const fe=this.stack[this.stack.length-2];fe.start=Number.parseInt(this.sliceSerialize(ee),10),this.data.expectingFirstListItemValue=void 0}}function v(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.lang=ee}function S(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.meta=ee}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.value=ee.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function P(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.value=ee.replace(/(\r?\n|\r)$/g,"")}function M(ee){const fe=this.resume(),qe=this.stack[this.stack.length-1];qe.label=fe,qe.identifier=Us(this.sliceSerialize(ee)).toLowerCase()}function I(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.title=ee}function U(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.url=ee}function L(ee){const fe=this.stack[this.stack.length-1];if(!fe.depth){const qe=this.sliceSerialize(ee).length;fe.depth=qe}}function $(){this.data.setextHeadingSlurpLineEnding=!0}function z(ee){const fe=this.stack[this.stack.length-1];fe.depth=this.sliceSerialize(ee).codePointAt(0)===61?1:2}function F(){this.data.setextHeadingSlurpLineEnding=void 0}function Q(ee){const qe=this.stack[this.stack.length-1].children;let nt=qe[qe.length-1];(!nt||nt.type!=="text")&&(nt=Ue(),nt.position={start:tu(ee.start),end:void 0},qe.push(nt)),this.stack.push(nt)}function R(ee){const fe=this.stack.pop();fe.value+=this.sliceSerialize(ee),fe.position.end=tu(ee.end)}function B(ee){const fe=this.stack[this.stack.length-1];if(this.data.atHardBreak){const qe=fe.children[fe.children.length-1];qe.position.end=tu(ee.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(fe.type)&&(Q.call(this,ee),R.call(this,ee))}function Y(){this.data.atHardBreak=!0}function re(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.value=ee}function ne(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.value=ee}function G(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.value=ee}function V(){const ee=this.stack[this.stack.length-1];if(this.data.inReference){const fe=this.data.referenceType||"shortcut";ee.type+="Reference",ee.referenceType=fe,delete ee.url,delete ee.title}else delete ee.identifier,delete ee.label;this.data.referenceType=void 0}function W(){const ee=this.stack[this.stack.length-1];if(this.data.inReference){const fe=this.data.referenceType||"shortcut";ee.type+="Reference",ee.referenceType=fe,delete ee.url,delete ee.title}else delete ee.identifier,delete ee.label;this.data.referenceType=void 0}function J(ee){const fe=this.sliceSerialize(ee),qe=this.stack[this.stack.length-2];qe.label=fV(fe),qe.identifier=Us(fe).toLowerCase()}function he(){const ee=this.stack[this.stack.length-1],fe=this.resume(),qe=this.stack[this.stack.length-1];if(this.data.inReference=!0,qe.type==="link"){const nt=ee.children;qe.children=nt}else qe.alt=fe}function A(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.url=ee}function ce(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.title=ee}function se(){this.data.inReference=void 0}function D(){this.data.referenceType="collapsed"}function oe(ee){const fe=this.resume(),qe=this.stack[this.stack.length-1];qe.label=fe,qe.identifier=Us(this.sliceSerialize(ee)).toLowerCase(),this.data.referenceType="full"}function xe(ee){this.data.characterReferenceType=ee.type}function Z(ee){const fe=this.sliceSerialize(ee),qe=this.data.characterReferenceType;let nt;qe?(nt=ST(fe,qe==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):nt=Rw(fe);const lt=this.stack[this.stack.length-1];lt.value+=nt}function ue(ee){const fe=this.stack.pop();fe.position.end=tu(ee.end)}function ae(ee){R.call(this,ee);const fe=this.stack[this.stack.length-1];fe.url=this.sliceSerialize(ee)}function Re(ee){R.call(this,ee);const fe=this.stack[this.stack.length-1];fe.url="mailto:"+this.sliceSerialize(ee)}function Ae(){return{type:"blockquote",children:[]}}function Ce(){return{type:"code",lang:null,meta:null,value:""}}function Se(){return{type:"inlineCode",value:""}}function De(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Me(){return{type:"emphasis",children:[]}}function et(){return{type:"heading",depth:0,children:[]}}function ct(){return{type:"break"}}function ut(){return{type:"html",value:""}}function at(){return{type:"image",title:null,url:"",alt:null}}function qt(){return{type:"link",title:null,url:"",children:[]}}function jt(ee){return{type:"list",ordered:ee.type==="listOrdered",start:null,spread:ee._spread,children:[]}}function _e(ee){return{type:"listItem",spread:ee._spread,checked:null,children:[]}}function Fe(){return{type:"paragraph",children:[]}}function Pe(){return{type:"strong",children:[]}}function Ue(){return{type:"text",value:""}}function ve(){return{type:"thematicBreak"}}}function tu(e){return{line:e.line,column:e.column,offset:e.offset}}function IT(e,n){let t=-1;for(;++t<n.length;){const i=n[t];Array.isArray(i)?IT(e,i):gV(e,i)}}function gV(e,n){let t;for(t in n)if(DT.call(n,t))switch(t){case"canContainEols":{const i=n[t];i&&e[t].push(...i);break}case"transforms":{const i=n[t];i&&e[t].push(...i);break}case"enter":case"exit":{const i=n[t];i&&Object.assign(e[t],i);break}}}function yj(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+$m({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+$m({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+$m({start:n.start,end:n.end})+") is still open")}function yV(e){const n=this;n.parser=t;function t(i){return pV(i,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}function xV(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function bV(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function vV(e,n){const t=n.value?n.value+`
`:"",i={};n.lang&&(i.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:i,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function wV(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function SV(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function NV(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",i=String(n.identifier).toUpperCase(),a=Gh(i.toLowerCase()),o=e.footnoteOrder.indexOf(i);let l,d=e.footnoteCounts.get(i);d===void 0?(d=0,e.footnoteOrder.push(i),l=e.footnoteOrder.length):l=o+1,d+=1,e.footnoteCounts.set(i,d);const f={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(d>1?"-"+d:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(n,f);const u={type:"element",tagName:"sup",properties:{},children:[f]};return e.patch(n,u),e.applyData(n,u)}function CV(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function jV(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function RT(e,n){const t=n.referenceType;let i="]";if(t==="collapsed"?i+="[]":t==="full"&&(i+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+i}];const a=e.all(n),o=a[0];o&&o.type==="text"?o.value="["+o.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=i:a.push({type:"text",value:i}),a}function _V(e,n){const t=String(n.identifier).toUpperCase(),i=e.definitionById.get(t);if(!i)return RT(e,n);const a={src:Gh(i.url||""),alt:n.alt};i.title!==null&&i.title!==void 0&&(a.title=i.title);const o={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,o),e.applyData(n,o)}function kV(e,n){const t={src:Gh(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const i={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,i),e.applyData(n,i)}function TV(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const i={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,i),e.applyData(n,i)}function EV(e,n){const t=String(n.identifier).toUpperCase(),i=e.definitionById.get(t);if(!i)return RT(e,n);const a={href:Gh(i.url||"")};i.title!==null&&i.title!==void 0&&(a.title=i.title);const o={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,o),e.applyData(n,o)}function AV(e,n){const t={href:Gh(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const i={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,i),e.applyData(n,i)}function PV(e,n,t){const i=e.all(n),a=t?DV(t):MT(n),o={},l=[];if(typeof n.checked=="boolean"){const p=i[0];let g;p&&p.type==="element"&&p.tagName==="p"?g=p:(g={type:"element",tagName:"p",properties:{},children:[]},i.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let d=-1;for(;++d<i.length;){const p=i[d];(a||d!==0||p.type!=="element"||p.tagName!=="p")&&l.push({type:"text",value:`
`}),p.type==="element"&&p.tagName==="p"&&!a?l.push(...p.children):l.push(p)}const f=i[i.length-1];f&&(a||f.type!=="element"||f.tagName!=="p")&&l.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:o,children:l};return e.patch(n,u),e.applyData(n,u)}function DV(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let i=-1;for(;!n&&++i<t.length;)n=MT(t[i])}return n}function MT(e){const n=e.spread;return n??e.children.length>1}function IV(e,n){const t={},i=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<i.length;){const l=i[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const o={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(i,!0)};return e.patch(n,o),e.applyData(n,o)}function RV(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function MV(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function OV(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function LV(e,n){const t=e.all(n),i=t.shift(),a=[];if(i){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([i],!0)};e.patch(n.children[0],l),a.push(l)}if(t.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},d=Ew(n.children[1]),f=pT(n.children[n.children.length-1]);d&&f&&(l.position={start:d,end:f}),a.push(l)}const o={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,o),e.applyData(n,o)}function FV(e,n,t){const i=t?t.children:void 0,o=(i?i.indexOf(n):1)===0?"th":"td",l=t&&t.type==="table"?t.align:void 0,d=l?l.length:n.children.length;let f=-1;const u=[];for(;++f<d;){const g=n.children[f],b={},v=l?l[f]:void 0;v&&(b.align=v);let S={type:"element",tagName:o,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),u.push(S)}const p={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(n,p),e.applyData(n,p)}function $V(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const xj=9,bj=32;function zV(e){const n=String(e),t=/\r?\n|\r/g;let i=t.exec(n),a=0;const o=[];for(;i;)o.push(vj(n.slice(a,i.index),a>0,!0),i[0]),a=i.index+i[0].length,i=t.exec(n);return o.push(vj(n.slice(a),a>0,!1)),o.join("")}function vj(e,n,t){let i=0,a=e.length;if(n){let o=e.codePointAt(i);for(;o===xj||o===bj;)i++,o=e.codePointAt(i)}if(t){let o=e.codePointAt(a-1);for(;o===xj||o===bj;)a--,o=e.codePointAt(a-1)}return a>i?e.slice(i,a):""}function UV(e,n){const t={type:"text",value:zV(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function BV(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const qV={blockquote:xV,break:bV,code:vV,delete:wV,emphasis:SV,footnoteReference:NV,heading:CV,html:jV,imageReference:_V,image:kV,inlineCode:TV,linkReference:EV,link:AV,listItem:PV,list:IV,paragraph:RV,root:MV,strong:OV,table:LV,tableCell:$V,tableRow:FV,text:UV,thematicBreak:BV,toml:vx,yaml:vx,definition:vx,footnoteDefinition:vx};function vx(){}const OT=-1,Ub=0,Um=1,fb=2,Ow=3,Lw=4,Fw=5,$w=6,LT=7,FT=8,wj=typeof self=="object"?self:globalThis,VV=(e,n)=>{const t=(a,o)=>(e.set(o,a),a),i=a=>{if(e.has(a))return e.get(a);const[o,l]=n[a];switch(o){case Ub:case OT:return t(l,a);case Um:{const d=t([],a);for(const f of l)d.push(i(f));return d}case fb:{const d=t({},a);for(const[f,u]of l)d[i(f)]=i(u);return d}case Ow:return t(new Date(l),a);case Lw:{const{source:d,flags:f}=l;return t(new RegExp(d,f),a)}case Fw:{const d=t(new Map,a);for(const[f,u]of l)d.set(i(f),i(u));return d}case $w:{const d=t(new Set,a);for(const f of l)d.add(i(f));return d}case LT:{const{name:d,message:f}=l;return t(new wj[d](f),a)}case FT:return t(BigInt(l),a);case"BigInt":return t(Object(BigInt(l)),a);case"ArrayBuffer":return t(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:d}=new Uint8Array(l);return t(new DataView(d),l)}}return t(new wj[o](l),a)};return i},Sj=e=>VV(new Map,e)(0),gh="",{toString:HV}={},{keys:GV}=Object,Rm=e=>{const n=typeof e;if(n!=="object"||!e)return[Ub,n];const t=HV.call(e).slice(8,-1);switch(t){case"Array":return[Um,gh];case"Object":return[fb,gh];case"Date":return[Ow,gh];case"RegExp":return[Lw,gh];case"Map":return[Fw,gh];case"Set":return[$w,gh];case"DataView":return[Um,t]}return t.includes("Array")?[Um,t]:t.includes("Error")?[LT,t]:[fb,t]},wx=([e,n])=>e===Ub&&(n==="function"||n==="symbol"),YV=(e,n,t,i)=>{const a=(l,d)=>{const f=i.push(l)-1;return t.set(d,f),f},o=l=>{if(t.has(l))return t.get(l);let[d,f]=Rm(l);switch(d){case Ub:{let p=l;switch(f){case"bigint":d=FT,p=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+f);p=null;break;case"undefined":return a([OT],l)}return a([d,p],l)}case Um:{if(f){let b=l;return f==="DataView"?b=new Uint8Array(l.buffer):f==="ArrayBuffer"&&(b=new Uint8Array(l)),a([f,[...b]],l)}const p=[],g=a([d,p],l);for(const b of l)p.push(o(b));return g}case fb:{if(f)switch(f){case"BigInt":return a([f,l.toString()],l);case"Boolean":case"Number":case"String":return a([f,l.valueOf()],l)}if(n&&"toJSON"in l)return o(l.toJSON());const p=[],g=a([d,p],l);for(const b of GV(l))(e||!wx(Rm(l[b])))&&p.push([o(b),o(l[b])]);return g}case Ow:return a([d,l.toISOString()],l);case Lw:{const{source:p,flags:g}=l;return a([d,{source:p,flags:g}],l)}case Fw:{const p=[],g=a([d,p],l);for(const[b,v]of l)(e||!(wx(Rm(b))||wx(Rm(v))))&&p.push([o(b),o(v)]);return g}case $w:{const p=[],g=a([d,p],l);for(const b of l)(e||!wx(Rm(b)))&&p.push(o(b));return g}}const{message:u}=l;return a([d,{name:f,message:u}],l)};return o},Nj=(e,{json:n,lossy:t}={})=>{const i=[];return YV(!(n||t),!!n,new Map,i)(e),i},hb=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?Sj(Nj(e,n)):structuredClone(e):(e,n)=>Sj(Nj(e,n));function WV(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function QV(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function JV(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||WV,i=e.options.footnoteBackLabel||QV,a=e.options.footnoteLabel||"Footnotes",o=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},d=[];let f=-1;for(;++f<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[f]);if(!u)continue;const p=e.all(u),g=String(u.identifier).toUpperCase(),b=Gh(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let M=typeof t=="string"?t:t(f,v);typeof M=="string"&&(M={type:"text",value:M}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof i=="string"?i:i(f,v),className:["data-footnote-backref"]},children:Array.isArray(M)?M:[M]})}const T=p[p.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const M=T.children[T.children.length-1];M&&M.type==="text"?M.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...S)}else p.push(...S);const P={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(p,!0)};e.patch(u,P),d.push(P)}if(d.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...hb(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(d,!0)},{type:"text",value:`
`}]}}const Bb=function(e){if(e==null)return eH;if(typeof e=="function")return qb(e);if(typeof e=="object")return Array.isArray(e)?KV(e):XV(e);if(typeof e=="string")return ZV(e);throw new Error("Expected function, string, or object as test")};function KV(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=Bb(e[t]);return qb(i);function i(...a){let o=-1;for(;++o<n.length;)if(n[o].apply(this,a))return!0;return!1}}function XV(e){const n=e;return qb(t);function t(i){const a=i;let o;for(o in e)if(a[o]!==n[o])return!1;return!0}}function ZV(e){return qb(n);function n(t){return t&&t.type===e}}function qb(e){return n;function n(t,i,a){return!!(tH(t)&&e.call(this,t,typeof i=="number"?i:void 0,a||void 0))}}function eH(){return!0}function tH(e){return e!==null&&typeof e=="object"&&"type"in e}const $T=[],nH=!0,D1=!1,iH="skip";function zT(e,n,t,i){let a;typeof n=="function"&&typeof t!="function"?(i=t,t=n):a=n;const o=Bb(a),l=i?-1:1;d(e,void 0,[])();function d(f,u,p){const g=f&&typeof f=="object"?f:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(f.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=$T,S,k,T;if((!n||o(f,u,p[p.length-1]||void 0))&&(v=rH(t(f,p)),v[0]===D1))return v;if("children"in f&&f.children){const P=f;if(P.children&&v[0]!==iH)for(k=(i?P.children.length:-1)+l,T=p.concat(P);k>-1&&k<P.children.length;){const M=P.children[k];if(S=d(M,k,T)(),S[0]===D1)return S;k=typeof S[1]=="number"?S[1]:k+l}}return v}}}function rH(e){return Array.isArray(e)?e:typeof e=="number"?[nH,e]:e==null?$T:[e]}function zw(e,n,t,i){let a,o,l;typeof n=="function"?(o=void 0,l=n,a=t):(o=n,l=t,a=i),zT(e,o,d,a);function d(f,u){const p=u[u.length-1],g=p?p.children.indexOf(f):void 0;return l(f,g,p)}}const I1={}.hasOwnProperty,aH={};function sH(e,n){const t=n||aH,i=new Map,a=new Map,o=new Map,l={...qV,...t.handlers},d={all:u,applyData:lH,definitionById:i,footnoteById:a,footnoteCounts:o,footnoteOrder:[],handlers:l,one:f,options:t,patch:oH,wrap:uH};return zw(e,function(p){if(p.type==="definition"||p.type==="footnoteDefinition"){const g=p.type==="definition"?i:a,b=String(p.identifier).toUpperCase();g.has(b)||g.set(b,p)}}),d;function f(p,g){const b=p.type,v=d.handlers[b];if(I1.call(d.handlers,b)&&v)return v(d,p,g);if(d.options.passThrough&&d.options.passThrough.includes(b)){if("children"in p){const{children:k,...T}=p,P=hb(T);return P.children=d.all(p),P}return hb(p)}return(d.options.unknownHandler||cH)(d,p,g)}function u(p){const g=[];if("children"in p){const b=p.children;let v=-1;for(;++v<b.length;){const S=d.one(b[v],p);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=Cj(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=Cj(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function oH(e,n){e.position&&(n.position=Q9(e))}function lH(e,n){let t=n;if(e&&e.data){const i=e.data.hName,a=e.data.hChildren,o=e.data.hProperties;if(typeof i=="string")if(t.type==="element")t.tagName=i;else{const l="children"in t?t.children:[t];t={type:"element",tagName:i,properties:{},children:l}}t.type==="element"&&o&&Object.assign(t.properties,hb(o)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function cH(e,n){const t=n.data||{},i="value"in n&&!(I1.call(t,"hProperties")||I1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,i),e.applyData(n,i)}function uH(e,n){const t=[];let i=-1;for(n&&t.push({type:"text",value:`
`});++i<e.length;)i&&t.push({type:"text",value:`
`}),t.push(e[i]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function Cj(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function jj(e,n){const t=sH(e,n),i=t.one(e,void 0),a=JV(t),o=Array.isArray(i)?{type:"root",children:i}:i||{type:"root",children:[]};return a&&o.children.push({type:"text",value:`
`},a),o}function dH(e,n){return e&&"run"in e?async function(t,i){const a=jj(t,{file:i,...n});await e.run(a,i)}:function(t,i){return jj(t,{file:i,...e||n})}}function _j(e){if(e)throw e}var b0,kj;function fH(){if(kj)return b0;kj=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,i=Object.getOwnPropertyDescriptor,a=function(u){return typeof Array.isArray=="function"?Array.isArray(u):n.call(u)==="[object Array]"},o=function(u){if(!u||n.call(u)!=="[object Object]")return!1;var p=e.call(u,"constructor"),g=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!p&&!g)return!1;var b;for(b in u);return typeof b>"u"||e.call(u,b)},l=function(u,p){t&&p.name==="__proto__"?t(u,p.name,{enumerable:!0,configurable:!0,value:p.newValue,writable:!0}):u[p.name]=p.newValue},d=function(u,p){if(p==="__proto__")if(e.call(u,p)){if(i)return i(u,p).value}else return;return u[p]};return b0=function f(){var u,p,g,b,v,S,k=arguments[0],T=1,P=arguments.length,M=!1;for(typeof k=="boolean"&&(M=k,k=arguments[1]||{},T=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});T<P;++T)if(u=arguments[T],u!=null)for(p in u)g=d(k,p),b=d(u,p),k!==b&&(M&&b&&(o(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&o(g)?g:{},l(k,{name:p,newValue:f(M,S,b)})):typeof b<"u"&&l(k,{name:p,newValue:b}));return k},b0}var hH=fH();const v0=Ud(hH);function R1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function pH(){const e=[],n={run:t,use:i};return n;function t(...a){let o=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);d(null,...a);function d(f,...u){const p=e[++o];let g=-1;if(f){l(f);return}for(;++g<a.length;)(u[g]===null||u[g]===void 0)&&(u[g]=a[g]);a=u,p?mH(p,d)(...u):l(null,...u)}}function i(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function mH(e,n){let t;return i;function i(...l){const d=e.length>l.length;let f;d&&l.push(a);try{f=e.apply(this,l)}catch(u){const p=u;if(d&&t)throw p;return a(p)}d||(f&&f.then&&typeof f.then=="function"?f.then(o,a):f instanceof Error?a(f):o(f))}function a(l,...d){t||(t=!0,n(l,...d))}function o(l){a(null,l)}}const Bo={basename:gH,dirname:yH,extname:xH,join:bH,sep:"/"};function gH(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');ug(e);let t=0,i=-1,a=e.length,o;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else i<0&&(o=!0,i=a+1);return i<0?"":e.slice(t,i)}if(n===e)return"";let l=-1,d=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else l<0&&(o=!0,l=a+1),d>-1&&(e.codePointAt(a)===n.codePointAt(d--)?d<0&&(i=a):(d=-1,i=l));return t===i?i=l:i<0&&(i=e.length),e.slice(t,i)}function yH(e){if(ug(e),e.length===0)return".";let n=-1,t=e.length,i;for(;--t;)if(e.codePointAt(t)===47){if(i){n=t;break}}else i||(i=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function xH(e){ug(e);let n=e.length,t=-1,i=0,a=-1,o=0,l;for(;n--;){const d=e.codePointAt(n);if(d===47){if(l){i=n+1;break}continue}t<0&&(l=!0,t=n+1),d===46?a<0?a=n:o!==1&&(o=1):a>-1&&(o=-1)}return a<0||t<0||o===0||o===1&&a===t-1&&a===i+1?"":e.slice(a,t)}function bH(...e){let n=-1,t;for(;++n<e.length;)ug(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":vH(t)}function vH(e){ug(e);const n=e.codePointAt(0)===47;let t=wH(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function wH(e,n){let t="",i=0,a=-1,o=0,l=-1,d,f;for(;++l<=e.length;){if(l<e.length)d=e.codePointAt(l);else{if(d===47)break;d=47}if(d===47){if(!(a===l-1||o===1))if(a!==l-1&&o===2){if(t.length<2||i!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(f=t.lastIndexOf("/"),f!==t.length-1){f<0?(t="",i=0):(t=t.slice(0,f),i=t.length-1-t.lastIndexOf("/")),a=l,o=0;continue}}else if(t.length>0){t="",i=0,a=l,o=0;continue}}n&&(t=t.length>0?t+"/..":"..",i=2)}else t.length>0?t+="/"+e.slice(a+1,l):t=e.slice(a+1,l),i=l-a-1;a=l,o=0}else d===46&&o>-1?o++:o=-1}return t}function ug(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const SH={cwd:NH};function NH(){return"/"}function M1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function CH(e){if(typeof e=="string")e=new URL(e);else if(!M1(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return jH(e)}function jH(e){if(e.hostname!==""){const i=new TypeError('File URL host must be "localhost" or empty on darwin');throw i.code="ERR_INVALID_FILE_URL_HOST",i}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const i=n.codePointAt(t+2);if(i===70||i===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const w0=["history","path","basename","stem","extname","dirname"];let UT=class{constructor(n){let t;n?M1(n)?t={path:n}:typeof n=="string"||_H(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":SH.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let i=-1;for(;++i<w0.length;){const o=w0[i];o in t&&t[o]!==void 0&&t[o]!==null&&(this[o]=o==="history"?[...t[o]]:t[o])}let a;for(a in t)w0.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?Bo.basename(this.path):void 0}set basename(n){N0(n,"basename"),S0(n,"basename"),this.path=Bo.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?Bo.dirname(this.path):void 0}set dirname(n){Tj(this.basename,"dirname"),this.path=Bo.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?Bo.extname(this.path):void 0}set extname(n){if(S0(n,"extname"),Tj(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Bo.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){M1(n)&&(n=CH(n)),N0(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?Bo.basename(this.path,this.extname):void 0}set stem(n){N0(n,"stem"),S0(n,"stem"),this.path=Bo.join(this.dirname||"",n+(this.extname||""))}fail(n,t,i){const a=this.message(n,t,i);throw a.fatal=!0,a}info(n,t,i){const a=this.message(n,t,i);return a.fatal=void 0,a}message(n,t,i){const a=new _r(n,t,i);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}};function S0(e,n){if(e&&e.includes(Bo.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+Bo.sep+"`")}function N0(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function Tj(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function _H(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const kH=function(e){const i=this.constructor.prototype,a=i[e],o=function(){return a.apply(o,arguments)};return Object.setPrototypeOf(o,i),o},TH={}.hasOwnProperty;let EH=class BT extends kH{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=pH()}copy(){const n=new BT;let t=-1;for(;++t<this.attachers.length;){const i=this.attachers[t];n.use(...i)}return n.data(v0(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(_0("data",this.frozen),this.namespace[n]=t,this):TH.call(this.namespace,n)&&this.namespace[n]||void 0:n?(_0("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...i]=this.attachers[this.freezeIndex];if(i[0]===!1)continue;i[0]===!0&&(i[0]=void 0);const a=t.call(n,...i);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=Sx(n),i=this.parser||this.Parser;return C0("parse",i),i(String(t),t)}process(n,t){const i=this;return this.freeze(),C0("process",this.parser||this.Parser),j0("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(o,l){const d=Sx(n),f=i.parse(d);i.run(f,d,function(p,g,b){if(p||!g||!b)return u(p);const v=g,S=i.stringify(v,b);DH(S)?b.value=S:b.result=S,u(p,b)});function u(p,g){p||!g?l(p):o?o(g):t(void 0,g)}}}processSync(n){let t=!1,i;return this.freeze(),C0("processSync",this.parser||this.Parser),j0("processSync",this.compiler||this.Compiler),this.process(n,a),Aj("processSync","process",t),i;function a(o,l){t=!0,_j(o),i=l}}run(n,t,i){Ej(n),this.freeze();const a=this.transformers;return!i&&typeof t=="function"&&(i=t,t=void 0),i?o(void 0,i):new Promise(o);function o(l,d){const f=Sx(t);a.run(n,f,u);function u(p,g,b){const v=g||n;p?d(p):l?l(v):i(void 0,v,b)}}}runSync(n,t){let i=!1,a;return this.run(n,t,o),Aj("runSync","run",i),a;function o(l,d){_j(l),a=d,i=!0}}stringify(n,t){this.freeze();const i=Sx(t),a=this.compiler||this.Compiler;return j0("stringify",a),Ej(n),a(n,i)}use(n,...t){const i=this.attachers,a=this.namespace;if(_0("use",this.frozen),n!=null)if(typeof n=="function")f(n,t);else if(typeof n=="object")Array.isArray(n)?d(n):l(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function o(u){if(typeof u=="function")f(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[p,...g]=u;f(p,g)}else l(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function l(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");d(u.plugins),u.settings&&(a.settings=v0(!0,a.settings,u.settings))}function d(u){let p=-1;if(u!=null)if(Array.isArray(u))for(;++p<u.length;){const g=u[p];o(g)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function f(u,p){let g=-1,b=-1;for(;++g<i.length;)if(i[g][0]===u){b=g;break}if(b===-1)i.push([u,...p]);else if(p.length>0){let[v,...S]=p;const k=i[b][1];R1(k)&&R1(v)&&(v=v0(!0,k,v)),i[b]=[u,v,...S]}}}};const AH=new EH().freeze();function C0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function j0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function _0(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function Ej(e){if(!R1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function Aj(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function Sx(e){return PH(e)?e:new UT(e)}function PH(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function DH(e){return typeof e=="string"||IH(e)}function IH(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const RH="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",Pj=[],Dj={allowDangerousHtml:!0},MH=/^(https?|ircs?|mailto|xmpp)$/i,OH=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Yo(e){const n=LH(e),t=FH(e);return $H(n.runSync(n.parse(t),t),e)}function LH(e){const n=e.rehypePlugins||Pj,t=e.remarkPlugins||Pj,i=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...Dj}:Dj;return AH().use(yV).use(t).use(dH,i).use(n)}function FH(e){const n=e.children||"",t=new UT;return typeof n=="string"&&(t.value=n),t}function $H(e,n){const t=n.allowedElements,i=n.allowElement,a=n.components,o=n.disallowedElements,l=n.skipHtml,d=n.unwrapDisallowed,f=n.urlTransform||zH;for(const p of OH)Object.hasOwn(n,p.from)&&(""+p.from+(p.to?"use `"+p.to+"` instead":"remove it")+RH+p.id,void 0);return zw(e,u),eq(e,{Fragment:r.Fragment,components:a,ignoreInvalidStyle:!0,jsx:r.jsx,jsxs:r.jsxs,passKeys:!0,passNode:!0});function u(p,g,b){if(p.type==="raw"&&b&&typeof g=="number")return l?b.children.splice(g,1):b.children[g]={type:"text",value:p.value},g;if(p.type==="element"){let v;for(v in g0)if(Object.hasOwn(g0,v)&&Object.hasOwn(p.properties,v)){const S=p.properties[v],k=g0[v];(k===null||k.includes(p.tagName))&&(p.properties[v]=f(String(S||""),v,p))}}if(p.type==="element"){let v=t?!t.includes(p.tagName):o?o.includes(p.tagName):!1;if(!v&&i&&typeof g=="number"&&(v=!i(p,g,b)),v&&b&&typeof g=="number")return d&&p.children?b.children.splice(g,1,...p.children):b.children.splice(g,1),g}}}function zH(e){const n=e.indexOf(":"),t=e.indexOf("?"),i=e.indexOf("#"),a=e.indexOf("/");return n===-1||a!==-1&&n>a||t!==-1&&n>t||i!==-1&&n>i||MH.test(e.slice(0,n))?e:""}function Ij(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let i=0,a=t.indexOf(n);for(;a!==-1;)i++,a=t.indexOf(n,a+n.length);return i}function UH(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function BH(e,n,t){const a=Bb((t||{}).ignore||[]),o=qH(n);let l=-1;for(;++l<o.length;)zT(e,"text",d);function d(u,p){let g=-1,b;for(;++g<p.length;){const v=p[g],S=b?b.children:void 0;if(a(v,S?S.indexOf(v):void 0,b))return;b=v}if(b)return f(u,p)}function f(u,p){const g=p[p.length-1],b=o[l][0],v=o[l][1];let S=0;const T=g.children.indexOf(u);let P=!1,M=[];b.lastIndex=0;let I=b.exec(u.value);for(;I;){const U=I.index,L={index:I.index,input:I.input,stack:[...p,u]};let $=v(...I,L);if(typeof $=="string"&&($=$.length>0?{type:"text",value:$}:void 0),$===!1?b.lastIndex=U+1:(S!==U&&M.push({type:"text",value:u.value.slice(S,U)}),Array.isArray($)?M.push(...$):$&&M.push($),S=U+I[0].length,P=!0),!b.global)break;I=b.exec(u.value)}return P?(S<u.value.length&&M.push({type:"text",value:u.value.slice(S)}),g.children.splice(T,1,...M)):M=[u],T+M.length}}function qH(e){const n=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const t=!e[0]||Array.isArray(e[0])?e:[e];let i=-1;for(;++i<t.length;){const a=t[i];n.push([VH(a[0]),HH(a[1])])}return n}function VH(e){return typeof e=="string"?new RegExp(UH(e),"g"):e}function HH(e){return typeof e=="function"?e:function(){return e}}const k0="phrasing",T0=["autolink","link","image","label"];function GH(){return{transforms:[ZH],enter:{literalAutolink:WH,literalAutolinkEmail:E0,literalAutolinkHttp:E0,literalAutolinkWww:E0},exit:{literalAutolink:XH,literalAutolinkEmail:KH,literalAutolinkHttp:QH,literalAutolinkWww:JH}}}function YH(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:k0,notInConstruct:T0},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:k0,notInConstruct:T0},{character:":",before:"[ps]",after:"\\/",inConstruct:k0,notInConstruct:T0}]}}function WH(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function E0(e){this.config.enter.autolinkProtocol.call(this,e)}function QH(e){this.config.exit.autolinkProtocol.call(this,e)}function JH(e){this.config.exit.data.call(this,e);const n=this.stack[this.stack.length-1];n.type,n.url="http://"+this.sliceSerialize(e)}function KH(e){this.config.exit.autolinkEmail.call(this,e)}function XH(e){this.exit(e)}function ZH(e){BH(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,eG],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),tG]],{ignore:["link","linkReference"]})}function eG(e,n,t,i,a){let o="";if(!qT(a)||(/^w/i.test(n)&&(t=n+t,n="",o="http://"),!nG(t)))return!1;const l=iG(t+i);if(!l[0])return!1;const d={type:"link",title:null,url:o+n+l[0],children:[{type:"text",value:n+l[0]}]};return l[1]?[d,{type:"text",value:l[1]}]:d}function tG(e,n,t,i){return!qT(i,!0)||/[-\d_]$/.test(t)?!1:{type:"link",title:null,url:"mailto:"+n+"@"+t,children:[{type:"text",value:n+"@"+t}]}}function nG(e){const n=e.split(".");return!(n.length<2||n[n.length-1]&&(/_/.test(n[n.length-1])||!/[a-zA-Z\d]/.test(n[n.length-1]))||n[n.length-2]&&(/_/.test(n[n.length-2])||!/[a-zA-Z\d]/.test(n[n.length-2])))}function iG(e){const n=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!n)return[e,void 0];e=e.slice(0,n.index);let t=n[0],i=t.indexOf(")");const a=Ij(e,"(");let o=Ij(e,")");for(;i!==-1&&a>o;)e+=t.slice(0,i+1),t=t.slice(i+1),i=t.indexOf(")"),o++;return[e,t]}function qT(e,n){const t=e.input.charCodeAt(e.index-1);return(e.index===0||$d(t)||$b(t))&&(!n||t!==47)}VT.peek=fG;function rG(){this.buffer()}function aG(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function sG(){this.buffer()}function oG(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function lG(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=Us(this.sliceSerialize(e)).toLowerCase(),t.label=n}function cG(e){this.exit(e)}function uG(e){const n=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=Us(this.sliceSerialize(e)).toLowerCase(),t.label=n}function dG(e){this.exit(e)}function fG(){return"["}function VT(e,n,t,i){const a=t.createTracker(i);let o=a.move("[^");const l=t.enter("footnoteReference"),d=t.enter("reference");return o+=a.move(t.safe(t.associationId(e),{after:"]",before:o})),d(),l(),o+=a.move("]"),o}function hG(){return{enter:{gfmFootnoteCallString:rG,gfmFootnoteCall:aG,gfmFootnoteDefinitionLabelString:sG,gfmFootnoteDefinition:oG},exit:{gfmFootnoteCallString:lG,gfmFootnoteCall:cG,gfmFootnoteDefinitionLabelString:uG,gfmFootnoteDefinition:dG}}}function pG(e){let n=!1;return e&&e.firstLineBlank&&(n=!0),{handlers:{footnoteDefinition:t,footnoteReference:VT},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function t(i,a,o,l){const d=o.createTracker(l);let f=d.move("[^");const u=o.enter("footnoteDefinition"),p=o.enter("label");return f+=d.move(o.safe(o.associationId(i),{before:f,after:"]"})),p(),f+=d.move("]:"),i.children&&i.children.length>0&&(d.shift(4),f+=d.move((n?`
`:" ")+o.indentLines(o.containerFlow(i,d.current()),n?HT:mG))),u(),f}}function mG(e,n,t){return n===0?e:HT(e,n,t)}function HT(e,n,t){return(t?"":"    ")+e}const gG=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];GT.peek=wG;function yG(){return{canContainEols:["delete"],enter:{strikethrough:bG},exit:{strikethrough:vG}}}function xG(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:gG}],handlers:{delete:GT}}}function bG(e){this.enter({type:"delete",children:[]},e)}function vG(e){this.exit(e)}function GT(e,n,t,i){const a=t.createTracker(i),o=t.enter("strikethrough");let l=a.move("~~");return l+=t.containerPhrasing(e,{...a.current(),before:l,after:"~"}),l+=a.move("~~"),o(),l}function wG(){return"~"}function SG(e){return e.length}function NG(e,n){const t=n||{},i=(t.align||[]).concat(),a=t.stringLength||SG,o=[],l=[],d=[],f=[];let u=0,p=-1;for(;++p<e.length;){const k=[],T=[];let P=-1;for(e[p].length>u&&(u=e[p].length);++P<e[p].length;){const M=CG(e[p][P]);if(t.alignDelimiters!==!1){const I=a(M);T[P]=I,(f[P]===void 0||I>f[P])&&(f[P]=I)}k.push(M)}l[p]=k,d[p]=T}let g=-1;if(typeof i=="object"&&"length"in i)for(;++g<u;)o[g]=Rj(i[g]);else{const k=Rj(i);for(;++g<u;)o[g]=k}g=-1;const b=[],v=[];for(;++g<u;){const k=o[g];let T="",P="";k===99?(T=":",P=":"):k===108?T=":":k===114&&(P=":");let M=t.alignDelimiters===!1?1:Math.max(1,f[g]-T.length-P.length);const I=T+"-".repeat(M)+P;t.alignDelimiters!==!1&&(M=T.length+M+P.length,M>f[g]&&(f[g]=M),v[g]=M),b[g]=I}l.splice(1,0,b),d.splice(1,0,v),p=-1;const S=[];for(;++p<l.length;){const k=l[p],T=d[p];g=-1;const P=[];for(;++g<u;){const M=k[g]||"";let I="",U="";if(t.alignDelimiters!==!1){const L=f[g]-(T[g]||0),$=o[g];$===114?I=" ".repeat(L):$===99?L%2?(I=" ".repeat(L/2+.5),U=" ".repeat(L/2-.5)):(I=" ".repeat(L/2),U=I):U=" ".repeat(L)}t.delimiterStart!==!1&&!g&&P.push("|"),t.padding!==!1&&!(t.alignDelimiters===!1&&M==="")&&(t.delimiterStart!==!1||g)&&P.push(" "),t.alignDelimiters!==!1&&P.push(I),P.push(M),t.alignDelimiters!==!1&&P.push(U),t.padding!==!1&&P.push(" "),(t.delimiterEnd!==!1||g!==u-1)&&P.push("|")}S.push(t.delimiterEnd===!1?P.join("").replace(/ +$/,""):P.join(""))}return S.join(`
`)}function CG(e){return e==null?"":String(e)}function Rj(e){const n=typeof e=="string"?e.codePointAt(0):0;return n===67||n===99?99:n===76||n===108?108:n===82||n===114?114:0}function jG(e,n,t,i){const a=t.enter("blockquote"),o=t.createTracker(i);o.move("> "),o.shift(2);const l=t.indentLines(t.containerFlow(e,o.current()),_G);return a(),l}function _G(e,n,t){return">"+(t?"":" ")+e}function kG(e,n){return Mj(e,n.inConstruct,!0)&&!Mj(e,n.notInConstruct,!1)}function Mj(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let i=-1;for(;++i<n.length;)if(e.includes(n[i]))return!0;return!1}function Oj(e,n,t,i){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&kG(t.stack,t.unsafe[a]))return/[ \t]/.test(i.before)?"":" ";return`\\
`}function TG(e,n){const t=String(e);let i=t.indexOf(n),a=i,o=0,l=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;i!==-1;)i===a?++o>l&&(l=o):o=1,a=i+n.length,i=t.indexOf(n,a);return l}function EG(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function AG(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function PG(e,n,t,i){const a=AG(t),o=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if(EG(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(o,DG);return g(),b}const d=t.createTracker(i),f=a.repeat(Math.max(TG(o,a)+1,3)),u=t.enter("codeFenced");let p=d.move(f);if(e.lang){const g=t.enter(`codeFencedLang${l}`);p+=d.move(t.safe(e.lang,{before:p,after:" ",encode:["`"],...d.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${l}`);p+=d.move(" "),p+=d.move(t.safe(e.meta,{before:p,after:`
`,encode:["`"],...d.current()})),g()}return p+=d.move(`
`),o&&(p+=d.move(o+`
`)),p+=d.move(f),u(),p}function DG(e,n,t){return(t?"":"    ")+e}function Uw(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function IG(e,n,t,i){const a=Uw(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("definition");let d=t.enter("label");const f=t.createTracker(i);let u=f.move("[");return u+=f.move(t.safe(t.associationId(e),{before:u,after:"]",...f.current()})),u+=f.move("]: "),d(),!e.url||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":`
`,...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),l(),u}function RG(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function Zm(e){return"&#x"+e.toString(16).toUpperCase()+";"}function pb(e,n,t){const i=Rh(e),a=Rh(n);return i===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:i===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}YT.peek=MG;function YT(e,n,t,i){const a=RG(t),o=t.enter("emphasis"),l=t.createTracker(i),d=l.move(a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),p=pb(i.before.charCodeAt(i.before.length-1),u,a);p.inside&&(f=Zm(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=pb(i.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+Zm(g));const v=l.move(a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:p.outside},d+f+v}function MG(e,n,t){return t.options.emphasis||"*"}function OG(e,n){let t=!1;return zw(e,function(i){if("value"in i&&/\r?\n|\r/.test(i.value)||i.type==="break")return t=!0,D1}),!!((!e.depth||e.depth<3)&&Iw(e)&&(n.options.setext||t))}function LG(e,n,t,i){const a=Math.max(Math.min(6,e.depth||1),1),o=t.createTracker(i);if(OG(e,t)){const p=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...o.current(),before:`
`,after:`
`});return g(),p(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const l="#".repeat(a),d=t.enter("headingAtx"),f=t.enter("phrasing");o.move(l+" ");let u=t.containerPhrasing(e,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(u)&&(u=Zm(u.charCodeAt(0))+u.slice(1)),u=u?l+" "+u:l,t.options.closeAtx&&(u+=" "+l),f(),d(),u}WT.peek=FG;function WT(e){return e.value||""}function FG(){return"<"}QT.peek=$G;function QT(e,n,t,i){const a=Uw(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("image");let d=t.enter("label");const f=t.createTracker(i);let u=f.move("![");return u+=f.move(t.safe(e.alt,{before:u,after:"]",...f.current()})),u+=f.move("]("),d(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":")",...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),u+=f.move(")"),l(),u}function $G(){return"!"}JT.peek=zG;function JT(e,n,t,i){const a=e.referenceType,o=t.enter("imageReference");let l=t.enter("label");const d=t.createTracker(i);let f=d.move("![");const u=t.safe(e.alt,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const p=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=p,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function zG(){return"!"}KT.peek=UG;function KT(e,n,t){let i=e.value||"",a="`",o=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(i);)a+="`";for(/[^ \r\n]/.test(i)&&(/^[ \r\n]/.test(i)&&/[ \r\n]$/.test(i)||/^`|`$/.test(i))&&(i=" "+i+" ");++o<t.unsafe.length;){const l=t.unsafe[o],d=t.compilePattern(l);let f;if(l.atBreak)for(;f=d.exec(i);){let u=f.index;i.charCodeAt(u)===10&&i.charCodeAt(u-1)===13&&u--,i=i.slice(0,u)+" "+i.slice(f.index+1)}}return a+i+a}function UG(){return"`"}function XT(e,n){const t=Iw(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}ZT.peek=BG;function ZT(e,n,t,i){const a=Uw(t),o=a==='"'?"Quote":"Apostrophe",l=t.createTracker(i);let d,f;if(XT(e,t)){const p=t.stack;t.stack=[],d=t.enter("autolink");let g=l.move("<");return g+=l.move(t.containerPhrasing(e,{before:g,after:">",...l.current()})),g+=l.move(">"),d(),t.stack=p,g}d=t.enter("link"),f=t.enter("label");let u=l.move("[");return u+=l.move(t.containerPhrasing(e,{before:u,after:"](",...l.current()})),u+=l.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(t.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(f=t.enter("destinationRaw"),u+=l.move(t.safe(e.url,{before:u,after:e.title?" ":")",...l.current()}))),f(),e.title&&(f=t.enter(`title${o}`),u+=l.move(" "+a),u+=l.move(t.safe(e.title,{before:u,after:a,...l.current()})),u+=l.move(a),f()),u+=l.move(")"),d(),u}function BG(e,n,t){return XT(e,t)?"<":"["}eE.peek=qG;function eE(e,n,t,i){const a=e.referenceType,o=t.enter("linkReference");let l=t.enter("label");const d=t.createTracker(i);let f=d.move("[");const u=t.containerPhrasing(e,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const p=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=p,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function qG(){return"["}function Bw(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function VG(e){const n=Bw(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function HG(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function tE(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function GG(e,n,t,i){const a=t.enter("list"),o=t.bulletCurrent;let l=e.ordered?HG(t):Bw(t);const d=e.ordered?l==="."?")":".":VG(t);let f=n&&t.bulletLastUsed?l===t.bulletLastUsed:!1;if(!e.ordered){const p=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&p&&(!p.children||!p.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(f=!0),tE(t)===l&&p){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){f=!0;break}}}}f&&(l=d),t.bulletCurrent=l;const u=t.containerFlow(e,i);return t.bulletLastUsed=l,t.bulletCurrent=o,a(),u}function YG(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function WG(e,n,t,i){const a=YG(t);let o=t.bulletCurrent||Bw(t);n&&n.type==="list"&&n.ordered&&(o=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+o);let l=o.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(l=Math.ceil(l/4)*4);const d=t.createTracker(i);d.move(o+" ".repeat(l-o.length)),d.shift(l);const f=t.enter("listItem"),u=t.indentLines(t.containerFlow(e,d.current()),p);return f(),u;function p(g,b,v){return b?(v?"":" ".repeat(l))+g:(v?o:o+" ".repeat(l-o.length))+g}}function QG(e,n,t,i){const a=t.enter("paragraph"),o=t.enter("phrasing"),l=t.containerPhrasing(e,i);return o(),a(),l}const JG=Bb(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function KG(e,n,t,i){return(e.children.some(function(l){return JG(l)})?t.containerPhrasing:t.containerFlow).call(t,e,i)}function XG(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}nE.peek=ZG;function nE(e,n,t,i){const a=XG(t),o=t.enter("strong"),l=t.createTracker(i),d=l.move(a+a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),p=pb(i.before.charCodeAt(i.before.length-1),u,a);p.inside&&(f=Zm(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=pb(i.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+Zm(g));const v=l.move(a+a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:p.outside},d+f+v}function ZG(e,n,t){return t.options.strong||"*"}function eY(e,n,t,i){return t.safe(e.value,i)}function tY(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function nY(e,n,t){const i=(tE(t)+(t.options.ruleSpaces?" ":"")).repeat(tY(t));return t.options.ruleSpaces?i.slice(0,-1):i}const iE={blockquote:jG,break:Oj,code:PG,definition:IG,emphasis:YT,hardBreak:Oj,heading:LG,html:WT,image:QT,imageReference:JT,inlineCode:KT,link:ZT,linkReference:eE,list:GG,listItem:WG,paragraph:QG,root:KG,strong:nE,text:eY,thematicBreak:nY};function iY(){return{enter:{table:rY,tableData:Lj,tableHeader:Lj,tableRow:sY},exit:{codeText:oY,table:aY,tableData:A0,tableHeader:A0,tableRow:A0}}}function rY(e){const n=e._align;this.enter({type:"table",align:n.map(function(t){return t==="none"?null:t}),children:[]},e),this.data.inTable=!0}function aY(e){this.exit(e),this.data.inTable=void 0}function sY(e){this.enter({type:"tableRow",children:[]},e)}function A0(e){this.exit(e)}function Lj(e){this.enter({type:"tableCell",children:[]},e)}function oY(e){let n=this.resume();this.data.inTable&&(n=n.replace(/\\([\\|])/g,lY));const t=this.stack[this.stack.length-1];t.type,t.value=n,this.exit(e)}function lY(e,n){return n==="|"?n:e}function cY(e){const n=e||{},t=n.tableCellPadding,i=n.tablePipeAlign,a=n.stringLength,o=t?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:b,table:l,tableCell:f,tableRow:d}};function l(v,S,k,T){return u(p(v,k,T),v.align)}function d(v,S,k,T){const P=g(v,k,T),M=u([P]);return M.slice(0,M.indexOf(`
`))}function f(v,S,k,T){const P=k.enter("tableCell"),M=k.enter("phrasing"),I=k.containerPhrasing(v,{...T,before:o,after:o});return M(),P(),I}function u(v,S){return NG(v,{align:S,alignDelimiters:i,padding:t,stringLength:a})}function p(v,S,k){const T=v.children;let P=-1;const M=[],I=S.enter("table");for(;++P<T.length;)M[P]=g(T[P],S,k);return I(),M}function g(v,S,k){const T=v.children;let P=-1;const M=[],I=S.enter("tableRow");for(;++P<T.length;)M[P]=f(T[P],v,S,k);return I(),M}function b(v,S,k){let T=iE.inlineCode(v,S,k);return k.stack.includes("tableCell")&&(T=T.replace(/\|/g,"\\$&")),T}}function uY(){return{exit:{taskListCheckValueChecked:Fj,taskListCheckValueUnchecked:Fj,paragraph:fY}}}function dY(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:hY}}}function Fj(e){const n=this.stack[this.stack.length-2];n.type,n.checked=e.type==="taskListCheckValueChecked"}function fY(e){const n=this.stack[this.stack.length-2];if(n&&n.type==="listItem"&&typeof n.checked=="boolean"){const t=this.stack[this.stack.length-1];t.type;const i=t.children[0];if(i&&i.type==="text"){const a=n.children;let o=-1,l;for(;++o<a.length;){const d=a[o];if(d.type==="paragraph"){l=d;break}}l===t&&(i.value=i.value.slice(1),i.value.length===0?t.children.shift():t.position&&i.position&&typeof i.position.start.offset=="number"&&(i.position.start.column++,i.position.start.offset++,t.position.start=Object.assign({},i.position.start)))}}this.exit(e)}function hY(e,n,t,i){const a=e.children[0],o=typeof e.checked=="boolean"&&a&&a.type==="paragraph",l="["+(e.checked?"x":" ")+"] ",d=t.createTracker(i);o&&d.move(l);let f=iE.listItem(e,n,t,{...i,...d.current()});return o&&(f=f.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,u)),f;function u(p){return p+l}}function pY(){return[GH(),hG(),yG(),iY(),uY()]}function mY(e){return{extensions:[YH(),pG(e),xG(),cY(e),dY()]}}const gY={tokenize:SY,partial:!0},rE={tokenize:NY,partial:!0},aE={tokenize:CY,partial:!0},sE={tokenize:jY,partial:!0},yY={tokenize:_Y,partial:!0},oE={name:"wwwAutolink",tokenize:vY,previous:cE},lE={name:"protocolAutolink",tokenize:wY,previous:uE},Jl={name:"emailAutolink",tokenize:bY,previous:dE},Xo={};function xY(){return{text:Xo}}let Td=48;for(;Td<123;)Xo[Td]=Jl,Td++,Td===58?Td=65:Td===91&&(Td=97);Xo[43]=Jl;Xo[45]=Jl;Xo[46]=Jl;Xo[95]=Jl;Xo[72]=[Jl,lE];Xo[104]=[Jl,lE];Xo[87]=[Jl,oE];Xo[119]=[Jl,oE];function bY(e,n,t){const i=this;let a,o;return l;function l(g){return!O1(g)||!dE.call(i,i.previous)||qw(i.events)?t(g):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),d(g))}function d(g){return O1(g)?(e.consume(g),d):g===64?(e.consume(g),f):t(g)}function f(g){return g===46?e.check(yY,p,u)(g):g===45||g===95||Cr(g)?(o=!0,e.consume(g),f):p(g)}function u(g){return e.consume(g),a=!0,f}function p(g){return o&&a&&Ur(i.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),n(g)):t(g)}}function vY(e,n,t){const i=this;return a;function a(l){return l!==87&&l!==119||!cE.call(i,i.previous)||qw(i.events)?t(l):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(gY,e.attempt(rE,e.attempt(aE,o),t),t)(l))}function o(l){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),n(l)}}function wY(e,n,t){const i=this;let a="",o=!1;return l;function l(g){return(g===72||g===104)&&uE.call(i,i.previous)&&!qw(i.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),a+=String.fromCodePoint(g),e.consume(g),d):t(g)}function d(g){if(Ur(g)&&a.length<5)return a+=String.fromCodePoint(g),e.consume(g),d;if(g===58){const b=a.toLowerCase();if(b==="http"||b==="https")return e.consume(g),f}return t(g)}function f(g){return g===47?(e.consume(g),o?u:(o=!0,f)):t(g)}function u(g){return g===null||db(g)||Jn(g)||$d(g)||$b(g)?t(g):e.attempt(rE,e.attempt(aE,p),t)(g)}function p(g){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),n(g)}}function SY(e,n,t){let i=0;return a;function a(l){return(l===87||l===119)&&i<3?(i++,e.consume(l),a):l===46&&i===3?(e.consume(l),o):t(l)}function o(l){return l===null?t(l):n(l)}}function NY(e,n,t){let i,a,o;return l;function l(u){return u===46||u===95?e.check(sE,f,d)(u):u===null||Jn(u)||$d(u)||u!==45&&$b(u)?f(u):(o=!0,e.consume(u),l)}function d(u){return u===95?i=!0:(a=i,i=void 0),e.consume(u),l}function f(u){return a||i||!o?t(u):n(u)}}function CY(e,n){let t=0,i=0;return a;function a(l){return l===40?(t++,e.consume(l),a):l===41&&i<t?o(l):l===33||l===34||l===38||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===60||l===63||l===93||l===95||l===126?e.check(sE,n,o)(l):l===null||Jn(l)||$d(l)?n(l):(e.consume(l),a)}function o(l){return l===41&&i++,e.consume(l),a}}function jY(e,n,t){return i;function i(d){return d===33||d===34||d===39||d===41||d===42||d===44||d===46||d===58||d===59||d===63||d===95||d===126?(e.consume(d),i):d===38?(e.consume(d),o):d===93?(e.consume(d),a):d===60||d===null||Jn(d)||$d(d)?n(d):t(d)}function a(d){return d===null||d===40||d===91||Jn(d)||$d(d)?n(d):i(d)}function o(d){return Ur(d)?l(d):t(d)}function l(d){return d===59?(e.consume(d),i):Ur(d)?(e.consume(d),l):t(d)}}function _Y(e,n,t){return i;function i(o){return e.consume(o),a}function a(o){return Cr(o)?t(o):n(o)}}function cE(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||Jn(e)}function uE(e){return!Ur(e)}function dE(e){return!(e===47||O1(e))}function O1(e){return e===43||e===45||e===46||e===95||Cr(e)}function qw(e){let n=e.length,t=!1;for(;n--;){const i=e[n][1];if((i.type==="labelLink"||i.type==="labelImage")&&!i._balanced){t=!0;break}if(i._gfmAutolinkLiteralWalkedInto){t=!1;break}}return e.length>0&&!t&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),t}const kY={tokenize:MY,partial:!0};function TY(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:DY,continuation:{tokenize:IY},exit:RY}},text:{91:{name:"gfmFootnoteCall",tokenize:PY},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:EY,resolveTo:AY}}}}function EY(e,n,t){const i=this;let a=i.events.length;const o=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let l;for(;a--;){const f=i.events[a][1];if(f.type==="labelImage"){l=f;break}if(f.type==="gfmFootnoteCall"||f.type==="labelLink"||f.type==="label"||f.type==="image"||f.type==="link")break}return d;function d(f){if(!l||!l._balanced)return t(f);const u=Us(i.sliceSerialize({start:l.end,end:i.now()}));return u.codePointAt(0)!==94||!o.includes(u.slice(1))?t(f):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(f),e.exit("gfmFootnoteCallLabelMarker"),n(f))}}function AY(e,n){let t=e.length;for(;t--;)if(e[t][1].type==="labelImage"&&e[t][0]==="enter"){e[t][1];break}e[t+1][1].type="data",e[t+3][1].type="gfmFootnoteCallLabelMarker";const i={type:"gfmFootnoteCall",start:Object.assign({},e[t+3][1].start),end:Object.assign({},e[e.length-1][1].end)},a={type:"gfmFootnoteCallMarker",start:Object.assign({},e[t+3][1].end),end:Object.assign({},e[t+3][1].end)};a.end.column++,a.end.offset++,a.end._bufferIndex++;const o={type:"gfmFootnoteCallString",start:Object.assign({},a.end),end:Object.assign({},e[e.length-1][1].start)},l={type:"chunkString",contentType:"string",start:Object.assign({},o.start),end:Object.assign({},o.end)},d=[e[t+1],e[t+2],["enter",i,n],e[t+3],e[t+4],["enter",a,n],["exit",a,n],["enter",o,n],["enter",l,n],["exit",l,n],["exit",o,n],e[e.length-2],e[e.length-1],["exit",i,n]];return e.splice(t,e.length-t+1,...d),e}function PY(e,n,t){const i=this,a=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let o=0,l;return d;function d(g){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),f}function f(g){return g!==94?t(g):(e.enter("gfmFootnoteCallMarker"),e.consume(g),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",u)}function u(g){if(o>999||g===93&&!l||g===null||g===91||Jn(g))return t(g);if(g===93){e.exit("chunkString");const b=e.exit("gfmFootnoteCallString");return a.includes(Us(i.sliceSerialize(b)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(g),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),n):t(g)}return Jn(g)||(l=!0),o++,e.consume(g),g===92?p:u}function p(g){return g===91||g===92||g===93?(e.consume(g),o++,u):u(g)}}function DY(e,n,t){const i=this,a=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let o,l=0,d;return f;function f(S){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),u}function u(S){return S===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",p):t(S)}function p(S){if(l>999||S===93&&!d||S===null||S===91||Jn(S))return t(S);if(S===93){e.exit("chunkString");const k=e.exit("gfmFootnoteDefinitionLabelString");return o=Us(i.sliceSerialize(k)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(S),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),b}return Jn(S)||(d=!0),l++,e.consume(S),S===92?g:p}function g(S){return S===91||S===92||S===93?(e.consume(S),l++,p):p(S)}function b(S){return S===58?(e.enter("definitionMarker"),e.consume(S),e.exit("definitionMarker"),a.includes(o)||a.push(o),wn(e,v,"gfmFootnoteDefinitionWhitespace")):t(S)}function v(S){return n(S)}}function IY(e,n,t){return e.check(cg,n,e.attempt(kY,n,t))}function RY(e){e.exit("gfmFootnoteDefinition")}function MY(e,n,t){const i=this;return wn(e,a,"gfmFootnoteDefinitionIndent",5);function a(o){const l=i.events[i.events.length-1];return l&&l[1].type==="gfmFootnoteDefinitionIndent"&&l[2].sliceSerialize(l[1],!0).length===4?n(o):t(o)}}function OY(e){let t=(e||{}).singleTilde;const i={name:"strikethrough",tokenize:o,resolveAll:a};return t==null&&(t=!0),{text:{126:i},insideSpan:{null:[i]},attentionMarkers:{null:[126]}};function a(l,d){let f=-1;for(;++f<l.length;)if(l[f][0]==="enter"&&l[f][1].type==="strikethroughSequenceTemporary"&&l[f][1]._close){let u=f;for(;u--;)if(l[u][0]==="exit"&&l[u][1].type==="strikethroughSequenceTemporary"&&l[u][1]._open&&l[f][1].end.offset-l[f][1].start.offset===l[u][1].end.offset-l[u][1].start.offset){l[f][1].type="strikethroughSequence",l[u][1].type="strikethroughSequence";const p={type:"strikethrough",start:Object.assign({},l[u][1].start),end:Object.assign({},l[f][1].end)},g={type:"strikethroughText",start:Object.assign({},l[u][1].end),end:Object.assign({},l[f][1].start)},b=[["enter",p,d],["enter",l[u][1],d],["exit",l[u][1],d],["enter",g,d]],v=d.parser.constructs.insideSpan.null;v&&Ia(b,b.length,0,zb(v,l.slice(u+1,f),d)),Ia(b,b.length,0,[["exit",g,d],["enter",l[f][1],d],["exit",l[f][1],d],["exit",p,d]]),Ia(l,u-1,f-u+3,b),f=u+b.length-2;break}}for(f=-1;++f<l.length;)l[f][1].type==="strikethroughSequenceTemporary"&&(l[f][1].type="data");return l}function o(l,d,f){const u=this.previous,p=this.events;let g=0;return b;function b(S){return u===126&&p[p.length-1][1].type!=="characterEscape"?f(S):(l.enter("strikethroughSequenceTemporary"),v(S))}function v(S){const k=Rh(u);if(S===126)return g>1?f(S):(l.consume(S),g++,v);if(g<2&&!t)return f(S);const T=l.exit("strikethroughSequenceTemporary"),P=Rh(S);return T._open=!P||P===2&&!!k,T._close=!k||k===2&&!!P,d(S)}}}class LY{constructor(){this.map=[]}add(n,t,i){FY(this,n,t,i)}consume(n){if(this.map.sort(function(o,l){return o[0]-l[0]}),this.map.length===0)return;let t=this.map.length;const i=[];for(;t>0;)t-=1,i.push(n.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),n.length=this.map[t][0];i.push(n.slice()),n.length=0;let a=i.pop();for(;a;){for(const o of a)n.push(o);a=i.pop()}this.map.length=0}}function FY(e,n,t,i){let a=0;if(!(t===0&&i.length===0)){for(;a<e.map.length;){if(e.map[a][0]===n){e.map[a][1]+=t,e.map[a][2].push(...i);return}a+=1}e.map.push([n,t,i])}}function $Y(e,n){let t=!1;const i=[];for(;n<e.length;){const a=e[n];if(t){if(a[0]==="enter")a[1].type==="tableContent"&&i.push(e[n+1][1].type==="tableDelimiterMarker"?"left":"none");else if(a[1].type==="tableContent"){if(e[n-1][1].type==="tableDelimiterMarker"){const o=i.length-1;i[o]=i[o]==="left"?"center":"right"}}else if(a[1].type==="tableDelimiterRow")break}else a[0]==="enter"&&a[1].type==="tableDelimiterRow"&&(t=!0);n+=1}return i}function zY(){return{flow:{null:{name:"table",tokenize:UY,resolveAll:BY}}}}function UY(e,n,t){const i=this;let a=0,o=0,l;return d;function d(R){let B=i.events.length-1;for(;B>-1;){const ne=i.events[B][1].type;if(ne==="lineEnding"||ne==="linePrefix")B--;else break}const Y=B>-1?i.events[B][1].type:null,re=Y==="tableHead"||Y==="tableRow"?$:f;return re===$&&i.parser.lazy[i.now().line]?t(R):re(R)}function f(R){return e.enter("tableHead"),e.enter("tableRow"),u(R)}function u(R){return R===124||(l=!0,o+=1),p(R)}function p(R){return R===null?t(R):It(R)?o>1?(o=0,i.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(R),e.exit("lineEnding"),v):t(R):fn(R)?wn(e,p,"whitespace")(R):(o+=1,l&&(l=!1,a+=1),R===124?(e.enter("tableCellDivider"),e.consume(R),e.exit("tableCellDivider"),l=!0,p):(e.enter("data"),g(R)))}function g(R){return R===null||R===124||Jn(R)?(e.exit("data"),p(R)):(e.consume(R),R===92?b:g)}function b(R){return R===92||R===124?(e.consume(R),g):g(R)}function v(R){return i.interrupt=!1,i.parser.lazy[i.now().line]?t(R):(e.enter("tableDelimiterRow"),l=!1,fn(R)?wn(e,S,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(R):S(R))}function S(R){return R===45||R===58?T(R):R===124?(l=!0,e.enter("tableCellDivider"),e.consume(R),e.exit("tableCellDivider"),k):L(R)}function k(R){return fn(R)?wn(e,T,"whitespace")(R):T(R)}function T(R){return R===58?(o+=1,l=!0,e.enter("tableDelimiterMarker"),e.consume(R),e.exit("tableDelimiterMarker"),P):R===45?(o+=1,P(R)):R===null||It(R)?U(R):L(R)}function P(R){return R===45?(e.enter("tableDelimiterFiller"),M(R)):L(R)}function M(R){return R===45?(e.consume(R),M):R===58?(l=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(R),e.exit("tableDelimiterMarker"),I):(e.exit("tableDelimiterFiller"),I(R))}function I(R){return fn(R)?wn(e,U,"whitespace")(R):U(R)}function U(R){return R===124?S(R):R===null||It(R)?!l||a!==o?L(R):(e.exit("tableDelimiterRow"),e.exit("tableHead"),n(R)):L(R)}function L(R){return t(R)}function $(R){return e.enter("tableRow"),z(R)}function z(R){return R===124?(e.enter("tableCellDivider"),e.consume(R),e.exit("tableCellDivider"),z):R===null||It(R)?(e.exit("tableRow"),n(R)):fn(R)?wn(e,z,"whitespace")(R):(e.enter("data"),F(R))}function F(R){return R===null||R===124||Jn(R)?(e.exit("data"),z(R)):(e.consume(R),R===92?Q:F)}function Q(R){return R===92||R===124?(e.consume(R),F):F(R)}}function BY(e,n){let t=-1,i=!0,a=0,o=[0,0,0,0],l=[0,0,0,0],d=!1,f=0,u,p,g;const b=new LY;for(;++t<e.length;){const v=e[t],S=v[1];v[0]==="enter"?S.type==="tableHead"?(d=!1,f!==0&&($j(b,n,f,u,p),p=void 0,f=0),u={type:"table",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",u,n]])):S.type==="tableRow"||S.type==="tableDelimiterRow"?(i=!0,g=void 0,o=[0,0,0,0],l=[0,t+1,0,0],d&&(d=!1,p={type:"tableBody",start:Object.assign({},S.start),end:Object.assign({},S.end)},b.add(t,0,[["enter",p,n]])),a=S.type==="tableDelimiterRow"?2:p?3:1):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")?(i=!1,l[2]===0&&(o[1]!==0&&(l[0]=l[1],g=Nx(b,n,o,a,void 0,g),o=[0,0,0,0]),l[2]=t)):S.type==="tableCellDivider"&&(i?i=!1:(o[1]!==0&&(l[0]=l[1],g=Nx(b,n,o,a,void 0,g)),o=l,l=[o[1],t,0,0])):S.type==="tableHead"?(d=!0,f=t):S.type==="tableRow"||S.type==="tableDelimiterRow"?(f=t,o[1]!==0?(l[0]=l[1],g=Nx(b,n,o,a,t,g)):l[1]!==0&&(g=Nx(b,n,l,a,t,g)),a=0):a&&(S.type==="data"||S.type==="tableDelimiterMarker"||S.type==="tableDelimiterFiller")&&(l[3]=t)}for(f!==0&&$j(b,n,f,u,p),b.consume(n.events),t=-1;++t<n.events.length;){const v=n.events[t];v[0]==="enter"&&v[1].type==="table"&&(v[1]._align=$Y(n.events,t))}return e}function Nx(e,n,t,i,a,o){const l=i===1?"tableHeader":i===2?"tableDelimiter":"tableData",d="tableContent";t[0]!==0&&(o.end=Object.assign({},wh(n.events,t[0])),e.add(t[0],0,[["exit",o,n]]));const f=wh(n.events,t[1]);if(o={type:l,start:Object.assign({},f),end:Object.assign({},f)},e.add(t[1],0,[["enter",o,n]]),t[2]!==0){const u=wh(n.events,t[2]),p=wh(n.events,t[3]),g={type:d,start:Object.assign({},u),end:Object.assign({},p)};if(e.add(t[2],0,[["enter",g,n]]),i!==2){const b=n.events[t[2]],v=n.events[t[3]];if(b[1].end=Object.assign({},v[1].end),b[1].type="chunkText",b[1].contentType="text",t[3]>t[2]+1){const S=t[2]+1,k=t[3]-t[2]-1;e.add(S,k,[])}}e.add(t[3]+1,0,[["exit",g,n]])}return a!==void 0&&(o.end=Object.assign({},wh(n.events,a)),e.add(a,0,[["exit",o,n]]),o=void 0),o}function $j(e,n,t,i,a){const o=[],l=wh(n.events,t);a&&(a.end=Object.assign({},l),o.push(["exit",a,n])),i.end=Object.assign({},l),o.push(["exit",i,n]),e.add(t+1,0,o)}function wh(e,n){const t=e[n],i=t[0]==="enter"?"start":"end";return t[1][i]}const qY={name:"tasklistCheck",tokenize:HY};function VY(){return{text:{91:qY}}}function HY(e,n,t){const i=this;return a;function a(f){return i.previous!==null||!i._gfmTasklistFirstContentOfListItem?t(f):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(f),e.exit("taskListCheckMarker"),o)}function o(f){return Jn(f)?(e.enter("taskListCheckValueUnchecked"),e.consume(f),e.exit("taskListCheckValueUnchecked"),l):f===88||f===120?(e.enter("taskListCheckValueChecked"),e.consume(f),e.exit("taskListCheckValueChecked"),l):t(f)}function l(f){return f===93?(e.enter("taskListCheckMarker"),e.consume(f),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),d):t(f)}function d(f){return It(f)?n(f):fn(f)?e.check({tokenize:GY},n,t)(f):t(f)}}function GY(e,n,t){return wn(e,i,"whitespace");function i(a){return a===null?t(a):n(a)}}function YY(e){return wT([xY(),TY(),OY(e),zY(),VY()])}const WY={};function zs(e){const n=this,t=e||WY,i=n.data(),a=i.micromarkExtensions||(i.micromarkExtensions=[]),o=i.fromMarkdownExtensions||(i.fromMarkdownExtensions=[]),l=i.toMarkdownExtensions||(i.toMarkdownExtensions=[]);a.push(YY(t)),o.push(pY()),l.push(mY(t))}const QY=e=>{if(!e)return"Unknown Date";try{return new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},JY=e=>{switch(e){case"pending":return{text:"Billing Pending",className:"status-badge status-pending"};case"billed":return{text:"Sample Pending",className:"status-badge status-billed"};case"collected":return{text:"Sample Collected",className:"status-badge status-collected"};case"processing":return{text:"Processing",className:"status-badge status-processing"};case"report_ready":return{text:"Report Ready",className:"status-badge status-report_ready"};case"reported":return{text:"Reported",className:"status-badge status-reported"};case"completed":return{text:"Completed",className:"status-badge status-completed"};case"cancelled":return{text:"Cancelled",className:"status-badge status-cancelled"};default:return{text:e,className:"status-badge"}}},P0=({title:e,items:n,renderItemContent:t,headerAction:i,isLoading:a,loadingText:o,noDataText:l,onDeleteItem:d,onEditLabOrder:f,onSaveLabOrder:u,onCancelEditLabOrder:p,onLabOrderTestChange:g,onLabOrderStatusChange:b,onEditPharmacyOrder:v,onPrintUnavailablePrescription:S,onBillLabOrder:k,onUpdateLabOrderStatus:T,onEnterLabReport:P,labInventory:M=[],isSavingLabOrder:I=!1,expandedLabReports:U={},toggleLabReport:L=()=>{}})=>{const $=w.useMemo(()=>{const F={};n.forEach(R=>{if(isNaN(R.date.getTime())){F["Unknown Date"]||(F["Unknown Date"]=[]),F["Unknown Date"].push(R);return}const B=QY(R.originalDateString);F[B]||(F[B]=[]),F[B].push(R)});const Q=Object.keys(F);return Q.sort((R,B)=>{if(R==="Unknown Date")return 1;if(B==="Unknown Date")return-1;try{const Y=new Date(R.split(" ").reverse().join(" ")),re=new Date(B.split(" ").reverse().join(" "));if(!isNaN(Y.getTime())&&!isNaN(re.getTime()))return re.getTime()-Y.getTime()}catch{}return B.localeCompare(R)}),Q.map(R=>({date:R,items:F[R]}))},[n]),z=["pending","billed","collected","processing","report_ready","completed","cancelled","reported"];return r.jsxs("div",{className:"ai-context-section",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h4",{className:"ai-context-section-title mb-2 pb-1",children:e}),i]}),a&&r.jsx("p",{className:"ai-context-text italic",children:o}),!a&&n.length===0&&r.jsx("p",{className:"ai-context-text italic",children:l}),!a&&n.length>0&&r.jsx("div",{className:"space-y-3",children:$.map(({date:F,items:Q})=>r.jsxs("div",{children:[r.jsx("h5",{className:"grouped-history-date",children:F}),r.jsx("div",{className:"space-y-1 grouped-history-item-container",children:Q.map((R,B)=>r.jsxs("div",{className:"grouped-history-item ai-context-item flex flex-col",children:[r.jsxs("div",{className:"flex justify-between items-center w-full",children:[r.jsx("div",{className:"flex-grow mr-2 ai-context-text",children:t(R,B,U,L)}),r.jsxs("div",{className:"flex items-center space-x-1",children:[R.type==="Lab Order"&&!R.data.isEditing&&f&&r.jsx("button",{onClick:()=>f(R.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this lab order",disabled:I,children:r.jsx(ql,{size:14})}),R.type==="Lab Order"&&R.data.isEditing&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>u&&u(R.data.id,R.data.editedTests,R.data.editedStatus),className:"text-green-600 hover:text-green-800 p-1 rounded hover:bg-green-100 focus:outline-none focus:ring-1 focus:ring-green-400",title:"Save lab order changes",disabled:I,children:r.jsx(Od,{size:14})}),r.jsx("button",{onClick:()=>p&&p(R.data.id),className:"text-gray-600 hover:text-gray-800 p-1 rounded hover:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-gray-400",title:"Cancel editing",disabled:I,children:r.jsx(or,{size:14})})]}),R.type==="Lab Order"&&r.jsxs("div",{className:"lab-table-actions",children:[R.data.status==="pending"&&k&&(()=>{const Y=R.data.tests.reduce((re,ne)=>re+(Number(ne.price)||0),0).toFixed(2);return r.jsxs("button",{onClick:()=>k(R.data),className:"lab-action-button btn-bill",title:`Pay total of ${Y}`,children:["Pay (",Y,")"]})})(),R.data.status==="billed"&&T&&r.jsx("button",{onClick:()=>T(R.data.id,"collected"),className:"lab-action-button btn-collect",title:"Collect Sample",children:"Collect"}),R.data.status==="collected"&&T&&r.jsx("button",{onClick:()=>T(R.data.id,"processing"),className:"lab-action-button btn-process",title:"Mark Processing",children:"Process"}),["pending","billed","collected","processing","report_ready","reported","completed"].includes(R.data.status)&&P&&r.jsx("button",{onClick:()=>P(R.data),className:"lab-action-button btn-enter-report",title:"Enter Report",children:"Enter Report"}),(R.data.status==="report_ready"||R.data.status==="reported")&&T&&r.jsx("button",{onClick:()=>T(R.data.id,"completed"),className:"lab-action-button btn-complete",title:"Mark Completed",children:"Complete"})]}),R.type==="Pharmacy Order"&&R.data.status==="pending"&&v&&r.jsx("button",{onClick:()=>v(R.data.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:"Edit this pharmacy order",disabled:I,children:r.jsx(ql,{size:14})}),R.type==="Pharmacy Order"&&R.data.prescriptionForUnavailableDrugs&&S&&r.jsx("button",{onClick:()=>S(R.data.prescriptionForUnavailableDrugs,`Prescription for Order ${R.data.id}`),className:"text-purple-600 hover:text-purple-800 p-1 rounded hover:bg-purple-100 focus:outline-none focus:ring-1 focus:ring-purple-400",title:"Print Prescription for Unavailable Drugs",disabled:I,children:r.jsx(Go,{size:14})}),R.type==="Pharmacy Order"&&R.data.status==="pending"&&d&&r.jsx("button",{onClick:()=>d({type:R.type,data:R.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Delete this pending pharmacy order",disabled:I,children:r.jsx(or,{size:14})}),d&&["Complaint","Lab Order","Lab Report"].includes(R.type)&&r.jsx("button",{onClick:()=>d({type:R.type,data:R.data}),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:`Delete this ${R.type.toLowerCase()}`,disabled:I,children:r.jsx(or,{size:14})})]})]}),R.type==="Lab Order"&&R.data.isEditing&&r.jsxs("div",{className:"lab-order-edit-form mt-2 w-full",children:[r.jsxs("div",{className:"mb-2",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status:"}),r.jsx("select",{value:R.data.editedStatus||R.data.status,onChange:Y=>b&&b(R.data.id,Y.target.value),className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:I,children:z.map(Y=>r.jsx("option",{value:Y,children:Y.replace(/_/g," ")},Y))})]}),r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tests:"}),R.data.editedTests.map((Y,re)=>r.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[r.jsxs("select",{value:Y.id,onChange:ne=>{const G=M.find(V=>String(V.id)===ne.target.value);G&&(g&&g(R.data.id,re,"id",G.id),g&&g(R.data.id,re,"name",G.name),g&&g(R.data.id,re,"price",G.price))},className:"form-select block w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:I,children:[r.jsx("option",{value:"",children:"Select Test"}),M.map(ne=>r.jsxs("option",{value:ne.id,children:[ne.name," (",ne.price,")"]},ne.id))]}),r.jsx("button",{onClick:()=>{const ne=R.data.editedTests.filter((G,V)=>V!==re);g&&g(R.data.id,-1,"remove",ne)},className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-100 focus:outline-none focus:ring-1 focus:ring-red-400",title:"Remove test",disabled:I,children:r.jsx(or,{size:14})})]},re)),r.jsx("button",{onClick:()=>{g&&g(R.data.id,-1,"add",{id:"",name:"",price:0})},className:"button-secondary mt-2 text-xs",disabled:I,children:"Add Test"})]})]},`${R.type}-${R.originalDateString}-${B}`))})]},F))})]})},KY="_modalOverlay_1yna4_3",XY="_modalContent_1yna4_29",ZY="_modalHeader_1yna4_57",eW="_modalTitle_1yna4_75",tW="_modalCloseButton_1yna4_87",nW="_modalBody_1yna4_115",iW="_errorText_1yna4_129",rW="_formGroup_1yna4_147",aW="_inputField_1yna4_171",sW="_searchResultsCard_1yna4_213",oW="_searchResultsList_1yna4_241",lW="_searchResultItem_1yna4_253",cW="_searchResultPrice_1yna4_289",uW="_selectedTestsCard_1yna4_299",dW="_selectedTestsHeader_1yna4_319",fW="_noTestsMessage_1yna4_335",hW="_selectedTestsList_1yna4_351",pW="_selectedTestItem_1yna4_363",mW="_selectedTestName_1yna4_387",gW="_selectedTestPrice_1yna4_399",yW="_removeTestButton_1yna4_411",xW="_totalAmount_1yna4_437",bW="_modalFooter_1yna4_455",vW="_button_1yna4_473",wW="_buttonPrimary_1yna4_491",SW="_buttonSecondary_1yna4_513",Nt={modalOverlay:KY,modalContent:XY,modalHeader:ZY,modalTitle:eW,modalCloseButton:tW,modalBody:nW,errorText:iW,formGroup:rW,inputField:aW,searchResultsCard:sW,searchResultsList:oW,searchResultItem:lW,searchResultPrice:cW,selectedTestsCard:uW,selectedTestsHeader:dW,noTestsMessage:fW,selectedTestsList:hW,selectedTestItem:pW,selectedTestName:mW,selectedTestPrice:gW,removeTestButton:yW,totalAmount:xW,modalFooter:bW,button:vW,buttonPrimary:wW,buttonSecondary:SW},NW=({isOpen:e,onClose:n,patientId:t,labInventory:i,fetchPendingLabOrdersData:a})=>{const[o,l]=w.useState([]),[d,f]=w.useState(""),[u,p]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>{if(!d){p([]);return}const M=d.toLowerCase();p(i.filter(I=>I.name.toLowerCase().includes(M)||I.description&&I.description.toLowerCase().includes(M)).slice(0,10))},[d,i]);const k=async()=>{if(!t){b("Patient ID is missing.");return}if(o.length===0){b("Please select at least one lab test.");return}S(!0),b(null);try{const M={patient_id:t,tests:o.map(U=>({id:U.id,name:U.name,price:U.price}))},I=await me("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)});if(!I.ok){const U=await I.json().catch(()=>({}));throw new Error(U.message||`Failed to create lab order: ${I.statusText}`)}await I.json(),a(t),n(),l([]),f("")}catch(M){b(`Lab Order Creation Error: ${M.message}`)}finally{S(!1)}},T=M=>{if(o.some(I=>I.id===M.id)){b(`${M.name} is already in the order.`),setTimeout(()=>b(null),3e3),f(""),p([]);return}l(I=>[...I,{...M}]),f(""),p([])},P=M=>{l(I=>I.filter(U=>U.id!==M))};return e?r.jsx("div",{className:Nt.modalOverlay,children:r.jsxs("div",{className:Nt.modalContent,children:[r.jsxs("div",{className:Nt.modalHeader,children:[r.jsx("h3",{className:Nt.modalTitle,children:"Create New Lab Order"}),r.jsx("button",{onClick:n,className:Nt.modalCloseButton,children:r.jsx(Qn,{size:20})})]}),r.jsxs("div",{className:Nt.modalBody,children:[g&&r.jsx("div",{className:Nt.errorText,children:g}),r.jsxs("div",{className:Nt.formGroup,style:{position:"relative"},children:[r.jsx("label",{htmlFor:"lab-test-search",children:"Add Lab Test"}),r.jsx("input",{type:"text",id:"lab-test-search",placeholder:"Search available lab tests...",value:d,onChange:M=>f(M.target.value),className:Nt.inputField}),d&&u.length>0&&r.jsx("div",{className:Nt.searchResultsCard,children:r.jsx("ul",{className:Nt.searchResultsList,children:u.map(M=>r.jsxs("li",{onClick:()=>T(M),className:Nt.searchResultItem,children:[r.jsx("span",{children:M.name}),r.jsxs("span",{className:Nt.searchResultPrice,children:["(",parseFloat(String(M.price)).toFixed(2),")"]})]},M.id))})})]}),r.jsxs("div",{className:Nt.selectedTestsCard,children:[r.jsx("h4",{className:Nt.selectedTestsHeader,children:"Selected Tests"}),o.length===0?r.jsx("p",{className:Nt.noTestsMessage,children:"No tests added yet."}):r.jsx("ul",{className:Nt.selectedTestsList,children:o.map(M=>r.jsxs("li",{className:Nt.selectedTestItem,children:[r.jsx("span",{className:Nt.selectedTestName,children:M.name}),r.jsxs("span",{className:Nt.selectedTestPrice,children:["",parseFloat(String(M.price)).toFixed(2)]}),r.jsx("button",{type:"button",onClick:()=>P(String(M.id)),className:Nt.removeTestButton,title:"Remove Test",children:r.jsx(or,{size:16})})]},M.id))})]}),o.length>0&&r.jsxs("div",{className:Nt.totalAmount,children:["Total: ",o.reduce((M,I)=>M+parseFloat(String(I.price)),0).toFixed(2)]})]}),r.jsxs("div",{className:Nt.modalFooter,children:[r.jsx("button",{type:"button",onClick:n,className:`${Nt.button} ${Nt.buttonSecondary}`,children:" Cancel "}),r.jsxs("button",{type:"button",onClick:k,disabled:o.length===0||v,className:`${Nt.button} ${Nt.buttonPrimary} ${o.length===0||v?Nt.buttonDisabled:""}`,children:[" ",v?"Saving...":"Create Lab Order"," "]})]})]})}):null},Cx=e=>{if(!e)return"";let n=e.toLowerCase();return n=n.replace(/\b(mg|g|ml|iu|unit|tabs|tablet|tablets|capsule|capsules|injection|injections|syrup|solution|cream|ointment|lotion|spray|drops|patch|suppository|vial|ampoule|bottle|pack|kit)\b/g,""),n=n.replace(/\b(test|panel|profile|assay|screen|analysis|level|count|culture)\b/g,""),n=n.replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim(),n},qx=(e,n)=>{if(!e||!n||n.length===0)return;const t=Cx(e);let i=n.find(l=>Cx(l.name)===t);if(i)return i;let a=n.find(l=>Cx(l.name).includes(t));if(a)return a;let o=n.find(l=>t.includes(Cx(l.name)));if(o)return o},CW=`You are an expert OPD (Outpatient Department) medical assistant for a Doctor in a clinic in India. You will receive all the medical data of the patient including complaints (history), labs, pharmacy orders, etc., along with their date and time. Your primary goal is to assist the doctor and analyze patient chief complaints (Co), provide a structured clinical assessment including lab test suggestions (Lx), differential diagnoses (Dx), and a treatment plan (Tx). You have access to tools (actions) to order lab tests and pharmacy items, and update patient details.



**1. Definitions:**
   - Co: Chief complaints
   - Pt: Patient (assume living in India)
   - Lx: Laboratory tests
   - Dx: Differential Diagnosis
   - Tx: Treatment Plan

**2. Workflow:**
   - Analyze Co, generate Lx, Dx, and Tx sections as described below.
   - **Prioritization for Orders:** Always prioritize using \`edit_pharmacy_order\` or \`edit_lab_order\` if there are existing pending orders for the patient, before considering \`create_pharmacy_order\` or \`create_lab_order\`.
   - using edit_lab_order edits the lab order with the given serial numnber use to add new tests to the existing order or remove the tests from existing order, marking the status affects all tests in the order not only the test,always use this tool if there are pending lab orders instead of creating new orders.
   - using edit_pharmacy_order edits the pharmacy order with the given serial numnber to add new items to the existing order, update existing items, or remove items (either by \`items_to_remove\` or by setting \`quantity\` to 0). Always use this tool if there are pending pharmacy orders instead of creating new orders.
   - If your Lx section suggests tests from the inventory, use the \`create_lab_order\` action, but only for tests that are both clinically required and have not already been ordered or are still pending. Skip tests that are already ordered and in pending.
   - If your Tx section prescribes medications, use the \`create_pharmacy_order\` action  but only for medications that are clinically required and have not already been prescribed or are still pending. Skip medications that are already dispensed or already ordered.
   - If your Tx section prescribes medications that are *not* available in the inventory, use the \`prescription_for_unavailable_drugs\` parameter within the \`create_pharmacy_order\` action to specify the prescription details for these unavailable drugs.
   - When ordering pharmacy items, specify both \`pack_quantity\` (number of full packs) and \`loose_quantity\` (number of individual units). The system will handle the conversion based on the drug's unit/pack size.
   - **Patient Details Management:** Always store or update patient name, age, sex, and phone number using the \`update_patient_details\` action. If patient name, age, or sex is received as 'New Patient - Direct Entry', 'N/A', or blank, treat it as missing data; if the user input provides anything resembling a name, age, or sex (e.g., shiva 25m, robin 50m, priya 19f), update them using the \`update_patient_details\` action. If details are missing, you can ask the user for the missing details using the \`ask_followup_question\` action.
   - Always update new complaints of the patient using the \`add_complaint_history\` action.
   - If you generate a concise summary of the patient's current situation based on the interaction and history, use the \`update_case_summary\` action to save it.
   - Remember, when you use \`update_case_summary\`, the previous case summary will be replaced by the new one, so you can use it like a short-term memory to store other stuff that **keeps changing**, like the current treatment plan, plan of action, active problems, or current vitals, etc.
   - When you use \`add_complaint_history\`, it will add the complaint to the previous ones. You will be given all the previous complaints back in every query, so you can use it to store other long-term facts that do **not change**, like the history of a chronic illness, surgical history, allergies, or social history, etc.
   - while placing or editing a pharmacy order make sure to set the \`pack_quantity\` and \`loose_quantity\` right.
   - Use the \`update_clinic_ai_memory\` action to store or update **various types of clinic-wide persistent information in a concise way**. This can include 'summaries of common patient encounters'+'summeries of previous **Clinic-wide AI Memory**'(e.g., 'Patient X, 50m, chronic gastritis, last visit YYYY-MM-DD, prescribed Z, follow-up in N days'+'**Clinic-wide AI Memory** summary'), notes on local health trends, common diagnostic patterns observed in the clinic, specific operational protocols. This memory is shared across all interactions for the clinic and helps tailor responses to its specific context over time.
**3.**Multiple Actions:** You can perform multiple actions (like ordering labs AND meds, adding complaints, updating patient information, and asking a follow-up question) in a single response by including multiple action objects within the main JSON array.


**4. Chief Complaints (Co):**
   - Analyze the provided chief complaints.
   - Present them in a table with two columns: 'Relevant Complaint (Score 8-10)' and 'Irrelevant Complaint (Score 0-7)', based on clinical relevance.

**5. Lab Tests (Lx):**
   - Suggest the most probable basic lab tests based on the clinical picture, ordered by likelihood.
   - If a basic test is positive/abnormal, suggest relevant advanced tests.
   - **Inventory Check:** Compare suggested tests against the provided inventory list.
   - **Table 1: Available Lab Tests:** Present tests *available* in the inventory in a table with columns: '**Clinical Importance (High/Medium/Low)**', 'Lab Test'. If suggesting tests from this table, prepare to use the \`create_lab_order\` tool in your response.
   - **Table 2: Unavailable Lab Tests:** Present tests *not available* in the inventory in a separate table with columns: '**Clinical Importance (High/Medium/Low)**', 'Unavailable Basic Test'. Clearly state these are not orderable via the tool (generate Table 2 only when required tests are unavailable).

**6. Differential Diagnosis (Dx):**
   - List potential differential diagnoses.
   - Provide a confidence score (0-10) for each.
   - Present in a table with columns: 'Differential Diagnosis' and 'Confidence Score (0-10)'.

**7. Treatment Plan (Tx):**
   - Create a structured treatment plan including ideal medications based on the diagnosis.
   - **Inventory Check:** Compare prescribed medications against the provided inventory list.
   - **Table 1: Available Medications:** Present medications *available* in the inventory in a table with columns: 'Time Frame' (from and to dates), 'Treatment Goal', 'Intervention', 'Medication Type', 'Drug Form', 'Drug Name', 'Regimen (Dose, Freq)', 'Duration'. Before using the \`create_pharmacy_order\` tool, check if an order for the same drug has already been placed for this patient today. If an order already exists for today, do *not* create a duplicate order. If no order exists for today, prepare to use the \`create_pharmacy_order\` tool in your response.
   - **Table 2: Unavailable Medications:** Present medications *not available* in the inventory in a separate table with columns: 'Unavailable Drug Name', 'Ideal Regimen', 'Reasoning/Indication', '**Clinical Importance (High/Medium/Low)**', 'Suggested Available Substitute (from inventory, if possible)'. Clearly state these are not orderable via the tool (generate Table 2 only when required medications are unavailable in the inventory).

**8. Tools / Actions:**
   When you need to perform actions like ordering tests/meds, updating patient info, or adding history, use the following JSON array format. The response should ONLY contain this JSON array, nothing else.

   ****STRICT JSON****>>>>>>\`\`\`json
[
  { "action": "create_pharmacy_order", "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "prescription_for_unavailable_drugs": "string | null" },
  { "action": "edit_pharmacy_order", "serialNumber": number, "items": [ { "name": "Drug Name", "pack_quantity": number, "loose_quantity": number, "tabletsPerDay": number | null, "numberOfDays": number | null, "directions_to_use": "string | null" } ], "items_to_remove": [ { "drug_id": number | null, "name": "Drug Name" } ], "status": "pending" | "billed" | "dispensed" | "cancelled", "prescription_for_unavailable_drugs": "string | null" },
  { "action": "create_lab_order", "tests": [ { "name": "Test Name" } ] },
  { "action": "edit_lab_order", "serialNumber": number, "tests": [ { "name": "Test Name" } ], "items_to_remove": [ { "id": number | string | null, "name": "Test Name" } ], "status": "pending" | "billed" | "collected" | "processing" | "report_ready" | "completed" | "cancelled" | "reported" },
  { "action": "add_complaint_history", "complaint": "Specific past complaint text..." },
  { "action": "update_patient_details", "name": "New Name (optional)", "age": number (optional), "gender": "M" | "F" | "O" | null (optional), "phone_number": "string (optional)" },
  { "action": "update_case_summary", "summary": "Concise summary text..." },
  { "action": "update_clinic_ai_memory", "memory_content": "New clinic-wide AI memory content..." }
]
\`\`\`

   - **Multiple Actions in One Response:** You can include multiple action objects within this single JSON array if several actions are required based on your analysis (e.g., adding history AND ordering labs).
   - **Prioritization Within the Array:** If including multiple actions, order them within the array according to this priority:
     1. \`add_complaint_history\`
     2. \`update_patient_details\`
     3. \`update_case_summary\`
     4. \`update_clinic_ai_memory\`
     5. \`create_lab_order\`
     6. \`edit_lab_order\`
     7. \`create_pharmacy_order\`
     8. \`edit_pharmacy_order\`
   - **Example (Multiple Actions):**
     \`\`\`json
     [
       { "action": "add_complaint_history", "complaint": "Patient also reports mild fever since yesterday." },
       { "action": "create_lab_order", "tests": [ { "name": "CBC" } ] }
     ]
     \`\`\`

   - **\`ask_followup_question\`**: Use this *separate* tool format (a single JSON object, NOT inside the array) only when you need clarification or missing information that prevents you from completing the assessment or required actions.
     \`\`\`json
     {
       "action": "ask_followup_question",
       "question": "Your clear, specific question here.",
       "options": ["Optional Answer 1", "Optional Answer 2"] // Optional: Provide 2-5 choices
     }
     \`\`\`
     *Description:* Ask the user a question to gather additional information needed to complete the task. This tool should be used when you encounter ambiguities, need clarification, or require more details to proceed effectively. It allows for interactive problem-solving by enabling direct communication with the user. Use this tool judiciously to maintain a balance between gathering necessary information and avoiding excessive back-and-forth.
     *Parameters:*
       - question: (required) The question to ask the user. This should be a clear, specific question that addresses the information you need.
       - options: (optional) An array of 2-5 options for the user to choose from. Each option should be a string describing a possible answer. You may not always need to provide options, but it may be helpful in many cases where it can save the user from having to type out a response manually.


**Important:**
- Ensure all tables are clearly formatted using Markdown.
- Strictly adhere to the inventory constraints for labs and medications when deciding whether to use \`create_lab_order\` or \`create_pharmacy_order\`.
- When using actions, provide ONLY the JSON array (or the single JSON object for \`ask_followup_question\`) as the *very last* part of your response, after all other content including tables. Do not include any other text after the JSON.

**Plan Mode:**
When the user asks a question about a patient's condition or general medical topics (not entering new medical data), respond in PLAN MODE. In this mode, focus on answering the user's inquiry, clarifying their request, brainstorming ideas, or architecting a solution (like exploring treatment options). Ask clarifying questions if needed. Present detailed plans or explanations **using clear table formats and markdown (like bolding) for easy readability**. Engage in back-and-back discussion to finalize details. Do not use action tools (\`create_lab_order\`, \`create_pharmacy_order\`, \`add_complaint_history\`, \`update_patient_details\`) while in PLAN MODE).`,zj="AIzaSyBEt7v-LxBxAKwpTCtkI-3IshYxdnEqbes",jW="gemini-2.5-flash";async function _W(){if(!V2())return console.warn("No auth token found, using default Gemini API key."),zj;let n=null;try{const t=await me("/api/clinics/settings");if(t.ok){const i=await t.json();i.gemini_api_key&&i.gemini_api_key.trim()!==""&&(n=i.gemini_api_key.trim())}}catch(t){console.warn("Could not fetch clinic settings (or key missing), proceeding to global fallback.",t)}if(n)return n;try{const t=await me("/api/global-settings/app_gemini_api_key");if(t.ok){const a=(await t.json()).value;if(a&&a.trim()!=="")return a.trim()}}catch(t){console.warn("Could not fetch global API key.",t)}return console.warn("Clinic-specific and global Gemini API keys not found, using default env var."),zj}let D0=null;async function kW(){if(!D0){const e=await _W();D0=new p2({apiKey:e})}return D0}async function TW(e,n){const{query:t,currentDateTime:i,patientName:a,patientAge:o,patientGender:l,case_summary:d,case_summary_last_updated:f,clinic_ai_memory:u,clinic_ai_memory_last_updated:p,clinic_wide_system_prompt:g,labHistory:b,pharmacyOrders:v,pastComplaints:S,pharmacyInventory:k,labInventory:T}=e;let P=`Patient Complaint: ${t}`;if(d&&(P+=`

--- Case Summary (Provided by Doctor) ---
${d}`,f))try{const R=new Date(f).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});P+=`
(Last Updated: ${R})`}catch{console.warn(`Could not format case_summary_last_updated: ${f}`),P+=`
(Last Updated: ${f})`}if(a&&(P+=`

Patient Name: ${a}`),o!=null&&(P+=`
Patient Age: ${o}`),l&&(P+=`
Patient Gender: ${l}`),i)try{const R=new Date(i).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});P+=`

Current Interaction Time: ${R}`}catch{console.warn(`Could not format currentDateTime: ${i}`),P+=`

Current Interaction Time: ${i}`}if(u&&(P+=`

--- Clinic-wide AI Memory/Context ---
${u}`,p))try{const R=new Date(p).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0,timeZoneName:"short"});P+=`
(Last Updated: ${R})`}catch{console.warn(`Could not format clinic_ai_memory_last_updated: ${p}`),P+=`
(Last Updated: ${p})`}let M="";b&&Array.isArray(b)&&b.length>0&&(M=`

--- Lab History (Orders & Reports) ---
`,b.forEach(R=>{let B="Unknown Date";try{B=new Date(R.orderDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab order: ${R.orderDate}`)}if(M+=`
Order #${R.serialNumber} Date: ${B} (Status: ${R.status})
`,M+=`Tests: ${R.tests.map(Y=>Y.name).join(", ")}
`,R.report){let Y="Unknown Date";try{Y=new Date(R.report.reportDate).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date for lab report: ${R.report.reportDate}`)}M+=`  -> Report Date: ${Y}
`,R.report.tests&&Array.isArray(R.report.tests)?(M+=`     Findings:
`,R.report.tests.forEach(re=>{M+=`       - Test: ${re.testName}
`,re.parameters&&Array.isArray(re.parameters)&&re.parameters.forEach(ne=>{M+=`         - ${ne.name}: ${ne.value} (Normal: ${ne.normal_range})
`})})):(M+=`     Findings: ${R.report.reportContent||"N/A"}
`,R.report.error&&(M+=`     Note: ${R.report.error}
`))}M+=`---
`}),P+=M);let I="";v&&Array.isArray(v)&&v.length>0&&(I=`

--- Recent Pharmacy Orders ---
`,v.forEach(R=>{let B="Unknown Date/Time";try{B=new Date(R.date).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for pharmacy order: ${R.date}`)}I+=`
Order #${R.serialNumber} Date/Time: ${B} (Status: ${R.status})
`,I+=`Prescribed By: ${R.prescribedBy||"N/A"}
`,R.dispensedBy&&(I+=`Dispensed By: ${R.dispensedBy}
`),I+=`Medications:
`,R.medications.forEach(Y=>{I+=`  - ${Y.name} (Qty: ${Y.quantity}`,Y.tabletsPerDay&&(I+=`, ${Y.tabletsPerDay}/day`),Y.numberOfDays&&(I+=` for ${Y.numberOfDays} days`),I+=`)
`}),R.prescriptionForUnavailableDrugs&&(I+=`  Prescription for Unavailable Drugs: ${R.prescriptionForUnavailableDrugs}
`),I+=`---
`}),P+=I);let U="";S&&Array.isArray(S)&&S.length>0&&(U=`

--- Past Complaints History ---
`,S.forEach(R=>{let B="Unknown Date/Time";try{B=new Date(R.createdAt).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{console.warn(`Could not format date/time for past complaint: ${R.createdAt}`)}U+=`
Date/Time: ${B}
Complaint: ${R.complaint||"N/A"}
---
`}),P+=U);let L="";k&&Array.isArray(k)&&k.length>0&&(L=`

--- Current Pharmacy Inventory (Stock Levels) ---
`,k.forEach(R=>{L+=`- ${R.name} (Pack: ${R.unit??"N/A"}): ${R.quantity_in_stock??"N/A"}
`}),P+=L);let $="";T&&Array.isArray(T)&&T.length>0&&($=`

--- Available Lab Tests ---
`,T.forEach(R=>{$+=`- ${R.name} (Price: ${R.price??"N/A"})
`}),P+=$);const z=[{text:CW}];g&&g.trim()!==""&&z.push({text:`--- Additional Clinic-Specific Instructions ---
${g}`});const F=[{text:P}];if(n){const R=new FileReader,B=await new Promise((Y,re)=>{R.onloadend=()=>{typeof R.result=="string"?Y(R.result.split(",")[1]):re(new Error("Failed to read image file as base64."))},R.onerror=re,R.readAsDataURL(n)});F.push({inlineData:{mimeType:n.type,data:B}})}const Q=[];z.length>0&&Q.push({role:"user",parts:z}),Q.push({role:"user",parts:F});try{const R={model:jW,contents:Q,generationConfig:{temperature:.7,maxOutputTokens:1024,responseMimeType:"text/plain"}},Y=await(await kW()).models.generateContentStream(R);let re="";for await(const ne of Y)if(ne&&typeof ne.text=="function"){const G=ne.text;G&&(re+=G)}else ne&&ne.candidates&&ne.candidates[0]&&ne.candidates[0].content&&ne.candidates[0].content.parts&&ne.candidates[0].content.parts[0]&&ne.candidates[0].content.parts[0].text&&(re+=ne.candidates[0].content.parts[0].text);if(re&&re.trim()!=="")return re.trim();throw console.error("Empty or invalid response received from Gemini API stream."),new Error("Failed to get suggestion from AI (Gemini). Empty or invalid stream response.")}catch(R){console.error("Error calling Gemini API:",R);let B="Failed to get suggestion from Gemini.";throw R.message&&(B=`Error processing Gemini request: ${R.message}`),new Error(B)}}const EW=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)(?:s|tabs)?/i);return n?parseInt(n[1],10):1},AW=w.forwardRef(({recordId:e,patientId:n,patientDetails:t,caseSummary:i,caseSummaryUpdatedAt:a,clinicSettings:o,userMessages:l,selectedImageFile:d,pendingLabOrders:f,labReports:u,pastComplaints:p,pharmacyOrders:g,pharmacyInventory:b,labInventory:v,currentComplaint:S,setCurrentComplaint:k,setAiResponse:T,setAiResponseText:P,setAiResponseJsonString:M,setShowAiJsonDetails:I,setIsLoadingAi:U,setAiError:L,setIsSubmittingAiOrder:$,setAiOrderSubmissionStatus:z,setIsSubmittingAiLabOrder:F,setAiLabOrderSubmissionStatus:Q,setIsSubmittingAiComplaint:R,setAiComplaintSubmissionStatus:B,setIsUpdatingCaseSummary:Y,setAiCaseSummaryUpdateStatus:re,setCaseSummary:ne,setIsUpdatingAiMemoryByAI:G,setAiMemoryUpdateByAIStatus:V,setFollowUpQuestion:W,setFollowUpOptions:J,setError:he,setIsSavingAiResponse:A,setSaveAiResponseError:ce,fetchPharmacyOrdersData:se,fetchPendingLabOrdersData:D,fetchPastComplaintsData:oe,fetchPatientDetails:xe,setClinicSettings:Z,setEditedAiMemory:ue,setCanUndo:ae,onAiActionSuccess:Re,addMessage:Ae},Ce)=>{const[Se,De]=vn.useState(null);vn.useEffect(()=>{ae(!!Se)},[Se,ae]);let Me;const et=async(jt,_e,Fe,Pe=0)=>{let Ue;const ee=["AI response did not contain a recognized function call","AI response did not result in a recognized or performed function call"].some(fe=>{var qe;return(qe=_e.message)==null?void 0:qe.includes(fe)});Fe&&ee?Ue=`AI Error: ${_e.message}

${Fe}`:(Ue=`I encountered a frontend error while trying to execute the '${jt}' function. The error message is: "${_e.message}". Based on this error, please analyze what went wrong and either correct the function call and try again, or explain the problem.`,(jt==="create_pharmacy_order"||jt==="edit_pharmacy_order")&&(Ue+=`

IMPORTANT: When ordering medication, please first check if the medication ordered matches the exact name given in the inventory. If the name itself is not given in the inventory, you can also use 'prescription_for_unavailable_drugs' to write a prescription for unavailable drugs.`),Fe&&(Ue+=`

The original AI response that caused the error was:
\`\`\`
${Fe}
\`\`\``)),Ae==null||Ae({role:"system",type:"error",content:`AI Error: ${_e.message}. Retrying...`}),await Me(Ue,Pe+1)},ct=async jt=>{console.log("Executing Rollback for actions:",jt);for(const _e of jt){const{actionType:Fe,undoData:Pe}=_e;if(console.log(`Attempting to rollback ${Fe}`,Pe),!Pe){console.warn(`No undoData found for action ${Fe}, skipping.`);continue}try{if(Fe==="create_pharmacy_order")Pe!=null&&Pe.orderId?(console.log(`Deleting pharmacy order ${Pe.orderId}`),await me(`/api/pharmacy-orders/${Pe.orderId}`,{method:"DELETE"}),se(n)):console.error("Missing orderId for create_pharmacy_order rollback");else if(Fe==="create_lab_order")Pe!=null&&Pe.orderId?(console.log(`Deleting lab order ${Pe.orderId}`),await me(`/api/lab/orders/${Pe.orderId}`,{method:"DELETE"}),D(n)):console.error("Missing orderId for create_lab_order rollback");else if(Fe==="update_patient_details")if(Pe!=null&&Pe.patientId&&(Pe!=null&&Pe.originalDetails)){console.log(`Reverting patient details for ${Pe.patientId}`);const Ue=Pe.originalDetails,ve={name:Ue.name,age:Ue.age,gender:Ue.gender,phone:Ue.phone,ai_response:Ue.ai_response};await me(`/api/patients/${Pe.patientId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ve)}),xe(Pe.patientId)}else console.error("Missing patientId or originalDetails for update_patient_details rollback");else if(Fe==="add_complaint_history")Pe!=null&&Pe.recordId?(console.log(`Reverting complaint history for ${Pe.recordId}`),await me(`/api/queue/doctor/complaint/${Pe.recordId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({complaint:Pe.originalComplaint||""})}),k(Pe.originalComplaint||"")):console.error("Missing recordId for add_complaint_history rollback");else if(Fe==="update_case_summary")Pe!=null&&Pe.recordId?(console.log(`Reverting case summary for ${Pe.recordId}`),await me(`/api/queue/doctor/complaint/${Pe.recordId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:Pe.originalSummary||""})}),ne(Pe.originalSummary||"")):console.error("Missing recordId for update_case_summary rollback");else if(Fe==="update_clinic_ai_memory")(Pe==null?void 0:Pe.originalMemory)!==void 0?(console.log("Reverting AI memory"),await me("/api/clinics/settings",{method:"PUT",body:JSON.stringify({...o,aiMemory:Pe.originalMemory})}),ue(Pe.originalMemory)):console.error("Missing originalMemory for update_clinic_ai_memory rollback");else if(Fe==="edit_pharmacy_order")if(Pe!=null&&Pe.orderId&&(Pe!=null&&Pe.originalState)){console.log(`Reverting pharmacy order ${Pe.orderId}`);const Ue={items:Pe.originalState.medications||[],status:Pe.originalState.status,prescription_for_unavailable_drugs:Pe.originalState.prescription_for_unavailable_drugs,order_total:Pe.originalState.order_total};await me(`/api/pharmacy-orders/${Pe.orderId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ue)}),se(n)}else console.error("Missing orderId or originalState for edit_pharmacy_order rollback");else if(Fe==="edit_lab_order")if(Pe!=null&&Pe.orderId&&(Pe!=null&&Pe.originalState)){console.log(`Reverting lab order ${Pe.orderId}`);const Ue={tests:Pe.originalState.tests,status:Pe.originalState.status};await me(`/api/lab/orders/${Pe.orderId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ue)}),D(n)}else console.error("Missing orderId or originalState for edit_lab_order rollback");else console.warn(`Unknown action type for rollback: ${Fe}`)}catch(Ue){console.error(`Failed to rollback ${Fe}:`,Ue)}}},ut=async()=>{!Se||!window.confirm("Are you sure you want to undo the last AI actions?")||(U(!0),await ct([...Se].reverse()),De(null),U(!1),L("Last actions undone successfully."))},at=async(jt,_e)=>{De(null),z(null),Q(null),B(null),re(null),V(null),W(null),J([]),he(null);let Fe=null;const Pe=/```json\s*([\s\S]*?)\s*```/,Ue=jt.match(Pe);if(Ue&&Ue[1])Fe=Ue[1];else{const ve=jt.trim();if(ve.startsWith("{")&&ve.endsWith("}"))Fe=ve;else if(ve.startsWith("[")&&ve.endsWith("]"))Fe=ve;else throw new Error("AI response did not contain a recognized function call.")}if(Fe)try{const ve=JSON.parse(Fe),ee=Array.isArray(ve)?ve:[ve],fe=[];let qe=null,nt=!1;for(const Ve of ee){if(Ve.action==="ask_followup_question"){qe=Ve,nt=!0;continue}nt=!0;const be=Ve.action;be==="update_clinic_ai_memory"&&typeof Ve.memory_content=="string"?fe.push((async()=>{G(!0),V("Processing AI mem..."),Ae==null||Ae({role:"system",type:"loading",content:"Processing AI memory..."});const ye=(o==null?void 0:o.aiMemory)||"";try{if(!o)throw new Error("Clinic settings not loaded.");const Oe={...o,aiMemory:Ve.memory_content.trim(),admissionCharge:o.admissionCharge,perDayCharge:o.perDayCharge,otherCharges:o.otherCharges,clinicWideSystemPrompt:o.clinicWideSystemPrompt},He=await me("/api/clinics/settings",{method:"PUT",body:JSON.stringify(Oe)});if(!He.ok){const rt=await He.json().catch(()=>({}));throw new Error(rt.message||`AI-triggered clinic memory update failed: ${He.statusText}`)}const tt=await He.json();return Z(rt=>rt?{...rt,aiMemory:tt.settings.aiMemory}:null),ue(tt.settings.aiMemory||""),V("AI mem updated!"),Ae==null||Ae({role:"system",type:"success",content:"AI memory updated successfully."}),{success:!0,actionType:be,undoData:{originalMemory:ye}}}catch(Oe){return V("Failed"),{success:!1,actionType:be,error:Oe,originalActionPayload:Ve}}finally{G(!1)}})()):be==="create_pharmacy_order"?fe.push((async()=>{var ye,Oe;$(!0),z("Processing order..."),Ae==null||Ae({role:"system",type:"loading",content:"Processing pharmacy order..."});try{if(!n)throw new Error("Missing patient ID.");const He=[];let tt=null;if(Array.isArray(Ve.items))for(const Et of Ve.items){let Vt;if(Et.drug_id?Vt=b.find(zn=>zn.id===Et.drug_id):Et.name&&(Vt=qx(Et.name,b)),!Vt){tt=`Drug "${Et.name||Et.drug_id}" not found.`;break}const hi=EW(Vt.unit),gn=Number(Vt.price),Dn=gn,Bt=hi>0?gn/hi:0,Ys=Number(Et.pack_quantity)||0,Ws=Number(Et.loose_quantity)||0,Fi=Ys*Dn+Ws*Bt;He.push({drug_id:String(Vt.id),name:Vt.name,pack_quantity:Ys,loose_quantity:Ws,tabletsPerDay:Et.tabletsPerDay,numberOfDays:Et.numberOfDays,directions_to_use:Et.directions_to_use,group_id:Et.group_id,pack_price:Dn,loose_price:Bt,total_price:Fi,price:gn,isLoose:Et.isLoose,unit:Vt.unit})}if(tt)throw new Error(tt);const rt=He.reduce((Et,Vt)=>Et+Vt.total_price,0),Ft={patient_id:n,items:He,prescription_for_unavailable_drugs:Ve.prescription_for_unavailable_drugs,order_total:parseFloat(rt.toFixed(2))},Kn=await me("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ft)});if(!Kn.ok){const Et=await Kn.json().catch(()=>({}));throw new Error(Et.message||"Order creation failed.")}const Pn=await Kn.json();return z("Order created!"),se(n),Ae==null||Ae({role:"system",type:"success",content:"Pharmacy order created successfully."}),{success:!0,actionType:be,data:Pn,undoData:{orderId:((Oe=(ye=Pn.orders)==null?void 0:ye[0])==null?void 0:Oe.id)||Pn.id}}}catch(He){return Ae==null||Ae({role:"system",type:"error",content:`Pharmacy order failed: ${He.message}`}),{success:!1,actionType:be,error:He,originalActionPayload:Ve}}finally{$(!1)}})()):be==="update_patient_details"?fe.push((async()=>{U(!0),Ae==null||Ae({role:"system",type:"loading",content:"Updating patient details..."});const ye={...t};try{if(!n)throw new Error("Missing patient ID.");const Oe={};if(Ve.name&&(Oe.name=Ve.name),Ve.age&&(Oe.age=Ve.age),Ve.gender&&(Oe.gender=Ve.gender),Ve.phone_number!==void 0&&(Oe.phone_number=Ve.phone_number),!(await me(`/api/patients/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Oe)})).ok)throw new Error("Patient update failed.");return xe(n),Ae==null||Ae({role:"system",type:"success",content:"Patient details updated."}),{success:!0,actionType:be,undoData:{patientId:n,originalDetails:ye}}}catch(Oe){return{success:!1,actionType:be,error:Oe,originalActionPayload:Ve}}finally{U(!1)}})()):be==="create_lab_order"?fe.push((async()=>{F(!0),Q("Processing lab..."),Ae==null||Ae({role:"system",type:"loading",content:"Processing lab order..."});try{if(!n)throw new Error("Missing patient ID.");const ye=[];for(const tt of Ve.tests||[]){let rt;if(tt.id?rt=v.find(Ft=>String(Ft.id)===String(tt.id)):tt.name&&(rt=qx(tt.name,v)),!rt)throw new Error(`Lab test "${tt.name}" not found.`);ye.push({id:rt.id,name:rt.name,price:Number(rt.price)})}const Oe=await me("/api/lab",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:n,tests:ye})});if(!Oe.ok)throw new Error("Lab order creation failed.");const He=await Oe.json();return Q("Success!"),D(n),Ae==null||Ae({role:"system",type:"success",content:"Lab order created."}),{success:!0,actionType:be,data:He.labOrder,undoData:{orderId:He.labOrder.id}}}catch(ye){return Ae==null||Ae({role:"system",type:"error",content:`Lab order failed: ${ye.message}`}),{success:!1,actionType:be,error:ye,originalActionPayload:Ve}}finally{F(!1)}})()):be==="edit_pharmacy_order"?fe.push((async()=>{$(!0);try{const ye=Ve.serialNumber;let Oe;if(ye?Oe=[...g].sort((Vt,hi)=>new Date(Vt.date).getTime()-new Date(hi.date).getTime())[ye-1]:Oe=g.find(Et=>Et.status==="pending"),!Oe)throw new Error("Order to edit not found.");const He=JSON.parse(JSON.stringify(Oe));let tt=[...Oe.medications];const rt=Ve.items_to_remove,Ft=Ve.items;if(Array.isArray(rt)&&(tt=tt.filter(Et=>!rt.some(Vt=>Vt.drug_id&&String(Et.drug_id)===String(Vt.drug_id)||Vt.name&&Et.name.toLowerCase()===Vt.name.toLowerCase()))),Array.isArray(Ft))for(const Et of Ft){let Vt;if(Et.drug_id?Vt=b.find(Dn=>String(Dn.id)===String(Et.drug_id)):Et.name&&(Vt=qx(Et.name,b)),!Vt)throw new Error(`Drug ${Et.name} not found.`);const hi=tt.findIndex(Dn=>Dn.drug_id===String(Vt==null?void 0:Vt.id)),gn={drug_id:String(Vt.id),name:Vt.name,pack_quantity:Et.pack_quantity||0,loose_quantity:Et.loose_quantity||0,pack_price:Number(Vt.price),loose_price:0,total_price:0,price:Number(Vt.price)};hi>=0?tt[hi]={...tt[hi],...gn}:tt.push(gn)}const Kn={items:tt,status:Ve.status,prescription_for_unavailable_drugs:Ve.prescription_for_unavailable_drugs,order_total:0};if(!(await me(`/api/pharmacy-orders/${Oe.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Kn)})).ok)throw new Error("Order edit failed.");return se(n),{success:!0,actionType:be,undoData:{orderId:Oe.id,originalState:He}}}catch(ye){return{success:!1,actionType:be,error:ye,originalActionPayload:Ve}}finally{$(!1)}})()):be==="edit_lab_order"?fe.push((async()=>{F(!0);try{const ye=f.sort((rt,Ft)=>new Date(Ft.createdAt).getTime()-new Date(rt.createdAt).getTime()).find(rt=>rt.status==="pending");if(!ye)throw new Error("No pending lab order to edit.");const Oe=JSON.parse(JSON.stringify(ye)),He={tests:[],status:Ve.status};if(!(await me(`/api/lab/orders/${ye.id}`,{method:"PUT",body:JSON.stringify(He),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Lab edit failed.");return D(n),{success:!0,actionType:be,undoData:{orderId:ye.id,originalState:Oe}}}catch(ye){return{success:!1,actionType:be,error:ye,originalActionPayload:Ve}}finally{F(!1)}})()):be==="add_complaint_history"?fe.push((async()=>{R(!0),Ae==null||Ae({role:"system",type:"loading",content:"Updating complaint history..."});const ye=S;try{if(!e)throw new Error("No record ID.");if(!(await me(`/api/queue/doctor/complaint/${e}`,{method:"PUT",body:JSON.stringify({complaint:Ve.complaint}),headers:{"Content-Type":"application/json"}})).ok)throw new Error("Complaint update failed.");return k(Ve.complaint),n&&oe(n),Ae==null||Ae({role:"system",type:"success",content:"Complaint history updated."}),{success:!0,actionType:be,undoData:{recordId:e,originalComplaint:ye}}}catch(Oe){return Ae==null||Ae({role:"system",type:"error",content:`Complaint history update failed: ${Oe.message}`}),{success:!1,actionType:be,error:Oe,originalActionPayload:Ve}}finally{R(!1)}})()):be==="update_case_summary"?fe.push((async()=>{Y(!0),Ae==null||Ae({role:"system",type:"loading",content:"Updating case summary..."});const ye=i;try{if(!e)throw new Error("No record ID.");const Oe=await me(`/api/queue/doctor/complaint/${e}`,{method:"PUT",body:JSON.stringify({case_summary:Ve.summary}),headers:{"Content-Type":"application/json"}});if(!Oe.ok)throw new Error("Summary update failed.");const He=await Oe.json();return ne(He.case_summary),Ae==null||Ae({role:"system",type:"success",content:"Case summary updated."}),{success:!0,actionType:be,undoData:{recordId:e,originalSummary:ye}}}catch(Oe){return Ae==null||Ae({role:"system",type:"error",content:`Case summary update failed: ${Oe.message}`}),{success:!1,actionType:be,error:Oe,originalActionPayload:Ve}}finally{Y(!1)}})()):(console.warn(`Unknown action ${be}`),fe.push(Promise.resolve({success:!1,actionType:be,error:new Error(`Unknown action: ${be}`),originalActionPayload:Ve})))}const lt=await Promise.all(fe),wt=lt.filter(Ve=>!Ve.success);if(wt.length>0){console.log("AI Actions Failed. Initiating Rollback...",wt);const Ve=lt.filter(tt=>tt.success),be=[...Ve].reverse();await ct(be);const ye=wt.map(tt=>{var rt;return`${tt.actionType}: ${(rt=tt.error)==null?void 0:rt.message}`}).join("; "),Oe=Ve.length>0?` I successfully rolled back ${Ve.length} other actions that succeeded.`:"",He=`One or more actions failed: [${ye}].${Oe} Please analyze the failure and try again.`;await et("multiple_actions",{message:He},jt,_e)}else{const Ve=lt.filter(be=>be.success);if(Ve.length>0&&(De(Ve),Re&&Ve.forEach(be=>Re(be.actionType))),qe&&typeof qe.question=="string")W(qe.question),J(Array.isArray(qe.options)?qe.options:[]);else if(!nt)throw new Error("AI response did not result in a recognized or performed function call.")}}catch(ve){await et("parse_json_actions",ve,jt,_e)}else throw new Error("AI response did not contain a recognized function call.")};Me=async(jt,_e=0)=>{if(_e>1){L("AI call failed after multiple retries. Please try a different prompt."),U(!1);return}U(!0),L(null);let Fe;const Ue=[...l,jt].join(`

`);try{const ve=new Map;(f??[]).forEach(Ve=>{ve.set(Ve.id,{...Ve})}),(u??[]).forEach(Ve=>{if(!ve.has(Ve.id))ve.set(Ve.id,{id:Ve.id,patient_id:Ve.patient_id,tests:Ve.tests,status:Ve.status,createdAt:Ve.createdAt,report:Ve});else{const be=ve.get(Ve.id);be&&(be.report=Ve,be.status=Ve.status)}});const ee=Array.from(ve.values());ee.sort((Ve,be)=>new Date(be.createdAt).getTime()-new Date(Ve.createdAt).getTime());const fe=ee.map((Ve,be)=>{let ye=null;if(Ve.report)try{const Oe=typeof Ve.report.report_content=="string"?Ve.report.report_content:JSON.stringify(Ve.report.report_content||{}),He=JSON.parse(Oe||"{}"),tt=(Ve.report.tests||[]).map(rt=>{const Ft=He[rt.id]||{},Kn=Pn=>({name:Pn.name,value:Ft[Pn.name]!==void 0?String(Ft[Pn.name]):String(Pn.defaultValue),normal_range:Pn.normal_range||"N/A"});return{testId:rt.id,testName:rt.name,parameters:(rt.default_parameters||[]).map(Kn)}});ye={reportId:Ve.report.reportId,reportDate:Ve.report.report_date,tests:tt}}catch{ye={reportId:Ve.report.reportId,reportDate:Ve.report.report_date,reportContent:typeof Ve.report.report_content=="string"?Ve.report.report_content:JSON.stringify(Ve.report.report_content),error:"Failed to parse report content JSON."}}return{serialNumber:ee.length-be,orderId:Ve.id,orderDate:isNaN(new Date(Ve.createdAt).getTime())?Ve.createdAt:new Date(Ve.createdAt).toISOString(),tests:Ve.tests.map(Oe=>({id:Oe.id,name:Oe.name,price:Oe.price})),status:Ve.status,report:ye}}),qe=p.map(Ve=>{try{return{...Ve,createdAt:isNaN(new Date(Ve.createdAt).getTime())?Ve.createdAt:new Date(Ve.createdAt).toISOString()}}catch{return Ve}}),lt=[...g].sort((Ve,be)=>{const ye=new Date(Ve.date).getTime(),Oe=new Date(be.date).getTime();return ye-Oe}).map((Ve,be)=>{try{return{serialNumber:be+1,...Ve,date:Ve.date&&!isNaN(new Date(Ve.date).getTime())?new Date(Ve.date).toISOString():Ve.date}}catch{return{serialNumber:be+1,...Ve}}}),wt={query:Ue,currentDateTime:new Date().toISOString(),patientName:(t==null?void 0:t.name)||"",patientAge:(t==null?void 0:t.age)||void 0,patientGender:(t==null?void 0:t.gender)||void 0,case_summary:i||"",case_summary_last_updated:a?new Date(a).toISOString():void 0,clinic_ai_memory:(o==null?void 0:o.aiMemory)||"",clinic_ai_memory_last_updated:o!=null&&o.aiMemoryUpdatedAt?new Date(o.aiMemoryUpdatedAt).toISOString():void 0,clinic_wide_system_prompt:(o==null?void 0:o.clinicWideSystemPrompt)||"",labHistory:fe,pharmacyOrders:lt,pastComplaints:qe,pharmacyInventory:b,labInventory:v};if(console.log("DEBUG: Payload before sending to Gemini API:",JSON.stringify(wt,null,2)),Fe=await TW(wt,d),Fe){T(Fe),Ae==null||Ae({role:"ai",content:Fe});const Ve=/```json\s*([\s\S]*?)\s*```/,be=Fe.match(Ve);if(be&&be[1])P(Fe.replace(Ve,"").trim()),M(be[1].trim());else{const ye=Fe.trim();if(ye.startsWith("{")&&ye.endsWith("}"))try{JSON.parse(ye),P(""),M(ye)}catch{P(ye),M(null)}else if(ye.startsWith("[")&&ye.endsWith("]"))try{JSON.parse(ye),P(""),M(ye)}catch{P(ye),M(null)}else P(ye),M(null)}I(!1),n&&Fe&&await qt(n,Fe),await at(Fe,_e),k("")}else throw new Error("Invalid AI response format.")}catch(ve){await et("call_generative_api",ve,Fe,_e)}finally{U(!1)}};const qt=async(jt,_e)=>{A(!0),ce(null);try{const Fe={ai_response:_e},Pe=await me(`/api/patients/${jt}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Fe)});if(!Pe.ok){const Ue=await Pe.json().catch(()=>({}));throw new Error(Ue.message||`Failed to save AI response to patient: ${Pe.statusText}`)}}catch(Fe){ce(`AI Response Save Error: ${Fe.message}`),Ae==null||Ae({role:"system",type:"error",content:`AI Response Save Error: ${Fe.message}`})}finally{A(!1)}};return w.useImperativeHandle(Ce,()=>({callGenerativeApi:Me,undoLastAction:ut})),null}),PW={};function Vw(e,n){const t=PW,i=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return fE(e,i,a)}function fE(e,n,t){if(DW(e)){if("value"in e)return e.type==="html"&&!t?"":e.value;if(n&&"alt"in e&&e.alt)return e.alt;if("children"in e)return Uj(e.children,n,t)}return Array.isArray(e)?Uj(e,n,t):""}function Uj(e,n,t){const i=[];let a=-1;for(;++a<e.length;)i[a]=fE(e[a],n,t);return i.join("")}function DW(e){return!!(e&&typeof e=="object")}const Bj=document.createElement("i");function Hw(e){const n="&"+e+";";Bj.innerHTML=n;const t=Bj.textContent;return t.charCodeAt(t.length-1)===59&&e!=="semi"||t===n?!1:t}function Ko(e,n,t,i){const a=e.length;let o=0,l;if(n<0?n=-n>a?0:a+n:n=n>a?a:n,t=t>0?t:0,i.length<1e4)l=Array.from(i),l.unshift(n,t),e.splice(...l);else for(t&&e.splice(n,t);o<i.length;)l=i.slice(o,o+1e4),l.unshift(n,0),e.splice(...l),o+=1e4,n+=1e4}function as(e,n){return e.length>0?(Ko(e,e.length,0,n),e):n}const qj={}.hasOwnProperty;function IW(e){const n={};let t=-1;for(;++t<e.length;)RW(n,e[t]);return n}function RW(e,n){let t;for(t in n){const a=(qj.call(e,t)?e[t]:void 0)||(e[t]={}),o=n[t];let l;if(o)for(l in o){qj.call(a,l)||(a[l]=[]);const d=o[l];MW(a[l],Array.isArray(d)?d:d?[d]:[])}}}function MW(e,n){let t=-1;const i=[];for(;++t<n.length;)(n[t].add==="after"?e:i).push(n[t]);Ko(e,0,0,i)}function hE(e,n){const t=Number.parseInt(e,n);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function _h(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Wo=yu(/[A-Za-z]/),Aa=yu(/[\dA-Za-z]/),OW=yu(/[#-'*+\--9=?A-Z^-~]/);function L1(e){return e!==null&&(e<32||e===127)}const F1=yu(/\d/),LW=yu(/[\dA-Fa-f]/),FW=yu(/[!-/:-@[-`{-~]/);function zt(e){return e!==null&&e<-2}function la(e){return e!==null&&(e<0||e===32)}function An(e){return e===-2||e===-1||e===32}const $W=yu(new RegExp("\\p{P}|\\p{S}","u")),zW=yu(/\s/);function yu(e){return n;function n(t){return t!==null&&t>-1&&e.test(String.fromCharCode(t))}}function Yh(e){const n=[];let t=-1,i=0,a=0;for(;++t<e.length;){const o=e.charCodeAt(t);let l="";if(o===37&&Aa(e.charCodeAt(t+1))&&Aa(e.charCodeAt(t+2)))a=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(l=String.fromCharCode(o));else if(o>55295&&o<57344){const d=e.charCodeAt(t+1);o<56320&&d>56319&&d<57344?(l=String.fromCharCode(o,d),a=1):l=""}else l=String.fromCharCode(o);l&&(n.push(e.slice(i,t),encodeURIComponent(l)),i=t+a+1,l=""),a&&(t+=a,a=0)}return n.join("")+e.slice(i)}function ri(e,n,t,i){const a=i?i-1:Number.POSITIVE_INFINITY;let o=0;return l;function l(f){return An(f)?(e.enter(t),d(f)):n(f)}function d(f){return An(f)&&o++<a?(e.consume(f),d):(e.exit(t),n(f))}}const UW={tokenize:BW};function BW(e){const n=e.attempt(this.parser.constructs.contentInitial,i,a);let t;return n;function i(d){if(d===null){e.consume(d);return}return e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),ri(e,n,"linePrefix")}function a(d){return e.enter("paragraph"),o(d)}function o(d){const f=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=f),t=f,l(d)}function l(d){if(d===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(d);return}return zt(d)?(e.consume(d),e.exit("chunkText"),o):(e.consume(d),l)}}const qW={tokenize:VW},Vj={tokenize:HW};function VW(e){const n=this,t=[];let i=0,a,o,l;return d;function d(I){if(i<t.length){const U=t[i];return n.containerState=U[1],e.attempt(U[0].continuation,f,u)(I)}return u(I)}function f(I){if(i++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,a&&M();const U=n.events.length;let L=U,$;for(;L--;)if(n.events[L][0]==="exit"&&n.events[L][1].type==="chunkFlow"){$=n.events[L][1].end;break}P(i);let z=U;for(;z<n.events.length;)n.events[z][1].end={...$},z++;return Ko(n.events,L+1,0,n.events.slice(U)),n.events.length=z,u(I)}return d(I)}function u(I){if(i===t.length){if(!a)return b(I);if(a.currentConstruct&&a.currentConstruct.concrete)return S(I);n.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return n.containerState={},e.check(Vj,p,g)(I)}function p(I){return a&&M(),P(i),b(I)}function g(I){return n.parser.lazy[n.now().line]=i!==t.length,l=n.now().offset,S(I)}function b(I){return n.containerState={},e.attempt(Vj,v,S)(I)}function v(I){return i++,t.push([n.currentConstruct,n.containerState]),b(I)}function S(I){if(I===null){a&&M(),P(0),e.consume(I);return}return a=a||n.parser.flow(n.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:o}),k(I)}function k(I){if(I===null){T(e.exit("chunkFlow"),!0),P(0),e.consume(I);return}return zt(I)?(e.consume(I),T(e.exit("chunkFlow")),i=0,n.interrupt=void 0,d):(e.consume(I),k)}function T(I,U){const L=n.sliceStream(I);if(U&&L.push(null),I.previous=o,o&&(o.next=I),o=I,a.defineSkip(I.start),a.write(L),n.parser.lazy[I.start.line]){let $=a.events.length;for(;$--;)if(a.events[$][1].start.offset<l&&(!a.events[$][1].end||a.events[$][1].end.offset>l))return;const z=n.events.length;let F=z,Q,R;for(;F--;)if(n.events[F][0]==="exit"&&n.events[F][1].type==="chunkFlow"){if(Q){R=n.events[F][1].end;break}Q=!0}for(P(i),$=z;$<n.events.length;)n.events[$][1].end={...R},$++;Ko(n.events,F+1,0,n.events.slice(z)),n.events.length=$}}function P(I){let U=t.length;for(;U-- >I;){const L=t[U];n.containerState=L[1],L[0].exit.call(n,e)}t.length=I}function M(){a.write([null]),o=void 0,a=void 0,n.containerState._closeFlow=void 0}}function HW(e,n,t){return ri(e,e.attempt(this.parser.constructs.document,n,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function mb(e){if(e===null||la(e)||zW(e))return 1;if($W(e))return 2}function Gw(e,n,t){const i=[];let a=-1;for(;++a<e.length;){const o=e[a].resolveAll;o&&!i.includes(o)&&(n=o(n,t),i.push(o))}return n}const $1={name:"attention",resolveAll:GW,tokenize:YW};function GW(e,n){let t=-1,i,a,o,l,d,f,u,p;for(;++t<e.length;)if(e[t][0]==="enter"&&e[t][1].type==="attentionSequence"&&e[t][1]._close){for(i=t;i--;)if(e[i][0]==="exit"&&e[i][1].type==="attentionSequence"&&e[i][1]._open&&n.sliceSerialize(e[i][1]).charCodeAt(0)===n.sliceSerialize(e[t][1]).charCodeAt(0)){if((e[i][1]._close||e[t][1]._open)&&(e[t][1].end.offset-e[t][1].start.offset)%3&&!((e[i][1].end.offset-e[i][1].start.offset+e[t][1].end.offset-e[t][1].start.offset)%3))continue;f=e[i][1].end.offset-e[i][1].start.offset>1&&e[t][1].end.offset-e[t][1].start.offset>1?2:1;const g={...e[i][1].end},b={...e[t][1].start};Hj(g,-f),Hj(b,f),l={type:f>1?"strongSequence":"emphasisSequence",start:g,end:{...e[i][1].end}},d={type:f>1?"strongSequence":"emphasisSequence",start:{...e[t][1].start},end:b},o={type:f>1?"strongText":"emphasisText",start:{...e[i][1].end},end:{...e[t][1].start}},a={type:f>1?"strong":"emphasis",start:{...l.start},end:{...d.end}},e[i][1].end={...l.start},e[t][1].start={...d.end},u=[],e[i][1].end.offset-e[i][1].start.offset&&(u=as(u,[["enter",e[i][1],n],["exit",e[i][1],n]])),u=as(u,[["enter",a,n],["enter",l,n],["exit",l,n],["enter",o,n]]),u=as(u,Gw(n.parser.constructs.insideSpan.null,e.slice(i+1,t),n)),u=as(u,[["exit",o,n],["enter",d,n],["exit",d,n],["exit",a,n]]),e[t][1].end.offset-e[t][1].start.offset?(p=2,u=as(u,[["enter",e[t][1],n],["exit",e[t][1],n]])):p=0,Ko(e,i-1,t-i+3,u),t=i+u.length-p-2;break}}for(t=-1;++t<e.length;)e[t][1].type==="attentionSequence"&&(e[t][1].type="data");return e}function YW(e,n){const t=this.parser.constructs.attentionMarkers.null,i=this.previous,a=mb(i);let o;return l;function l(f){return o=f,e.enter("attentionSequence"),d(f)}function d(f){if(f===o)return e.consume(f),d;const u=e.exit("attentionSequence"),p=mb(f),g=!p||p===2&&a||t.includes(f),b=!a||a===2&&p||t.includes(i);return u._open=!!(o===42?g:g&&(a||!b)),u._close=!!(o===42?b:b&&(p||!g)),n(f)}}function Hj(e,n){e.column+=n,e.offset+=n,e._bufferIndex+=n}const WW={name:"autolink",tokenize:QW};function QW(e,n,t){let i=0;return a;function a(v){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o}function o(v){return Wo(v)?(e.consume(v),l):v===64?t(v):u(v)}function l(v){return v===43||v===45||v===46||Aa(v)?(i=1,d(v)):u(v)}function d(v){return v===58?(e.consume(v),i=0,f):(v===43||v===45||v===46||Aa(v))&&i++<32?(e.consume(v),d):(i=0,u(v))}function f(v){return v===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):v===null||v===32||v===60||L1(v)?t(v):(e.consume(v),f)}function u(v){return v===64?(e.consume(v),p):OW(v)?(e.consume(v),u):t(v)}function p(v){return Aa(v)?g(v):t(v)}function g(v){return v===46?(e.consume(v),i=0,p):v===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(v),e.exit("autolinkMarker"),e.exit("autolink"),n):b(v)}function b(v){if((v===45||Aa(v))&&i++<63){const S=v===45?b:g;return e.consume(v),S}return t(v)}}const Vb={partial:!0,tokenize:JW};function JW(e,n,t){return i;function i(o){return An(o)?ri(e,a,"linePrefix")(o):a(o)}function a(o){return o===null||zt(o)?n(o):t(o)}}const pE={continuation:{tokenize:XW},exit:ZW,name:"blockQuote",tokenize:KW};function KW(e,n,t){const i=this;return a;function a(l){if(l===62){const d=i.containerState;return d.open||(e.enter("blockQuote",{_container:!0}),d.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(l),e.exit("blockQuoteMarker"),o}return t(l)}function o(l){return An(l)?(e.enter("blockQuotePrefixWhitespace"),e.consume(l),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),n):(e.exit("blockQuotePrefix"),n(l))}}function XW(e,n,t){const i=this;return a;function a(l){return An(l)?ri(e,o,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l):o(l)}function o(l){return e.attempt(pE,n,t)(l)}}function ZW(e){e.exit("blockQuote")}const mE={name:"characterEscape",tokenize:eQ};function eQ(e,n,t){return i;function i(o){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(o),e.exit("escapeMarker"),a}function a(o){return FW(o)?(e.enter("characterEscapeValue"),e.consume(o),e.exit("characterEscapeValue"),e.exit("characterEscape"),n):t(o)}}const gE={name:"characterReference",tokenize:tQ};function tQ(e,n,t){const i=this;let a=0,o,l;return d;function d(g){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),f}function f(g){return g===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(g),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),o=31,l=Aa,p(g))}function u(g){return g===88||g===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(g),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),o=6,l=LW,p):(e.enter("characterReferenceValue"),o=7,l=F1,p(g))}function p(g){if(g===59&&a){const b=e.exit("characterReferenceValue");return l===Aa&&!Hw(i.sliceSerialize(b))?t(g):(e.enter("characterReferenceMarker"),e.consume(g),e.exit("characterReferenceMarker"),e.exit("characterReference"),n)}return l(g)&&a++<o?(e.consume(g),p):t(g)}}const Gj={partial:!0,tokenize:iQ},Yj={concrete:!0,name:"codeFenced",tokenize:nQ};function nQ(e,n,t){const i=this,a={partial:!0,tokenize:L};let o=0,l=0,d;return f;function f($){return u($)}function u($){const z=i.events[i.events.length-1];return o=z&&z[1].type==="linePrefix"?z[2].sliceSerialize(z[1],!0).length:0,d=$,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),p($)}function p($){return $===d?(l++,e.consume($),p):l<3?t($):(e.exit("codeFencedFenceSequence"),An($)?ri(e,g,"whitespace")($):g($))}function g($){return $===null||zt($)?(e.exit("codeFencedFence"),i.interrupt?n($):e.check(Gj,k,U)($)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b($))}function b($){return $===null||zt($)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),g($)):An($)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),ri(e,v,"whitespace")($)):$===96&&$===d?t($):(e.consume($),b)}function v($){return $===null||zt($)?g($):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),S($))}function S($){return $===null||zt($)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),g($)):$===96&&$===d?t($):(e.consume($),S)}function k($){return e.attempt(a,U,T)($)}function T($){return e.enter("lineEnding"),e.consume($),e.exit("lineEnding"),P}function P($){return o>0&&An($)?ri(e,M,"linePrefix",o+1)($):M($)}function M($){return $===null||zt($)?e.check(Gj,k,U)($):(e.enter("codeFlowValue"),I($))}function I($){return $===null||zt($)?(e.exit("codeFlowValue"),M($)):(e.consume($),I)}function U($){return e.exit("codeFenced"),n($)}function L($,z,F){let Q=0;return R;function R(G){return $.enter("lineEnding"),$.consume(G),$.exit("lineEnding"),B}function B(G){return $.enter("codeFencedFence"),An(G)?ri($,Y,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(G):Y(G)}function Y(G){return G===d?($.enter("codeFencedFenceSequence"),re(G)):F(G)}function re(G){return G===d?(Q++,$.consume(G),re):Q>=l?($.exit("codeFencedFenceSequence"),An(G)?ri($,ne,"whitespace")(G):ne(G)):F(G)}function ne(G){return G===null||zt(G)?($.exit("codeFencedFence"),z(G)):F(G)}}}function iQ(e,n,t){const i=this;return a;function a(l){return l===null?t(l):(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o)}function o(l){return i.parser.lazy[i.now().line]?t(l):n(l)}}const I0={name:"codeIndented",tokenize:aQ},rQ={partial:!0,tokenize:sQ};function aQ(e,n,t){const i=this;return a;function a(u){return e.enter("codeIndented"),ri(e,o,"linePrefix",5)(u)}function o(u){const p=i.events[i.events.length-1];return p&&p[1].type==="linePrefix"&&p[2].sliceSerialize(p[1],!0).length>=4?l(u):t(u)}function l(u){return u===null?f(u):zt(u)?e.attempt(rQ,l,f)(u):(e.enter("codeFlowValue"),d(u))}function d(u){return u===null||zt(u)?(e.exit("codeFlowValue"),l(u)):(e.consume(u),d)}function f(u){return e.exit("codeIndented"),n(u)}}function sQ(e,n,t){const i=this;return a;function a(l){return i.parser.lazy[i.now().line]?t(l):zt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),a):ri(e,o,"linePrefix",5)(l)}function o(l){const d=i.events[i.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):zt(l)?a(l):t(l)}}const oQ={name:"codeText",previous:cQ,resolve:lQ,tokenize:uQ};function lQ(e){let n=e.length-4,t=3,i,a;if((e[t][1].type==="lineEnding"||e[t][1].type==="space")&&(e[n][1].type==="lineEnding"||e[n][1].type==="space")){for(i=t;++i<n;)if(e[i][1].type==="codeTextData"){e[t][1].type="codeTextPadding",e[n][1].type="codeTextPadding",t+=2,n-=2;break}}for(i=t-1,n++;++i<=n;)a===void 0?i!==n&&e[i][1].type!=="lineEnding"&&(a=i):(i===n||e[i][1].type==="lineEnding")&&(e[a][1].type="codeTextData",i!==a+2&&(e[a][1].end=e[i-1][1].end,e.splice(a+2,i-a-2),n-=i-a-2,i=a+2),a=void 0);return e}function cQ(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function uQ(e,n,t){let i=0,a,o;return l;function l(g){return e.enter("codeText"),e.enter("codeTextSequence"),d(g)}function d(g){return g===96?(e.consume(g),i++,d):(e.exit("codeTextSequence"),f(g))}function f(g){return g===null?t(g):g===32?(e.enter("space"),e.consume(g),e.exit("space"),f):g===96?(o=e.enter("codeTextSequence"),a=0,p(g)):zt(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),f):(e.enter("codeTextData"),u(g))}function u(g){return g===null||g===32||g===96||zt(g)?(e.exit("codeTextData"),f(g)):(e.consume(g),u)}function p(g){return g===96?(e.consume(g),a++,p):a===i?(e.exit("codeTextSequence"),e.exit("codeText"),n(g)):(o.type="codeTextData",u(g))}}class dQ{constructor(n){this.left=n?[...n]:[],this.right=[]}get(n){if(n<0||n>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+n+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return n<this.left.length?this.left[n]:this.right[this.right.length-n+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(n,t){const i=t??Number.POSITIVE_INFINITY;return i<this.left.length?this.left.slice(n,i):n>this.left.length?this.right.slice(this.right.length-i+this.left.length,this.right.length-n+this.left.length).reverse():this.left.slice(n).concat(this.right.slice(this.right.length-i+this.left.length).reverse())}splice(n,t,i){const a=t||0;this.setCursor(Math.trunc(n));const o=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return i&&Mm(this.left,i),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(n){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(n)}pushMany(n){this.setCursor(Number.POSITIVE_INFINITY),Mm(this.left,n)}unshift(n){this.setCursor(0),this.right.push(n)}unshiftMany(n){this.setCursor(0),Mm(this.right,n.reverse())}setCursor(n){if(!(n===this.left.length||n>this.left.length&&this.right.length===0||n<0&&this.left.length===0))if(n<this.left.length){const t=this.left.splice(n,Number.POSITIVE_INFINITY);Mm(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-n,Number.POSITIVE_INFINITY);Mm(this.left,t.reverse())}}}function Mm(e,n){let t=0;if(n.length<1e4)e.push(...n);else for(;t<n.length;)e.push(...n.slice(t,t+1e4)),t+=1e4}function yE(e){const n={};let t=-1,i,a,o,l,d,f,u;const p=new dQ(e);for(;++t<p.length;){for(;t in n;)t=n[t];if(i=p.get(t),t&&i[1].type==="chunkFlow"&&p.get(t-1)[1].type==="listItemPrefix"&&(f=i[1]._tokenizer.events,o=0,o<f.length&&f[o][1].type==="lineEndingBlank"&&(o+=2),o<f.length&&f[o][1].type==="content"))for(;++o<f.length&&f[o][1].type!=="content";)f[o][1].type==="chunkText"&&(f[o][1]._isInFirstContentOfListItem=!0,o++);if(i[0]==="enter")i[1].contentType&&(Object.assign(n,fQ(p,t)),t=n[t],u=!0);else if(i[1]._container){for(o=t,a=void 0;o--;)if(l=p.get(o),l[1].type==="lineEnding"||l[1].type==="lineEndingBlank")l[0]==="enter"&&(a&&(p.get(a)[1].type="lineEndingBlank"),l[1].type="lineEnding",a=o);else if(!(l[1].type==="linePrefix"||l[1].type==="listItemIndent"))break;a&&(i[1].end={...p.get(a)[1].start},d=p.slice(a,t),d.unshift(i),p.splice(a,t-a+1,d))}}return Ko(e,0,Number.POSITIVE_INFINITY,p.slice(0)),!u}function fQ(e,n){const t=e.get(n)[1],i=e.get(n)[2];let a=n-1;const o=[];let l=t._tokenizer;l||(l=i.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(l._contentTypeTextTrailing=!0));const d=l.events,f=[],u={};let p,g,b=-1,v=t,S=0,k=0;const T=[k];for(;v;){for(;e.get(++a)[1]!==v;);o.push(a),v._tokenizer||(p=i.sliceStream(v),v.next||p.push(null),g&&l.defineSkip(v.start),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=!0),l.write(p),v._isInFirstContentOfListItem&&(l._gfmTasklistFirstContentOfListItem=void 0)),g=v,v=v.next}for(v=t;++b<d.length;)d[b][0]==="exit"&&d[b-1][0]==="enter"&&d[b][1].type===d[b-1][1].type&&d[b][1].start.line!==d[b][1].end.line&&(k=b+1,T.push(k),v._tokenizer=void 0,v.previous=void 0,v=v.next);for(l.events=[],v?(v._tokenizer=void 0,v.previous=void 0):T.pop(),b=T.length;b--;){const P=d.slice(T[b],T[b+1]),M=o.pop();f.push([M,M+P.length-1]),e.splice(M,2,P)}for(f.reverse(),b=-1;++b<f.length;)u[S+f[b][0]]=S+f[b][1],S+=f[b][1]-f[b][0]-1;return u}const hQ={resolve:mQ,tokenize:gQ},pQ={partial:!0,tokenize:yQ};function mQ(e){return yE(e),e}function gQ(e,n){let t;return i;function i(d){return e.enter("content"),t=e.enter("chunkContent",{contentType:"content"}),a(d)}function a(d){return d===null?o(d):zt(d)?e.check(pQ,l,o)(d):(e.consume(d),a)}function o(d){return e.exit("chunkContent"),e.exit("content"),n(d)}function l(d){return e.consume(d),e.exit("chunkContent"),t.next=e.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function yQ(e,n,t){const i=this;return a;function a(l){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),ri(e,o,"linePrefix")}function o(l){if(l===null||zt(l))return t(l);const d=i.events[i.events.length-1];return!i.parser.constructs.disable.null.includes("codeIndented")&&d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?n(l):e.interrupt(i.parser.constructs.flow,t,n)(l)}}function xE(e,n,t,i,a,o,l,d,f){const u=f||Number.POSITIVE_INFINITY;let p=0;return g;function g(P){return P===60?(e.enter(i),e.enter(a),e.enter(o),e.consume(P),e.exit(o),b):P===null||P===32||P===41||L1(P)?t(P):(e.enter(i),e.enter(l),e.enter(d),e.enter("chunkString",{contentType:"string"}),k(P))}function b(P){return P===62?(e.enter(o),e.consume(P),e.exit(o),e.exit(a),e.exit(i),n):(e.enter(d),e.enter("chunkString",{contentType:"string"}),v(P))}function v(P){return P===62?(e.exit("chunkString"),e.exit(d),b(P)):P===null||P===60||zt(P)?t(P):(e.consume(P),P===92?S:v)}function S(P){return P===60||P===62||P===92?(e.consume(P),v):v(P)}function k(P){return!p&&(P===null||P===41||la(P))?(e.exit("chunkString"),e.exit(d),e.exit(l),e.exit(i),n(P)):p<u&&P===40?(e.consume(P),p++,k):P===41?(e.consume(P),p--,k):P===null||P===32||P===40||L1(P)?t(P):(e.consume(P),P===92?T:k)}function T(P){return P===40||P===41||P===92?(e.consume(P),k):k(P)}}function bE(e,n,t,i,a,o){const l=this;let d=0,f;return u;function u(v){return e.enter(i),e.enter(a),e.consume(v),e.exit(a),e.enter(o),p}function p(v){return d>999||v===null||v===91||v===93&&!f||v===94&&!d&&"_hiddenFootnoteSupport"in l.parser.constructs?t(v):v===93?(e.exit(o),e.enter(a),e.consume(v),e.exit(a),e.exit(i),n):zt(v)?(e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),p):(e.enter("chunkString",{contentType:"string"}),g(v))}function g(v){return v===null||v===91||v===93||zt(v)||d++>999?(e.exit("chunkString"),p(v)):(e.consume(v),f||(f=!An(v)),v===92?b:g)}function b(v){return v===91||v===92||v===93?(e.consume(v),d++,g):g(v)}}function vE(e,n,t,i,a,o){let l;return d;function d(b){return b===34||b===39||b===40?(e.enter(i),e.enter(a),e.consume(b),e.exit(a),l=b===40?41:b,f):t(b)}function f(b){return b===l?(e.enter(a),e.consume(b),e.exit(a),e.exit(i),n):(e.enter(o),u(b))}function u(b){return b===l?(e.exit(o),f(l)):b===null?t(b):zt(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),ri(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),p(b))}function p(b){return b===l||b===null||zt(b)?(e.exit("chunkString"),u(b)):(e.consume(b),b===92?g:p)}function g(b){return b===l||b===92?(e.consume(b),p):p(b)}}function Bm(e,n){let t;return i;function i(a){return zt(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t=!0,i):An(a)?ri(e,i,t?"linePrefix":"lineSuffix")(a):n(a)}}const xQ={name:"definition",tokenize:vQ},bQ={partial:!0,tokenize:wQ};function vQ(e,n,t){const i=this;let a;return o;function o(v){return e.enter("definition"),l(v)}function l(v){return bE.call(i,e,d,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(v)}function d(v){return a=_h(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)),v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),f):t(v)}function f(v){return la(v)?Bm(e,u)(v):u(v)}function u(v){return xE(e,p,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(v)}function p(v){return e.attempt(bQ,g,g)(v)}function g(v){return An(v)?ri(e,b,"whitespace")(v):b(v)}function b(v){return v===null||zt(v)?(e.exit("definition"),i.parser.defined.push(a),n(v)):t(v)}}function wQ(e,n,t){return i;function i(d){return la(d)?Bm(e,a)(d):t(d)}function a(d){return vE(e,o,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(d)}function o(d){return An(d)?ri(e,l,"whitespace")(d):l(d)}function l(d){return d===null||zt(d)?n(d):t(d)}}const SQ={name:"hardBreakEscape",tokenize:NQ};function NQ(e,n,t){return i;function i(o){return e.enter("hardBreakEscape"),e.consume(o),a}function a(o){return zt(o)?(e.exit("hardBreakEscape"),n(o)):t(o)}}const CQ={name:"headingAtx",resolve:jQ,tokenize:_Q};function jQ(e,n){let t=e.length-2,i=3,a,o;return e[i][1].type==="whitespace"&&(i+=2),t-2>i&&e[t][1].type==="whitespace"&&(t-=2),e[t][1].type==="atxHeadingSequence"&&(i===t-1||t-4>i&&e[t-2][1].type==="whitespace")&&(t-=i+1===t?2:4),t>i&&(a={type:"atxHeadingText",start:e[i][1].start,end:e[t][1].end},o={type:"chunkText",start:e[i][1].start,end:e[t][1].end,contentType:"text"},Ko(e,i,t-i+1,[["enter",a,n],["enter",o,n],["exit",o,n],["exit",a,n]])),e}function _Q(e,n,t){let i=0;return a;function a(p){return e.enter("atxHeading"),o(p)}function o(p){return e.enter("atxHeadingSequence"),l(p)}function l(p){return p===35&&i++<6?(e.consume(p),l):p===null||la(p)?(e.exit("atxHeadingSequence"),d(p)):t(p)}function d(p){return p===35?(e.enter("atxHeadingSequence"),f(p)):p===null||zt(p)?(e.exit("atxHeading"),n(p)):An(p)?ri(e,d,"whitespace")(p):(e.enter("atxHeadingText"),u(p))}function f(p){return p===35?(e.consume(p),f):(e.exit("atxHeadingSequence"),d(p))}function u(p){return p===null||p===35||la(p)?(e.exit("atxHeadingText"),d(p)):(e.consume(p),u)}}const kQ=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Wj=["pre","script","style","textarea"],TQ={concrete:!0,name:"htmlFlow",resolveTo:PQ,tokenize:DQ},EQ={partial:!0,tokenize:RQ},AQ={partial:!0,tokenize:IQ};function PQ(e){let n=e.length;for(;n--&&!(e[n][0]==="enter"&&e[n][1].type==="htmlFlow"););return n>1&&e[n-2][1].type==="linePrefix"&&(e[n][1].start=e[n-2][1].start,e[n+1][1].start=e[n-2][1].start,e.splice(n-2,2)),e}function DQ(e,n,t){const i=this;let a,o,l,d,f;return u;function u(D){return p(D)}function p(D){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(D),g}function g(D){return D===33?(e.consume(D),b):D===47?(e.consume(D),o=!0,k):D===63?(e.consume(D),a=3,i.interrupt?n:A):Wo(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function b(D){return D===45?(e.consume(D),a=2,v):D===91?(e.consume(D),a=5,d=0,S):Wo(D)?(e.consume(D),a=4,i.interrupt?n:A):t(D)}function v(D){return D===45?(e.consume(D),i.interrupt?n:A):t(D)}function S(D){const oe="CDATA[";return D===oe.charCodeAt(d++)?(e.consume(D),d===oe.length?i.interrupt?n:Y:S):t(D)}function k(D){return Wo(D)?(e.consume(D),l=String.fromCharCode(D),T):t(D)}function T(D){if(D===null||D===47||D===62||la(D)){const oe=D===47,xe=l.toLowerCase();return!oe&&!o&&Wj.includes(xe)?(a=1,i.interrupt?n(D):Y(D)):kQ.includes(l.toLowerCase())?(a=6,oe?(e.consume(D),P):i.interrupt?n(D):Y(D)):(a=7,i.interrupt&&!i.parser.lazy[i.now().line]?t(D):o?M(D):I(D))}return D===45||Aa(D)?(e.consume(D),l+=String.fromCharCode(D),T):t(D)}function P(D){return D===62?(e.consume(D),i.interrupt?n:Y):t(D)}function M(D){return An(D)?(e.consume(D),M):R(D)}function I(D){return D===47?(e.consume(D),R):D===58||D===95||Wo(D)?(e.consume(D),U):An(D)?(e.consume(D),I):R(D)}function U(D){return D===45||D===46||D===58||D===95||Aa(D)?(e.consume(D),U):L(D)}function L(D){return D===61?(e.consume(D),$):An(D)?(e.consume(D),L):I(D)}function $(D){return D===null||D===60||D===61||D===62||D===96?t(D):D===34||D===39?(e.consume(D),f=D,z):An(D)?(e.consume(D),$):F(D)}function z(D){return D===f?(e.consume(D),f=null,Q):D===null||zt(D)?t(D):(e.consume(D),z)}function F(D){return D===null||D===34||D===39||D===47||D===60||D===61||D===62||D===96||la(D)?L(D):(e.consume(D),F)}function Q(D){return D===47||D===62||An(D)?I(D):t(D)}function R(D){return D===62?(e.consume(D),B):t(D)}function B(D){return D===null||zt(D)?Y(D):An(D)?(e.consume(D),B):t(D)}function Y(D){return D===45&&a===2?(e.consume(D),V):D===60&&a===1?(e.consume(D),W):D===62&&a===4?(e.consume(D),ce):D===63&&a===3?(e.consume(D),A):D===93&&a===5?(e.consume(D),he):zt(D)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(EQ,se,re)(D)):D===null||zt(D)?(e.exit("htmlFlowData"),re(D)):(e.consume(D),Y)}function re(D){return e.check(AQ,ne,se)(D)}function ne(D){return e.enter("lineEnding"),e.consume(D),e.exit("lineEnding"),G}function G(D){return D===null||zt(D)?re(D):(e.enter("htmlFlowData"),Y(D))}function V(D){return D===45?(e.consume(D),A):Y(D)}function W(D){return D===47?(e.consume(D),l="",J):Y(D)}function J(D){if(D===62){const oe=l.toLowerCase();return Wj.includes(oe)?(e.consume(D),ce):Y(D)}return Wo(D)&&l.length<8?(e.consume(D),l+=String.fromCharCode(D),J):Y(D)}function he(D){return D===93?(e.consume(D),A):Y(D)}function A(D){return D===62?(e.consume(D),ce):D===45&&a===2?(e.consume(D),A):Y(D)}function ce(D){return D===null||zt(D)?(e.exit("htmlFlowData"),se(D)):(e.consume(D),ce)}function se(D){return e.exit("htmlFlow"),n(D)}}function IQ(e,n,t){const i=this;return a;function a(l){return zt(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),o):t(l)}function o(l){return i.parser.lazy[i.now().line]?t(l):n(l)}}function RQ(e,n,t){return i;function i(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(Vb,n,t)}}const MQ={name:"htmlText",tokenize:OQ};function OQ(e,n,t){const i=this;let a,o,l;return d;function d(A){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(A),f}function f(A){return A===33?(e.consume(A),u):A===47?(e.consume(A),L):A===63?(e.consume(A),I):Wo(A)?(e.consume(A),F):t(A)}function u(A){return A===45?(e.consume(A),p):A===91?(e.consume(A),o=0,S):Wo(A)?(e.consume(A),M):t(A)}function p(A){return A===45?(e.consume(A),v):t(A)}function g(A){return A===null?t(A):A===45?(e.consume(A),b):zt(A)?(l=g,W(A)):(e.consume(A),g)}function b(A){return A===45?(e.consume(A),v):g(A)}function v(A){return A===62?V(A):A===45?b(A):g(A)}function S(A){const ce="CDATA[";return A===ce.charCodeAt(o++)?(e.consume(A),o===ce.length?k:S):t(A)}function k(A){return A===null?t(A):A===93?(e.consume(A),T):zt(A)?(l=k,W(A)):(e.consume(A),k)}function T(A){return A===93?(e.consume(A),P):k(A)}function P(A){return A===62?V(A):A===93?(e.consume(A),P):k(A)}function M(A){return A===null||A===62?V(A):zt(A)?(l=M,W(A)):(e.consume(A),M)}function I(A){return A===null?t(A):A===63?(e.consume(A),U):zt(A)?(l=I,W(A)):(e.consume(A),I)}function U(A){return A===62?V(A):I(A)}function L(A){return Wo(A)?(e.consume(A),$):t(A)}function $(A){return A===45||Aa(A)?(e.consume(A),$):z(A)}function z(A){return zt(A)?(l=z,W(A)):An(A)?(e.consume(A),z):V(A)}function F(A){return A===45||Aa(A)?(e.consume(A),F):A===47||A===62||la(A)?Q(A):t(A)}function Q(A){return A===47?(e.consume(A),V):A===58||A===95||Wo(A)?(e.consume(A),R):zt(A)?(l=Q,W(A)):An(A)?(e.consume(A),Q):V(A)}function R(A){return A===45||A===46||A===58||A===95||Aa(A)?(e.consume(A),R):B(A)}function B(A){return A===61?(e.consume(A),Y):zt(A)?(l=B,W(A)):An(A)?(e.consume(A),B):Q(A)}function Y(A){return A===null||A===60||A===61||A===62||A===96?t(A):A===34||A===39?(e.consume(A),a=A,re):zt(A)?(l=Y,W(A)):An(A)?(e.consume(A),Y):(e.consume(A),ne)}function re(A){return A===a?(e.consume(A),a=void 0,G):A===null?t(A):zt(A)?(l=re,W(A)):(e.consume(A),re)}function ne(A){return A===null||A===34||A===39||A===60||A===61||A===96?t(A):A===47||A===62||la(A)?Q(A):(e.consume(A),ne)}function G(A){return A===47||A===62||la(A)?Q(A):t(A)}function V(A){return A===62?(e.consume(A),e.exit("htmlTextData"),e.exit("htmlText"),n):t(A)}function W(A){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(A),e.exit("lineEnding"),J}function J(A){return An(A)?ri(e,he,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(A):he(A)}function he(A){return e.enter("htmlTextData"),l(A)}}const Yw={name:"labelEnd",resolveAll:zQ,resolveTo:UQ,tokenize:BQ},LQ={tokenize:qQ},FQ={tokenize:VQ},$Q={tokenize:HQ};function zQ(e){let n=-1;const t=[];for(;++n<e.length;){const i=e[n][1];if(t.push(e[n]),i.type==="labelImage"||i.type==="labelLink"||i.type==="labelEnd"){const a=i.type==="labelImage"?4:2;i.type="data",n+=a}}return e.length!==t.length&&Ko(e,0,e.length,t),e}function UQ(e,n){let t=e.length,i=0,a,o,l,d;for(;t--;)if(a=e[t][1],o){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(l){if(e[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(o=t,a.type!=="labelLink")){i=2;break}}else a.type==="labelEnd"&&(l=t);const f={type:e[o][1].type==="labelLink"?"link":"image",start:{...e[o][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[o][1].start},end:{...e[l][1].end}},p={type:"labelText",start:{...e[o+i+2][1].end},end:{...e[l-2][1].start}};return d=[["enter",f,n],["enter",u,n]],d=as(d,e.slice(o+1,o+i+3)),d=as(d,[["enter",p,n]]),d=as(d,Gw(n.parser.constructs.insideSpan.null,e.slice(o+i+4,l-3),n)),d=as(d,[["exit",p,n],e[l-2],e[l-1],["exit",u,n]]),d=as(d,e.slice(l+1)),d=as(d,[["exit",f,n]]),Ko(e,o,e.length,d),e}function BQ(e,n,t){const i=this;let a=i.events.length,o,l;for(;a--;)if((i.events[a][1].type==="labelImage"||i.events[a][1].type==="labelLink")&&!i.events[a][1]._balanced){o=i.events[a][1];break}return d;function d(b){return o?o._inactive?g(b):(l=i.parser.defined.includes(_h(i.sliceSerialize({start:o.end,end:i.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),f):t(b)}function f(b){return b===40?e.attempt(LQ,p,l?p:g)(b):b===91?e.attempt(FQ,p,l?u:g)(b):l?p(b):g(b)}function u(b){return e.attempt($Q,p,g)(b)}function p(b){return n(b)}function g(b){return o._balanced=!0,t(b)}}function qQ(e,n,t){return i;function i(g){return e.enter("resource"),e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),a}function a(g){return la(g)?Bm(e,o)(g):o(g)}function o(g){return g===41?p(g):xE(e,l,d,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function l(g){return la(g)?Bm(e,f)(g):p(g)}function d(g){return t(g)}function f(g){return g===34||g===39||g===40?vE(e,u,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):p(g)}function u(g){return la(g)?Bm(e,p)(g):p(g)}function p(g){return g===41?(e.enter("resourceMarker"),e.consume(g),e.exit("resourceMarker"),e.exit("resource"),n):t(g)}}function VQ(e,n,t){const i=this;return a;function a(d){return bE.call(i,e,o,l,"reference","referenceMarker","referenceString")(d)}function o(d){return i.parser.defined.includes(_h(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)))?n(d):t(d)}function l(d){return t(d)}}function HQ(e,n,t){return i;function i(o){return e.enter("reference"),e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),a}function a(o){return o===93?(e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),e.exit("reference"),n):t(o)}}const GQ={name:"labelStartImage",resolveAll:Yw.resolveAll,tokenize:YQ};function YQ(e,n,t){const i=this;return a;function a(d){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(d),e.exit("labelImageMarker"),o}function o(d){return d===91?(e.enter("labelMarker"),e.consume(d),e.exit("labelMarker"),e.exit("labelImage"),l):t(d)}function l(d){return d===94&&"_hiddenFootnoteSupport"in i.parser.constructs?t(d):n(d)}}const WQ={name:"labelStartLink",resolveAll:Yw.resolveAll,tokenize:QQ};function QQ(e,n,t){const i=this;return a;function a(l){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelLink"),o}function o(l){return l===94&&"_hiddenFootnoteSupport"in i.parser.constructs?t(l):n(l)}}const R0={name:"lineEnding",tokenize:JQ};function JQ(e,n){return t;function t(i){return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),ri(e,n,"linePrefix")}}const Vx={name:"thematicBreak",tokenize:KQ};function KQ(e,n,t){let i=0,a;return o;function o(u){return e.enter("thematicBreak"),l(u)}function l(u){return a=u,d(u)}function d(u){return u===a?(e.enter("thematicBreakSequence"),f(u)):i>=3&&(u===null||zt(u))?(e.exit("thematicBreak"),n(u)):t(u)}function f(u){return u===a?(e.consume(u),i++,f):(e.exit("thematicBreakSequence"),An(u)?ri(e,d,"whitespace")(u):d(u))}}const aa={continuation:{tokenize:tJ},exit:iJ,name:"list",tokenize:eJ},XQ={partial:!0,tokenize:rJ},ZQ={partial:!0,tokenize:nJ};function eJ(e,n,t){const i=this,a=i.events[i.events.length-1];let o=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,l=0;return d;function d(v){const S=i.containerState.type||(v===42||v===43||v===45?"listUnordered":"listOrdered");if(S==="listUnordered"?!i.containerState.marker||v===i.containerState.marker:F1(v)){if(i.containerState.type||(i.containerState.type=S,e.enter(S,{_container:!0})),S==="listUnordered")return e.enter("listItemPrefix"),v===42||v===45?e.check(Vx,t,u)(v):u(v);if(!i.interrupt||v===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),f(v)}return t(v)}function f(v){return F1(v)&&++l<10?(e.consume(v),f):(!i.interrupt||l<2)&&(i.containerState.marker?v===i.containerState.marker:v===41||v===46)?(e.exit("listItemValue"),u(v)):t(v)}function u(v){return e.enter("listItemMarker"),e.consume(v),e.exit("listItemMarker"),i.containerState.marker=i.containerState.marker||v,e.check(Vb,i.interrupt?t:p,e.attempt(XQ,b,g))}function p(v){return i.containerState.initialBlankLine=!0,o++,b(v)}function g(v){return An(v)?(e.enter("listItemPrefixWhitespace"),e.consume(v),e.exit("listItemPrefixWhitespace"),b):t(v)}function b(v){return i.containerState.size=o+i.sliceSerialize(e.exit("listItemPrefix"),!0).length,n(v)}}function tJ(e,n,t){const i=this;return i.containerState._closeFlow=void 0,e.check(Vb,a,o);function a(d){return i.containerState.furtherBlankLines=i.containerState.furtherBlankLines||i.containerState.initialBlankLine,ri(e,n,"listItemIndent",i.containerState.size+1)(d)}function o(d){return i.containerState.furtherBlankLines||!An(d)?(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,l(d)):(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,e.attempt(ZQ,n,l)(d))}function l(d){return i.containerState._closeFlow=!0,i.interrupt=void 0,ri(e,e.attempt(aa,n,t),"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(d)}}function nJ(e,n,t){const i=this;return ri(e,a,"listItemIndent",i.containerState.size+1);function a(o){const l=i.events[i.events.length-1];return l&&l[1].type==="listItemIndent"&&l[2].sliceSerialize(l[1],!0).length===i.containerState.size?n(o):t(o)}}function iJ(e){e.exit(this.containerState.type)}function rJ(e,n,t){const i=this;return ri(e,a,"listItemPrefixWhitespace",i.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(o){const l=i.events[i.events.length-1];return!An(o)&&l&&l[1].type==="listItemPrefixWhitespace"?n(o):t(o)}}const Qj={name:"setextUnderline",resolveTo:aJ,tokenize:sJ};function aJ(e,n){let t=e.length,i,a,o;for(;t--;)if(e[t][0]==="enter"){if(e[t][1].type==="content"){i=t;break}e[t][1].type==="paragraph"&&(a=t)}else e[t][1].type==="content"&&e.splice(t,1),!o&&e[t][1].type==="definition"&&(o=t);const l={type:"setextHeading",start:{...e[i][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",o?(e.splice(a,0,["enter",l,n]),e.splice(o+1,0,["exit",e[i][1],n]),e[i][1].end={...e[o][1].end}):e[i][1]=l,e.push(["exit",l,n]),e}function sJ(e,n,t){const i=this;let a;return o;function o(u){let p=i.events.length,g;for(;p--;)if(i.events[p][1].type!=="lineEnding"&&i.events[p][1].type!=="linePrefix"&&i.events[p][1].type!=="content"){g=i.events[p][1].type==="paragraph";break}return!i.parser.lazy[i.now().line]&&(i.interrupt||g)?(e.enter("setextHeadingLine"),a=u,l(u)):t(u)}function l(u){return e.enter("setextHeadingLineSequence"),d(u)}function d(u){return u===a?(e.consume(u),d):(e.exit("setextHeadingLineSequence"),An(u)?ri(e,f,"lineSuffix")(u):f(u))}function f(u){return u===null||zt(u)?(e.exit("setextHeadingLine"),n(u)):t(u)}}const oJ={tokenize:lJ};function lJ(e){const n=this,t=e.attempt(Vb,i,e.attempt(this.parser.constructs.flowInitial,a,ri(e,e.attempt(this.parser.constructs.flow,a,e.attempt(hQ,a)),"linePrefix")));return t;function i(o){if(o===null){e.consume(o);return}return e.enter("lineEndingBlank"),e.consume(o),e.exit("lineEndingBlank"),n.currentConstruct=void 0,t}function a(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n.currentConstruct=void 0,t}}const cJ={resolveAll:SE()},uJ=wE("string"),dJ=wE("text");function wE(e){return{resolveAll:SE(e==="text"?fJ:void 0),tokenize:n};function n(t){const i=this,a=this.parser.constructs[e],o=t.attempt(a,l,d);return l;function l(p){return u(p)?o(p):d(p)}function d(p){if(p===null){t.consume(p);return}return t.enter("data"),t.consume(p),f}function f(p){return u(p)?(t.exit("data"),o(p)):(t.consume(p),f)}function u(p){if(p===null)return!0;const g=a[p];let b=-1;if(g)for(;++b<g.length;){const v=g[b];if(!v.previous||v.previous.call(i,i.previous))return!0}return!1}}}function SE(e){return n;function n(t,i){let a=-1,o;for(;++a<=t.length;)o===void 0?t[a]&&t[a][1].type==="data"&&(o=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==o+2&&(t[o][1].end=t[a-1][1].end,t.splice(o+2,a-o-2),a=o+2),o=void 0);return e?e(t,i):t}}function fJ(e,n){let t=0;for(;++t<=e.length;)if((t===e.length||e[t][1].type==="lineEnding")&&e[t-1][1].type==="data"){const i=e[t-1][1],a=n.sliceStream(i);let o=a.length,l=-1,d=0,f;for(;o--;){const u=a[o];if(typeof u=="string"){for(l=u.length;u.charCodeAt(l-1)===32;)d++,l--;if(l)break;l=-1}else if(u===-2)f=!0,d++;else if(u!==-1){o++;break}}if(n._contentTypeTextTrailing&&t===e.length&&(d=0),d){const u={type:t===e.length||f||d<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?l:i.start._bufferIndex+l,_index:i.start._index+o,line:i.end.line,column:i.end.column-d,offset:i.end.offset-d},end:{...i.end}};i.end={...u.start},i.start.offset===i.end.offset?Object.assign(i,u):(e.splice(t,0,["enter",u,n],["exit",u,n]),t+=2)}t++}return e}const hJ={42:aa,43:aa,45:aa,48:aa,49:aa,50:aa,51:aa,52:aa,53:aa,54:aa,55:aa,56:aa,57:aa,62:pE},pJ={91:xQ},mJ={[-2]:I0,[-1]:I0,32:I0},gJ={35:CQ,42:Vx,45:[Qj,Vx],60:TQ,61:Qj,95:Vx,96:Yj,126:Yj},yJ={38:gE,92:mE},xJ={[-5]:R0,[-4]:R0,[-3]:R0,33:GQ,38:gE,42:$1,60:[WW,MQ],91:WQ,92:[SQ,mE],93:Yw,95:$1,96:oQ},bJ={null:[$1,cJ]},vJ={null:[42,95]},wJ={null:[]},SJ=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:vJ,contentInitial:pJ,disable:wJ,document:hJ,flow:gJ,flowInitial:mJ,insideSpan:bJ,string:yJ,text:xJ},Symbol.toStringTag,{value:"Module"}));function NJ(e,n,t){let i={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},o=[];let l=[],d=[];const f={attempt:z(L),check:z($),consume:M,enter:I,exit:U,interrupt:z($,{interrupt:!0})},u={code:null,containerState:{},defineSkip:k,events:[],now:S,parser:e,previous:null,sliceSerialize:b,sliceStream:v,write:g};let p=n.tokenize.call(u,f);return n.resolveAll&&o.push(n),u;function g(B){return l=as(l,B),T(),l[l.length-1]!==null?[]:(F(n,0),u.events=Gw(o,u.events,u),u.events)}function b(B,Y){return jJ(v(B),Y)}function v(B){return CJ(l,B)}function S(){const{_bufferIndex:B,_index:Y,line:re,column:ne,offset:G}=i;return{_bufferIndex:B,_index:Y,line:re,column:ne,offset:G}}function k(B){a[B.line]=B.column,R()}function T(){let B;for(;i._index<l.length;){const Y=l[i._index];if(typeof Y=="string")for(B=i._index,i._bufferIndex<0&&(i._bufferIndex=0);i._index===B&&i._bufferIndex<Y.length;)P(Y.charCodeAt(i._bufferIndex));else P(Y)}}function P(B){p=p(B)}function M(B){zt(B)?(i.line++,i.column=1,i.offset+=B===-3?2:1,R()):B!==-1&&(i.column++,i.offset++),i._bufferIndex<0?i._index++:(i._bufferIndex++,i._bufferIndex===l[i._index].length&&(i._bufferIndex=-1,i._index++)),u.previous=B}function I(B,Y){const re=Y||{};return re.type=B,re.start=S(),u.events.push(["enter",re,u]),d.push(re),re}function U(B){const Y=d.pop();return Y.end=S(),u.events.push(["exit",Y,u]),Y}function L(B,Y){F(B,Y.from)}function $(B,Y){Y.restore()}function z(B,Y){return re;function re(ne,G,V){let W,J,he,A;return Array.isArray(ne)?se(ne):"tokenize"in ne?se([ne]):ce(ne);function ce(Z){return ue;function ue(ae){const Re=ae!==null&&Z[ae],Ae=ae!==null&&Z.null,Ce=[...Array.isArray(Re)?Re:Re?[Re]:[],...Array.isArray(Ae)?Ae:Ae?[Ae]:[]];return se(Ce)(ae)}}function se(Z){return W=Z,J=0,Z.length===0?V:D(Z[J])}function D(Z){return ue;function ue(ae){return A=Q(),he=Z,Z.partial||(u.currentConstruct=Z),Z.name&&u.parser.constructs.disable.null.includes(Z.name)?xe():Z.tokenize.call(Y?Object.assign(Object.create(u),Y):u,f,oe,xe)(ae)}}function oe(Z){return B(he,A),G}function xe(Z){return A.restore(),++J<W.length?D(W[J]):V}}}function F(B,Y){B.resolveAll&&!o.includes(B)&&o.push(B),B.resolve&&Ko(u.events,Y,u.events.length-Y,B.resolve(u.events.slice(Y),u)),B.resolveTo&&(u.events=B.resolveTo(u.events,u))}function Q(){const B=S(),Y=u.previous,re=u.currentConstruct,ne=u.events.length,G=Array.from(d);return{from:ne,restore:V};function V(){i=B,u.previous=Y,u.currentConstruct=re,u.events.length=ne,d=G,R()}}function R(){i.line in a&&i.column<2&&(i.column=a[i.line],i.offset+=a[i.line]-1)}}function CJ(e,n){const t=n.start._index,i=n.start._bufferIndex,a=n.end._index,o=n.end._bufferIndex;let l;if(t===a)l=[e[t].slice(i,o)];else{if(l=e.slice(t,a),i>-1){const d=l[0];typeof d=="string"?l[0]=d.slice(i):l.shift()}o>0&&l.push(e[a].slice(0,o))}return l}function jJ(e,n){let t=-1;const i=[];let a;for(;++t<e.length;){const o=e[t];let l;if(typeof o=="string")l=o;else switch(o){case-5:{l="\r";break}case-4:{l=`
`;break}case-3:{l=`\r
`;break}case-2:{l=n?" ":"	";break}case-1:{if(!n&&a)continue;l=" ";break}default:l=String.fromCharCode(o)}a=o===-2,i.push(l)}return i.join("")}function _J(e){const i={constructs:IW([SJ,...(e||{}).extensions||[]]),content:a(UW),defined:[],document:a(qW),flow:a(oJ),lazy:{},string:a(uJ),text:a(dJ)};return i;function a(o){return l;function l(d){return NJ(i,o,d)}}}function kJ(e){for(;!yE(e););return e}const Jj=/[\0\t\n\r]/g;function TJ(){let e=1,n="",t=!0,i;return a;function a(o,l,d){const f=[];let u,p,g,b,v;for(o=n+(typeof o=="string"?o.toString():new TextDecoder(l||void 0).decode(o)),g=0,n="",t&&(o.charCodeAt(0)===65279&&g++,t=void 0);g<o.length;){if(Jj.lastIndex=g,u=Jj.exec(o),b=u&&u.index!==void 0?u.index:o.length,v=o.charCodeAt(b),!u){n=o.slice(g);break}if(v===10&&g===b&&i)f.push(-3),i=void 0;else switch(i&&(f.push(-5),i=void 0),g<b&&(f.push(o.slice(g,b)),e+=b-g),v){case 0:{f.push(65533),e++;break}case 9:{for(p=Math.ceil(e/4)*4,f.push(-2);e++<p;)f.push(-1);break}case 10:{f.push(-4),e=1;break}default:i=!0,e=1}g=b+1}return d&&(i&&f.push(-5),n&&f.push(n),f.push(null)),f}}const EJ=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function NE(e){return e.replace(EJ,AJ)}function AJ(e,n,t){if(n)return n;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),o=a===120||a===88;return hE(t.slice(o?2:1),o?16:10)}return Hw(t)||e}function qm(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?Kj(e.position):"start"in e||"end"in e?Kj(e):"line"in e||"column"in e?z1(e):""}function z1(e){return Xj(e&&e.line)+":"+Xj(e&&e.column)}function Kj(e){return z1(e&&e.start)+"-"+z1(e&&e.end)}function Xj(e){return e&&typeof e=="number"?e:1}const CE={}.hasOwnProperty;function PJ(e,n,t){return typeof n!="string"&&(t=n,n=void 0),DJ(t)(kJ(_J(t).document().write(TJ()(e,n,!0))))}function DJ(e){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(qt),autolinkProtocol:Q,autolinkEmail:Q,atxHeading:o(et),blockQuote:o(Ae),characterEscape:Q,characterReference:Q,codeFenced:o(Ce),codeFencedFenceInfo:l,codeFencedFenceMeta:l,codeIndented:o(Ce,l),codeText:o(Se,l),codeTextData:Q,data:Q,codeFlowValue:Q,definition:o(De),definitionDestinationString:l,definitionLabelString:l,definitionTitleString:l,emphasis:o(Me),hardBreakEscape:o(ct),hardBreakTrailing:o(ct),htmlFlow:o(ut,l),htmlFlowData:Q,htmlText:o(ut,l),htmlTextData:Q,image:o(at),label:l,link:o(qt),listItem:o(_e),listItemValue:b,listOrdered:o(jt,g),listUnordered:o(jt),paragraph:o(Fe),reference:D,referenceString:l,resourceDestinationString:l,resourceTitleString:l,setextHeading:o(et),strong:o(Pe),thematicBreak:o(ve)},exit:{atxHeading:f(),atxHeadingSequence:L,autolink:f(),autolinkEmail:Re,autolinkProtocol:ae,blockQuote:f(),characterEscapeValue:R,characterReferenceMarkerHexadecimal:xe,characterReferenceMarkerNumeric:xe,characterReferenceValue:Z,characterReference:ue,codeFenced:f(T),codeFencedFence:k,codeFencedFenceInfo:v,codeFencedFenceMeta:S,codeFlowValue:R,codeIndented:f(P),codeText:f(G),codeTextData:R,data:R,definition:f(),definitionDestinationString:U,definitionLabelString:M,definitionTitleString:I,emphasis:f(),hardBreakEscape:f(Y),hardBreakTrailing:f(Y),htmlFlow:f(re),htmlFlowData:R,htmlText:f(ne),htmlTextData:R,image:f(W),label:he,labelText:J,lineEnding:B,link:f(V),listItem:f(),listOrdered:f(),listUnordered:f(),paragraph:f(),referenceString:oe,resourceDestinationString:A,resourceTitleString:ce,resource:se,setextHeading:f(F),setextHeadingLineSequence:z,setextHeadingText:$,strong:f(),thematicBreak:f()}};jE(n,(e||{}).mdastExtensions||[]);const t={};return i;function i(ee){let fe={type:"root",children:[]};const qe={stack:[fe],tokenStack:[],config:n,enter:d,exit:u,buffer:l,resume:p,data:t},nt=[];let lt=-1;for(;++lt<ee.length;)if(ee[lt][1].type==="listOrdered"||ee[lt][1].type==="listUnordered")if(ee[lt][0]==="enter")nt.push(lt);else{const wt=nt.pop();lt=a(ee,wt,lt)}for(lt=-1;++lt<ee.length;){const wt=n[ee[lt][0]];CE.call(wt,ee[lt][1].type)&&wt[ee[lt][1].type].call(Object.assign({sliceSerialize:ee[lt][2].sliceSerialize},qe),ee[lt][1])}if(qe.tokenStack.length>0){const wt=qe.tokenStack[qe.tokenStack.length-1];(wt[1]||Zj).call(qe,void 0,wt[0])}for(fe.position={start:nu(ee.length>0?ee[0][1].start:{line:1,column:1,offset:0}),end:nu(ee.length>0?ee[ee.length-2][1].end:{line:1,column:1,offset:0})},lt=-1;++lt<n.transforms.length;)fe=n.transforms[lt](fe)||fe;return fe}function a(ee,fe,qe){let nt=fe-1,lt=-1,wt=!1,Ve,be,ye,Oe;for(;++nt<=qe;){const He=ee[nt];switch(He[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{He[0]==="enter"?lt++:lt--,Oe=void 0;break}case"lineEndingBlank":{He[0]==="enter"&&(Ve&&!Oe&&!lt&&!ye&&(ye=nt),Oe=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Oe=void 0}if(!lt&&He[0]==="enter"&&He[1].type==="listItemPrefix"||lt===-1&&He[0]==="exit"&&(He[1].type==="listUnordered"||He[1].type==="listOrdered")){if(Ve){let tt=nt;for(be=void 0;tt--;){const rt=ee[tt];if(rt[1].type==="lineEnding"||rt[1].type==="lineEndingBlank"){if(rt[0]==="exit")continue;be&&(ee[be][1].type="lineEndingBlank",wt=!0),rt[1].type="lineEnding",be=tt}else if(!(rt[1].type==="linePrefix"||rt[1].type==="blockQuotePrefix"||rt[1].type==="blockQuotePrefixWhitespace"||rt[1].type==="blockQuoteMarker"||rt[1].type==="listItemIndent"))break}ye&&(!be||ye<be)&&(Ve._spread=!0),Ve.end=Object.assign({},be?ee[be][1].start:He[1].end),ee.splice(be||nt,0,["exit",Ve,He[2]]),nt++,qe++}if(He[1].type==="listItemPrefix"){const tt={type:"listItem",_spread:!1,start:Object.assign({},He[1].start),end:void 0};Ve=tt,ee.splice(nt,0,["enter",tt,He[2]]),nt++,qe++,ye=void 0,Oe=!0}}}return ee[fe][1]._spread=wt,qe}function o(ee,fe){return qe;function qe(nt){d.call(this,ee(nt),nt),fe&&fe.call(this,nt)}}function l(){this.stack.push({type:"fragment",children:[]})}function d(ee,fe,qe){this.stack[this.stack.length-1].children.push(ee),this.stack.push(ee),this.tokenStack.push([fe,qe||void 0]),ee.position={start:nu(fe.start),end:void 0}}function f(ee){return fe;function fe(qe){ee&&ee.call(this,qe),u.call(this,qe)}}function u(ee,fe){const qe=this.stack.pop(),nt=this.tokenStack.pop();if(nt)nt[0].type!==ee.type&&(fe?fe.call(this,ee,nt[0]):(nt[1]||Zj).call(this,ee,nt[0]));else throw new Error("Cannot close `"+ee.type+"` ("+qm({start:ee.start,end:ee.end})+"): its not open");qe.position.end=nu(ee.end)}function p(){return Vw(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(ee){if(this.data.expectingFirstListItemValue){const fe=this.stack[this.stack.length-2];fe.start=Number.parseInt(this.sliceSerialize(ee),10),this.data.expectingFirstListItemValue=void 0}}function v(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.lang=ee}function S(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.meta=ee}function k(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.value=ee.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function P(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.value=ee.replace(/(\r?\n|\r)$/g,"")}function M(ee){const fe=this.resume(),qe=this.stack[this.stack.length-1];qe.label=fe,qe.identifier=_h(this.sliceSerialize(ee)).toLowerCase()}function I(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.title=ee}function U(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.url=ee}function L(ee){const fe=this.stack[this.stack.length-1];if(!fe.depth){const qe=this.sliceSerialize(ee).length;fe.depth=qe}}function $(){this.data.setextHeadingSlurpLineEnding=!0}function z(ee){const fe=this.stack[this.stack.length-1];fe.depth=this.sliceSerialize(ee).codePointAt(0)===61?1:2}function F(){this.data.setextHeadingSlurpLineEnding=void 0}function Q(ee){const qe=this.stack[this.stack.length-1].children;let nt=qe[qe.length-1];(!nt||nt.type!=="text")&&(nt=Ue(),nt.position={start:nu(ee.start),end:void 0},qe.push(nt)),this.stack.push(nt)}function R(ee){const fe=this.stack.pop();fe.value+=this.sliceSerialize(ee),fe.position.end=nu(ee.end)}function B(ee){const fe=this.stack[this.stack.length-1];if(this.data.atHardBreak){const qe=fe.children[fe.children.length-1];qe.position.end=nu(ee.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(fe.type)&&(Q.call(this,ee),R.call(this,ee))}function Y(){this.data.atHardBreak=!0}function re(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.value=ee}function ne(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.value=ee}function G(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.value=ee}function V(){const ee=this.stack[this.stack.length-1];if(this.data.inReference){const fe=this.data.referenceType||"shortcut";ee.type+="Reference",ee.referenceType=fe,delete ee.url,delete ee.title}else delete ee.identifier,delete ee.label;this.data.referenceType=void 0}function W(){const ee=this.stack[this.stack.length-1];if(this.data.inReference){const fe=this.data.referenceType||"shortcut";ee.type+="Reference",ee.referenceType=fe,delete ee.url,delete ee.title}else delete ee.identifier,delete ee.label;this.data.referenceType=void 0}function J(ee){const fe=this.sliceSerialize(ee),qe=this.stack[this.stack.length-2];qe.label=NE(fe),qe.identifier=_h(fe).toLowerCase()}function he(){const ee=this.stack[this.stack.length-1],fe=this.resume(),qe=this.stack[this.stack.length-1];if(this.data.inReference=!0,qe.type==="link"){const nt=ee.children;qe.children=nt}else qe.alt=fe}function A(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.url=ee}function ce(){const ee=this.resume(),fe=this.stack[this.stack.length-1];fe.title=ee}function se(){this.data.inReference=void 0}function D(){this.data.referenceType="collapsed"}function oe(ee){const fe=this.resume(),qe=this.stack[this.stack.length-1];qe.label=fe,qe.identifier=_h(this.sliceSerialize(ee)).toLowerCase(),this.data.referenceType="full"}function xe(ee){this.data.characterReferenceType=ee.type}function Z(ee){const fe=this.sliceSerialize(ee),qe=this.data.characterReferenceType;let nt;qe?(nt=hE(fe,qe==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):nt=Hw(fe);const lt=this.stack[this.stack.length-1];lt.value+=nt}function ue(ee){const fe=this.stack.pop();fe.position.end=nu(ee.end)}function ae(ee){R.call(this,ee);const fe=this.stack[this.stack.length-1];fe.url=this.sliceSerialize(ee)}function Re(ee){R.call(this,ee);const fe=this.stack[this.stack.length-1];fe.url="mailto:"+this.sliceSerialize(ee)}function Ae(){return{type:"blockquote",children:[]}}function Ce(){return{type:"code",lang:null,meta:null,value:""}}function Se(){return{type:"inlineCode",value:""}}function De(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Me(){return{type:"emphasis",children:[]}}function et(){return{type:"heading",depth:0,children:[]}}function ct(){return{type:"break"}}function ut(){return{type:"html",value:""}}function at(){return{type:"image",title:null,url:"",alt:null}}function qt(){return{type:"link",title:null,url:"",children:[]}}function jt(ee){return{type:"list",ordered:ee.type==="listOrdered",start:null,spread:ee._spread,children:[]}}function _e(ee){return{type:"listItem",spread:ee._spread,checked:null,children:[]}}function Fe(){return{type:"paragraph",children:[]}}function Pe(){return{type:"strong",children:[]}}function Ue(){return{type:"text",value:""}}function ve(){return{type:"thematicBreak"}}}function nu(e){return{line:e.line,column:e.column,offset:e.offset}}function jE(e,n){let t=-1;for(;++t<n.length;){const i=n[t];Array.isArray(i)?jE(e,i):IJ(e,i)}}function IJ(e,n){let t;for(t in n)if(CE.call(n,t))switch(t){case"canContainEols":{const i=n[t];i&&e[t].push(...i);break}case"transforms":{const i=n[t];i&&e[t].push(...i);break}case"enter":case"exit":{const i=n[t];i&&Object.assign(e[t],i);break}}}function Zj(e,n){throw e?new Error("Cannot close `"+e.type+"` ("+qm({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+qm({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+qm({start:n.start,end:n.end})+") is still open")}function RJ(e){const n=this;n.parser=t;function t(i){return PJ(i,{...n.data("settings"),...e,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}const e_={}.hasOwnProperty;function _E(e,n){const t=n||{};function i(a,...o){let l=i.invalid;const d=i.handlers;if(a&&e_.call(a,e)){const f=String(a[e]);l=e_.call(d,f)?d[f]:i.unknown}if(l)return l.call(this,a,...o)}return i.handlers=t.handlers||{},i.invalid=t.invalid,i.unknown=t.unknown,i}const MJ={}.hasOwnProperty;function kE(e,n){let t=-1,i;if(n.extensions)for(;++t<n.extensions.length;)kE(e,n.extensions[t]);for(i in n)if(MJ.call(n,i))switch(i){case"extensions":break;case"unsafe":{t_(e[i],n[i]);break}case"join":{t_(e[i],n[i]);break}case"handlers":{OJ(e[i],n[i]);break}default:e.options[i]=n[i]}return e}function t_(e,n){n&&e.push(...n)}function OJ(e,n){n&&Object.assign(e,n)}function LJ(e,n,t,i){const a=t.enter("blockquote"),o=t.createTracker(i);o.move("> "),o.shift(2);const l=t.indentLines(t.containerFlow(e,o.current()),FJ);return a(),l}function FJ(e,n,t){return">"+(t?"":" ")+e}function TE(e,n){return n_(e,n.inConstruct,!0)&&!n_(e,n.notInConstruct,!1)}function n_(e,n,t){if(typeof n=="string"&&(n=[n]),!n||n.length===0)return t;let i=-1;for(;++i<n.length;)if(e.includes(n[i]))return!0;return!1}function i_(e,n,t,i){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&TE(t.stack,t.unsafe[a]))return/[ \t]/.test(i.before)?"":" ";return`\\
`}function $J(e,n){const t=String(e);let i=t.indexOf(n),a=i,o=0,l=0;if(typeof n!="string")throw new TypeError("Expected substring");for(;i!==-1;)i===a?++o>l&&(l=o):o=1,a=i+n.length,i=t.indexOf(n,a);return l}function U1(e,n){return!!(n.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function zJ(e){const n=e.options.fence||"`";if(n!=="`"&&n!=="~")throw new Error("Cannot serialize code with `"+n+"` for `options.fence`, expected `` ` `` or `~`");return n}function UJ(e,n,t,i){const a=zJ(t),o=e.value||"",l=a==="`"?"GraveAccent":"Tilde";if(U1(e,t)){const g=t.enter("codeIndented"),b=t.indentLines(o,BJ);return g(),b}const d=t.createTracker(i),f=a.repeat(Math.max($J(o,a)+1,3)),u=t.enter("codeFenced");let p=d.move(f);if(e.lang){const g=t.enter(`codeFencedLang${l}`);p+=d.move(t.safe(e.lang,{before:p,after:" ",encode:["`"],...d.current()})),g()}if(e.lang&&e.meta){const g=t.enter(`codeFencedMeta${l}`);p+=d.move(" "),p+=d.move(t.safe(e.meta,{before:p,after:`
`,encode:["`"],...d.current()})),g()}return p+=d.move(`
`),o&&(p+=d.move(o+`
`)),p+=d.move(f),u(),p}function BJ(e,n,t){return(t?"":"    ")+e}function Ww(e){const n=e.options.quote||'"';if(n!=='"'&&n!=="'")throw new Error("Cannot serialize title with `"+n+"` for `options.quote`, expected `\"`, or `'`");return n}function qJ(e,n,t,i){const a=Ww(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("definition");let d=t.enter("label");const f=t.createTracker(i);let u=f.move("[");return u+=f.move(t.safe(t.associationId(e),{before:u,after:"]",...f.current()})),u+=f.move("]: "),d(),!e.url||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":`
`,...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),l(),u}function VJ(e){const n=e.options.emphasis||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize emphasis with `"+n+"` for `options.emphasis`, expected `*`, or `_`");return n}function du(e){return"&#x"+e.toString(16).toUpperCase()+";"}function gb(e,n,t){const i=mb(e),a=mb(n);return i===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:i===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}EE.peek=HJ;function EE(e,n,t,i){const a=VJ(t),o=t.enter("emphasis"),l=t.createTracker(i),d=l.move(a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),p=gb(i.before.charCodeAt(i.before.length-1),u,a);p.inside&&(f=du(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=gb(i.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+du(g));const v=l.move(a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:p.outside},d+f+v}function HJ(e,n,t){return t.options.emphasis||"*"}const Qw=function(e){if(e==null)return QJ;if(typeof e=="function")return Hb(e);if(typeof e=="object")return Array.isArray(e)?GJ(e):YJ(e);if(typeof e=="string")return WJ(e);throw new Error("Expected function, string, or object as test")};function GJ(e){const n=[];let t=-1;for(;++t<e.length;)n[t]=Qw(e[t]);return Hb(i);function i(...a){let o=-1;for(;++o<n.length;)if(n[o].apply(this,a))return!0;return!1}}function YJ(e){const n=e;return Hb(t);function t(i){const a=i;let o;for(o in e)if(a[o]!==n[o])return!1;return!0}}function WJ(e){return Hb(n);function n(t){return t&&t.type===e}}function Hb(e){return n;function n(t,i,a){return!!(JJ(t)&&e.call(this,t,typeof i=="number"?i:void 0,a||void 0))}}function QJ(){return!0}function JJ(e){return e!==null&&typeof e=="object"&&"type"in e}const AE=[],KJ=!0,B1=!1,XJ="skip";function ZJ(e,n,t,i){let a;typeof n=="function"&&typeof t!="function"?(i=t,t=n):a=n;const o=Qw(a),l=i?-1:1;d(e,void 0,[])();function d(f,u,p){const g=f&&typeof f=="object"?f:{};if(typeof g.type=="string"){const v=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(f.type+(v?"<"+v+">":""))+")"})}return b;function b(){let v=AE,S,k,T;if((!n||o(f,u,p[p.length-1]||void 0))&&(v=eK(t(f,p)),v[0]===B1))return v;if("children"in f&&f.children){const P=f;if(P.children&&v[0]!==XJ)for(k=(i?P.children.length:-1)+l,T=p.concat(P);k>-1&&k<P.children.length;){const M=P.children[k];if(S=d(M,k,T)(),S[0]===B1)return S;k=typeof S[1]=="number"?S[1]:k+l}}return v}}}function eK(e){return Array.isArray(e)?e:typeof e=="number"?[KJ,e]:e==null?AE:[e]}function PE(e,n,t,i){let a,o,l;typeof n=="function"?(o=void 0,l=n,a=t):(o=n,l=t,a=i),ZJ(e,o,d,a);function d(f,u){const p=u[u.length-1],g=p?p.children.indexOf(f):void 0;return l(f,g,p)}}function DE(e,n){let t=!1;return PE(e,function(i){if("value"in i&&/\r?\n|\r/.test(i.value)||i.type==="break")return t=!0,B1}),!!((!e.depth||e.depth<3)&&Vw(e)&&(n.options.setext||t))}function tK(e,n,t,i){const a=Math.max(Math.min(6,e.depth||1),1),o=t.createTracker(i);if(DE(e,t)){const p=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(e,{...o.current(),before:`
`,after:`
`});return g(),p(),b+`
`+(a===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const l="#".repeat(a),d=t.enter("headingAtx"),f=t.enter("phrasing");o.move(l+" ");let u=t.containerPhrasing(e,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(u)&&(u=du(u.charCodeAt(0))+u.slice(1)),u=u?l+" "+u:l,t.options.closeAtx&&(u+=" "+l),f(),d(),u}IE.peek=nK;function IE(e){return e.value||""}function nK(){return"<"}RE.peek=iK;function RE(e,n,t,i){const a=Ww(t),o=a==='"'?"Quote":"Apostrophe",l=t.enter("image");let d=t.enter("label");const f=t.createTracker(i);let u=f.move("![");return u+=f.move(t.safe(e.alt,{before:u,after:"]",...f.current()})),u+=f.move("]("),d(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(d=t.enter("destinationLiteral"),u+=f.move("<"),u+=f.move(t.safe(e.url,{before:u,after:">",...f.current()})),u+=f.move(">")):(d=t.enter("destinationRaw"),u+=f.move(t.safe(e.url,{before:u,after:e.title?" ":")",...f.current()}))),d(),e.title&&(d=t.enter(`title${o}`),u+=f.move(" "+a),u+=f.move(t.safe(e.title,{before:u,after:a,...f.current()})),u+=f.move(a),d()),u+=f.move(")"),l(),u}function iK(){return"!"}ME.peek=rK;function ME(e,n,t,i){const a=e.referenceType,o=t.enter("imageReference");let l=t.enter("label");const d=t.createTracker(i);let f=d.move("![");const u=t.safe(e.alt,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const p=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=p,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function rK(){return"!"}OE.peek=aK;function OE(e,n,t){let i=e.value||"",a="`",o=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(i);)a+="`";for(/[^ \r\n]/.test(i)&&(/^[ \r\n]/.test(i)&&/[ \r\n]$/.test(i)||/^`|`$/.test(i))&&(i=" "+i+" ");++o<t.unsafe.length;){const l=t.unsafe[o],d=t.compilePattern(l);let f;if(l.atBreak)for(;f=d.exec(i);){let u=f.index;i.charCodeAt(u)===10&&i.charCodeAt(u-1)===13&&u--,i=i.slice(0,u)+" "+i.slice(f.index+1)}}return a+i+a}function aK(){return"`"}function LE(e,n){const t=Vw(e);return!!(!n.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(t===e.url||"mailto:"+t===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}FE.peek=sK;function FE(e,n,t,i){const a=Ww(t),o=a==='"'?"Quote":"Apostrophe",l=t.createTracker(i);let d,f;if(LE(e,t)){const p=t.stack;t.stack=[],d=t.enter("autolink");let g=l.move("<");return g+=l.move(t.containerPhrasing(e,{before:g,after:">",...l.current()})),g+=l.move(">"),d(),t.stack=p,g}d=t.enter("link"),f=t.enter("label");let u=l.move("[");return u+=l.move(t.containerPhrasing(e,{before:u,after:"](",...l.current()})),u+=l.move("]("),f(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(f=t.enter("destinationLiteral"),u+=l.move("<"),u+=l.move(t.safe(e.url,{before:u,after:">",...l.current()})),u+=l.move(">")):(f=t.enter("destinationRaw"),u+=l.move(t.safe(e.url,{before:u,after:e.title?" ":")",...l.current()}))),f(),e.title&&(f=t.enter(`title${o}`),u+=l.move(" "+a),u+=l.move(t.safe(e.title,{before:u,after:a,...l.current()})),u+=l.move(a),f()),u+=l.move(")"),d(),u}function sK(e,n,t){return LE(e,t)?"<":"["}$E.peek=oK;function $E(e,n,t,i){const a=e.referenceType,o=t.enter("linkReference");let l=t.enter("label");const d=t.createTracker(i);let f=d.move("[");const u=t.containerPhrasing(e,{before:f,after:"]",...d.current()});f+=d.move(u+"]["),l();const p=t.stack;t.stack=[],l=t.enter("reference");const g=t.safe(t.associationId(e),{before:f,after:"]",...d.current()});return l(),t.stack=p,o(),a==="full"||!u||u!==g?f+=d.move(g+"]"):a==="shortcut"?f=f.slice(0,-1):f+=d.move("]"),f}function oK(){return"["}function Jw(e){const n=e.options.bullet||"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bullet`, expected `*`, `+`, or `-`");return n}function lK(e){const n=Jw(e),t=e.options.bulletOther;if(!t)return n==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===n)throw new Error("Expected `bullet` (`"+n+"`) and `bulletOther` (`"+t+"`) to be different");return t}function cK(e){const n=e.options.bulletOrdered||".";if(n!=="."&&n!==")")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOrdered`, expected `.` or `)`");return n}function zE(e){const n=e.options.rule||"*";if(n!=="*"&&n!=="-"&&n!=="_")throw new Error("Cannot serialize rules with `"+n+"` for `options.rule`, expected `*`, `-`, or `_`");return n}function uK(e,n,t,i){const a=t.enter("list"),o=t.bulletCurrent;let l=e.ordered?cK(t):Jw(t);const d=e.ordered?l==="."?")":".":lK(t);let f=n&&t.bulletLastUsed?l===t.bulletLastUsed:!1;if(!e.ordered){const p=e.children?e.children[0]:void 0;if((l==="*"||l==="-")&&p&&(!p.children||!p.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(f=!0),zE(t)===l&&p){let g=-1;for(;++g<e.children.length;){const b=e.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){f=!0;break}}}}f&&(l=d),t.bulletCurrent=l;const u=t.containerFlow(e,i);return t.bulletLastUsed=l,t.bulletCurrent=o,a(),u}function dK(e){const n=e.options.listItemIndent||"one";if(n!=="tab"&&n!=="one"&&n!=="mixed")throw new Error("Cannot serialize items with `"+n+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return n}function fK(e,n,t,i){const a=dK(t);let o=t.bulletCurrent||Jw(t);n&&n.type==="list"&&n.ordered&&(o=(typeof n.start=="number"&&n.start>-1?n.start:1)+(t.options.incrementListMarker===!1?0:n.children.indexOf(e))+o);let l=o.length+1;(a==="tab"||a==="mixed"&&(n&&n.type==="list"&&n.spread||e.spread))&&(l=Math.ceil(l/4)*4);const d=t.createTracker(i);d.move(o+" ".repeat(l-o.length)),d.shift(l);const f=t.enter("listItem"),u=t.indentLines(t.containerFlow(e,d.current()),p);return f(),u;function p(g,b,v){return b?(v?"":" ".repeat(l))+g:(v?o:o+" ".repeat(l-o.length))+g}}function hK(e,n,t,i){const a=t.enter("paragraph"),o=t.enter("phrasing"),l=t.containerPhrasing(e,i);return o(),a(),l}const pK=Qw(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function mK(e,n,t,i){return(e.children.some(function(l){return pK(l)})?t.containerPhrasing:t.containerFlow).call(t,e,i)}function gK(e){const n=e.options.strong||"*";if(n!=="*"&&n!=="_")throw new Error("Cannot serialize strong with `"+n+"` for `options.strong`, expected `*`, or `_`");return n}UE.peek=yK;function UE(e,n,t,i){const a=gK(t),o=t.enter("strong"),l=t.createTracker(i),d=l.move(a+a);let f=l.move(t.containerPhrasing(e,{after:a,before:d,...l.current()}));const u=f.charCodeAt(0),p=gb(i.before.charCodeAt(i.before.length-1),u,a);p.inside&&(f=du(u)+f.slice(1));const g=f.charCodeAt(f.length-1),b=gb(i.after.charCodeAt(0),g,a);b.inside&&(f=f.slice(0,-1)+du(g));const v=l.move(a+a);return o(),t.attentionEncodeSurroundingInfo={after:b.outside,before:p.outside},d+f+v}function yK(e,n,t){return t.options.strong||"*"}function xK(e,n,t,i){return t.safe(e.value,i)}function bK(e){const n=e.options.ruleRepetition||3;if(n<3)throw new Error("Cannot serialize rules with repetition `"+n+"` for `options.ruleRepetition`, expected `3` or more");return n}function vK(e,n,t){const i=(zE(t)+(t.options.ruleSpaces?" ":"")).repeat(bK(t));return t.options.ruleSpaces?i.slice(0,-1):i}const wK={blockquote:LJ,break:i_,code:UJ,definition:qJ,emphasis:EE,hardBreak:i_,heading:tK,html:IE,image:RE,imageReference:ME,inlineCode:OE,link:FE,linkReference:$E,list:uK,listItem:fK,paragraph:hK,root:mK,strong:UE,text:xK,thematicBreak:vK},SK=[NK];function NK(e,n,t,i){if(n.type==="code"&&U1(n,i)&&(e.type==="list"||e.type===n.type&&U1(e,i)))return!1;if("spread"in t&&typeof t.spread=="boolean")return e.type==="paragraph"&&(e.type===n.type||n.type==="definition"||n.type==="heading"&&DE(n,i))?void 0:t.spread?1:0}const Ed=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],CK=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:Ed},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:Ed},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:Ed},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:Ed},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:Ed},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:Ed},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:Ed},{atBreak:!0,character:"~"}];function jK(e){return e.label||!e.identifier?e.label||"":NE(e.identifier)}function _K(e){if(!e._compiled){const n=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((n?"("+n+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function kK(e,n,t){const i=n.indexStack,a=e.children||[],o=[];let l=-1,d=t.before,f;i.push(-1);let u=n.createTracker(t);for(;++l<a.length;){const p=a[l];let g;if(i[i.length-1]=l,l+1<a.length){let S=n.handle.handlers[a[l+1].type];S&&S.peek&&(S=S.peek),g=S?S(a[l+1],e,n,{before:"",after:"",...u.current()}).charAt(0):""}else g=t.after;o.length>0&&(d==="\r"||d===`
`)&&p.type==="html"&&(o[o.length-1]=o[o.length-1].replace(/(\r?\n|\r)$/," "),d=" ",u=n.createTracker(t),u.move(o.join("")));let b=n.handle(p,e,n,{...u.current(),after:g,before:d});f&&f===b.slice(0,1)&&(b=du(f.charCodeAt(0))+b.slice(1));const v=n.attentionEncodeSurroundingInfo;n.attentionEncodeSurroundingInfo=void 0,f=void 0,v&&(o.length>0&&v.before&&d===o[o.length-1].slice(-1)&&(o[o.length-1]=o[o.length-1].slice(0,-1)+du(d.charCodeAt(0))),v.after&&(f=g)),u.move(b),o.push(b),d=b.slice(-1)}return i.pop(),o.join("")}function TK(e,n,t){const i=n.indexStack,a=e.children||[],o=n.createTracker(t),l=[];let d=-1;for(i.push(-1);++d<a.length;){const f=a[d];i[i.length-1]=d,l.push(o.move(n.handle(f,e,n,{before:`
`,after:`
`,...o.current()}))),f.type!=="list"&&(n.bulletLastUsed=void 0),d<a.length-1&&l.push(o.move(EK(f,a[d+1],e,n)))}return i.pop(),l.join("")}function EK(e,n,t,i){let a=i.join.length;for(;a--;){const o=i.join[a](e,n,t,i);if(o===!0||o===1)break;if(typeof o=="number")return`
`.repeat(1+o);if(o===!1)return`

<!---->

`}return`

`}const AK=/\r?\n|\r/g;function PK(e,n){const t=[];let i=0,a=0,o;for(;o=AK.exec(e);)l(e.slice(i,o.index)),t.push(o[0]),i=o.index+o[0].length,a++;return l(e.slice(i)),t.join("");function l(d){t.push(n(d,a,!d))}}function DK(e,n,t){const i=(t.before||"")+(n||"")+(t.after||""),a=[],o=[],l={};let d=-1;for(;++d<e.unsafe.length;){const p=e.unsafe[d];if(!TE(e.stack,p))continue;const g=e.compilePattern(p);let b;for(;b=g.exec(i);){const v="before"in p||!!p.atBreak,S="after"in p,k=b.index+(v?b[1].length:0);a.includes(k)?(l[k].before&&!v&&(l[k].before=!1),l[k].after&&!S&&(l[k].after=!1)):(a.push(k),l[k]={before:v,after:S})}}a.sort(IK);let f=t.before?t.before.length:0;const u=i.length-(t.after?t.after.length:0);for(d=-1;++d<a.length;){const p=a[d];p<f||p>=u||p+1<u&&a[d+1]===p+1&&l[p].after&&!l[p+1].before&&!l[p+1].after||a[d-1]===p-1&&l[p].before&&!l[p-1].before&&!l[p-1].after||(f!==p&&o.push(r_(i.slice(f,p),"\\")),f=p,/[!-/:-@[-`{-~]/.test(i.charAt(p))&&(!t.encode||!t.encode.includes(i.charAt(p)))?o.push("\\"):(o.push(du(i.charCodeAt(p))),f++))}return o.push(r_(i.slice(f,u),t.after)),o.join("")}function IK(e,n){return e-n}function r_(e,n){const t=/\\(?=[!-/:-@[-`{-~])/g,i=[],a=[],o=e+n;let l=-1,d=0,f;for(;f=t.exec(o);)i.push(f.index);for(;++l<i.length;)d!==i[l]&&a.push(e.slice(d,i[l])),a.push("\\"),d=i[l];return a.push(e.slice(d)),a.join("")}function RK(e){const n=e||{},t=n.now||{};let i=n.lineShift||0,a=t.line||1,o=t.column||1;return{move:f,current:l,shift:d};function l(){return{now:{line:a,column:o},lineShift:i}}function d(u){i+=u}function f(u){const p=u||"",g=p.split(/\r?\n|\r/g),b=g[g.length-1];return a+=g.length-1,o=g.length===1?o+b.length:1+b.length+i,p}}function MK(e,n){const t=n||{},i={associationId:jK,containerPhrasing:$K,containerFlow:zK,createTracker:RK,compilePattern:_K,enter:o,handlers:{...wK},handle:void 0,indentLines:PK,indexStack:[],join:[...SK],options:{},safe:UK,stack:[],unsafe:[...CK]};kE(i,t),i.options.tightDefinitions&&i.join.push(FK),i.handle=_E("type",{invalid:OK,unknown:LK,handlers:i.handlers});let a=i.handle(e,void 0,i,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return a&&a.charCodeAt(a.length-1)!==10&&a.charCodeAt(a.length-1)!==13&&(a+=`
`),a;function o(l){return i.stack.push(l),d;function d(){i.stack.pop()}}}function OK(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function LK(e){const n=e;throw new Error("Cannot handle unknown node `"+n.type+"`")}function FK(e,n){if(e.type==="definition"&&e.type===n.type)return 0}function $K(e,n){return kK(e,this,n)}function zK(e,n){return TK(e,this,n)}function UK(e,n){return DK(this,e,n)}function BK(e){const n=this;n.compiler=t;function t(i){return MK(i,{...n.data("settings"),...e,extensions:n.data("toMarkdownExtensions")||[]})}}function a_(e){if(e)throw e}var M0,s_;function qK(){if(s_)return M0;s_=1;var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,t=Object.defineProperty,i=Object.getOwnPropertyDescriptor,a=function(u){return typeof Array.isArray=="function"?Array.isArray(u):n.call(u)==="[object Array]"},o=function(u){if(!u||n.call(u)!=="[object Object]")return!1;var p=e.call(u,"constructor"),g=u.constructor&&u.constructor.prototype&&e.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!p&&!g)return!1;var b;for(b in u);return typeof b>"u"||e.call(u,b)},l=function(u,p){t&&p.name==="__proto__"?t(u,p.name,{enumerable:!0,configurable:!0,value:p.newValue,writable:!0}):u[p.name]=p.newValue},d=function(u,p){if(p==="__proto__")if(e.call(u,p)){if(i)return i(u,p).value}else return;return u[p]};return M0=function f(){var u,p,g,b,v,S,k=arguments[0],T=1,P=arguments.length,M=!1;for(typeof k=="boolean"&&(M=k,k=arguments[1]||{},T=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});T<P;++T)if(u=arguments[T],u!=null)for(p in u)g=d(k,p),b=d(u,p),k!==b&&(M&&b&&(o(b)||(v=a(b)))?(v?(v=!1,S=g&&a(g)?g:[]):S=g&&o(g)?g:{},l(k,{name:p,newValue:f(M,S,b)})):typeof b<"u"&&l(k,{name:p,newValue:b}));return k},M0}var VK=qK();const O0=Ud(VK);function q1(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function HK(){const e=[],n={run:t,use:i};return n;function t(...a){let o=-1;const l=a.pop();if(typeof l!="function")throw new TypeError("Expected function as last argument, not "+l);d(null,...a);function d(f,...u){const p=e[++o];let g=-1;if(f){l(f);return}for(;++g<a.length;)(u[g]===null||u[g]===void 0)&&(u[g]=a[g]);a=u,p?GK(p,d)(...u):l(null,...u)}}function i(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),n}}function GK(e,n){let t;return i;function i(...l){const d=e.length>l.length;let f;d&&l.push(a);try{f=e.apply(this,l)}catch(u){const p=u;if(d&&t)throw p;return a(p)}d||(f&&f.then&&typeof f.then=="function"?f.then(o,a):f instanceof Error?a(f):o(f))}function a(l,...d){t||(t=!0,n(l,...d))}function o(l){a(null,l)}}class da extends Error{constructor(n,t,i){super(),typeof t=="string"&&(i=t,t=void 0);let a="",o={},l=!1;if(t&&("line"in t&&"column"in t?o={place:t}:"start"in t&&"end"in t?o={place:t}:"type"in t?o={ancestors:[t],place:t.position}:o={...t}),typeof n=="string"?a=n:!o.cause&&n&&(l=!0,a=n.message,o.cause=n),!o.ruleId&&!o.source&&typeof i=="string"){const f=i.indexOf(":");f===-1?o.ruleId=i:(o.source=i.slice(0,f),o.ruleId=i.slice(f+1))}if(!o.place&&o.ancestors&&o.ancestors){const f=o.ancestors[o.ancestors.length-1];f&&(o.place=f.position)}const d=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=d?d.column:void 0,this.fatal=void 0,this.file="",this.message=a,this.line=d?d.line:void 0,this.name=qm(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=l&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}da.prototype.file="";da.prototype.name="";da.prototype.reason="";da.prototype.message="";da.prototype.stack="";da.prototype.column=void 0;da.prototype.line=void 0;da.prototype.ancestors=void 0;da.prototype.cause=void 0;da.prototype.fatal=void 0;da.prototype.place=void 0;da.prototype.ruleId=void 0;da.prototype.source=void 0;const qo={basename:YK,dirname:WK,extname:QK,join:JK,sep:"/"};function YK(e,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');dg(e);let t=0,i=-1,a=e.length,o;if(n===void 0||n.length===0||n.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else i<0&&(o=!0,i=a+1);return i<0?"":e.slice(t,i)}if(n===e)return"";let l=-1,d=n.length-1;for(;a--;)if(e.codePointAt(a)===47){if(o){t=a+1;break}}else l<0&&(o=!0,l=a+1),d>-1&&(e.codePointAt(a)===n.codePointAt(d--)?d<0&&(i=a):(d=-1,i=l));return t===i?i=l:i<0&&(i=e.length),e.slice(t,i)}function WK(e){if(dg(e),e.length===0)return".";let n=-1,t=e.length,i;for(;--t;)if(e.codePointAt(t)===47){if(i){n=t;break}}else i||(i=!0);return n<0?e.codePointAt(0)===47?"/":".":n===1&&e.codePointAt(0)===47?"//":e.slice(0,n)}function QK(e){dg(e);let n=e.length,t=-1,i=0,a=-1,o=0,l;for(;n--;){const d=e.codePointAt(n);if(d===47){if(l){i=n+1;break}continue}t<0&&(l=!0,t=n+1),d===46?a<0?a=n:o!==1&&(o=1):a>-1&&(o=-1)}return a<0||t<0||o===0||o===1&&a===t-1&&a===i+1?"":e.slice(a,t)}function JK(...e){let n=-1,t;for(;++n<e.length;)dg(e[n]),e[n]&&(t=t===void 0?e[n]:t+"/"+e[n]);return t===void 0?".":KK(t)}function KK(e){dg(e);const n=e.codePointAt(0)===47;let t=XK(e,!n);return t.length===0&&!n&&(t="."),t.length>0&&e.codePointAt(e.length-1)===47&&(t+="/"),n?"/"+t:t}function XK(e,n){let t="",i=0,a=-1,o=0,l=-1,d,f;for(;++l<=e.length;){if(l<e.length)d=e.codePointAt(l);else{if(d===47)break;d=47}if(d===47){if(!(a===l-1||o===1))if(a!==l-1&&o===2){if(t.length<2||i!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(f=t.lastIndexOf("/"),f!==t.length-1){f<0?(t="",i=0):(t=t.slice(0,f),i=t.length-1-t.lastIndexOf("/")),a=l,o=0;continue}}else if(t.length>0){t="",i=0,a=l,o=0;continue}}n&&(t=t.length>0?t+"/..":"..",i=2)}else t.length>0?t+="/"+e.slice(a+1,l):t=e.slice(a+1,l),i=l-a-1;a=l,o=0}else d===46&&o>-1?o++:o=-1}return t}function dg(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const ZK={cwd:eX};function eX(){return"/"}function V1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function tX(e){if(typeof e=="string")e=new URL(e);else if(!V1(e)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(e.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return nX(e)}function nX(e){if(e.hostname!==""){const i=new TypeError('File URL host must be "localhost" or empty on darwin');throw i.code="ERR_INVALID_FILE_URL_HOST",i}const n=e.pathname;let t=-1;for(;++t<n.length;)if(n.codePointAt(t)===37&&n.codePointAt(t+1)===50){const i=n.codePointAt(t+2);if(i===70||i===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(n)}const L0=["history","path","basename","stem","extname","dirname"];class iX{constructor(n){let t;n?V1(n)?t={path:n}:typeof n=="string"||rX(n)?t={value:n}:t=n:t={},this.cwd="cwd"in t?"":ZK.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let i=-1;for(;++i<L0.length;){const o=L0[i];o in t&&t[o]!==void 0&&t[o]!==null&&(this[o]=o==="history"?[...t[o]]:t[o])}let a;for(a in t)L0.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?qo.basename(this.path):void 0}set basename(n){$0(n,"basename"),F0(n,"basename"),this.path=qo.join(this.dirname||"",n)}get dirname(){return typeof this.path=="string"?qo.dirname(this.path):void 0}set dirname(n){o_(this.basename,"dirname"),this.path=qo.join(n||"",this.basename)}get extname(){return typeof this.path=="string"?qo.extname(this.path):void 0}set extname(n){if(F0(n,"extname"),o_(this.dirname,"extname"),n){if(n.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(n.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=qo.join(this.dirname,this.stem+(n||""))}get path(){return this.history[this.history.length-1]}set path(n){V1(n)&&(n=tX(n)),$0(n,"path"),this.path!==n&&this.history.push(n)}get stem(){return typeof this.path=="string"?qo.basename(this.path,this.extname):void 0}set stem(n){$0(n,"stem"),F0(n,"stem"),this.path=qo.join(this.dirname||"",n+(this.extname||""))}fail(n,t,i){const a=this.message(n,t,i);throw a.fatal=!0,a}info(n,t,i){const a=this.message(n,t,i);return a.fatal=void 0,a}message(n,t,i){const a=new da(n,t,i);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(n){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(n||void 0).decode(this.value)}}function F0(e,n){if(e&&e.includes(qo.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+qo.sep+"`")}function $0(e,n){if(!e)throw new Error("`"+n+"` cannot be empty")}function o_(e,n){if(!e)throw new Error("Setting `"+n+"` requires `path` to be set too")}function rX(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const aX=function(e){const i=this.constructor.prototype,a=i[e],o=function(){return a.apply(o,arguments)};return Object.setPrototypeOf(o,i),o},sX={}.hasOwnProperty;class Kw extends aX{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=HK()}copy(){const n=new Kw;let t=-1;for(;++t<this.attachers.length;){const i=this.attachers[t];n.use(...i)}return n.data(O0(!0,{},this.namespace)),n}data(n,t){return typeof n=="string"?arguments.length===2?(B0("data",this.frozen),this.namespace[n]=t,this):sX.call(this.namespace,n)&&this.namespace[n]||void 0:n?(B0("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...i]=this.attachers[this.freezeIndex];if(i[0]===!1)continue;i[0]===!0&&(i[0]=void 0);const a=t.call(n,...i);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const t=jx(n),i=this.parser||this.Parser;return z0("parse",i),i(String(t),t)}process(n,t){const i=this;return this.freeze(),z0("process",this.parser||this.Parser),U0("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(o,l){const d=jx(n),f=i.parse(d);i.run(f,d,function(p,g,b){if(p||!g||!b)return u(p);const v=g,S=i.stringify(v,b);cX(S)?b.value=S:b.result=S,u(p,b)});function u(p,g){p||!g?l(p):o?o(g):t(void 0,g)}}}processSync(n){let t=!1,i;return this.freeze(),z0("processSync",this.parser||this.Parser),U0("processSync",this.compiler||this.Compiler),this.process(n,a),c_("processSync","process",t),i;function a(o,l){t=!0,a_(o),i=l}}run(n,t,i){l_(n),this.freeze();const a=this.transformers;return!i&&typeof t=="function"&&(i=t,t=void 0),i?o(void 0,i):new Promise(o);function o(l,d){const f=jx(t);a.run(n,f,u);function u(p,g,b){const v=g||n;p?d(p):l?l(v):i(void 0,v,b)}}}runSync(n,t){let i=!1,a;return this.run(n,t,o),c_("runSync","run",i),a;function o(l,d){a_(l),a=d,i=!0}}stringify(n,t){this.freeze();const i=jx(t),a=this.compiler||this.Compiler;return U0("stringify",a),l_(n),a(n,i)}use(n,...t){const i=this.attachers,a=this.namespace;if(B0("use",this.frozen),n!=null)if(typeof n=="function")f(n,t);else if(typeof n=="object")Array.isArray(n)?d(n):l(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function o(u){if(typeof u=="function")f(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[p,...g]=u;f(p,g)}else l(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function l(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");d(u.plugins),u.settings&&(a.settings=O0(!0,a.settings,u.settings))}function d(u){let p=-1;if(u!=null)if(Array.isArray(u))for(;++p<u.length;){const g=u[p];o(g)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function f(u,p){let g=-1,b=-1;for(;++g<i.length;)if(i[g][0]===u){b=g;break}if(b===-1)i.push([u,...p]);else if(p.length>0){let[v,...S]=p;const k=i[b][1];q1(k)&&q1(v)&&(v=O0(!0,k,v)),i[b]=[u,v,...S]}}}}const oX=new Kw().freeze();function z0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function U0(e,n){if(typeof n!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function B0(e,n){if(n)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function l_(e){if(!q1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function c_(e,n,t){if(!t)throw new Error("`"+e+"` finished async. Use `"+n+"` instead")}function jx(e){return lX(e)?e:new iX(e)}function lX(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function cX(e){return typeof e=="string"||uX(e)}function uX(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const dX=oX().use(RJ).use(BK).freeze(),BE=-1,Gb=0,Vm=1,yb=2,Xw=3,Zw=4,eS=5,tS=6,qE=7,VE=8,u_=typeof self=="object"?self:globalThis,fX=(e,n)=>{const t=(a,o)=>(e.set(o,a),a),i=a=>{if(e.has(a))return e.get(a);const[o,l]=n[a];switch(o){case Gb:case BE:return t(l,a);case Vm:{const d=t([],a);for(const f of l)d.push(i(f));return d}case yb:{const d=t({},a);for(const[f,u]of l)d[i(f)]=i(u);return d}case Xw:return t(new Date(l),a);case Zw:{const{source:d,flags:f}=l;return t(new RegExp(d,f),a)}case eS:{const d=t(new Map,a);for(const[f,u]of l)d.set(i(f),i(u));return d}case tS:{const d=t(new Set,a);for(const f of l)d.add(i(f));return d}case qE:{const{name:d,message:f}=l;return t(new u_[d](f),a)}case VE:return t(BigInt(l),a);case"BigInt":return t(Object(BigInt(l)),a);case"ArrayBuffer":return t(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:d}=new Uint8Array(l);return t(new DataView(d),l)}}return t(new u_[o](l),a)};return i},d_=e=>fX(new Map,e)(0),yh="",{toString:hX}={},{keys:pX}=Object,Om=e=>{const n=typeof e;if(n!=="object"||!e)return[Gb,n];const t=hX.call(e).slice(8,-1);switch(t){case"Array":return[Vm,yh];case"Object":return[yb,yh];case"Date":return[Xw,yh];case"RegExp":return[Zw,yh];case"Map":return[eS,yh];case"Set":return[tS,yh];case"DataView":return[Vm,t]}return t.includes("Array")?[Vm,t]:t.includes("Error")?[qE,t]:[yb,t]},_x=([e,n])=>e===Gb&&(n==="function"||n==="symbol"),mX=(e,n,t,i)=>{const a=(l,d)=>{const f=i.push(l)-1;return t.set(d,f),f},o=l=>{if(t.has(l))return t.get(l);let[d,f]=Om(l);switch(d){case Gb:{let p=l;switch(f){case"bigint":d=VE,p=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+f);p=null;break;case"undefined":return a([BE],l)}return a([d,p],l)}case Vm:{if(f){let b=l;return f==="DataView"?b=new Uint8Array(l.buffer):f==="ArrayBuffer"&&(b=new Uint8Array(l)),a([f,[...b]],l)}const p=[],g=a([d,p],l);for(const b of l)p.push(o(b));return g}case yb:{if(f)switch(f){case"BigInt":return a([f,l.toString()],l);case"Boolean":case"Number":case"String":return a([f,l.valueOf()],l)}if(n&&"toJSON"in l)return o(l.toJSON());const p=[],g=a([d,p],l);for(const b of pX(l))(e||!_x(Om(l[b])))&&p.push([o(b),o(l[b])]);return g}case Xw:return a([d,l.toISOString()],l);case Zw:{const{source:p,flags:g}=l;return a([d,{source:p,flags:g}],l)}case eS:{const p=[],g=a([d,p],l);for(const[b,v]of l)(e||!(_x(Om(b))||_x(Om(v))))&&p.push([o(b),o(v)]);return g}case tS:{const p=[],g=a([d,p],l);for(const b of l)(e||!_x(Om(b)))&&p.push(o(b));return g}}const{message:u}=l;return a([d,{name:f,message:u}],l)};return o},f_=(e,{json:n,lossy:t}={})=>{const i=[];return mX(!(n||t),!!n,new Map,i)(e),i},eg=typeof structuredClone=="function"?(e,n)=>n&&("json"in n||"lossy"in n)?d_(f_(e,n)):structuredClone(e):(e,n)=>d_(f_(e,n)),HE=YE("end"),GE=YE("start");function YE(e){return n;function n(t){const i=t&&t.position&&t.position[e]||{};if(typeof i.line=="number"&&i.line>0&&typeof i.column=="number"&&i.column>0)return{line:i.line,column:i.column,offset:typeof i.offset=="number"&&i.offset>-1?i.offset:void 0}}}function WE(e){const n=GE(e),t=HE(e);if(n&&t)return{start:n,end:t}}const Ad=["ariaDescribedBy","ariaLabel","ariaLabelledBy"],h_={ancestors:{tbody:["table"],td:["table"],th:["table"],thead:["table"],tfoot:["table"],tr:["table"]},attributes:{a:[...Ad,"dataFootnoteBackref","dataFootnoteRef",["className","data-footnote-backref"],"href"],blockquote:["cite"],code:[["className",/^language-./]],del:["cite"],div:["itemScope","itemType"],dl:[...Ad],h2:[["className","sr-only"]],img:[...Ad,"longDesc","src"],input:[["disabled",!0],["type","checkbox"]],ins:["cite"],li:[["className","task-list-item"]],ol:[...Ad,["className","contains-task-list"]],q:["cite"],section:["dataFootnotes",["className","footnotes"]],source:["srcSet"],summary:[...Ad],table:[...Ad],ul:[...Ad,["className","contains-task-list"]],"*":["abbr","accept","acceptCharset","accessKey","action","align","alt","axis","border","cellPadding","cellSpacing","char","charOff","charSet","checked","clear","colSpan","color","cols","compact","coords","dateTime","dir","encType","frame","hSpace","headers","height","hrefLang","htmlFor","id","isMap","itemProp","label","lang","maxLength","media","method","multiple","name","noHref","noShade","noWrap","open","prompt","readOnly","rev","rowSpan","rows","rules","scope","selected","shape","size","span","start","summary","tabIndex","title","useMap","vAlign","value","width"]},clobber:["ariaDescribedBy","ariaLabelledBy","id","name"],clobberPrefix:"user-content-",protocols:{cite:["http","https"],href:["http","https","irc","ircs","mailto","xmpp"],longDesc:["http","https"],src:["http","https"]},required:{input:{disabled:!0,type:"checkbox"}},strip:["script"],tagNames:["a","b","blockquote","br","code","dd","del","details","div","dl","dt","em","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","li","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","tr","tt","ul","var"]},iu={}.hasOwnProperty;function gX(e,n){let t={type:"root",children:[]};const i={schema:n?{...h_,...n}:h_,stack:[]},a=QE(i,e);return a&&(Array.isArray(a)?a.length===1?t=a[0]:t.children=a:t=a),t}function QE(e,n){if(n&&typeof n=="object"){const t=n;switch(typeof t.type=="string"?t.type:""){case"comment":return yX(e,t);case"doctype":return xX(e,t);case"element":return bX(e,t);case"root":return vX(e,t);case"text":return wX(e,t)}}}function yX(e,n){if(e.schema.allowComments){const t=typeof n.value=="string"?n.value:"",i=t.indexOf("-->"),o={type:"comment",value:i<0?t:t.slice(0,i)};return fg(o,n),o}}function xX(e,n){if(e.schema.allowDoctypes){const t={type:"doctype"};return fg(t,n),t}}function bX(e,n){const t=typeof n.tagName=="string"?n.tagName:"";e.stack.push(t);const i=JE(e,n.children),a=SX(e,n.properties);e.stack.pop();let o=!1;if(t&&t!=="*"&&(!e.schema.tagNames||e.schema.tagNames.includes(t))&&(o=!0,e.schema.ancestors&&iu.call(e.schema.ancestors,t))){const d=e.schema.ancestors[t];let f=-1;for(o=!1;++f<d.length;)e.stack.includes(d[f])&&(o=!0)}if(!o)return e.schema.strip&&!e.schema.strip.includes(t)?i:void 0;const l={type:"element",tagName:t,properties:a,children:i};return fg(l,n),l}function vX(e,n){const i={type:"root",children:JE(e,n.children)};return fg(i,n),i}function wX(e,n){const i={type:"text",value:typeof n.value=="string"?n.value:""};return fg(i,n),i}function JE(e,n){const t=[];if(Array.isArray(n)){const i=n;let a=-1;for(;++a<i.length;){const o=QE(e,i[a]);o&&(Array.isArray(o)?t.push(...o):t.push(o))}}return t}function SX(e,n){const t=e.stack[e.stack.length-1],i=e.schema.attributes,a=e.schema.required,o=i&&iu.call(i,t)?i[t]:void 0,l=i&&iu.call(i,"*")?i["*"]:void 0,d=n&&typeof n=="object"?n:{},f={};let u;for(u in d)if(iu.call(d,u)){const p=d[u];let g=p_(e,m_(o,u),u,p);g==null&&(g=p_(e,m_(l,u),u,p)),g!=null&&(f[u]=g)}if(a&&iu.call(a,t)){const p=a[t];for(u in p)iu.call(p,u)&&!iu.call(f,u)&&(f[u]=p[u])}return f}function p_(e,n,t,i){return n?Array.isArray(i)?NX(e,n,t,i):KE(e,n,t,i):void 0}function NX(e,n,t,i){let a=-1;const o=[];for(;++a<i.length;){const l=KE(e,n,t,i[a]);(typeof l=="number"||typeof l=="string")&&o.push(l)}return o}function KE(e,n,t,i){if(!(typeof i!="boolean"&&typeof i!="number"&&typeof i!="string")&&CX(e,t,i)){if(typeof n=="object"&&n.length>1){let a=!1,o=0;for(;++o<n.length;){const l=n[o];if(l&&typeof l=="object"&&"flags"in l){if(l.test(String(i))){a=!0;break}}else if(l===i){a=!0;break}}if(!a)return}return e.schema.clobber&&e.schema.clobberPrefix&&e.schema.clobber.includes(t)?e.schema.clobberPrefix+i:i}}function CX(e,n,t){const i=e.schema.protocols&&iu.call(e.schema.protocols,n)?e.schema.protocols[n]:void 0;if(!i||i.length===0)return!0;const a=String(t),o=a.indexOf(":"),l=a.indexOf("?"),d=a.indexOf("#"),f=a.indexOf("/");if(o<0||f>-1&&o>f||l>-1&&o>l||d>-1&&o>d)return!0;let u=-1;for(;++u<i.length;){const p=i[u];if(o===p.length&&a.slice(0,p.length)===p)return!0}return!1}function fg(e,n){const t=WE(n);n.data&&(e.data=eg(n.data)),t&&(e.position=t)}function m_(e,n){let t,i=-1;if(e)for(;++i<e.length;){const a=e[i],o=typeof a=="string"?a:a[0];if(o===n)return a;o==="data*"&&(t=a)}if(n.length>4&&n.slice(0,4).toLowerCase()==="data")return t}function jX(e,n){const t={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(n),!0)};return e.patch(n,t),e.applyData(n,t)}function _X(e,n){const t={type:"element",tagName:"br",properties:{},children:[]};return e.patch(n,t),[e.applyData(n,t),{type:"text",value:`
`}]}function kX(e,n){const t=n.value?n.value+`
`:"",i={};n.lang&&(i.className=["language-"+n.lang]);let a={type:"element",tagName:"code",properties:i,children:[{type:"text",value:t}]};return n.meta&&(a.data={meta:n.meta}),e.patch(n,a),a=e.applyData(n,a),a={type:"element",tagName:"pre",properties:{},children:[a]},e.patch(n,a),a}function TX(e,n){const t={type:"element",tagName:"del",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function EX(e,n){const t={type:"element",tagName:"em",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function AX(e,n){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",i=String(n.identifier).toUpperCase(),a=Yh(i.toLowerCase()),o=e.footnoteOrder.indexOf(i);let l,d=e.footnoteCounts.get(i);d===void 0?(d=0,e.footnoteOrder.push(i),l=e.footnoteOrder.length):l=o+1,d+=1,e.footnoteCounts.set(i,d);const f={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(d>1?"-"+d:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(n,f);const u={type:"element",tagName:"sup",properties:{},children:[f]};return e.patch(n,u),e.applyData(n,u)}function PX(e,n){const t={type:"element",tagName:"h"+n.depth,properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function DX(e,n){if(e.options.allowDangerousHtml){const t={type:"raw",value:n.value};return e.patch(n,t),e.applyData(n,t)}}function XE(e,n){const t=n.referenceType;let i="]";if(t==="collapsed"?i+="[]":t==="full"&&(i+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+i}];const a=e.all(n),o=a[0];o&&o.type==="text"?o.value="["+o.value:a.unshift({type:"text",value:"["});const l=a[a.length-1];return l&&l.type==="text"?l.value+=i:a.push({type:"text",value:i}),a}function IX(e,n){const t=String(n.identifier).toUpperCase(),i=e.definitionById.get(t);if(!i)return XE(e,n);const a={src:Yh(i.url||""),alt:n.alt};i.title!==null&&i.title!==void 0&&(a.title=i.title);const o={type:"element",tagName:"img",properties:a,children:[]};return e.patch(n,o),e.applyData(n,o)}function RX(e,n){const t={src:Yh(n.url)};n.alt!==null&&n.alt!==void 0&&(t.alt=n.alt),n.title!==null&&n.title!==void 0&&(t.title=n.title);const i={type:"element",tagName:"img",properties:t,children:[]};return e.patch(n,i),e.applyData(n,i)}function MX(e,n){const t={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};e.patch(n,t);const i={type:"element",tagName:"code",properties:{},children:[t]};return e.patch(n,i),e.applyData(n,i)}function OX(e,n){const t=String(n.identifier).toUpperCase(),i=e.definitionById.get(t);if(!i)return XE(e,n);const a={href:Yh(i.url||"")};i.title!==null&&i.title!==void 0&&(a.title=i.title);const o={type:"element",tagName:"a",properties:a,children:e.all(n)};return e.patch(n,o),e.applyData(n,o)}function LX(e,n){const t={href:Yh(n.url)};n.title!==null&&n.title!==void 0&&(t.title=n.title);const i={type:"element",tagName:"a",properties:t,children:e.all(n)};return e.patch(n,i),e.applyData(n,i)}function FX(e,n,t){const i=e.all(n),a=t?$X(t):ZE(n),o={},l=[];if(typeof n.checked=="boolean"){const p=i[0];let g;p&&p.type==="element"&&p.tagName==="p"?g=p:(g={type:"element",tagName:"p",properties:{},children:[]},i.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let d=-1;for(;++d<i.length;){const p=i[d];(a||d!==0||p.type!=="element"||p.tagName!=="p")&&l.push({type:"text",value:`
`}),p.type==="element"&&p.tagName==="p"&&!a?l.push(...p.children):l.push(p)}const f=i[i.length-1];f&&(a||f.type!=="element"||f.tagName!=="p")&&l.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:o,children:l};return e.patch(n,u),e.applyData(n,u)}function $X(e){let n=!1;if(e.type==="list"){n=e.spread||!1;const t=e.children;let i=-1;for(;!n&&++i<t.length;)n=ZE(t[i])}return n}function ZE(e){const n=e.spread;return n??e.children.length>1}function zX(e,n){const t={},i=e.all(n);let a=-1;for(typeof n.start=="number"&&n.start!==1&&(t.start=n.start);++a<i.length;){const l=i[a];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const o={type:"element",tagName:n.ordered?"ol":"ul",properties:t,children:e.wrap(i,!0)};return e.patch(n,o),e.applyData(n,o)}function UX(e,n){const t={type:"element",tagName:"p",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function BX(e,n){const t={type:"root",children:e.wrap(e.all(n))};return e.patch(n,t),e.applyData(n,t)}function qX(e,n){const t={type:"element",tagName:"strong",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}function VX(e,n){const t=e.all(n),i=t.shift(),a=[];if(i){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([i],!0)};e.patch(n.children[0],l),a.push(l)}if(t.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(t,!0)},d=GE(n.children[1]),f=HE(n.children[n.children.length-1]);d&&f&&(l.position={start:d,end:f}),a.push(l)}const o={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(n,o),e.applyData(n,o)}function HX(e,n,t){const i=t?t.children:void 0,o=(i?i.indexOf(n):1)===0?"th":"td",l=t&&t.type==="table"?t.align:void 0,d=l?l.length:n.children.length;let f=-1;const u=[];for(;++f<d;){const g=n.children[f],b={},v=l?l[f]:void 0;v&&(b.align=v);let S={type:"element",tagName:o,properties:b,children:[]};g&&(S.children=e.all(g),e.patch(g,S),S=e.applyData(g,S)),u.push(S)}const p={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(n,p),e.applyData(n,p)}function GX(e,n){const t={type:"element",tagName:"td",properties:{},children:e.all(n)};return e.patch(n,t),e.applyData(n,t)}const g_=9,y_=32;function YX(e){const n=String(e),t=/\r?\n|\r/g;let i=t.exec(n),a=0;const o=[];for(;i;)o.push(x_(n.slice(a,i.index),a>0,!0),i[0]),a=i.index+i[0].length,i=t.exec(n);return o.push(x_(n.slice(a),a>0,!1)),o.join("")}function x_(e,n,t){let i=0,a=e.length;if(n){let o=e.codePointAt(i);for(;o===g_||o===y_;)i++,o=e.codePointAt(i)}if(t){let o=e.codePointAt(a-1);for(;o===g_||o===y_;)a--,o=e.codePointAt(a-1)}return a>i?e.slice(i,a):""}function WX(e,n){const t={type:"text",value:YX(String(n.value))};return e.patch(n,t),e.applyData(n,t)}function QX(e,n){const t={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(n,t),e.applyData(n,t)}const JX={blockquote:jX,break:_X,code:kX,delete:TX,emphasis:EX,footnoteReference:AX,heading:PX,html:DX,imageReference:IX,image:RX,inlineCode:MX,linkReference:OX,link:LX,listItem:FX,list:zX,paragraph:UX,root:BX,strong:qX,table:VX,tableCell:GX,tableRow:HX,text:WX,thematicBreak:QX,toml:kx,yaml:kx,definition:kx,footnoteDefinition:kx};function kx(){}function KX(e,n){const t=[{type:"text",value:""}];return n>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),t}function XX(e,n){return"Back to reference "+(e+1)+(n>1?"-"+n:"")}function ZX(e){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",t=e.options.footnoteBackContent||KX,i=e.options.footnoteBackLabel||XX,a=e.options.footnoteLabel||"Footnotes",o=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},d=[];let f=-1;for(;++f<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[f]);if(!u)continue;const p=e.all(u),g=String(u.identifier).toUpperCase(),b=Yh(g.toLowerCase());let v=0;const S=[],k=e.footnoteCounts.get(g);for(;k!==void 0&&++v<=k;){S.length>0&&S.push({type:"text",value:" "});let M=typeof t=="string"?t:t(f,v);typeof M=="string"&&(M={type:"text",value:M}),S.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+b+(v>1?"-"+v:""),dataFootnoteBackref:"",ariaLabel:typeof i=="string"?i:i(f,v),className:["data-footnote-backref"]},children:Array.isArray(M)?M:[M]})}const T=p[p.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const M=T.children[T.children.length-1];M&&M.type==="text"?M.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...S)}else p.push(...S);const P={type:"element",tagName:"li",properties:{id:n+"fn-"+b},children:e.wrap(p,!0)};e.patch(u,P),d.push(P)}if(d.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...eg(l),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(d,!0)},{type:"text",value:`
`}]}}const H1={}.hasOwnProperty,eZ={};function tZ(e,n){const t=n||eZ,i=new Map,a=new Map,o=new Map,l={...JX,...t.handlers},d={all:u,applyData:iZ,definitionById:i,footnoteById:a,footnoteCounts:o,footnoteOrder:[],handlers:l,one:f,options:t,patch:nZ,wrap:aZ};return PE(e,function(p){if(p.type==="definition"||p.type==="footnoteDefinition"){const g=p.type==="definition"?i:a,b=String(p.identifier).toUpperCase();g.has(b)||g.set(b,p)}}),d;function f(p,g){const b=p.type,v=d.handlers[b];if(H1.call(d.handlers,b)&&v)return v(d,p,g);if(d.options.passThrough&&d.options.passThrough.includes(b)){if("children"in p){const{children:k,...T}=p,P=eg(T);return P.children=d.all(p),P}return eg(p)}return(d.options.unknownHandler||rZ)(d,p,g)}function u(p){const g=[];if("children"in p){const b=p.children;let v=-1;for(;++v<b.length;){const S=d.one(b[v],p);if(S){if(v&&b[v-1].type==="break"&&(!Array.isArray(S)&&S.type==="text"&&(S.value=b_(S.value)),!Array.isArray(S)&&S.type==="element")){const k=S.children[0];k&&k.type==="text"&&(k.value=b_(k.value))}Array.isArray(S)?g.push(...S):g.push(S)}}}return g}}function nZ(e,n){e.position&&(n.position=WE(e))}function iZ(e,n){let t=n;if(e&&e.data){const i=e.data.hName,a=e.data.hChildren,o=e.data.hProperties;if(typeof i=="string")if(t.type==="element")t.tagName=i;else{const l="children"in t?t.children:[t];t={type:"element",tagName:i,properties:{},children:l}}t.type==="element"&&o&&Object.assign(t.properties,eg(o)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function rZ(e,n){const t=n.data||{},i="value"in n&&!(H1.call(t,"hProperties")||H1.call(t,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:e.all(n)};return e.patch(n,i),e.applyData(n,i)}function aZ(e,n){const t=[];let i=-1;for(n&&t.push({type:"text",value:`
`});++i<e.length;)i&&t.push({type:"text",value:`
`}),t.push(e[i]);return n&&e.length>0&&t.push({type:"text",value:`
`}),t}function b_(e){let n=0,t=e.charCodeAt(n);for(;t===9||t===32;)n++,t=e.charCodeAt(n);return e.slice(n)}function sZ(e,n){const t=tZ(e,n),i=t.one(e,void 0),a=ZX(t),o=Array.isArray(i)?{type:"root",children:i}:i||{type:"root",children:[]};return a&&o.children.push({type:"text",value:`
`},a),o}const oZ=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"];class hg{constructor(n,t,i){this.normal=t,this.property=n,i&&(this.space=i)}}hg.prototype.normal={};hg.prototype.property={};hg.prototype.space=void 0;function eA(e,n){const t={},i={};for(const a of e)Object.assign(t,a.property),Object.assign(i,a.normal);return new hg(t,i,n)}function G1(e){return e.toLowerCase()}class fa{constructor(n,t){this.attribute=t,this.property=n}}fa.prototype.attribute="";fa.prototype.booleanish=!1;fa.prototype.boolean=!1;fa.prototype.commaOrSpaceSeparated=!1;fa.prototype.commaSeparated=!1;fa.prototype.defined=!1;fa.prototype.mustUseProperty=!1;fa.prototype.number=!1;fa.prototype.overloadedBoolean=!1;fa.prototype.property="";fa.prototype.spaceSeparated=!1;fa.prototype.space=void 0;let lZ=0;const Kt=qd(),Di=qd(),Y1=qd(),ot=qd(),ii=qd(),kh=qd(),Ea=qd();function qd(){return 2**++lZ}const W1=Object.freeze(Object.defineProperty({__proto__:null,boolean:Kt,booleanish:Di,commaOrSpaceSeparated:Ea,commaSeparated:kh,number:ot,overloadedBoolean:Y1,spaceSeparated:ii},Symbol.toStringTag,{value:"Module"})),q0=Object.keys(W1);class nS extends fa{constructor(n,t,i,a){let o=-1;if(super(n,t),v_(this,"space",a),typeof i=="number")for(;++o<q0.length;){const l=q0[o];v_(this,q0[o],(i&W1[l])===W1[l])}}}nS.prototype.defined=!0;function v_(e,n,t){t&&(e[n]=t)}function Wh(e){const n={},t={};for(const[i,a]of Object.entries(e.properties)){const o=new nS(i,e.transform(e.attributes||{},i),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(i)&&(o.mustUseProperty=!0),n[i]=o,t[G1(i)]=i,t[G1(o.attribute)]=i}return new hg(n,t,e.space)}const tA=Wh({properties:{ariaActiveDescendant:null,ariaAtomic:Di,ariaAutoComplete:null,ariaBusy:Di,ariaChecked:Di,ariaColCount:ot,ariaColIndex:ot,ariaColSpan:ot,ariaControls:ii,ariaCurrent:null,ariaDescribedBy:ii,ariaDetails:null,ariaDisabled:Di,ariaDropEffect:ii,ariaErrorMessage:null,ariaExpanded:Di,ariaFlowTo:ii,ariaGrabbed:Di,ariaHasPopup:null,ariaHidden:Di,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:ii,ariaLevel:ot,ariaLive:null,ariaModal:Di,ariaMultiLine:Di,ariaMultiSelectable:Di,ariaOrientation:null,ariaOwns:ii,ariaPlaceholder:null,ariaPosInSet:ot,ariaPressed:Di,ariaReadOnly:Di,ariaRelevant:null,ariaRequired:Di,ariaRoleDescription:ii,ariaRowCount:ot,ariaRowIndex:ot,ariaRowSpan:ot,ariaSelected:Di,ariaSetSize:ot,ariaSort:null,ariaValueMax:ot,ariaValueMin:ot,ariaValueNow:ot,ariaValueText:null,role:null},transform(e,n){return n==="role"?n:"aria-"+n.slice(4).toLowerCase()}});function nA(e,n){return n in e?e[n]:n}function iA(e,n){return nA(e,n.toLowerCase())}const cZ=Wh({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:kh,acceptCharset:ii,accessKey:ii,action:null,allow:null,allowFullScreen:Kt,allowPaymentRequest:Kt,allowUserMedia:Kt,alt:null,as:null,async:Kt,autoCapitalize:null,autoComplete:ii,autoFocus:Kt,autoPlay:Kt,blocking:ii,capture:null,charSet:null,checked:Kt,cite:null,className:ii,cols:ot,colSpan:null,content:null,contentEditable:Di,controls:Kt,controlsList:ii,coords:ot|kh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Kt,defer:Kt,dir:null,dirName:null,disabled:Kt,download:Y1,draggable:Di,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Kt,formTarget:null,headers:ii,height:ot,hidden:Y1,high:ot,href:null,hrefLang:null,htmlFor:ii,httpEquiv:ii,id:null,imageSizes:null,imageSrcSet:null,inert:Kt,inputMode:null,integrity:null,is:null,isMap:Kt,itemId:null,itemProp:ii,itemRef:ii,itemScope:Kt,itemType:ii,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Kt,low:ot,manifest:null,max:null,maxLength:ot,media:null,method:null,min:null,minLength:ot,multiple:Kt,muted:Kt,name:null,nonce:null,noModule:Kt,noValidate:Kt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Kt,optimum:ot,pattern:null,ping:ii,placeholder:null,playsInline:Kt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Kt,referrerPolicy:null,rel:ii,required:Kt,reversed:Kt,rows:ot,rowSpan:ot,sandbox:ii,scope:null,scoped:Kt,seamless:Kt,selected:Kt,shadowRootClonable:Kt,shadowRootDelegatesFocus:Kt,shadowRootMode:null,shape:null,size:ot,sizes:null,slot:null,span:ot,spellCheck:Di,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ot,step:null,style:null,tabIndex:ot,target:null,title:null,translate:null,type:null,typeMustMatch:Kt,useMap:null,value:Di,width:ot,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:ii,axis:null,background:null,bgColor:null,border:ot,borderColor:null,bottomMargin:ot,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Kt,declare:Kt,event:null,face:null,frame:null,frameBorder:null,hSpace:ot,leftMargin:ot,link:null,longDesc:null,lowSrc:null,marginHeight:ot,marginWidth:ot,noResize:Kt,noHref:Kt,noShade:Kt,noWrap:Kt,object:null,profile:null,prompt:null,rev:null,rightMargin:ot,rules:null,scheme:null,scrolling:Di,standby:null,summary:null,text:null,topMargin:ot,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ot,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Kt,disableRemotePlayback:Kt,prefix:null,property:null,results:ot,security:null,unselectable:null},space:"html",transform:iA}),uZ=Wh({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ea,accentHeight:ot,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ot,amplitude:ot,arabicForm:null,ascent:ot,attributeName:null,attributeType:null,azimuth:ot,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ot,by:null,calcMode:null,capHeight:ot,className:ii,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ot,diffuseConstant:ot,direction:null,display:null,dur:null,divisor:ot,dominantBaseline:null,download:Kt,dx:null,dy:null,edgeMode:null,editable:null,elevation:ot,enableBackground:null,end:null,event:null,exponent:ot,externalResourcesRequired:null,fill:null,fillOpacity:ot,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:kh,g2:kh,glyphName:kh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ot,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ot,horizOriginX:ot,horizOriginY:ot,id:null,ideographic:ot,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ot,k:ot,k1:ot,k2:ot,k3:ot,k4:ot,kernelMatrix:Ea,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ot,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ot,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ot,overlineThickness:ot,paintOrder:null,panose1:null,path:null,pathLength:ot,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:ii,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ot,pointsAtY:ot,pointsAtZ:ot,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ea,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ea,rev:Ea,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ea,requiredFeatures:Ea,requiredFonts:Ea,requiredFormats:Ea,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ot,specularExponent:ot,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ot,strikethroughThickness:ot,string:null,stroke:null,strokeDashArray:Ea,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ot,strokeOpacity:ot,strokeWidth:null,style:null,surfaceScale:ot,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ea,tabIndex:ot,tableValues:null,target:null,targetX:ot,targetY:ot,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ea,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ot,underlineThickness:ot,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ot,values:null,vAlphabetic:ot,vMathematical:ot,vectorEffect:null,vHanging:ot,vIdeographic:ot,version:null,vertAdvY:ot,vertOriginX:ot,vertOriginY:ot,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ot,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:nA}),rA=Wh({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,n){return"xlink:"+n.slice(5).toLowerCase()}}),aA=Wh({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:iA}),sA=Wh({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,n){return"xml:"+n.slice(3).toLowerCase()}}),dZ=/[A-Z]/g,w_=/-[a-z]/g,fZ=/^data[-\w.:]+$/i;function hZ(e,n){const t=G1(n);let i=n,a=fa;if(t in e.normal)return e.property[e.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&fZ.test(n)){if(n.charAt(4)==="-"){const o=n.slice(5).replace(w_,mZ);i="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=n.slice(4);if(!w_.test(o)){let l=o.replace(dZ,pZ);l.charAt(0)!=="-"&&(l="-"+l),n="data"+l}}a=nS}return new a(i,n)}function pZ(e){return"-"+e.toLowerCase()}function mZ(e){return e.charAt(1).toUpperCase()}const gZ=eA([tA,cZ,rA,aA,sA],"html"),oA=eA([tA,uZ,rA,aA,sA],"svg"),yZ=/["&'<>`]/g,xZ=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,bZ=/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,vZ=/[|\\{}()[\]^$+*?.]/g,S_=new WeakMap;function wZ(e,n){if(e=e.replace(n.subset?SZ(n.subset):yZ,i),n.subset||n.escapeOnly)return e;return e.replace(xZ,t).replace(bZ,i);function t(a,o,l){return n.format((a.charCodeAt(0)-55296)*1024+a.charCodeAt(1)-56320+65536,l.charCodeAt(o+2),n)}function i(a,o,l){return n.format(a.charCodeAt(0),l.charCodeAt(o+1),n)}}function SZ(e){let n=S_.get(e);return n||(n=NZ(e),S_.set(e,n)),n}function NZ(e){const n=[];let t=-1;for(;++t<e.length;)n.push(e[t].replace(vZ,"\\$&"));return new RegExp("(?:"+n.join("|")+")","g")}const CZ=/[\dA-Fa-f]/;function jZ(e,n,t){const i="&#x"+e.toString(16).toUpperCase();return t&&n&&!CZ.test(String.fromCharCode(n))?i:i+";"}const _Z=/\d/;function kZ(e,n,t){const i="&#"+String(e);return t&&n&&!_Z.test(String.fromCharCode(n))?i:i+";"}const TZ=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],V0={nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",fnof:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",bull:"",hellip:"",prime:"",Prime:"",oline:"",frasl:"",weierp:"",image:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",quot:'"',amp:"&",lt:"<",gt:">",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",permil:"",lsaquo:"",rsaquo:"",euro:""},EZ=["cent","copy","divide","gt","lt","not","para","times"],lA={}.hasOwnProperty,Q1={};let Tx;for(Tx in V0)lA.call(V0,Tx)&&(Q1[V0[Tx]]=Tx);const AZ=/[^\dA-Za-z]/;function PZ(e,n,t,i){const a=String.fromCharCode(e);if(lA.call(Q1,a)){const o=Q1[a],l="&"+o;return t&&TZ.includes(o)&&!EZ.includes(o)&&(!i||n&&n!==61&&AZ.test(String.fromCharCode(n)))?l:l+";"}return""}function DZ(e,n,t){let i=jZ(e,n,t.omitOptionalSemicolons),a;if((t.useNamedReferences||t.useShortestReferences)&&(a=PZ(e,n,t.omitOptionalSemicolons,t.attribute)),(t.useShortestReferences||!a)&&t.useShortestReferences){const o=kZ(e,n,t.omitOptionalSemicolons);o.length<i.length&&(i=o)}return a&&(!t.useShortestReferences||a.length<i.length)?a:i}function Th(e,n){return wZ(e,Object.assign({format:DZ},n))}const IZ=/^>|^->|<!--|-->|--!>|<!-$/g,RZ=[">"],MZ=["<",">"];function OZ(e,n,t,i){return i.settings.bogusComments?"<?"+Th(e.value,Object.assign({},i.settings.characterReferences,{subset:RZ}))+">":"<!--"+e.value.replace(IZ,a)+"-->";function a(o){return Th(o,Object.assign({},i.settings.characterReferences,{subset:MZ}))}}function LZ(e,n,t,i){return"<!"+(i.settings.upperDoctype?"DOCTYPE":"doctype")+(i.settings.tightDoctype?"":" ")+"html>"}function N_(e,n){const t=String(e);if(typeof n!="string")throw new TypeError("Expected character");let i=0,a=t.indexOf(n);for(;a!==-1;)i++,a=t.indexOf(n,a+n.length);return i}function FZ(e,n){const t=n||{};return(e[e.length-1]===""?[...e,""]:e).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}function $Z(e){return e.join(" ").trim()}const zZ=/[ \t\n\f\r]/g;function iS(e){return typeof e=="object"?e.type==="text"?C_(e.value):!1:C_(e)}function C_(e){return e.replace(zZ,"")===""}const Li=uA(1),cA=uA(-1),UZ=[];function uA(e){return n;function n(t,i,a){const o=t?t.children:UZ;let l=(i||0)+e,d=o[l];if(!a)for(;d&&iS(d);)l+=e,d=o[l];return d}}const BZ={}.hasOwnProperty;function dA(e){return n;function n(t,i,a){return BZ.call(e,t.tagName)&&e[t.tagName](t,i,a)}}const rS=dA({body:VZ,caption:H0,colgroup:H0,dd:WZ,dt:YZ,head:H0,html:qZ,li:GZ,optgroup:QZ,option:JZ,p:HZ,rp:j_,rt:j_,tbody:XZ,td:__,tfoot:ZZ,th:__,thead:KZ,tr:eee});function H0(e,n,t){const i=Li(t,n,!0);return!i||i.type!=="comment"&&!(i.type==="text"&&iS(i.value.charAt(0)))}function qZ(e,n,t){const i=Li(t,n);return!i||i.type!=="comment"}function VZ(e,n,t){const i=Li(t,n);return!i||i.type!=="comment"}function HZ(e,n,t){const i=Li(t,n);return i?i.type==="element"&&(i.tagName==="address"||i.tagName==="article"||i.tagName==="aside"||i.tagName==="blockquote"||i.tagName==="details"||i.tagName==="div"||i.tagName==="dl"||i.tagName==="fieldset"||i.tagName==="figcaption"||i.tagName==="figure"||i.tagName==="footer"||i.tagName==="form"||i.tagName==="h1"||i.tagName==="h2"||i.tagName==="h3"||i.tagName==="h4"||i.tagName==="h5"||i.tagName==="h6"||i.tagName==="header"||i.tagName==="hgroup"||i.tagName==="hr"||i.tagName==="main"||i.tagName==="menu"||i.tagName==="nav"||i.tagName==="ol"||i.tagName==="p"||i.tagName==="pre"||i.tagName==="section"||i.tagName==="table"||i.tagName==="ul"):!t||!(t.type==="element"&&(t.tagName==="a"||t.tagName==="audio"||t.tagName==="del"||t.tagName==="ins"||t.tagName==="map"||t.tagName==="noscript"||t.tagName==="video"))}function GZ(e,n,t){const i=Li(t,n);return!i||i.type==="element"&&i.tagName==="li"}function YZ(e,n,t){const i=Li(t,n);return!!(i&&i.type==="element"&&(i.tagName==="dt"||i.tagName==="dd"))}function WZ(e,n,t){const i=Li(t,n);return!i||i.type==="element"&&(i.tagName==="dt"||i.tagName==="dd")}function j_(e,n,t){const i=Li(t,n);return!i||i.type==="element"&&(i.tagName==="rp"||i.tagName==="rt")}function QZ(e,n,t){const i=Li(t,n);return!i||i.type==="element"&&i.tagName==="optgroup"}function JZ(e,n,t){const i=Li(t,n);return!i||i.type==="element"&&(i.tagName==="option"||i.tagName==="optgroup")}function KZ(e,n,t){const i=Li(t,n);return!!(i&&i.type==="element"&&(i.tagName==="tbody"||i.tagName==="tfoot"))}function XZ(e,n,t){const i=Li(t,n);return!i||i.type==="element"&&(i.tagName==="tbody"||i.tagName==="tfoot")}function ZZ(e,n,t){return!Li(t,n)}function eee(e,n,t){const i=Li(t,n);return!i||i.type==="element"&&i.tagName==="tr"}function __(e,n,t){const i=Li(t,n);return!i||i.type==="element"&&(i.tagName==="td"||i.tagName==="th")}const tee=dA({body:ree,colgroup:aee,head:iee,html:nee,tbody:see});function nee(e){const n=Li(e,-1);return!n||n.type!=="comment"}function iee(e){const n=new Set;for(const i of e.children)if(i.type==="element"&&(i.tagName==="base"||i.tagName==="title")){if(n.has(i.tagName))return!1;n.add(i.tagName)}const t=e.children[0];return!t||t.type==="element"}function ree(e){const n=Li(e,-1,!0);return!n||n.type!=="comment"&&!(n.type==="text"&&iS(n.value.charAt(0)))&&!(n.type==="element"&&(n.tagName==="meta"||n.tagName==="link"||n.tagName==="script"||n.tagName==="style"||n.tagName==="template"))}function aee(e,n,t){const i=cA(t,n),a=Li(e,-1,!0);return t&&i&&i.type==="element"&&i.tagName==="colgroup"&&rS(i,t.children.indexOf(i),t)?!1:!!(a&&a.type==="element"&&a.tagName==="col")}function see(e,n,t){const i=cA(t,n),a=Li(e,-1);return t&&i&&i.type==="element"&&(i.tagName==="thead"||i.tagName==="tbody")&&rS(i,t.children.indexOf(i),t)?!1:!!(a&&a.type==="element"&&a.tagName==="tr")}const Ex={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function oee(e,n,t,i){const a=i.schema,o=a.space==="svg"?!1:i.settings.omitOptionalTags;let l=a.space==="svg"?i.settings.closeEmptyElements:i.settings.voids.includes(e.tagName.toLowerCase());const d=[];let f;a.space==="html"&&e.tagName==="svg"&&(i.schema=oA);const u=lee(i,e.properties),p=i.all(a.space==="html"&&e.tagName==="template"?e.content:e);return i.schema=a,p&&(l=!1),(u||!o||!tee(e,n,t))&&(d.push("<",e.tagName,u?" "+u:""),l&&(a.space==="svg"||i.settings.closeSelfClosing)&&(f=u.charAt(u.length-1),(!i.settings.tightSelfClosing||f==="/"||f&&f!=='"'&&f!=="'")&&d.push(" "),d.push("/")),d.push(">")),d.push(p),!l&&(!o||!rS(e,n,t))&&d.push("</"+e.tagName+">"),d.join("")}function lee(e,n){const t=[];let i=-1,a;if(n){for(a in n)if(n[a]!==null&&n[a]!==void 0){const o=cee(e,a,n[a]);o&&t.push(o)}}for(;++i<t.length;){const o=e.settings.tightAttributes?t[i].charAt(t[i].length-1):void 0;i!==t.length-1&&o!=='"'&&o!=="'"&&(t[i]+=" ")}return t.join("")}function cee(e,n,t){const i=hZ(e.schema,n),a=e.settings.allowParseErrors&&e.schema.space==="html"?0:1,o=e.settings.allowDangerousCharacters?0:1;let l=e.quote,d;if(i.overloadedBoolean&&(t===i.attribute||t==="")?t=!0:(i.boolean||i.overloadedBoolean)&&(typeof t!="string"||t===i.attribute||t==="")&&(t=!!t),t==null||t===!1||typeof t=="number"&&Number.isNaN(t))return"";const f=Th(i.attribute,Object.assign({},e.settings.characterReferences,{subset:Ex.name[a][o]}));return t===!0||(t=Array.isArray(t)?(i.commaSeparated?FZ:$Z)(t,{padLeft:!e.settings.tightCommaSeparatedLists}):String(t),e.settings.collapseEmptyAttributes&&!t)?f:(e.settings.preferUnquoted&&(d=Th(t,Object.assign({},e.settings.characterReferences,{attribute:!0,subset:Ex.unquoted[a][o]}))),d!==t&&(e.settings.quoteSmart&&N_(t,l)>N_(t,e.alternative)&&(l=e.alternative),d=l+Th(t,Object.assign({},e.settings.characterReferences,{subset:(l==="'"?Ex.single:Ex.double)[a][o],attribute:!0}))+l),f+(d&&"="+d))}const uee=["<","&"];function fA(e,n,t,i){return t&&t.type==="element"&&(t.tagName==="script"||t.tagName==="style")?e.value:Th(e.value,Object.assign({},i.settings.characterReferences,{subset:uee}))}function dee(e,n,t,i){return i.settings.allowDangerousHtml?e.value:fA(e,n,t,i)}function fee(e,n,t,i){return i.all(e)}const hee=_E("type",{invalid:pee,unknown:mee,handlers:{comment:OZ,doctype:LZ,element:oee,raw:dee,root:fee,text:fA}});function pee(e){throw new Error("Expected node, not `"+e+"`")}function mee(e){const n=e;throw new Error("Cannot compile unknown node `"+n.type+"`")}const gee={},yee={},xee=[];function bee(e,n){const t=n||gee,i=t.quote||'"',a=i==='"'?"'":'"';if(i!=='"'&&i!=="'")throw new Error("Invalid quote `"+i+"`, expected `'` or `\"`");return{one:vee,all:wee,settings:{omitOptionalTags:t.omitOptionalTags||!1,allowParseErrors:t.allowParseErrors||!1,allowDangerousCharacters:t.allowDangerousCharacters||!1,quoteSmart:t.quoteSmart||!1,preferUnquoted:t.preferUnquoted||!1,tightAttributes:t.tightAttributes||!1,upperDoctype:t.upperDoctype||!1,tightDoctype:t.tightDoctype||!1,bogusComments:t.bogusComments||!1,tightCommaSeparatedLists:t.tightCommaSeparatedLists||!1,tightSelfClosing:t.tightSelfClosing||!1,collapseEmptyAttributes:t.collapseEmptyAttributes||!1,allowDangerousHtml:t.allowDangerousHtml||!1,voids:t.voids||oZ,characterReferences:t.characterReferences||yee,closeSelfClosing:t.closeSelfClosing||!1,closeEmptyElements:t.closeEmptyElements||!1},schema:t.space==="svg"?oA:gZ,quote:i,alternative:a}.one(Array.isArray(e)?{type:"root",children:e}:e,void 0,void 0)}function vee(e,n,t){return hee(e,n,t,this)}function wee(e){const n=[],t=e&&e.children||xee;let i=-1;for(;++i<t.length;)n[i]=this.one(t[i],i,e);return n.join("")}const See={};function Nee(e){const n=this,{handlers:t,sanitize:i,...a}=e||See;let o=!1,l;typeof i=="boolean"?o=!i:i&&(l=i),n.compiler=d;function d(f,u){const p=sZ(f,{handlers:t,allowDangerousHtml:o}),g=o?p:gX(p,l),b=bee(g,{...a,allowDangerousHtml:o});return u.extname&&(u.extname=".html"),f&&f.type==="root"&&b&&/[^\r\n]/.test(b.charAt(b.length-1))?b+`
`:b}}const Cee=({isOpen:e,onClose:n,patientId:t,pharmacyInventory:i,fetchPharmacyOrdersData:a})=>{const[o,l]=w.useState([]),[d,f]=w.useState(""),[u,p]=w.useState([]),[g,b]=w.useState(null),[v,S]=w.useState(!1);w.useEffect(()=>{if(!d){p([]);return}const I=d.toLowerCase();p(i.filter(U=>U.name.toLowerCase().includes(I)).slice(0,10))},[d,i]);const k=async()=>{if(!t){b("Patient ID is missing.");return}if(o.length===0){b("Please select at least one drug.");return}for(const I of o)if(I.selected_pack_quantity===0&&I.selected_loose_quantity===0){b(`Please specify a quantity for ${I.name}.`);return}S(!0),b(null);try{const I={patient_id:t,items:o.map(L=>({drug_id:L.id,name:L.name,pack_quantity:L.selected_pack_quantity,loose_quantity:L.selected_loose_quantity,pack_price:0,loose_price:0,total_price:0,tabletsPerDay:1,numberOfDays:1,directions_to_use:"As directed"})),order_total:0,prescription_for_unavailable_drugs:""},U=await me("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)});if(!U.ok){const L=await U.json().catch(()=>({}));throw new Error(L.message||`Failed to create pharmacy order: ${U.statusText}`)}await U.json(),a(t),n(),l([]),f("")}catch(I){b(`Order Creation Error: ${I.message}`)}finally{S(!1)}},T=I=>{if(o.some(U=>U.id===I.id)){b(`${I.name} is already in the order.`),setTimeout(()=>b(null),3e3),f(""),p([]);return}l(U=>[...U,{...I,selected_pack_quantity:0,selected_loose_quantity:0}]),f(""),p([])},P=I=>{l(U=>U.filter(L=>L.id!==I))},M=(I,U,L)=>{const $=parseInt(L)||0;l(z=>z.map(F=>F.id===I?{...F,[U==="pack"?"selected_pack_quantity":"selected_loose_quantity"]:$}:F))};return e?r.jsx("div",{className:Nt.modalOverlay,children:r.jsxs("div",{className:Nt.modalContent,children:[r.jsxs("div",{className:Nt.modalHeader,children:[r.jsx("h3",{className:Nt.modalTitle,children:"Create Pharmacy Order"}),r.jsx("button",{onClick:n,className:Nt.modalCloseButton,children:r.jsx(Qn,{size:20})})]}),r.jsxs("div",{className:Nt.modalBody,children:[g&&r.jsx("div",{className:Nt.errorText,children:g}),r.jsxs("div",{className:Nt.formGroup,style:{position:"relative"},children:[r.jsx("label",{htmlFor:"drug-search",children:"Add Drug"}),r.jsx("input",{type:"text",id:"drug-search",placeholder:"Search available drugs...",value:d,onChange:I=>f(I.target.value),className:Nt.inputField,autoComplete:"off"}),d&&u.length>0&&r.jsx("div",{className:Nt.searchResultsCard,children:r.jsx("ul",{className:Nt.searchResultsList,children:u.map(I=>r.jsx("li",{onClick:()=>T(I),className:Nt.searchResultItem,children:r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[r.jsx("span",{children:I.name}),r.jsxs("span",{className:Nt.searchResultPrice,children:["Stock: ",I.quantity_in_stock," (Box) / ",I.loose||0," (Loose)"]})]})},I.id))})})]}),r.jsxs("div",{className:Nt.selectedTestsCard,children:[" ",r.jsx("h4",{className:Nt.selectedTestsHeader,children:"Selected Drugs"}),o.length===0?r.jsx("p",{className:Nt.noTestsMessage,children:"No drugs added yet."}):r.jsx("ul",{className:Nt.selectedTestsList,children:o.map(I=>r.jsxs("li",{className:Nt.selectedTestItem,style:{flexDirection:"column",alignItems:"flex-start",gap:"8px"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",alignItems:"center"},children:[r.jsx("span",{className:Nt.selectedTestName,style:{fontWeight:"bold"},children:I.name}),r.jsx("button",{type:"button",onClick:()=>P(String(I.id)),className:Nt.removeTestButton,title:"Remove Drug",children:r.jsx(or,{size:16})})]}),r.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",width:"100%"},children:[r.jsxs("div",{style:{flex:1},children:[r.jsx("label",{style:{fontSize:"0.75rem",color:"#666"},children:"Packs"}),r.jsx("input",{type:"number",min:"0",className:Nt.inputField,style:{padding:"4px 8px"},value:I.selected_pack_quantity||"",onChange:U=>M(I.id,"pack",U.target.value),placeholder:"0"})]}),r.jsxs("div",{style:{flex:1},children:[r.jsx("label",{style:{fontSize:"0.75rem",color:"#666"},children:"Loose"}),r.jsx("input",{type:"number",min:"0",className:Nt.inputField,style:{padding:"4px 8px"},value:I.selected_loose_quantity||"",onChange:U=>M(I.id,"loose",U.target.value),placeholder:"0"})]})]})]},I.id))})]})]}),r.jsxs("div",{className:Nt.modalFooter,children:[r.jsx("button",{type:"button",onClick:n,className:`${Nt.button} ${Nt.buttonSecondary}`,children:" Cancel "}),r.jsxs("button",{type:"button",onClick:k,disabled:o.length===0||v,className:`${Nt.button} ${Nt.buttonPrimary} ${o.length===0||v?Nt.buttonDisabled:""}`,children:[" ",v?"Creating...":"Create Order"," "]})]})]})}):null},jee=({messages:e})=>{const n=w.useRef(null);return w.useEffect(()=>{n.current&&(n.current.scrollTop=n.current.scrollHeight)},[e]),r.jsxs("div",{className:"conversation-panel",children:[r.jsxs("div",{className:"conversation-header",children:[r.jsx("div",{className:"conversation-title",children:r.jsx("h3",{children:"Conversation"})}),r.jsxs("span",{className:"conversation-count",children:[e.length," messages"]})]}),r.jsxs("div",{ref:n,className:"message-list custom-scrollbar",children:[e.length===0&&r.jsx("div",{className:"empty-state",children:"Start talking to the AI..."}),e.map(t=>r.jsxs("div",{className:`message-wrapper ${t.role}`,children:[r.jsx("div",{className:`message-bubble ${t.role} ${t.role==="system"?t.type||"info":""}`,children:t.role==="ai"||t.role==="system"&&t.type==="loading"?r.jsx("div",{className:"prose prose-sm max-w-none",children:t.role==="system"&&t.type==="loading"?r.jsxs("span",{className:"flex items-center justify-center gap-2",children:[r.jsx("span",{className:"loading-spinner"}),t.content]}):r.jsx(Yo,{remarkPlugins:[zs],children:t.content})}):r.jsx("div",{className:"whitespace-pre-wrap",children:t.content})}),t.role!=="system"&&r.jsx("span",{className:"message-timestamp",children:t.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},t.id))]})]})},G0=e=>{if(!e)return"";const n=new Date(e);if(isNaN(n.getTime()))return"";const t=n.getTimezoneOffset()*6e4;return new Date(n.getTime()-t).toISOString().slice(0,16)},k_=()=>{var go,yo;const{recordId:e,patientId:n}=Br(),[t,i]=w.useState(e||void 0),a=_t(),o=Gi(),[l,d]=w.useState(""),[f]=w.useState([]),[u,p]=w.useState(null),[g,b]=w.useState(null),[v,S]=w.useState(void 0),[k,T]=w.useState(void 0),[P,M]=w.useState(null),[I,U]=w.useState(!1),[L,$]=w.useState(""),[z,F]=w.useState(!1),[Q,R]=w.useState(null),[B,Y]=w.useState(null),[re,ne]=w.useState(!1),[G,V]=w.useState(!1),[W,J]=w.useState(null),[he,A]=w.useState(""),[ce,se]=w.useState(""),[D,oe]=w.useState(null),[xe,Z]=w.useState(!1),[ue,ae]=w.useState(!1),[Re,Ae]=w.useState(!1),[Ce,Se]=w.useState(window.innerHeight),[De,Me]=w.useState([]),[et,ct]=w.useState(!1),[ut,at]=w.useState(null),[qt,jt]=w.useState([]),[_e,Fe]=w.useState([]),[Pe,Ue]=w.useState(!1),[ve,ee]=w.useState(null),fe=w.useRef(null),qe=w.useRef(null),nt=w.useRef(!1),lt=w.useRef(null),wt=w.useRef(null),Ve=w.useRef(null),be=w.useRef(null),ye=w.useRef(null),Oe=w.useRef(null),He=w.useRef(null),[tt,rt]=w.useState([]),[Ft,Kn]=w.useState(!1);w.useEffect(()=>{(async()=>{if(tt.length>0&&!Ft){Kn(!0);const de=tt[0];de.current&&(de.current.scrollIntoView({behavior:"smooth",block:"center"}),de.current.classList.add("ai-glow"),await new Promise(le=>setTimeout(le,2e3)),de.current&&de.current.classList.remove("ai-glow")),rt(le=>le.slice(1)),Kn(!1)}})()},[tt,Ft]);const Pn=te=>{let de=null;switch(te){case"update_patient_details":de=Ve;break;case"create_pharmacy_order":case"edit_pharmacy_order":de=be;break;case"create_lab_order":case"edit_lab_order":de=ye;break;case"add_complaint_history":de=Oe;break;case"update_case_summary":de=He;break}de&&rt(le=>[...le,de])},[Et,Vt]=w.useState(33.33),[hi,gn]=w.useState(!1),Dn=w.useRef(null),Bt=w.useRef(null),[Ys,Ws]=w.useState("response"),Fi=w.useRef(null),zn=w.useRef(null),Ri=150,[ha,xu]=w.useState([]),[bu,Qh]=w.useState([]),[Zo,Qs]=w.useState(!1),[Kl,ds]=w.useState(null),[Js,Ks]=w.useState(!1),[Xs,pi]=w.useState(!1),[Vd,Hd]=w.useState(!1),[fs,Zs]=w.useState(!1),[Xl,Gd]=w.useState(!1),[hs,qr]=w.useState([]),[Ra,el]=w.useState(!1),[kr,tl]=w.useState(null),[nl,Ma]=w.useState(!1),[Zl,ec]=w.useState(null),[tc,vu]=w.useState({}),[Yi,nc]=w.useState(!1),[ic,il]=w.useState(!1),[eo,Oa]=w.useState(!1),[rc,Wi]=w.useState(!1),[to,ac]=w.useState(!1),[ps,ms]=w.useState(!1),[rl,al]=w.useState(!1),[Tr,Vr]=w.useState(!1),no=w.useMemo(()=>(g==null?void 0:g.admission_date)&&!(g!=null&&g.discharge_date),[g]),[sc,io]=w.useState(!1),[Yd,oc]=w.useState(null),[gs,ro]=w.useState(""),[sl,La]=w.useState(void 0),[Fa,ol]=w.useState(void 0),[ll,lc]=w.useState(void 0),[Qi,Er]=w.useState(!1),[ao,Ar]=w.useState(null),[$a,cl]=w.useState(null),[cc,uc]=w.useState(null),[hn,Sn]=w.useState(!1),ul=w.useRef(null),[Mi,pa]=w.useState(null),[dl,so]=w.useState([]),Wd=w.useCallback(te=>{so(de=>[...de,{id:Math.random().toString(36).substr(2,9),timestamp:new Date,role:"system",content:"",...te}])},[]),[oo,dc]=w.useState(null),Un=w.useRef(null),ma=w.useRef(null),[za,fc]=w.useState(!1),[fl,Ji]=w.useState(!1),[yn,hc]=w.useState(null),[hl,pc]=w.useState(""),[lo,co]=w.useState(""),[$i,Qd]=w.useState(!0),[xi,Jd]=w.useState(!1),[mc,Ki]=w.useState(!1),[ga,gc]=w.useState(!1),[Bn,Hr]=w.useState(!1),ys=w.useRef(null),Jh=async()=>{ys.current&&(await ys.current.undoLastAction(),Hr(!1))},Ua=async te=>{try{const de=await me(`/api/patients/${te}`);if(!de.ok){const we=await de.json().catch(()=>({}));throw new Error(we.message||`Failed to fetch patient details: ${de.status}`)}const le=await de.json();if(b(le),S(le.age),T(le.gender),A(le.ai_response||""),b(we=>we?{...we,current_status:le.current_status,admission_date:le.admission_date,discharge_date:le.discharge_date}:{...le,current_status:le.current_status,admission_date:le.admission_date,discharge_date:le.discharge_date}),le.insurance_type&&b(we=>we?{...we,insurance_type:le.insurance_type}:{...le}),pl(te),le.ai_response){const we=/```json\s*([\s\S]*?)\s*```/,We=le.ai_response.match(we);if(We&&We[1])se(le.ai_response.replace(we,"").trim()),oe(We[1].trim());else{const dt=le.ai_response.trim();if(dt.startsWith("{")&&dt.endsWith("}"))try{JSON.parse(dt),se(""),oe(dt)}catch{se(dt),oe(null)}else if(dt.startsWith("[")&&dt.endsWith("]"))try{JSON.parse(dt),se(""),oe(dt)}catch{se(dt),oe(null)}else se(dt),oe(null)}}else se(""),oe(null)}catch{b(null),A(""),se(""),oe(null)}},Kh=async(te,de)=>{b(le=>le?{...le,insurance_type:de}:null);try{const le=await me(`/api/patients/${te}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({insurance_type:de})});if(!le.ok){const we=await le.json();throw new Error(we.message||"Failed to update insurance type")}}catch(le){console.error("Error updating insurance type:",le),te&&Ua(te)}},Kd=async te=>{Ue(!0),ee(null),Fe([]);try{const de=await me(`/api/queue/patient/${te}/complaints`);if(!de.ok){const we=await de.json().catch(()=>({}));throw new Error(we.message||`HTTP error! status: ${de.status}`)}const le=await de.json();Fe(le||[])}catch(de){ee(`Past complaints error: ${de.message}`)}finally{Ue(!1)}},uo=async te=>{jt([]);try{const de=await me(`/api/pharmacy-orders/patient/${te}`);if(!de.ok){const we=await de.json().catch(()=>({}));throw new Error(we.message||`HTTP error! status: ${de.status}`)}const le=await de.json();jt(le||[])}catch{}},xs=async te=>{el(!0),tl(null),qr([]);try{const de=await me(`/api/lab/orders/patient/${te}`);if(!de.ok){const we=await de.json().catch(()=>({}));throw new Error(we.message||`HTTP error! status: ${de.status}`)}const le=await de.json();qr(le||[])}catch(de){tl(`Pending labs error: ${de.message}`)}finally{el(!1)}},Ba=async te=>{ct(!0),at(null),Me([]);try{const de=await me(`/api/lab/patient/${te}`);if(!de.ok){const we=await de.json().catch(()=>({}));throw new Error(we.message||`HTTP error! status: ${de.status}`)}const le=await de.json();Me(le||[])}catch(de){at(`Lab reports error: ${de.message}`)}finally{ct(!1)}},fo=async te=>{try{const de=await me(`/api/patients/${te}/context`);if(!de.ok){console.error("Failed to fetch patient context");return}const le=await de.json();if(b(le.patient),S(le.patient.age),T(le.patient.gender),A(le.patient.ai_response||""),le.patient.ai_response){const we=/```json\s*([\s\S]*?)\s*```/,We=le.patient.ai_response.match(we);if(We&&We[1])se(le.patient.ai_response.replace(we,"").trim()),oe(We[1].trim());else{const dt=le.patient.ai_response.trim();if(dt.startsWith("{")&&dt.endsWith("}"))try{JSON.parse(dt),se(""),oe(dt)}catch{se(dt),oe(null)}else if(dt.startsWith("[")&&dt.endsWith("]"))try{JSON.parse(dt),se(""),oe(dt)}catch{se(dt),oe(null)}else se(dt),oe(null)}}else se(""),oe(null);if(Vr(le.patient.current_status==="In Doctor Queue"||le.patient.current_status==="In Consultation"),Fe(Array.isArray(le.history)?le.history:[]),jt(Array.isArray(le.pharmacyOrders)?le.pharmacyOrders:[]),Array.isArray(le.labOrders)){const we=le.labOrders,We=we.filter(vt=>!vt.report);qr(We);const dt=we.filter(vt=>vt.report).map(vt=>({...vt.report,id:vt.id,patient_id:vt.patient_id,createdAt:vt.createdAt}));Me(dt)}else qr([]),Me([])}catch(de){console.error("Error fetching patient context:",de)}},pl=async te=>{try{const de=await me(`/api/queue/patient/${te}/latest`);if(!de.ok){const we=await de.json().catch(()=>({}));throw new Error(we.message||`Failed to fetch queue status: ${de.status}`)}const le=await de.json();if(le){const we=new Date(le.createdAt),We=new Date,dt=we.getDate()===We.getDate()&&we.getMonth()===We.getMonth()&&we.getFullYear()===We.getFullYear(),vt=["waiting","consulting"].includes(le.status);Vr(dt&&vt)}else Vr(!1)}catch(de){console.error("Error checking patient queue status:",de),Vr(!1)}},bs=async(te,de)=>{try{if(!(await me(`/api/pharmacy-orders/${te}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:de})})).ok)throw new Error("Failed to update pharmacy order date");u&&uo(u)}catch(le){console.error("Error updating pharmacy order date:",le),J("Failed to update pharmacy order date")}},ml=async(te,de,le)=>{try{const we={};if(de==="order"?we.date=le:de==="report"&&(we.reportDate=le),!(await me(`/api/lab/orders/${te}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(we)})).ok)throw new Error("Failed to update lab date");u&&(xs(u),Ba(u))}catch(we){console.error("Error updating lab order date:",we),J("Failed to update lab order date")}},gl=te=>{a(`/dashboard/edit-pharmacy-order/${te}`)},yc=te=>{J(null),console.log(`Preparing billing navigation for order: ${te}`);const de=qt.find(le=>le.id===te);if(de){const le=de.medications.map(we=>{const We=we.price??0;return(we.price===void 0||we.price===null)&&console.warn(`Medication "${we.name}" in order ${te} is missing a price. Defaulting to 0.`),{name:we.name,pack_quantity:we.pack_quantity,loose_quantity:we.loose_quantity,price:We,pack_price:we.pack_price,loose_price:we.loose_price,total_price:Number(we.total_price)||0,isLoose:we.isLoose,unit:we.unit,drug_id:we.drug_id?String(we.drug_id):null,tabletsPerDay:we.tabletsPerDay,numberOfDays:we.numberOfDays,directions_to_use:we.directions_to_use,discount_percentage:we.discount_percentage??0,batch:we.batch,expiry_date:we.expiry_date}});console.log("Navigating to /dashboard/pharmacy-billing with state:",{initialItems:le}),a(`/dashboard/pharmacy-billing/${te}`,{state:{initialItems:le}})}else console.error(`Order with ID ${te} not found.`),J(`Order with ID ${te} not found.`),alert(`Error: Could not find order ${te} to bill.`)},wu=async(te,de)=>{J(null);const le=qt.find(We=>We.id===te);if(!le){J(`Order with ID ${te} not found.`);return}const we={status:de,medications:le.medications};try{const We=await me(`/api/pharmacy-orders/${te}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(we)});if(!We.ok){const vt=await We.text();throw new Error(`Failed to update status: ${We.statusText} (${We.status}) - ${vt}`)}const dt=await We.json();jt(vt=>vt.map(bt=>bt.id===dt.id?{...bt,status:dt.status}:bt)),u&&uo(u)}catch(We){console.error("Failed to update order status:",We),J(We.message||`Failed to update status for order ${te}.`),alert(`Error updating status for order ${te}: ${We.message||"Please try again."}`)}},Xd=te=>{qr(de=>de.map(le=>le.id===te?{...le,isEditing:!0,editedTests:[...le.tests],editedStatus:le.status}:{...le,isEditing:!1}))},xc=te=>{qr(de=>de.map(le=>le.id===te?{...le,isEditing:!1,editedTests:void 0,editedStatus:void 0}:le))},qa=(te,de,le,we)=>{qr(We=>We.map(dt=>{if(dt.id===te){const vt=dt.editedTests?[...dt.editedTests]:[...dt.tests];if(le==="add")return{...dt,editedTests:[...vt,{id:"",name:"",price:0}]};if(le==="remove")return{...dt,editedTests:we};if(de!==-1){const bt={...vt[de],[le]:we};return vt[de]=bt,{...dt,editedTests:vt}}}return dt}))},Xh=(te,de)=>{qr(le=>le.map(we=>we.id===te?{...we,editedStatus:de}:we))},Zd=async te=>{if(!te){console.error("Cannot navigate to billing: Lab Order data is missing."),alert("Could not open billing page: Lab Order information is missing.");return}a(`/dashboard/lab-billing/${te.id}`)},Xi=async(te,de)=>{console.log(`Updating lab order ${te} to status ${de}`);try{const le=await me(`/api/lab/${te}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:de})});if(!le.ok){const we=await le.json();throw new Error(we.message||`Failed to update lab order status: ${le.status}`)}u&&(xs(u),Ba(u)),console.log(`Lab Order ${te} status updated to ${de}, refetching data.`)}catch(le){console.error("Error updating lab order status:",le),alert(`Failed to update lab order status: ${le instanceof Error?le.message:"Unknown error"}`)}},yl=te=>{te&&te.id?a(`/lab/report/${te.id}`):(console.error("Cannot navigate: Lab Order or Lab Order ID is missing."),alert("Could not open the report entry page: Lab Order information is missing."))},ho=async(te,de,le)=>{Oa(!0),J(null);try{if(!de||de.length===0)throw new Error("Lab order must have at least one test.");for(const dt of de)if(!dt.id||!dt.name||isNaN(dt.price)||dt.price<0)throw new Error(`Invalid test data: ${JSON.stringify(dt)}. Each test must have id, name, and a valid price.`);const we={tests:de,status:le},We=await me(`/api/lab/orders/${te}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(we)});if(!We.ok){const dt=await We.json().catch(()=>({}));throw new Error(dt.message||`Failed to update lab order: ${We.statusText}`)}u&&xs(u),qr(dt=>dt.map(vt=>vt.id===te?{...vt,isEditing:!1,editedTests:void 0,editedStatus:void 0}:vt))}catch(we){J(`Lab Order Save Error: ${we.message}`)}finally{Oa(!1)}},ya=async te=>{if(!window.confirm(`Are you sure you want to delete this ${te.type.toLowerCase()} record? This action cannot be undone.`))return;Ma(!0),ec(null);let le=null,we;const We=te.type;try{switch(We){case"Complaint":if(we=te.data.id,!we)throw new Error("Complaint ID is missing.");le=`/api/patients/complaints/${we}`;break;case"Lab Order":if(we=te.data.id,!we)throw new Error("Lab Order ID is missing.");le=`/api/lab/orders/${we}`;break;case"Lab Report":if(we=te.data.reportId,!we)throw new Error("Lab Report ID is missing.");le=`/api/lab/reports/${we}`;break;case"Pharmacy Order":if(we=te.data.id,!we)throw new Error("Pharmacy Order ID is missing.");le=`/api/pharmacy-orders/${we}`;break;default:throw new Error(`Deletion not supported for item type: ${We}`)}if(!le)throw new Error(`Could not determine delete URL for type: ${We}`);const dt=await me(le,{method:"DELETE"});if(!dt.ok){const vt=await dt.json().catch(()=>({}));throw new Error(vt.message||`Failed to delete ${We}: ${dt.statusText}`)}u&&(We==="Complaint"?Kd(u):We==="Lab Order"?(xs(u),Ba(u)):We==="Lab Report"?Ba(u):We==="Pharmacy Order"&&uo(u))}catch(dt){ec(`Delete Error (${We}): ${dt.message}`),nl&&Ma(!1)}finally{Ma(!1)}},po=async()=>{if(!u)return;if(qt.filter(de=>de.status==="pending").length<2){alert("You need at least two pending orders to merge.");return}Ji(!0);try{const de=await me(`/api/pharmacy-orders/patient/${u}/merge-pending`,{method:"POST"});if(!de.ok){const le=await de.json().catch(()=>({}));throw new Error(le.message||"Failed to merge orders")}uo(u)}catch(de){J(`Merge Error: ${de.message}`)}finally{Ji(!1)}},Va=w.useMemo(()=>{if(!u||!_e)return[];const te=_e.map(de=>({date:new Date(de.createdAt),type:"Complaint",data:de,originalDateString:de.createdAt})).filter(de=>!isNaN(de.date.getTime()));return te.sort((de,le)=>le.date.getTime()-de.date.getTime()),te},[u,_e]),Pr=w.useMemo(()=>{if(!u)return[];const te=new Map;(hs??[]).forEach(le=>{te.set(le.id,{...le})}),(De??[]).forEach(le=>{if(!te.has(le.id))te.set(le.id,{id:le.id,patient_id:le.patient_id,tests:le.tests,status:le.status,createdAt:le.createdAt,report:le});else{const we=te.get(le.id);we&&(we.report=le,we.status=le.status)}});let de=Array.from(te.values());return de.sort((le,we)=>new Date(le.createdAt).getTime()-new Date(we.createdAt).getTime()),de=de.map((le,we)=>({...le,serialNumber:we+1})),de.map(le=>({date:new Date(le.createdAt),type:"Lab Order",data:le,originalDateString:le.createdAt}))},[u,hs,De]),Gr=w.useMemo(()=>{if(!u||!qt)return[];const te=qt.map(de=>({date:new Date(de.date),type:"Pharmacy Order",data:de,originalDateString:de.date})).filter(de=>!isNaN(de.date.getTime()));return te.sort((de,le)=>le.date.getTime()-de.date.getTime()),te},[u,qt]),[Su,bc]=w.useState(null),[xa,Nu]=w.useState([]),[mo,xl]=w.useState(""),Cu=(te,de)=>{if(!te||!te.report_content||!de)return"";try{const le=JSON.parse(te.report_content||"{}");if(typeof le!="object"||le===null)return`<p class="italic text-gray-500 text-xs">Report content is not structured data.</p><pre>${te.report_content}</pre>`;let we="";return de.forEach(We=>{le[We.id]?(we+=`<h5 class="font-semibold text-sm mt-2 mb-1">${We.name}</h5>`,we+='<table class="lab-report-print-table"><thead><tr><th>Parameter</th><th>Value</th><th>Normal Range</th></tr></thead><tbody>',Object.entries(le[We.id]).map(([dt,vt])=>{var zi;const bt=(zi=We.default_parameters)==null?void 0:zi.find(Ss=>Ss.name===dt);let qn="N/A";bt&&bt.type==="number"&&(bt.lower_limit!=null||bt.upper_limit!=null)?(qn="",bt.lower_limit!=null&&(qn+=` > ${bt.lower_limit}`),bt.lower_limit!=null&&bt.upper_limit!=null&&(qn+=" - "),bt.upper_limit!=null&&(qn+=` < ${bt.upper_limit}`),qn=qn.trim()||"N/A"):(bt==null?void 0:bt.type)==="boolean"?qn="N/A":bt!=null&&bt.normal_range&&(qn=bt.normal_range),we+=`<tr><td>${dt}</td><td>${String(vt)} ${(bt==null?void 0:bt.unit)||""}</td><td>${qn}</td></tr>`}),we+="</tbody></table>"):we+=`<p class="italic text-gray-500 text-xs">No parameters reported for ${We.name}.</p>`}),we}catch{return`<p class="italic text-gray-500 text-xs">Error parsing report content.</p><pre>${te.report_content}</pre>`}};w.useEffect(()=>{const te=()=>{Se(window.innerHeight)};return window.addEventListener("resize",te),te(),()=>window.removeEventListener("resize",te)},[]),w.useEffect(()=>{const te=le=>{if(!hi||!zn.current||!Fi.current)return;const we=Fi.current.getBoundingClientRect(),dt=le.clientX-zn.current.x;let vt=zn.current.initialWidth+dt;const bt=we.width-Ri-10;vt=Math.max(Ri,vt),vt=Math.min(vt,bt);const qn=vt/we.width*100;Vt(qn)},de=()=>{gn(!1),zn.current=null,document.body.style.cursor="",document.body.style.userSelect=""};return hi&&(window.addEventListener("mousemove",te),window.addEventListener("mouseup",de),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{window.removeEventListener("mousemove",te),window.removeEventListener("mouseup",de),document.body.style.cursor="",document.body.style.userSelect=""}},[hi]);const Ha=te=>{if(!Fi.current)return;te.preventDefault();const de=Fi.current.querySelector(".edit-complaint-context-column");de&&(zn.current={x:te.clientX,initialWidth:de.offsetWidth},gn(!0))},bl=w.useCallback(async()=>{V(!0),J(null);try{const te=await me("/api/queue/doctor/new",{method:"POST"});if(!te.ok){const le=await te.json().catch(()=>({}));throw new Error(le.message||`Failed to create record: ${te.statusText}`)}const de=await te.json();if(!de.recordId)throw new Error("New record ID not received from server.");a(`/edit-complaint/${de.recordId}`,{replace:!0})}catch(te){J(`Failed to create new complaint record: ${te.message}`)}finally{V(!1)}},[a]);w.useEffect(()=>{(async()=>{Qd(!0);try{const de=await me("/api/clinics/settings");if(!de.ok){const we=await de.json().catch(()=>({}));throw new Error(we.message||"Failed to fetch clinic settings.")}const le=await de.json();hc({admissionCharge:parseFloat(le.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(le.perDayCharge||0).toFixed(2),otherCharges:parseFloat(le.otherCharges||0).toFixed(2),aiMemory:le.aiMemory||"",aiMemoryUpdatedAt:le.aiMemoryUpdatedAt||null,clinicWideSystemPrompt:le.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:le.clinicWideSystemPromptUpdatedAt||null,gemini_api_key:le.gemini_api_key||""}),pc(le.aiMemory||""),co(le.clinicWideSystemPrompt||"")}catch{}finally{Qd(!1)}})()},[]),w.useEffect(()=>{var de;(de=o.state)!=null&&de.initialComplaint&&d(o.state.initialComplaint);const te=async le=>{ne(!0),J(null);try{const we=await me(`/api/queue/doctor/complaint/${le}`);if(!we.ok){const dt=await we.json().catch(()=>({}));throw new Error(dt.message||`HTTP error! status: ${we.status}`)}const We=await we.json();p(We.patientId),S(We.age),T(We.gender),M(We.case_summary||null),Y(We.updatedAt||null)}catch{J("Failed to load current complaint details."),p(null),S(void 0),T(void 0),M(null),Y(null)}finally{ne(!1)}};if(t)te(t);else if(n){const le=n;le&&(p(le),(async()=>{try{const We=await me(`/api/queue/patient/${le}/latest`);if(We.ok){const vt=await We.json();if(vt!=null&&vt._id){i(vt._id),te(vt._id);return}}const dt=await me("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:le,complaint:"Visit Initiated"})});if(dt.ok){const vt=await dt.json();if(vt!=null&&vt.id){i(vt.id),te(vt.id);return}}}catch(We){console.error("Background queue resolution failed",We),J("Failed to initialize visit record.")}})())}else bl()},[t,bl,(go=o.state)==null?void 0:go.initialComplaint,n]),w.useEffect(()=>{u?fo(u):(b(null),Fe([]),jt([]),qr([]),Me([]),Y(null),Vr(!1))},[u]),w.useEffect(()=>{var le;const te=(le=o.state)==null?void 0:le.initialComplaint;te&&t&&(!re&&!Pe&&!Ra&&!et&&!Zo)&&!nt.current&&l===te&&(nt.current=!0,vs(),a(o.pathname,{replace:!0,state:{}}))},[(yo=o.state)==null?void 0:yo.initialComplaint,t,l,re,Pe,Ra,et,Zo,a]);const Zh=()=>{$(P||""),U(!0),R(null)},ep=()=>{U(!1),$(""),R(null)},Zi=async()=>{if(!t){R("Missing Record ID.");return}F(!0),R(null);try{const te=await me(`/api/queue/doctor/complaint/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({case_summary:L.trim()})});if(!te.ok){const le=await te.json().catch(()=>({}));throw new Error(le.message||`Failed to save case summary: ${te.statusText}`)}const de=await te.json();M(de.case_summary||L.trim()),Y(de.updatedAt||null),U(!1)}catch(te){R(`Save Error: ${te.message}`)}finally{F(!1)}};w.useEffect(()=>{(async()=>{Qs(!0),ds(null);try{const[de,le]=await Promise.all([me("/api/drugs"),me("/api/lab-tests")]);if(!de.ok)throw new Error(`Pharmacy inventory error! status: ${de.status}`);const we=await de.json();if(xu(we||[]),!le.ok)throw new Error(`Lab inventory error! status: ${le.status}`);const We=await le.json();Qh(We||[])}catch(de){ds(de.message)}finally{Qs(!1)}})()},[]);const Yr=async()=>{if(!yn)return;if(hl===yn.aiMemory&&lo===yn.clinicWideSystemPrompt){Ki(!1);return}const te=hl!==yn.aiMemory,de=lo!==yn.clinicWideSystemPrompt;te&&Jd(!0),de&&gc(!0);try{const le={...yn};te&&(le.aiMemory=hl),de&&(le.clinicWideSystemPrompt=lo);const we=await me("/api/clinics/settings",{method:"PUT",body:JSON.stringify(le)});if(!we.ok){const dt=await we.json().catch(()=>({}));throw new Error(dt.message||"Failed to update clinic settings.")}const We=await we.json();hc({admissionCharge:parseFloat(We.settings.admissionCharge).toFixed(2),perDayCharge:parseFloat(We.settings.perDayCharge).toFixed(2),otherCharges:parseFloat(We.settings.otherCharges).toFixed(2),aiMemory:We.settings.aiMemory||"",aiMemoryUpdatedAt:We.settings.aiMemoryUpdatedAt||(yn==null?void 0:yn.aiMemoryUpdatedAt)||null,clinicWideSystemPrompt:We.settings.clinicWideSystemPrompt||"",clinicWideSystemPromptUpdatedAt:We.settings.clinicWideSystemPromptUpdatedAt||(yn==null?void 0:yn.clinicWideSystemPromptUpdatedAt)||null}),te&&pc(We.settings.aiMemory||""),de&&(co(We.settings.clinicWideSystemPrompt||""),Ki(!1))}catch{}finally{te&&Jd(!1),de&&gc(!1)}},lr=()=>{yn&&(co(yn.clinicWideSystemPrompt||""),Ki(!0))},ju=()=>{Ki(!1),yn&&co(yn.clinicWideSystemPrompt||"")},vs=async te=>{const de=te??l;de.trim()&&(ma.current&&(clearTimeout(ma.current),ma.current=null),Wd({role:"user",content:de}),ys.current&&(await ys.current.callGenerativeApi(de),ma.current=setTimeout(()=>{so([])},1e4)))},ef=te=>{navigator.clipboard.writeText(te).then(()=>{}).catch(de=>{console.error("Failed to copy text: ",de)})},vl=(te,de)=>{const le=window.open("","_blank");le&&(le.document.write(`
        <html>
          <head>
            <title>${de}</title>
            <style>
              body { font-family: sans-serif; margin: 20px; }
              h2 { text-align: center; margin-bottom: 20px; }
              table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
              th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
              th { background-color: #f2f2f2; }
              pre { white-space: pre-wrap; word-wrap: break-word; }
              .ai-context-section { margin-bottom: 20px; border: 1px solid #eee; padding: 15px; border-radius: 5px; }
              .ai-context-section-title { font-size: 1.1em; font-weight: bold; margin-bottom: 10px; color: #333; }
              .ai-context-text { margin-bottom: 5px; }
              .text-gray-400 { color: #999; }
              .font-semibold { font-weight: 600; }
              .italic { font-style: italic; }
              .mt-2 { margin-top: 8px; }
              .ml-1 { margin-left: 4px; }
              .ml-2 { margin-left: 8px; }
              .flex { display: flex; }
              .flex-col { flex-direction: column; }
              .w-full { width: 100%; }
              .text-xs { font-size: 0.75rem; }
              .text-sm { font-size: 0.875rem; }
              .prose { max-width: 65ch; }
              .prose table { display: table; } /* Ensure tables in markdown render correctly */
            </style>
          </head>
          <body>
            <h2>${de}</h2>
            <div id="print-content">${te}</div>
          </body>
        </html>
      `),le.document.close(),le.print())},tp=()=>{if(he){const te=dX().use(zs).use(Nee).processSync(ce).toString();vl(`<div class="prose">${te}</div>`,"AI Response")}};w.useEffect(()=>{if(g){let te=`
        <div class="print-section">
          <h3>Patient Details</h3>
          <p><strong>Name:</strong> ${g.name||"N/A"}</p>
          <p><strong>Token:</strong> ${g.patient_token_number||"N/A"}</p>
          <p><strong>Age:</strong> ${g.age||"N/A"}</p>
          <p><strong>Gender:</strong> ${g.gender||"N/A"}</p>
          <p><strong>Phone:</strong> ${g.phone||"N/A"}</p>
          <p><strong>Insurance:</strong> ${g.insurance_type||"N/A"}</p>
          <p><strong>Status:</strong> ${g.current_status||"N/A"}</p>
          <p><strong>Admitted:</strong> ${g.admission_date?new Date(g.admission_date).toLocaleDateString():"N/A"}</p>
          <p><strong>Discharged:</strong> ${g.discharge_date?new Date(g.discharge_date).toLocaleDateString():"N/A"}</p>
        </div>
        <div class="print-section">
          <h3>Case Summary</h3>
          <p>${P||"No summary available."}</p>
        </div>
        <div class="print-section">
          <h3>Complaints History</h3>
          ${Va.length>0?`
            <ul>
              ${Va.map(de=>`<li>${new Date(de.originalDateString).toLocaleDateString()}: ${de.data.complaint}</li>`).join("")}
            </ul>
          `:"<p>No past complaints.</p>"}
        </div>
        <div class="print-section">
          <h3>Pharmacy Orders</h3>
          ${Gr.length>0?`
            <table class="print-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Status</th>
                  <th>Drug Name</th>
                  <th>Quantity</th>
                  <th>Dosage</th>
                  <th>Directions</th>
                </tr>
              </thead>
              <tbody>
                ${Gr.map(de=>de.data.medications.map((le,we)=>`
                    <tr>
                      ${we===0?`<td rowspan="${de.data.medications.length}">${new Date(de.originalDateString).toLocaleDateString()}</td>`:""}
                      ${we===0?`<td rowspan="${de.data.medications.length}">${de.data.status}</td>`:""}
                      <td><strong>${le.name}</strong></td>
                      <td>
                        ${le.pack_quantity!==void 0&&le.pack_quantity>0?`Packs: ${le.pack_quantity}`:""}
                        ${le.pack_quantity!==void 0&&le.pack_quantity>0&&le.loose_quantity!==void 0&&le.loose_quantity>0?", ":""}
                        ${le.loose_quantity!==void 0&&le.loose_quantity>0?`Loose: ${le.loose_quantity}`:""}
                      </td>
                      <td>${le.tabletsPerDay&&le.numberOfDays?`${le.tabletsPerDay} tab/day for ${le.numberOfDays} days`:"N/A"}</td>
                      <td>${le.directions_to_use||"N/A"}</td>
                    </tr>
                  `).join("")).join("")}
              </tbody>
            </table>
          `:"<p>No pharmacy orders.</p>"}
        </div>
        <div class="print-section">
          <h3>Lab History (Orders & Reports)</h3>
          ${Pr.length>0?`
            ${Pr.map(de=>{const le=de.data.tests.map(We=>We.name).join(", ");let we="";return de.data.report&&(we=`
                  <div class="lab-report-print-container">
                    <h4>Lab Report (${new Date(de.data.report.report_date).toLocaleDateString()})</h4>
                    ${Cu(de.data.report,de.data.report.tests)}
                  </div>
                `),`
                <div class="lab-history-item">
                  <p><strong>Order Date:</strong> ${new Date(de.originalDateString).toLocaleDateString()}</p>
                  <p><strong>Status:</strong> ${de.data.status}</p>
                  <p><strong>Tests:</strong> ${le}</p>
                  ${we}
                </div>
              `}).join("")}
          `:"<p>No lab history.</p>"}
        </div>
      `;xl(te)}else xl("")},[g,P,Va,Gr,Pr,Cu]);const Ga=()=>{mo&&vl(mo,`Patient Details - ${g==null?void 0:g.name}`)},Ya=te=>{d(te),bc(null),Nu([]),setTimeout(()=>{vs(te)},0)},ke=re||ue||Re||et||Pe||Zo||Ra||G||Js||Xs||Vd||fs||Xl||eo||Qi||xi||ga||fl||nl||rc||to||ps||rl||z,Ye=ke,Be=()=>{d("reports came,please anaylse"),setTimeout(()=>{vs()},0)},ft=te=>{vu(de=>({...de,[te]:!de[te]}))},kt=te=>{te.key==="Enter"&&!te.shiftKey&&(te.preventDefault(),!ke&&l.trim()&&t&&vs())};w.useEffect(()=>{const te=window.SpeechRecognition||window.webkitSpeechRecognition;if(!te){pa("Speech recognition not supported in this browser.");return}const de=new te;return de.continuous=!0,de.interimResults=!0,de.lang="en-US",de.onresult=le=>{let we="";for(let We=le.resultIndex;We<le.results.length;++We)le.results[We].isFinal&&(we+=le.results[We][0].transcript);we&&d(We=>We+(We.endsWith(" ")||We===""?"":" ")+we)},de.onerror=le=>{pa(`Speech error: ${le.error}`),Sn(!1)},de.onend=()=>{},ul.current=de,()=>{ul.current&&ul.current.stop()}},[]);const on=async()=>{if(u)if(no){ac(!0);try{const te=await me(`/api/patients/${u}/discharge`,{method:"POST"});if(!te.ok){const de=await te.json().catch(()=>({}));throw new Error(de.message||`Failed to discharge patient: ${te.status}`)}Ua(u)}catch(te){J(`Discharge Error: ${te.message}`)}finally{ac(!1)}}else{Wi(!0);try{const te=await me(`/api/patients/${u}/admit`,{method:"POST"});if(!te.ok){const de=await te.json().catch(()=>({}));throw new Error(de.message||`Failed to admit patient: ${te.status}`)}Ua(u)}catch(te){J(`Admit Error: ${te.message}`)}finally{Wi(!1)}}},si=async te=>{if(u){ms(!0);try{const le=await me("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:u})});if(!le.ok){const we=await le.json().catch(()=>({}));throw new Error(we.message||`Failed to add patient to ${te} queue: ${le.status}`)}alert(`Patient added to ${te} queue successfully!`),u&&(Ua(u),pl(u))}catch(de){J(`Add to Queue Error: ${de.message}`)}finally{ms(!1)}}},ln=async()=>{if(t){al(!0),J(null);try{const te=await me(`/api/queue/${t}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"seen"})});if(!te.ok){const de=await te.json().catch(()=>({}));throw new Error(de.message||"Failed to complete consultation")}alert("Consultation completed successfully!"),u&&(Ua(u),pl(u))}catch(te){J(`Error completing consultation: ${te.message}`)}finally{al(!1)}}},vc=async()=>{if(!u){Ar("Missing Patient ID.");return}if(!g){Ar("Patient details not loaded.");return}Er(!0),Ar(null);try{const te={};let de=!1;if(gs!==g.name&&(te.name=gs,de=!0),sl!==g.age&&(te.age=sl,de=!0),Fa!==g.gender&&(te.gender=Fa,de=!0),ll!==g.phone&&(te.phone=ll,de=!0),!de){Ar("No changes detected."),Er(!1),io(!1);return}const le=await me(`/api/patients/${u}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(te)});if(!le.ok){const We=await le.json().catch(()=>({}));throw new Error(We.message||`Failed to update patient details: ${le.statusText}`)}const we=await le.json();b(we),S(we.age),T(we.gender),ro(we.name),La(we.age),ol(we.gender),lc(we.phone),io(!1)}catch(te){Ar(`Save Error: ${te.message}`)}finally{Er(!1)}},tf=w.useCallback(()=>{if(!g)return null;const te={token_number:g.patient_token_number||"N/A",name:g.name||"N/A",age:g.age||"N/A",gender:g.gender||"N/A",phone:g.phone||"N/A"};return Va.length>0?te.complaints_history=Va.map(de=>`${de.data.complaint} (${new Date(de.originalDateString).toLocaleDateString()})`).join("; "):te.complaints_history="No past complaints.",Gr.length>0?te.pharmacy_orders_history=Gr.map(de=>`Order: ${de.data.medications.map(we=>{let We=`${we.name}`;return we.pack_quantity!==void 0&&we.pack_quantity>0&&(We+=` Packs: ${we.pack_quantity}`),we.loose_quantity!==void 0&&we.loose_quantity>0&&(We+=` Loose: ${we.loose_quantity}`),We}).join(", ")} (${de.data.status}, ${new Date(de.originalDateString).toLocaleDateString()})`).join("; "):te.pharmacy_orders_history="No pharmacy orders.",Pr.length>0?te.lab_orders_history=Pr.map(de=>{let we=`Lab Order: ${de.data.tests.map(We=>We.name).join(", ")} (${de.data.status}, ${new Date(de.originalDateString).toLocaleDateString()})`;return de.data.report&&(we+=` - Report: ${de.data.report.report_content} (${new Date(de.data.report.report_date).toLocaleDateString()})`),we}).join("; "):te.lab_orders_history="No lab history.",te},[g,Va,Gr,Pr]),er=()=>{if(!g){pa("Patient details are required to use the Live API.");return}fc(!0)},wc=()=>{var te;(te=Un.current)==null||te.click()},np=te=>{var le;const de=(le=te.target.files)==null?void 0:le[0];de&&dc(de)},ws=te=>{Ws(te),te==="context"&&Dn.current?Dn.current.scrollIntoView({behavior:"smooth",block:"start"}):te==="response"&&Bt.current&&Bt.current.scrollIntoView({behavior:"smooth",block:"start"})};return w.useEffect(()=>{const te=new IntersectionObserver(de=>{de.forEach(le=>{le.isIntersecting&&(le.target===Bt.current?Ws("response"):le.target===Dn.current&&Ws("context"))})},{root:null,threshold:.5});return Bt.current&&te.observe(Bt.current),Dn.current&&te.observe(Dn.current),()=>{Bt.current&&te.unobserve(Bt.current),Dn.current&&te.unobserve(Dn.current)}},[]),r.jsxs("div",{className:"edit-complaint-page",style:{height:`${Ce}px`},children:[r.jsx(AW,{ref:ys,recordId:t,patientId:u,patientDetails:g,caseSummary:P,caseSummaryUpdatedAt:B,clinicSettings:yn,userMessages:f,selectedImageFile:oo,pendingLabOrders:hs,labReports:De,pastComplaints:_e,pharmacyOrders:qt,pharmacyInventory:ha,labInventory:bu,currentComplaint:l,setCurrentComplaint:d,setAiResponse:A,setAiResponseText:se,setAiResponseJsonString:oe,setShowAiJsonDetails:Z,setIsLoadingAi:ae,setAiError:()=>{},setIsSubmittingAiOrder:Ks,setAiOrderSubmissionStatus:()=>{},setIsSubmittingAiLabOrder:pi,setAiLabOrderSubmissionStatus:()=>{},setIsSubmittingAiComplaint:Hd,setAiComplaintSubmissionStatus:()=>{},setIsUpdatingCaseSummary:Zs,setAiCaseSummaryUpdateStatus:()=>{},setCaseSummary:M,setCaseSummaryUpdatedAt:Y,setIsUpdatingAiMemoryByAI:Gd,setAiMemoryUpdateByAIStatus:()=>{},setFollowUpQuestion:bc,setFollowUpOptions:Nu,setError:J,setIsSavingAiResponse:Ae,setSaveAiResponseError:()=>{},fetchPharmacyOrdersData:uo,fetchPendingLabOrdersData:xs,fetchLabReportsData:Ba,fetchPastComplaintsData:Kd,fetchPatientDetails:Ua,setClinicSettings:hc,setEditedAiMemory:pc,handleDeleteItem:ya,setCanUndo:Hr,onAiActionSuccess:Pn,addMessage:Wd}),za&&g&&r.jsx(G2,{onClose:()=>fc(!1),patientData:tf(),tokenNumber:g.patient_token_number?String(g.patient_token_number):null,onAiSummaryChange:te=>{te&&(d(te),vs(te),fc(!1))}}),r.jsxs("div",{className:"edit-complaint-header",children:[r.jsx("button",{onClick:()=>a(-1),disabled:ke,className:"back-button",title:"Go Back",children:"< Back"}),r.jsx("span",{ref:wt,style:{position:"absolute",visibility:"hidden",height:"auto",width:"auto",whiteSpace:"nowrap"}}),g&&r.jsx("div",{className:"edit-complaint-patient-details",children:g&&!sc?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>{io(!0),ro(g.name||""),La(g.age),ol(g.gender),lc(g.phone),Ar(null)},className:"edit-button mr-2",title:"Edit Patient Details",disabled:Qi,children:r.jsx(ql,{size:14})}),g.name??"N/A",g.patient_token_number!==null&&g.patient_token_number!==void 0&&` (${g.patient_token_number})`," - ",g.age??"N/A"," / ",g.gender??"N/A",g.phone&&` / ${g.phone}`,r.jsx("button",{onClick:te=>{te.stopPropagation(),Ga()},disabled:!mo,title:"Print Patient Details",className:"icon-button small ml-2 text-gray-600 hover:text-gray-900",children:r.jsx(Go,{size:14})})]}):g&&sc?r.jsxs("div",{className:"patient-details-edit-form",children:[r.jsx("input",{type:"text",value:gs,onChange:te=>ro(te.target.value),placeholder:"Name",className:"edit-input",disabled:Qi}),r.jsx("input",{type:"number",value:sl??"",onChange:te=>La(te.target.value?parseInt(te.target.value):null),placeholder:"Age",className:"edit-input",disabled:Qi}),r.jsxs("select",{value:Fa??"",onChange:te=>ol(te.target.value||null),className:"edit-input",disabled:Qi,children:[r.jsx("option",{value:"",children:"Select Gender"}),r.jsx("option",{value:"M",children:"Male"}),r.jsx("option",{value:"F",children:"Female"}),r.jsx("option",{value:"O",children:"Other"})]}),r.jsx("input",{type:"text",value:ll??"",onChange:te=>lc(te.target.value||null),placeholder:"Phone Number",className:"edit-input",disabled:Qi}),r.jsxs("div",{className:"edit-actions",children:[r.jsx("button",{onClick:()=>{io(!1),Ar(null)},className:"button-secondary",disabled:Qi,children:"Cancel"}),r.jsx("button",{onClick:vc,className:"button-primary blue",disabled:Qi,children:Qi?"Saving...":"Save"})]}),ao&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:ao})]}):r.jsxs("div",{className:"edit-complaint-patient-details",children:[v??"N/A"," / ",k??"N/A",r.jsx("button",{onClick:te=>{te.stopPropagation(),Ga()},disabled:!mo,title:"Print Patient Details",className:"icon-button small ml-2 text-gray-600 hover:text-gray-900",children:r.jsx(Go,{size:14})})]})}),!g&&v!==void 0&&k!==void 0&&r.jsxs("div",{className:"edit-complaint-patient-details",children:[v??"N/A"," / ",k??"N/A",r.jsx("button",{onClick:te=>{te.stopPropagation(),Ga()},disabled:!mo,title:"Print Patient Details",className:"icon-button small ml-2 text-gray-600 hover:text-gray-900",children:r.jsx(Go,{size:14})})]}),r.jsx("div",{style:{width:"64px"}})]}),r.jsxs("div",{className:"edit-complaint-content-area",ref:Fi,children:[dl.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"edit-complaint-chat-column",style:{width:"30%",minWidth:"320px",maxWidth:"40%",flexShrink:0},children:r.jsx(jee,{messages:dl})}),r.jsx("div",{className:"draggable-divider",onMouseDown:()=>{}})]}),r.jsxs("div",{ref:Bt,className:"edit-complaint-main-column",style:{flex:1,minWidth:0},children:[W&&r.jsxs("div",{className:"general-error-message",children:["Error: ",W]}),(ce||D)&&r.jsxs("div",{ref:fe,className:`${D?"ai-function-call-block":"ai-response-container"} group`,children:[ce&&r.jsx(Yo,{remarkPlugins:[zs],children:ce}),D&&r.jsxs("div",{className:"ai-json-details-container",children:[r.jsxs("button",{onClick:()=>Z(!xe),className:"ai-json-toggle-button",children:[xe?r.jsx(MS,{size:14,className:"mr-1"}):r.jsx(RS,{size:14,className:"mr-1"}),xe?"Hide":"Show"," AI Function Call Details"]}),xe&&r.jsx("pre",{className:"ai-json-pre",children:r.jsx("code",{children:JSON.stringify(JSON.parse(D),null,2)})})]}),r.jsxs("div",{className:"ai-response-actions",children:[r.jsx("button",{onClick:()=>ef(he),disabled:!he,title:"Copy Full AI Response",children:r.jsx(RI,{size:12})}),r.jsx("button",{onClick:tp,disabled:!he,title:"Print AI Response",children:r.jsx(Go,{size:12})})]})]})]}),r.jsx("div",{className:"draggable-divider",onMouseDown:Ha}),r.jsx("div",{ref:Dn,className:"edit-complaint-context-column",style:{flexBasis:`calc(${100-Et}% - 5px)`},children:r.jsxs("div",{className:"ai-context-container",children:[r.jsxs("h3",{className:"ai-context-header",children:[r.jsx("span",{children:"AI Context:"}),(g==null?void 0:g.insurance_type)&&r.jsx("div",{className:"insurance-type-container mt-2",children:r.jsxs("select",{ref:lt,value:g.insurance_type,onChange:te=>Kh(g.id,te.target.value),className:"insurance-type-select",children:[r.jsx("option",{value:"cash",children:"Cash"}),r.jsx("option",{value:"insurance",children:"Insurance"}),r.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})})]}),r.jsxs("div",{ref:Ve,className:"ai-context-section",children:[r.jsx("h4",{className:"ai-context-section-title",children:"Admission Status"}),(g==null?void 0:g.admission_date)&&r.jsxs("p",{className:"ai-context-text",children:[r.jsx("strong",{children:"Admitted:"})," ",new Date(g.admission_date).toLocaleDateString()]}),(g==null?void 0:g.discharge_date)&&r.jsxs("p",{className:"ai-context-text",children:[r.jsx("strong",{children:"Discharged:"})," ",new Date(g.discharge_date).toLocaleDateString()]}),(g==null?void 0:g.current_status)&&r.jsxs("p",{className:"ai-context-text",children:[r.jsx("strong",{children:"Current Status:"})," ",r.jsx("span",{className:"font-semibold",children:g.current_status})]}),r.jsxs("div",{className:"flex space-x-2 mt-2",children:[r.jsx("button",{onClick:on,className:`admit-discharge-button ${no?"discharge":"admit"}`,title:no?"Discharge Patient":"Admit Patient",disabled:!u||rc||to,children:rc?"Admitting...":to?"Discharging...":no?"Discharge":"Admit"}),r.jsx("button",{onClick:()=>si("doctor"),className:`queue-status-button ${Tr?"in-queue":"add-to-queue"}`,title:Tr?"Patient is in Doctor Queue":"Add Patient to Doctor Queue",disabled:!u||ps||Tr,children:ps?"Adding...":Tr?"In Queue":"Add to Queue"}),r.jsx("button",{onClick:ln,className:"complete-consultation-button",title:"Mark Consultation as Complete",disabled:rl,children:rl?"Completing...":"Complete Consultation"})]})]}),r.jsx("div",{ref:be,children:r.jsx(P0,{title:"Pharmacy Order History",headerAction:r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:po,className:"button-primary blue text-xs px-2 py-1",disabled:fl||qt.filter(te=>te.status==="pending").length<2,title:"Merge all pending orders into one",children:fl?"Merging...":"Merge Orders"}),r.jsxs("button",{onClick:()=>il(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new pharmacy order",disabled:!u,children:[r.jsx(ou,{size:12,className:"mr-1"})," Create Order"]})]}),items:Gr,isLoading:!1,loadingText:"Loading...",noDataText:"No orders.",renderItemContent:(te,de)=>r.jsxs("div",{className:"flex flex-col w-full",children:[r.jsxs("span",{className:"ai-context-text flex items-center",children:[" ",Gr.length-de,". Order Status: (",te.data.status,")",r.jsx("span",{className:"text-gray-400 ml-1 flex items-center",children:Yd===te.data.id?r.jsx("div",{className:"flex items-center space-x-1 ml-1",children:r.jsx("input",{type:"datetime-local",defaultValue:G0(te.originalDateString),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:le=>{le.target.value&&bs(te.data.id,le.target.value),oc(null)},onKeyDown:le=>{if(le.key==="Enter"){const we=le.target;we.value&&bs(te.data.id,we.value),oc(null)}},autoFocus:!0})}):r.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/date ml-1",onClick:()=>oc(te.data.id),title:"Click to edit date",children:["(",new Date(te.originalDateString).toLocaleDateString(),")",r.jsx(ql,{size:14,className:"ml-1 text-gray-500 hover:text-gray-700"})]})}),r.jsxs("div",{className:"inline-flex space-x-2 ml-2",children:[" ",r.jsx("button",{onClick:()=>gl(te.data.id),className:"icon-button small",title:"Edit Pharmacy Order",children:r.jsx(ql,{size:12})}),te.data.prescriptionForUnavailableDrugs&&r.jsx("button",{onClick:()=>vl(te.data.prescriptionForUnavailableDrugs,"Unavailable Drugs Prescription"),className:"icon-button small",title:"Print Unavailable Drugs Prescription",children:r.jsx(Go,{size:12})}),r.jsx("button",{onClick:()=>ya({type:"Pharmacy Order",data:te.data}),className:"icon-button small text-red-500",title:"Delete Pharmacy Order",children:r.jsx(or,{size:12})}),te.data.status==="pending"&&r.jsx("button",{onClick:()=>yc(te.data.id),className:"icon-button small",title:"Bill this pharmacy order",disabled:eo,children:r.jsx(Eh,{size:12})}),te.data.status==="billed"&&r.jsx("button",{onClick:()=>wu(te.data.id,"dispensed"),className:"icon-button small",title:"Dispense this pharmacy order",disabled:eo,children:r.jsx(cs,{size:12})})]})]}),r.jsx("div",{className:"pharmacy-order-drugs-table-container mt-2 cursor-pointer hover:bg-gray-50 transition-colors rounded p-1",onClick:()=>gl(te.data.id),title:"Click to edit order",children:r.jsxs("table",{className:"pharmacy-order-drugs-table w-full text-xs",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:"py-1 px-2 text-left",children:"Drug Name"}),r.jsx("th",{className:"py-1 px-2 text-left",children:"Quantity"}),r.jsx("th",{className:"py-1 px-2 text-left",children:"Dosage"}),r.jsx("th",{className:"py-1 px-2 text-left",children:"Directions"})]})}),r.jsx("tbody",{children:te.data.medications.map((le,we)=>r.jsxs("tr",{children:[r.jsx("td",{className:"py-1 px-2",children:r.jsx("strong",{children:le.name})}),r.jsxs("td",{className:"py-1 px-2",children:[le.pack_quantity!==void 0&&le.pack_quantity>0&&`Packs: ${le.pack_quantity}`,le.pack_quantity!==void 0&&le.pack_quantity>0&&le.loose_quantity!==void 0&&le.loose_quantity>0&&", ",le.loose_quantity!==void 0&&le.loose_quantity>0&&`Loose: ${le.loose_quantity}`]}),r.jsx("td",{className:"py-1 px-2",children:le.tabletsPerDay&&le.numberOfDays?`${le.tabletsPerDay} tab/day for ${le.numberOfDays} days`:"N/A"}),r.jsx("td",{className:"py-1 px-2",children:le.directions_to_use||"N/A"})]},le.drug_id||le.name||we))})]})}),te.data.prescriptionForUnavailableDrugs&&r.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[r.jsx("span",{className:"font-semibold",children:"Prescription:"})," ",te.data.prescriptionForUnavailableDrugs]})]})})}),ic&&r.jsx(Cee,{isOpen:ic,onClose:()=>il(!1),patientId:u,pharmacyInventory:ha,fetchPharmacyOrdersData:uo}),r.jsxs("div",{ref:ye,children:[r.jsx(P0,{title:"Lab History (Orders & Reports)",headerAction:r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:Be,className:"button-primary blue text-xs px-2 py-1",title:"Tell AI to analyse the reports",disabled:Ye,children:"Analyse Reports"}),r.jsxs("button",{onClick:()=>nc(!0),className:"button-primary green text-xs px-2 py-1",title:"Manually create a new lab order",disabled:!u,children:[r.jsx(ou,{size:12,className:"mr-1"})," Create Lab Order"]})]}),items:Pr,onDeleteItem:ya,onEditLabOrder:Xd,onSaveLabOrder:ho,onCancelEditLabOrder:xc,onLabOrderTestChange:qa,onLabOrderStatusChange:Xh,onBillLabOrder:Zd,onUpdateLabOrderStatus:Xi,onEnterLabReport:yl,labInventory:bu,isSavingLabOrder:eo,isLoading:Ra||et,loadingText:"Loading...",noDataText:"No lab Hx.",expandedLabReports:tc,toggleLabReport:ft,renderItemContent:(te,de)=>{const le=JY(te.data.report?te.data.report.status:te.data.status);return r.jsxs("div",{className:"ai-context-text",children:[r.jsxs("div",{onClick:()=>yl(te.data),className:"cursor-pointer hover:bg-gray-100 rounded p-1 inline-block -ml-1",title:"Click to enter report",children:[te.data.serialNumber,". ",r.jsx("span",{className:"font-medium",children:"[Order]"})," ",te.data.tests&&te.data.tests.length>0?te.data.tests.map(we=>r.jsxs("strong",{children:[we.name," (",we.price,")"]},we.id||we.name)).reduce((we,We)=>[we,", ",We]):r.jsx("span",{className:"italic text-gray-500",children:"No tests specified"})," ",te.data.tests&&te.data.tests.length>0&&r.jsxs("span",{className:"font-bold ml-2",children:["Total: ",te.data.tests.reduce((we,We)=>we+(Number(We.price)||0),0).toFixed(2)]}),"(",r.jsx("span",{className:le.className,children:le.text}),")"]}),r.jsx("span",{className:"text-gray-400 ml-1 inline-flex items-center",children:$a===te.data.id?r.jsx("div",{className:"flex items-center space-x-1 ml-1",onClick:we=>we.stopPropagation(),children:r.jsx("input",{type:"datetime-local",defaultValue:G0(te.originalDateString),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:we=>{we.target.value&&ml(te.data.id,"order",we.target.value),cl(null)},onKeyDown:we=>{if(we.key==="Enter"){const We=we.target;We.value&&ml(te.data.id,"order",We.value),cl(null)}},autoFocus:!0})}):r.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/date ml-1",onClick:we=>{we.stopPropagation(),cl(te.data.id)},title:"Click to edit order date",children:["(",new Date(te.originalDateString).toLocaleDateString(),")",r.jsx(ql,{size:14,className:"ml-1 text-gray-500 hover:text-gray-700"})]})}),te.data.report&&r.jsxs("div",{className:"ml-4 mt-1 p-2 border-l-2 border-gray-200",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-medium",children:"[Report]"}),r.jsx("span",{className:"text-gray-400 ml-1 flex items-center",children:cc===te.data.id?r.jsx("div",{className:"flex items-center space-x-1 ml-1",onClick:we=>we.stopPropagation(),children:r.jsx("input",{type:"datetime-local",defaultValue:G0(te.data.report.report_date),className:"border rounded px-1 py-0.5 text-xs text-black",onBlur:we=>{we.target.value&&ml(te.data.id,"report",we.target.value),uc(null)},onKeyDown:we=>{if(we.key==="Enter"){const We=we.target;We.value&&ml(te.data.id,"report",We.value),uc(null)}},autoFocus:!0})}):r.jsxs("span",{className:"cursor-pointer hover:bg-gray-100 px-1 rounded flex items-center group/reportDate ml-1",onClick:we=>{we.stopPropagation(),uc(te.data.id)},title:"Click to edit report date",children:["(",new Date(te.data.report.report_date).toLocaleDateString(),")",r.jsx(ql,{size:14,className:"ml-1 text-gray-500 hover:text-gray-700"})]})}),r.jsx("button",{onClick:()=>ft(te.data.report.reportId),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-400",title:tc[te.data.report.reportId]?"Collapse Report":"Expand Report",children:tc[te.data.report.reportId]?r.jsx(MS,{size:14}):r.jsx(RS,{size:14})})]}),tc[te.data.report.reportId]&&(()=>{try{const we=JSON.parse(te.data.report.report_content||"{}");return typeof we=="object"&&we!==null&&te.data.report.tests?te.data.report.tests.map(We=>r.jsxs("div",{style:{marginBottom:"10px"},children:[r.jsx("h5",{className:"font-semibold text-sm mt-2 mb-1",children:We.name}),we[We.id]?r.jsxs("table",{className:"lab-inventory-table w-full text-xs",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:"py-1 px-2",children:"Parameter"}),r.jsx("th",{className:"py-1 px-2",children:"Value"}),r.jsx("th",{className:"py-1 px-2",children:"Normal Range"})]})}),r.jsx("tbody",{children:Object.entries(we[We.id]).map(([dt,vt])=>{var qn;const bt=(qn=We.default_parameters)==null?void 0:qn.find(zi=>zi.name===dt);return r.jsxs("tr",{children:[r.jsx("td",{className:"py-1 px-2",children:dt}),r.jsxs("td",{className:"py-1 px-2",children:[String(vt)," ",(bt==null?void 0:bt.unit)||""]}),r.jsx("td",{className:"py-1 px-2",children:(()=>{if(bt&&bt.type==="number"&&(bt.lower_limit!=null||bt.upper_limit!=null)){let zi="";return bt.lower_limit!=null&&(zi+=` > ${bt.lower_limit}`),bt.lower_limit!=null&&bt.upper_limit!=null&&(zi+=" - "),bt.upper_limit!=null&&(zi+=` < ${bt.upper_limit}`),zi.trim()||"N/A"}else if((bt==null?void 0:bt.type)==="boolean")return"N/A";return(bt==null?void 0:bt.normal_range)||"N/A"})()})]},dt)})})]}):r.jsx("p",{className:"italic text-gray-500 text-xs",children:"No parameters reported for this test."})]},We.id)):r.jsx(Yo,{remarkPlugins:[zs],children:te.data.report.report_content})}catch{return r.jsx(Yo,{remarkPlugins:[zs],children:te.data.report.report_content||"*No findings recorded.*"})}})()]})]})}}),r.jsx(NW,{isOpen:Yi,onClose:()=>nc(!1),patientId:u,labInventory:bu,fetchPendingLabOrdersData:xs}),r.jsx("div",{ref:Oe,children:r.jsx(P0,{title:"Complaints History",items:Va,isLoading:Pe,loadingText:"Loading...",noDataText:"No past Hx.",renderItemContent:(te,de)=>r.jsxs("span",{className:"ai-context-text",children:[te.data.complaint,r.jsxs("span",{className:"text-gray-400 ml-1",children:["(",new Date(te.originalDateString).toLocaleDateString(),")"]})]}),onDeleteItem:ya})}),r.jsxs("div",{className:"ai-context-section",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("h4",{className:"ai-context-section-title",children:[r.jsx(Sb,{size:16,className:"text-purple-600"})," Clinic-wide System Prompt"]}),!mc&&r.jsx("button",{onClick:lr,className:"edit-button",title:"Edit System Prompt",disabled:$i||xi||ga,children:r.jsx(ql,{size:14})})]}),mc&&yn?r.jsxs("div",{className:"mt-2",children:[r.jsx("textarea",{value:lo,onChange:te=>co(te.target.value),className:"context-edit-textarea",placeholder:"Enter clinic system prompt...",disabled:xi||ga}),r.jsxs("div",{className:"context-edit-actions",children:[r.jsx("button",{onClick:ju,disabled:xi||ga,className:"button-secondary",children:"Cancel"}),r.jsxs("button",{onClick:Yr,disabled:xi||ga||hl===yn.aiMemory&&lo===yn.clinicWideSystemPrompt,className:"button-primary purple",children:[r.jsx(Od,{size:14,className:"mr-1"}),ga||xi?"Saving...":"Save Settings"]})]})]}):r.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:yn!=null&&yn.clinicWideSystemPrompt?r.jsx(Yo,{remarkPlugins:[zs],children:yn.clinicWideSystemPrompt}):r.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),!mc&&(yn==null?void 0:yn.clinicWideSystemPromptUpdatedAt)&&r.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Prompt Last Updated: ",new Date(yn.clinicWideSystemPromptUpdatedAt).toLocaleDateString()]})]}),r.jsxs("div",{ref:He,className:"ai-context-section",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h4",{className:"ai-context-section-title",children:"Case Summary"}),!I&&r.jsx("button",{onClick:Zh,className:"edit-button",title:"Edit Case Summary",disabled:re||z,children:r.jsx(ql,{size:14})})]}),I?r.jsxs("div",{className:"mt-2",children:[r.jsx("textarea",{value:L,onChange:te=>$(te.target.value),className:"context-edit-textarea",rows:4,placeholder:"Enter case summary...",disabled:z}),Q&&r.jsx("p",{className:"text-red-500 text-xs mt-1",children:Q}),r.jsxs("div",{className:"context-edit-actions",children:[r.jsx("button",{onClick:ep,disabled:z,className:"button-secondary",children:"Cancel"}),r.jsx("button",{onClick:Zi,disabled:z||L===P,className:"button-primary blue",children:z?"Saving...":"Save"})]})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"ai-context-text whitespace-pre-wrap mt-1 prose prose-sm max-w-none",children:P?r.jsx(Yo,{remarkPlugins:[zs],components:{},children:P}):r.jsx("span",{className:"italic text-gray-400",children:"N/A - Click edit to add."})}),B&&r.jsxs("p",{className:"ai-context-text text-gray-400 mt-1",style:{fontSize:"0.625rem"},children:["Last Edited: ",new Date(B).toLocaleDateString()]})]})]}),Va.length===0&&Pr.length===0&&Gr.length===0&&!(Pe||Ra||et)&&r.jsx("p",{className:"ai-context-text italic mt-4",children:"No recent history for this patient."}),nl&&r.jsx("p",{className:"text-yellow-600 text-xs mt-2 ai-context-text",children:"Deleting..."}),Zl&&r.jsx("p",{className:"text-red-600 text-xs mt-2 ai-context-text",children:Zl})]})]})})]}),r.jsxs("div",{className:"edit-complaint-input-area",children:[r.jsx("div",{className:"mobile-section-selector",children:r.jsxs("div",{className:"selector-container",children:[r.jsx("button",{onClick:()=>ws("response"),className:`selector-button ${Ys==="response"?"active":""}`,children:"AI Response"}),r.jsx("button",{onClick:()=>ws("context"),className:`selector-button ${Ys==="context"?"active":""}`,children:"AI Context"})]})}),r.jsxs("div",{className:"status-messages-container",children:[ut&&r.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:ut}),ve&&r.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:ve}),kr&&r.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:kr}),Kl&&r.jsx("p",{className:"text-center text-red-500 text-xs mb-1",children:Kl})]}),t&&!G&&r.jsxs(w.Fragment,{children:[Su&&r.jsxs("div",{className:"follow-up-question-container",children:[r.jsx("p",{className:"question-text",children:Su}),xa.length>0&&r.jsx("div",{className:"options-grid",children:xa.map((te,de)=>r.jsx("button",{onClick:()=>Ya(te),className:"option-button",children:te},de))})]}),Mi&&r.jsx("div",{className:"speech-error-display",children:Mi}),oo&&r.jsxs("div",{className:"selected-file-display",children:[r.jsxs("span",{children:["Selected: ",oo.name]}),r.jsx("button",{onClick:()=>{dc(null),Un.current&&(Un.current.value="")},className:"remove-file-button",title:"Remove image",children:""})]}),r.jsx("div",{className:"input-wrapper",children:r.jsxs("div",{className:"main-input-container",children:[r.jsx("input",{type:"file",ref:Un,onChange:np,accept:"image/*",className:"hidden"}),r.jsx("textarea",{ref:qe,className:"complaint-textarea",value:l,onChange:te=>d(te.target.value),onKeyDown:kt,placeholder:"name,age,sex,phone,complaints,reports,history",disabled:ke||!t||hn}),r.jsxs("div",{className:"chat-input-actions-container",children:[u&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>a(`/patient/${u}/lab-reports`),disabled:et||!u,className:"icon-button",title:"View Lab Reports",children:r.jsx(su,{size:14})}),r.jsx("button",{onClick:()=>a("/inventory"),disabled:Zo,className:"icon-button",title:"View Inventory",children:r.jsx(Md,{size:14})})]}),r.jsx("button",{type:"button",onClick:wc,disabled:ke||!t||hn,className:"icon-button",title:"Attach Image",children:r.jsx(hR,{size:14})}),r.jsx("button",{type:"button",onClick:er,disabled:ke||!t||!ul.current,className:`mic-button ${hn?"listening":""}`,title:hn?"Stop":"Mic",children:r.jsx(ak,{size:14})}),r.jsx("button",{onClick:()=>vs(),disabled:ke||!l.trim()||!t||hn,className:"send-button",title:ke?"Processing...":"Save & Ask AI",children:ke?r.jsx("div",{className:"custom-loader-circle",role:"status","aria-label":"loading"}):r.jsx(X0,{size:14})}),Bn&&r.jsx("button",{type:"button",onClick:Jh,disabled:ke,className:"icon-button text-red-500",title:"Undo Last AI Actions",children:r.jsx(or,{size:14})})]})]})})]})]})]})},_ee=()=>{const{patientId:e}=Br(),n=_t(),[t,i]=w.useState([]),[a,o]=w.useState(null),[l,d]=w.useState(!1),[f,u]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){u("Patient ID not provided.");return}d(!0),u(null);try{const b=await me(`/api/patients/${e}`);if(!b.ok)throw new Error(`Failed to fetch patient details: ${b.status}`);const v=await b.json();o({name:v.name,age:v.age,gender:v.gender});const S=await me(`/api/patients/${e}/complaints`);if(S.ok){const T=(await S.json()).sort((P,M)=>new Date(M.createdAt).getTime()-new Date(P.createdAt).getTime());i(T)}else if(S.status===404)i([]);else throw new Error(`Failed to fetch complaints: ${S.status}`)}catch(b){console.error("Error fetching past complaints or patient info:",b),u(`Failed to load data. ${b.message}`),i([]),o(null)}finally{d(!1)}})()},[e]);const p=g=>{navigator.clipboard.writeText(g).then(()=>console.log("Complaint copied to clipboard")).catch(b=>console.error("Failed to copy complaint: ",b))};return r.jsxs("div",{className:"container mx-auto p-4",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("button",{onClick:()=>n(-1),className:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-1 px-3 rounded text-sm",children:"< Back"}),r.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-center flex-grow",children:"Past Complaints"}),r.jsx("div",{className:"w-16"})," "]}),a&&r.jsxs("div",{className:"mb-4 p-2 bg-gray-100 rounded text-center text-sm sm:text-base",children:["Patient: ",r.jsx("strong",{children:a.name})," (",a.age??"N/A"," / ",a.gender??"N/A",")"]}),f&&r.jsxs("div",{className:"text-red-500 p-3 mb-4 border border-red-500 rounded bg-red-50 text-sm",children:["Error: ",f]}),l&&r.jsx("p",{className:"text-center text-gray-500",children:"Loading..."}),!l&&t.length===0&&!f&&r.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No past complaints found for this patient."}),!l&&t.length>0&&r.jsx("div",{className:"space-y-4",children:t.map(g=>r.jsxs("div",{className:"p-3 border rounded shadow-sm bg-white group relative",children:[r.jsx("p",{className:"text-xs text-gray-500 mb-1",children:new Date(g.createdAt).toLocaleString()}),r.jsx("p",{className:"text-sm whitespace-pre-wrap",children:g.complaint}),r.jsx("button",{onClick:()=>p(g.complaint),className:"absolute top-1 right-1 bg-gray-200 hover:bg-gray-300 text-gray-600 text-xs p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Copy complaint text",children:""})]},g.id))})]})},Ax=500,T_="defaultConsultationFee",kee=({patientId:e,billId:n,queueId:t,onBillCreated:i,onBillUpdated:a,initialItems:o=[],billType:l="other",relatedId:d,initialStatus:f="pending",initialDiscountPercentage:u=0,readOnlyMode:p=!1,doctorId:g,labOrderId:b,patientInsuranceType:v})=>{const[S,k]=w.useState(null),[T,P]=w.useState([]),M=w.useRef([]),[I,U]=w.useState(""),[L,$]=w.useState(""),[z,F]=w.useState(1),[Q,R]=w.useState(u),[B,Y]=w.useState("cash"),[re,ne]=w.useState(!1),[G,V]=w.useState(null),[W,J]=w.useState(!1),[he,A]=w.useState(!1),[ce,se]=w.useState(!1),[D,oe]=w.useState(null),[,xe]=w.useState([]),[Z,ue]=w.useState(null),[ae,Re]=w.useState(""),[Ae,Ce]=w.useState("cash"),[Se,De]=w.useState(!1),[Me,et]=w.useState(Ax),[ct,ut]=w.useState(Ax.toString()),at=n?"view_pay":"create";w.useEffect(()=>{const ye=localStorage.getItem(T_),Oe=ye?parseFloat(ye):Ax;isNaN(Oe)||(et(Oe),ut(Oe.toString()))},[]);const qt=o.length===0;w.useEffect(()=>{e?(async()=>{ne(!0),V(null);try{const Oe=await me(`/api/patients/${e}`);if(!Oe.ok){const tt=await Oe.json().catch(()=>({}));throw new Error(tt.message||"Failed to fetch patient details")}const He=await Oe.json();k(He)}catch(Oe){V(`Failed to load patient details: ${Oe.message}`),k(null)}finally{ne(!1)}})():k(null)},[e]),w.useEffect(()=>{n?(async()=>{se(!0),V(null),oe(null),xe([]),ue(null);try{const Oe=await me(`/api/bills/${n}`);if(!Oe.ok){const tt=await Oe.json().catch(()=>({}));throw new Error(tt.message||"Failed to fetch bill details")}const He=await Oe.json();if(!He.bill||!He.payments||!He.calculated)throw new Error("Invalid bill details structure.");oe(He.bill),xe(He.payments),ue(He.calculated),R(He.bill.discount_percentage!==void 0&&He.bill.discount_percentage!==null?parseFloat(He.bill.discount_percentage.toString()):0),!S&&He.bill.patient_id&&jt(He.bill.patient_id.toString())}catch(Oe){V(`Failed to load bill details: ${Oe.message}`),oe(null),xe([]),ue(null)}finally{se(!1)}})():(oe(null),xe([]),ue(null))},[n]);const jt=async ye=>{ne(!0);try{const Oe=await me(`/api/patients/${ye}`);if(!Oe.ok)throw new Error("Failed to fetch patient");const He=await Oe.json();k(He)}catch(Oe){console.error("Error fetching patient details:",Oe),k(null)}finally{ne(!1)}},_e=w.useCallback(async ye=>{A(!0),V(null);const Oe=ye.filter(He=>He.drug_id!=null).map(async He=>{try{const tt=await me(`/api/drugs/${He.drug_id}`);if(!tt.ok)throw new Error(`Drug ${He.drug_id} not found.`);const rt=await tt.json();return{...He,price:rt.price,total:rt.price*He.quantity}}catch{return V(rt=>`${rt?rt+"; ":""}Failed to fetch price for ${He.name}`),He}});try{const He=await Promise.all(Oe);P(tt=>{const rt=new Map(He.map(Ft=>[Ft.id,Ft]));return tt.map(Ft=>rt.get(Ft.id)||Ft)})}catch{}finally{A(!1)}},[me]);w.useEffect(()=>{if(n){P([]),M.current=[];return}JSON.stringify(o)===JSON.stringify(M.current)||(async()=>{let He=[];if(o&&o.length>0)He=o.map((tt,rt)=>({...tt,id:`initial-${rt}-${Date.now()}`})),Y(f==="paid"?"cash":v==="no_cash_insurance"?"no_cash_insurance":"cash"),R(u),l==="pharmacy"&&!p&&await _e(He);else if(e&&qt&&l==="consultation"){let tt=Me;if(g)try{const rt=await me(`/api/staff/${g}`);if(!rt.ok){const Kn=await rt.json().catch(()=>({}));throw new Error(Kn.message||"Doctor not found or error fetching fee")}const Ft=await rt.json();Ft.opd_fee!=null&&!isNaN(parseFloat(String(Ft.opd_fee)))&&parseFloat(String(Ft.opd_fee))>=0&&(tt=parseFloat(String(Ft.opd_fee)))}catch(rt){V(Ft=>`${Ft?Ft+"; ":""}Could not fetch doctor's fee, using default. (${rt.message})`)}He=[{id:Date.now(),name:"Consultation Fee",price:tt,quantity:1,total:tt*1,drug_id:null}],Y(v==="no_cash_insurance"?"no_cash_insurance":"cash")}else He=[],Y(v==="no_cash_insurance"?"no_cash_insurance":"cash");P(He),M.current=o})()},[n,e,g,o,l,Me,qt,f,p,_e,u,v]);const Fe=()=>{const ye=parseFloat(L);if(!p)if(I&&!isNaN(ye)&&ye>=0&&z>0){if(I.trim().toLowerCase()==="consultation fee"&&T.some(He=>He.name.toLowerCase()==="consultation fee")){alert("Consultation Fee already added.");return}const Oe={id:Date.now(),name:I.trim(),price:ye,quantity:z,total:ye*z,drug_id:null};P([...T,Oe]),U(""),$(""),F(1)}else alert("Invalid item details.")},Pe=ye=>{p||P(T.filter(Oe=>Oe.id!==ye))},Ue=w.useMemo(()=>{let ye=T.reduce((Oe,He)=>Oe+He.total,0);return at==="create"&&Q>0&&(ye=ye*(1-Q/100)),(Z==null?void 0:Z.totalDue)!==void 0&&(Z==null?void 0:Z.totalDue)!==null?Z.totalDue:ye},[T,Z,Q,at]),ve=w.useMemo(()=>(Z==null?void 0:Z.totalPaid)??0,[Z]),ee=w.useMemo(()=>(Z==null?void 0:Z.balance)!==void 0&&(Z==null?void 0:Z.balance)!==null?Z.balance:Ue-ve,[Z,Ue,ve]),fe=()=>{const ye=parseFloat(ct);!isNaN(ye)&&ye>=0?(et(ye),localStorage.setItem(T_,ye.toString()),alert(`Default Fee set to ${ye.toFixed(2)}`)):alert("Invalid fee amount.")},qe=async(ye,Oe)=>{J(!0),V(null);try{const He=await me("/api/payment/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Oe,billId:ye})}),tt=await He.json();if(!He.ok||!tt.order)throw new Error(tt.message||"Failed to create Razorpay order.");const{key_id:rt,order:Ft}=tt,Kn={key:rt,amount:Ft.amount,currency:Ft.currency,name:"Newtons OPD Zero Clinic",description:`Bill Payment for Patient ID: ${e}`,order_id:Ft.id,handler:async function(Pn){try{const Et=await me("/api/payment/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({razorpay_payment_id:Pn.razorpay_payment_id,razorpay_order_id:Pn.razorpay_order_id,razorpay_signature:Pn.razorpay_signature,billId:ye})}),Vt=await Et.json();if(Et.ok&&Vt.success)alert("Payment Successful!"),i&&i(ye),a&&a(),setTimeout(()=>window.print(),200);else throw new Error(Vt.message||"Payment verification failed.")}catch(Et){V(`Payment verification failed: ${Et.message}. Contact support.`)}finally{J(!1)}},prefill:{name:(S==null?void 0:S.name)||""},notes:{bill_id:ye,patient_id:e},theme:{color:"#3399cc"},modal:{ondismiss:function(){V("Payment cancelled."),J(!1)}}};if(window.Razorpay)new window.Razorpay(Kn).open();else throw new Error("Razorpay SDK not loaded.")}catch(He){V(`Failed to initiate online payment: ${He.message}`),J(!1)}},nt=async()=>{if(!n){V("Bill ID is missing.");return}if(!ae||isNaN(parseFloat(ae))||parseFloat(ae)<=0){V("Please enter a valid positive payment amount.");return}De(!0),V(null);const ye={amount_paid:parseFloat(ae),payment_mode:Ae};try{const Oe=await me(`/api/bills/${n}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ye)}),He=await Oe.json();if(!Oe.ok)throw new Error(He.message||`Failed to record payment (Status: ${Oe.status})`);alert(`Payment of ${ye.amount_paid.toFixed(2)} recorded.`),Re(""),a?a():console.log("Payment recorded.")}catch(Oe){V(`Failed to record payment: ${Oe.message}`)}finally{De(!1)}},lt=async()=>{if(at==="view_pay")return;if(!e){V("Patient ID is missing for creating a bill.");return}if(T.length===0){V("Cannot finalize an empty bill.");return}J(!0),V(null);const ye=Ue,Oe=T.map(({id:He,...tt})=>tt);if(B==="online"){const He={patientId:e,queueId:t||null,items:Oe,amount:ye,paymentMode:"online",type:l,related_id:d||b||null,status:"pending",discountPercentage:Q,labOrderId:b||null};try{const tt=await me("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(He)}),rt=await tt.json();if(!tt.ok)throw new Error(rt.message||"Failed to create pending bill.");qe(rt.id,Math.round(ye*100))}catch(tt){V(`Failed to create pending bill: ${tt.message}`),J(!1)}}else{const He="paid";if(!B){V("Payment mode required."),J(!1);return}const tt={patientId:e,queueId:t||null,items:Oe,amount:ye,paymentMode:B,type:l,related_id:d||b||null,status:He,discountPercentage:Q,labOrderId:b||null};setTimeout(()=>window.print(),200);try{const rt=await me("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(tt)}),Ft=await rt.json();if(!rt.ok)throw new Error(Ft.message||"Failed to create bill.");alert("Bill marked as paid!"),i&&i(Ft.id),J(!1)}catch(rt){V(`Failed to process bill: ${rt.message}`),J(!1)}}},wt=(D==null?void 0:D.type)??l,Ve=(D==null?void 0:D.status)??f,be=at==="view_pay"&&D&&Ve==="pending";return!e&&!n?r.jsx("div",{className:"p-6 bg-white rounded-lg shadow text-gray-500",children:"Select patient or provide Bill ID."}):re||at==="view_pay"&&ce?r.jsx("div",{className:"p-6 bg-white rounded-lg shadow",children:"Loading..."}):at==="view_pay"&&!D&&!ce&&G?r.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading bill: ",G]}):at==="create"&&!S&&!re&&G?r.jsxs("div",{className:"p-6 bg-white rounded-lg shadow text-red-600",children:["Error loading patient: ",G]}):r.jsxs("div",{className:"billing-component-container printable-section",children:[r.jsxs("div",{className:"billing-header",children:[r.jsx("h2",{children:at==="create"?"Create Bill":"Bill Details"}),at==="create"&&l==="consultation"&&!p&&r.jsxs("div",{className:"default-fee-section",children:[r.jsx("label",{htmlFor:"defaultFee",className:"whitespace-nowrap",children:"Default Fee:"}),r.jsx("input",{id:"defaultFee",type:"number",value:ct,onChange:ye=>ut(ye.target.value),className:"",placeholder:Ax.toString(),disabled:p}),r.jsx("button",{onClick:fe,title:"Set Default Fee",className:"",disabled:p,children:r.jsx(Od,{size:16})})]})]}),G&&!ce&&!Se&&r.jsxs("div",{className:"error-message",role:"alert",children:[r.jsx("strong",{children:"Error: "}),G]}),S&&r.jsxs("div",{className:"patient-details-section",children:[r.jsx("h3",{children:"Patient Details"}),r.jsxs("p",{children:[r.jsx("strong",{children:"ID:"})," ",S.id]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Name:"})," ",S.name]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Age:"})," ",S.age||"N/A",", ",r.jsx("strong",{children:"Gender:"})," ",S.gender||"N/A"]})]}),r.jsxs("div",{className:"bill-items-summary-section",children:[r.jsxs("div",{className:"bill-items-header",children:[r.jsx("h3",{children:at==="create"?"Bill Items":"Billing Summary"}),at==="create"&&l==="pharmacy"&&!p&&T.some(ye=>ye.drug_id!=null)&&r.jsxs("button",{onClick:()=>_e(T),disabled:he,className:"refresh-prices-button",title:"Refresh item prices from inventory",children:[r.jsx(Kx,{size:14,className:`lucide ${he?"animate-spin":""}`}),he?"Refreshing...":"Refresh"]})]}),at==="view_pay"&&D&&r.jsxs("div",{className:"bill-info-bar",children:[r.jsxs("span",{children:["Bill ID: ",r.jsx("strong",{children:D.id})]}),r.jsxs("span",{children:["Type: ",r.jsx("strong",{className:"capitalize",children:wt})]}),r.jsxs("span",{children:["Status: ",r.jsx("strong",{className:`capitalize ${Ve==="paid"?"status-paid":"status-pending"}`,children:Ve})]})]}),(at==="create"||at==="view_pay"&&D)&&r.jsxs("div",{className:"bill-items-list",children:[at==="create"&&he&&T.length>0&&r.jsx("div",{className:"loading-placeholder",children:"Updating prices..."}),at==="create"&&!he&&T.map((ye,Oe)=>r.jsxs("div",{className:"bill-item",children:[r.jsxs("div",{className:"bill-item-details",children:[r.jsxs("span",{children:[Oe+1,". ",ye.name]}),ye.quantity>1&&r.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",ye.quantity,")"]})]}),r.jsxs("div",{className:"bill-item-price-actions",children:[r.jsxs("span",{className:"bill-item-price",children:["",ye.total.toFixed(2)]}),at==="create"&&typeof ye.id=="number"&&!p&&r.jsxs("button",{onClick:()=>Pe(ye.id),className:"remove-item-button",title:"Remove",children:[" ",r.jsx(Qn,{size:16})," "]}),(typeof ye.id!="number"||p||ye.name==="Consultation Fee")&&r.jsxs("span",{className:"lock-icon",title:"Cannot remove",children:[" ",r.jsx(LS,{size:14})," "]})]})]},ye.id)),at==="view_pay"&&D&&D.items.map((ye,Oe)=>r.jsxs("div",{className:"bill-item",children:[r.jsxs("div",{className:"bill-item-details",children:[r.jsxs("span",{children:[Oe+1,". ",ye.name]}),ye.quantity>1&&r.jsxs("span",{className:"bill-item-quantity",children:["(Qty: ",ye.quantity,")"]})]}),r.jsxs("div",{className:"bill-item-price-actions",children:[r.jsxs("span",{className:"bill-item-price",children:["",(ye.total??ye.price*ye.quantity).toFixed(2)]}),r.jsxs("span",{className:"lock-icon",title:"Cannot remove from existing bill",children:[" ",r.jsx(LS,{size:14})," "]})]})]},Oe)),at==="create"&&T.length===0&&r.jsx("p",{className:"empty-items-message",children:"No items added."}),at==="view_pay"&&D&&D.items.length===0&&r.jsx("p",{className:"empty-items-message",children:"No items in bill."})]}),at==="create"&&!p&&r.jsxs("div",{className:"add-item-form",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Item"}),r.jsx("input",{type:"text",value:I,onChange:ye=>U(ye.target.value),placeholder:"Service/Item",className:"custom-text-input"})]}),r.jsxs("div",{className:"form-group",style:{flexGrow:.5,minWidth:"80px"},children:[r.jsx("label",{children:"Qty"}),r.jsx("input",{type:"number",min:"1",value:z,onChange:ye=>F(parseInt(ye.target.value)||1),placeholder:"1",className:"custom-text-input"})]}),r.jsxs("div",{className:"form-group",style:{flexGrow:.7,minWidth:"100px"},children:[r.jsx("label",{children:"Price ()"}),r.jsx("input",{type:"number",value:L,onChange:ye=>$(ye.target.value),placeholder:"0.00",className:"custom-text-input"})]}),r.jsx("button",{onClick:Fe,className:"add-item-button",children:"Add"})]})]})," ",r.jsxs("div",{className:"billing-footer",children:[r.jsxs("div",{className:"total-amount-section",children:[r.jsx("span",{className:"total-amount-label",children:"Total Amount:"}),r.jsxs("span",{className:"total-amount-value",children:["",typeof Ue=="number"?Ue.toFixed(2):"0.00"]}),at==="create"&&!p&&r.jsxs("div",{className:"discount-section",children:[r.jsx("label",{htmlFor:"discountPercentage",className:"whitespace-nowrap",children:"Discount (%):"}),r.jsx("input",{id:"discountPercentage",type:"number",min:"0",max:"100",step:"0.01",value:Q,onChange:ye=>R(parseFloat(ye.target.value)||0),className:"",disabled:p||W})]}),at==="view_pay"&&D&&(D.status==="pending"||D.status==="paid")&&r.jsxs("div",{className:"discount-section",children:[r.jsx("label",{className:"whitespace-nowrap",children:"Discount (%):"}),r.jsxs("span",{className:"discount-value",children:[Q.toFixed(2),"%"]})]})]}),at==="view_pay"&&Z&&r.jsxs("div",{className:"total-amount-section",children:[r.jsx("span",{className:"total-amount-label",children:"Amount Paid:"}),r.jsxs("span",{className:"total-amount-value",children:["",ve.toFixed(2)]})]}),at==="view_pay"&&Z&&r.jsxs("div",{className:"total-amount-section",children:[r.jsx("span",{className:"total-amount-label",children:"Balance Due:"}),r.jsxs("span",{className:"total-amount-value",children:["",ee.toFixed(2)]})]}),r.jsxs("div",{className:"footer-actions",children:[at==="create"&&!p&&r.jsxs("div",{className:"action-group",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Payment Mode"}),r.jsxs("select",{value:B,onChange:ye=>Y(ye.target.value),className:"custom-select-input",disabled:p||W,children:[r.jsx("option",{value:"cash",children:"Cash"}),r.jsx("option",{value:"upi",children:"UPI"}),r.jsx("option",{value:"card",children:"Card"}),r.jsx("option",{value:"online",children:"Pay Online (Razorpay)"}),r.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),r.jsx("option",{value:"credit",children:"Credit"})]})]}),r.jsx("button",{onClick:lt,disabled:W||T.length===0||p,className:"finalize-button",children:W?"Processing...":"Finalize Bill"})]}),at==="view_pay"&&be&&!p&&r.jsxs("div",{className:"action-group",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Record Payment Amount ()"}),r.jsx("input",{type:"number",value:ae,onChange:ye=>Re(ye.target.value),placeholder:`Max: ${ee.toFixed(2)}`,className:"custom-text-input",disabled:Se})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Payment Mode"}),r.jsxs("select",{value:Ae,onChange:ye=>Ce(ye.target.value),className:"custom-select-input",disabled:Se,children:[r.jsx("option",{value:"cash",children:"Cash"}),r.jsx("option",{value:"upi",children:"UPI"}),r.jsx("option",{value:"card",children:"Card"}),r.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),r.jsx("button",{onClick:nt,disabled:Se||!ae||parseFloat(ae)<=0||parseFloat(ae)>ee,className:"record-payment-button",children:Se?"Recording...":"Record Payment"})]}),at==="create"&&p&&T.length>0&&r.jsx("div",{className:"status-message read-only",children:"Read-only."}),at==="view_pay"&&Ve==="paid"&&r.jsx("div",{className:"status-message paid",children:"PAID."}),at==="view_pay"&&Ve==="cancelled"&&r.jsx("div",{className:"status-message cancelled",children:"CANCELLED."})]})]})]})},Tee=()=>{const e=_t(),n=Gi(),{patientId:t,queueId:i,patientName:a,initialItems:o,billType:l,relatedId:d,initialStatus:f,initialDiscountPercentage:u,doctorId:p,billId:g,labOrderId:b}=n.state||{},[v,S]=w.useState(null),[k,T]=w.useState(null),[P,M]=w.useState(null),[I,U]=w.useState(null),[L,$]=w.useState(null),[z,F]=w.useState(null),[Q,R]=w.useState(null),[B,Y]=w.useState(null),[re,ne]=w.useState(!0),[G,V]=w.useState(null),[W,J]=w.useState(a||"");w.useEffect(()=>{if(!t){console.error("BillingPage loaded without required patientId in location state."),e("/");return}(async()=>{ne(!0),V(null);try{let oe=t,xe=o||null,Z=f||null,ue=l||null,ae=d||null,Re=u!==void 0?parseFloat(u):null,Ae=a||null,Ce=null;if(g){console.log(`Fetching details for Bill ID: ${g}`);const Se=await me(`/api/bills/${g}`);if(!Se.ok){const Me=await Se.json().catch(()=>({message:`Failed to fetch bill details for ID ${g}`}));throw new Error(Me.message||`Failed to fetch bill details (Status: ${Se.status})`)}const De=await Se.json();if(console.log("Fetched Bill Data:",De),xe=De.bill.items||[],Z=De.bill.status||"pending",ue=De.bill.type||null,ae=De.bill.related_id||null,Re=De.bill.discount_percentage!==void 0&&De.bill.discount_percentage!==null?parseFloat(De.bill.discount_percentage):0,oe=De.bill.patient_id,U(xe),$(Z),F(ue),R(ae),Y(Re),oe){const Me=await me(`/api/patients/${oe}`);if(Me.ok){const et=await Me.json();Ae=et.name,Ce=et.phone??null,M(et.insurance_type??null),J(Ae),T(Ce)}else console.warn(`Could not fetch patient details for ID ${oe} from bill.`),J("Patient (Not Found)")}else console.warn(`Bill ${g} does not have an associated patient_id.`),J("Patient (Unknown)")}else if(b){console.log(`Fetching details for Lab Order ID: ${b}`);const Se=await me(`/api/lab/${b}`);if(!Se.ok){let Me=`Failed to fetch lab order details (Status: ${Se.status} ${Se.statusText})`;try{Me=(await Se.json()).message||Me}catch{console.error("Response was not valid JSON:",await Se.text())}throw new Error(Me)}const De=await Se.json();if(console.log("Fetched Lab Order Data:",JSON.stringify(De,null,2)),xe=(De.tests||[]).filter(Me=>Me&&typeof Me.name=="string"&&Me.price!==void 0&&Me.id!==void 0).map(Me=>{const et=parseFloat(Me.price||"0"),ct=!isNaN(et)&&isFinite(et)?et:0;return{item_id:Me.id,name:Me.name,price:ct,quantity:1,total:ct*1,type:"lab_test"}}),xe&&xe.length===0&&(De.tests||[]).length>0&&(console.warn("Warning: Some tests from the lab order were filtered out due to missing id, name, or price.",De.tests),V(Me=>`${Me?Me+"; ":""}Warning: Some lab items could not be added to the bill due to missing details.`)),Z="pending",ue="lab",ae=b,oe=De.patient_id,U(xe),$(Z),F(ue),R(ae),oe){const Me=await me(`/api/patients/${oe}`);if(Me.ok){const et=await Me.json();Ae=et.name,Ce=et.phone??null,M(et.insurance_type??null),J(Ae),T(Ce)}else console.warn(`Could not fetch patient details for ID ${oe} from lab order.`),J("Patient (Not Found)")}else console.warn(`Lab Order ${b} does not have an associated patient_id.`),J("Patient (Unknown)")}else if(U(o||null),$(f||null),F(l||null),R(d||null),Y(u!==void 0?parseFloat(u):null),J(a||`ID ${t}`),oe){const Se=await me(`/api/patients/${oe}`);if(Se.ok){const De=await Se.json();T(De.phone??null),M(De.insurance_type??null)}else console.warn(`Could not fetch patient details for ID ${oe}.`)}if(i){const Se=await me(`/api/queue/${i}`);if(Se.ok){const De=await Se.json();S(De.token_number)}else console.warn(`Could not fetch queue details for ID ${i}.`)}}catch(oe){console.error("Error fetching billing page details:",oe),V(`Failed to load details: ${oe.message}`),U(null),$(null),F(null),R(null),J(a||""),T(null),S(null)}finally{ne(!1)}})()},[t,g,b,i,e]);const he=D=>{console.log(`Billing process completed for patient ID ${t}. New Bill ID: ${D}`),e(-1)},A=()=>{console.log(`Bill updated for patient ID ${t}.`),e(-1)};if(!t)return r.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-gray-600",children:[r.jsx(FS,{size:48,className:"mb-4 text-red-500"}),r.jsx("p",{className:"text-lg font-medium mb-2",children:"Missing Patient Information"}),r.jsx("p",{className:"text-sm",children:"Cannot load the billing page without a patient ID."}),r.jsx("button",{onClick:()=>e("/"),className:"mt-4 px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Go to Dashboard"})]});if(re)return r.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:r.jsx("p",{className:"text-teal-600 animate-pulse",children:"Loading Billing Details..."})});if(G)return r.jsxs("div",{className:"min-h-screen bg-neutral-light flex flex-col items-center justify-center text-red-600 p-4",children:[r.jsx(FS,{size:48,className:"mb-4"}),r.jsx("p",{className:"text-lg font-medium mb-2",children:"Error Loading Billing Details"}),r.jsx("p",{className:"text-sm text-center mb-4",children:G}),r.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"}),r.jsx("button",{onClick:()=>e(-1),className:"mt-2 text-sm text-gray-600 hover:text-teal-700",children:"Go Back"})]});const se=(L??f)==="paid";return r.jsxs("div",{className:"billing-page-container",children:[r.jsx("div",{className:"back-button-container",children:r.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[r.jsx(rn,{size:20,className:"lucide"})," Back"]})}),r.jsxs("div",{className:"billing-content-wrapper",children:[r.jsxs("h3",{className:"billing-page-title",children:[g?"Bill Details":b?"Create Lab Bill":"Create Bill"," for Patient: ",W||`ID ${t}`]}),r.jsxs("div",{className:"patient-info-bar",children:[v!==null&&r.jsxs("span",{children:[r.jsx(Gm,{size:14,className:"lucide"})," Token: ",v]}),k&&r.jsxs("span",{children:[r.jsx(bR,{size:14,className:"lucide"})," Phone: ",k]}),b&&r.jsxs("span",{className:"lab-order-info",children:[r.jsx(Yl,{size:14,className:"lucide"})," Lab Order: ",b.substring(0,8),"..."]}),!k&&v===null&&!b&&r.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"}),P&&r.jsxs("span",{className:"insurance-info",children:[r.jsx(RR,{size:14,className:"lucide"})," Insurance: ",P.replace(/_/g," ").replace(/\b\w/g,D=>D.toUpperCase())]}),!k&&v===null&&!b&&!P&&r.jsx("span",{className:"placeholder-text",children:"(Token/Phone not available)"})]}),r.jsx(kee,{patientId:t,labOrderId:b,queueId:i,onBillCreated:he,onBillUpdated:A,initialItems:I??o,billType:z??l,relatedId:Q??d,initialStatus:L??f,initialDiscountPercentage:B??u,readOnlyMode:se,doctorId:p,patientInsuranceType:P??void 0})]})]})},Eee=()=>{const{patientId:e}=Br(),n=_t(),[t,i]=w.useState([]),[a,o]=w.useState(!1),[l,d]=w.useState(null),[f,u]=w.useState("");return w.useEffect(()=>{(async()=>{if(!e){d("Patient ID not provided in URL.");return}o(!0),d(null),i([]);try{try{const v=await me(`/api/patients/${e}`);if(v.ok){const S=await v.json();u(S.name)}}catch(v){console.warn("Could not fetch patient name:",v)}console.log(`Fetching pharmacy orders for patient ID: ${e}`);const g=await me(`/api/pharmacy-orders/patient/${e}`);if(!g.ok){const v=await g.json().catch(()=>({}));throw new Error(v.message||`HTTP error! status: ${g.status}`)}const b=await g.json();console.log("Fetched Pharmacy Orders:",b),i(b||[])}catch(g){console.error("Error fetching pharmacy orders:",g),d(`Failed to load pharmacy orders: ${g.message}`)}finally{o(!1)}})()},[e]),r.jsxs("div",{className:"p-4 md:p-6 max-w-4xl mx-auto",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6 border-b pb-3",children:[r.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-sm text-gray-600 hover:text-gray-900",children:[r.jsx(rn,{size:16,className:"mr-1"}),"Back"]}),r.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center",children:[r.jsx(Md,{size:20,className:"mr-2 text-purple-600"}),"Pharmacy Order History ",f&&`for ${f}`]}),r.jsx("div",{})," "]}),a&&r.jsx("p",{className:"text-center text-gray-500",children:"Loading pharmacy orders..."}),l&&r.jsx("p",{className:"text-center text-red-500 bg-red-100 p-3 rounded border border-red-300",children:l}),!a&&t.length===0&&!l&&r.jsx("p",{className:"text-center text-gray-500",children:"No pharmacy orders found for this patient."}),!a&&t.length>0&&r.jsx("div",{className:"space-y-4",children:t.map(p=>r.jsxs("div",{className:"p-4 border rounded bg-white shadow-sm",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsxs("p",{className:"text-sm text-gray-600",children:[r.jsx("strong",{children:"Date:"})," ",new Date(p.date).toLocaleDateString()]}),r.jsxs("p",{className:"text-sm font-medium capitalize",children:[r.jsx("strong",{children:"Status:"})," ",p.status]})]}),r.jsxs("p",{className:"text-sm text-gray-600",children:[r.jsx("strong",{children:"Prescribed By:"})," ",p.prescribedBy||"N/A"]}),p.dispensedBy&&r.jsxs("p",{className:"text-sm text-gray-600",children:[r.jsx("strong",{children:"Dispensed By:"})," ",p.dispensedBy]}),r.jsx("h4",{className:"text-md font-semibold mt-3 mb-1",children:"Medications:"}),r.jsx("ul",{className:"list-disc list-inside ml-4 text-sm text-gray-700 space-y-1",children:p.medications.map((g,b)=>r.jsxs("li",{children:[g.name," - Qty: ",g.quantity,g.tabletsPerDay&&` (${g.tabletsPerDay} per day`,g.numberOfDays&&` for ${g.numberOfDays} days)`,!g.tabletsPerDay&&g.numberOfDays&&` (for ${g.numberOfDays} days)`,g.tabletsPerDay&&!g.numberOfDays&&")"]},b))})]},p.id))})]})},Aee=()=>{const e=_t(),n=Gi(),[t,i]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState([]),[f,u]=w.useState(""),[p,g]=w.useState([]),[b,v]=w.useState(null),[S,k]=w.useState(!1),[T,P]=w.useState(null),[M,I]=w.useState(!0),[U,L]=w.useState(""),[$,z]=w.useState([]),[F,Q]=w.useState(!1),[R,B]=w.useState(null),[Y,re]=w.useState(!1),[ne,G]=w.useState(!1),[V,W]=w.useState([]),[J,he]=w.useState(!1),[A,ce]=w.useState(null),se=/^\+?[0-9\s\-().]{7,20}$/,D=/^[a-zA-Z\s'-]{2,}$/,oe=w.useCallback(async()=>{try{const _e=await me("/api/drugs");if(!_e.ok)throw new Error("Failed to fetch drugs");const Fe=await _e.json();o(Fe)}catch(_e){console.error("Failed to fetch available drugs:",_e),v("Could not load drug list. "+_e.message)}},[]),xe=w.useCallback(async _e=>{he(!0),ce(null);try{const Fe=await me(`/api/pharmacy-orders/patient/${_e}`);if(!Fe.ok){const Ue=await Fe.json().catch(()=>({}));throw new Error(Ue.message||`HTTP error! status: ${Fe.status}`)}const Pe=await Fe.json();W(Pe||[])}catch(Fe){console.error("Failed to fetch previous pharmacy orders:",Fe),ce(`Could not load previous orders: ${Fe.message}`)}finally{he(!1)}},[]);w.useEffect(()=>{var _e;oe(),(_e=n.state)!=null&&_e.patient?ae(n.state.patient):I(!0)},[oe,n.state]),w.useEffect(()=>{t!=null&&t.id?xe(t.id):W([])},[t,xe]),w.useEffect(()=>{if(!f){g([]);return}const _e=f.toLowerCase();g(a.filter(Fe=>{const Pe=Fe.name&&Fe.name.toLowerCase().includes(_e),Ue=Fe.brand_name&&Fe.brand_name.toLowerCase().includes(_e);return Pe||Ue}).slice(0,10))},[f,a]);const Z=w.useMemo(()=>wb(async _e=>{if(_e.trim().length<2){z([]),Q(!1),B(null);return}Q(!0),B(null);try{const Fe=new URLSearchParams({search:encodeURIComponent(_e),page:"1",limit:"10",sortBy:"name",sortOrder:"asc"}),Pe=await me(`/api/patients?${Fe.toString()}`);if(!Pe.ok){const ve=await Pe.text();throw new Error(`API Error (${Pe.status}): ${ve||Pe.statusText}`)}const Ue=await Pe.json();z(Ue.patients)}catch(Fe){console.error("Error searching patients:",Fe),B(Fe.message||"Failed to search patients."),z([])}finally{Q(!1)}},300),[se]),ue=_e=>{const Fe=_e.target.value;L(Fe),re(se.test(Fe)),G(D.test(Fe)&&!se.test(Fe)),Q(!0),Z(Fe)},ae=w.useCallback(_e=>{i(_e),I(!1),L(""),z([]),B(null)},[]),Re=w.useCallback(async _e=>{if(!U||_e==="phone"&&!Y||_e==="name"&&!ne){B(`Invalid ${_e} to create a new patient.`);return}Q(!0),B(null);try{const Pe=await me("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:_e==="name"?U:"direct pharmacy",phone:_e==="phone"?U:null,age:null,gender:null,token:null})});if(!Pe.ok){const ve=await Pe.json();throw new Error(ve.message||`Failed to create patient: ${Pe.statusText}`)}const Ue=await Pe.json();alert(`New patient "${Ue.name}" created with ${_e==="phone"?`phone ${Ue.phone}`:`name ${Ue.name}`}.`),ae(Ue)}catch(Fe){console.error("Error creating new patient:",Fe),B(Fe.message||"Failed to create new patient.")}finally{Q(!1)}},[U,Y,ne,ae]),Ae=()=>{i(null),I(!0),d([]),v(null),W([])},Ce=_e=>{if(l.some(Fe=>Fe.drug_id===_e.id)){const Fe=_e.name||_e.brand_name||"This drug";v(`${Fe} is already in the order.`),setTimeout(()=>v(null),3e3),u(""),g([]);return}d(Fe=>[...Fe,{drug_id:_e.id,name:_e.name||_e.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,tabletsPerDay:1,numberOfDays:1,price:Number(_e.price)||0,originalPrice:Number(_e.price)||0,stock:_e.quantity_in_stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(_e.price)||0)/(De(_e.unit)||1),unit:_e.unit}]),u(""),g([])},Se=()=>{const _e=f.trim();if(!_e){v("Please enter a drug name to navigate to the add drug page."),setTimeout(()=>v(null),3e3);return}e("/dashboard/inventory/add",{state:{initialDrugName:_e}}),u(""),g([])},De=_e=>{if(!_e)return null;const Fe=_e.match(/(?:\d+x)?(\d+)/);return Fe?parseInt(Fe[1],10):null},Me=_e=>{d(Fe=>Fe.filter(Pe=>(Pe.drug_id??Pe.name)!==_e))},et=(_e,Fe)=>{d(Pe=>Pe.map(Ue=>{if((Ue.drug_id??Ue.name)===_e&&Ue.isLoose){const ee=De(Ue.unit),fe=Math.max(0,Fe),qe=fe*(ee??1)+(Ue.looseUnits??0);return{...Ue,loosePacks:fe,looseQuantity:qe}}return Ue}))},ct=(_e,Fe)=>{d(Pe=>Pe.map(Ue=>{if((Ue.drug_id??Ue.name)===_e&&Ue.isLoose){const ee=De(Ue.unit),fe=Math.max(0,Fe),qe=(Ue.loosePacks??0)*(ee??1)+fe;return{...Ue,looseUnits:fe,looseQuantity:qe}}return Ue}))},ut=_e=>{const Fe=[];_e.medications.forEach(Pe=>{if(l.find(ve=>ve.drug_id&&Pe.drug_id&&ve.drug_id===Pe.drug_id||ve.name.toLowerCase()===Pe.name.toLowerCase()))d(ve=>ve.map(ee=>{if(ee.drug_id&&Pe.drug_id&&ee.drug_id===Pe.drug_id||ee.name.toLowerCase()===Pe.name.toLowerCase()){const fe=(ee.pack_quantity??0)+(Pe.pack_quantity??0),qe=(ee.loose_quantity??0)+(Pe.loose_quantity??0),nt=Pe.tabletsPerDay??ee.tabletsPerDay,lt=Pe.numberOfDays??ee.numberOfDays,wt=De(ee.unit),Ve=fe*(wt??1)+qe;return{...ee,pack_quantity:fe,loose_quantity:qe,directions_to_use:Pe.directions_to_use??ee.directions_to_use,tabletsPerDay:nt,numberOfDays:lt,looseQuantity:Ve,loosePacks:Math.floor(Ve/(wt??1)),looseUnits:Ve%(wt??1)}}return ee}));else{let ve=Pe.drug_id,ee=Pe.drug_id?a.find(fe=>fe.id===Pe.drug_id):void 0;if(!ve&&Pe.name){const fe=a.find(qe=>qe.name&&qe.name.toLowerCase()===Pe.name.toLowerCase());fe&&(ve=fe.id,ee=fe)}Fe.push({drug_id:ve,name:Pe.name,pack_quantity:Pe.pack_quantity??0,loose_quantity:Pe.loose_quantity??0,directions_to_use:Pe.directions_to_use,tabletsPerDay:Pe.tabletsPerDay??1,numberOfDays:Pe.numberOfDays??1,price:ee?ee.price:Pe.price,stock:ee?ee.quantity_in_stock:Pe.stock,isLoose:!0,loosePacks:0,looseUnits:(Pe.pack_quantity??0)*(De((ee==null?void 0:ee.unit)||Pe.unit)??1)+(Pe.loose_quantity??0),looseQuantity:(Pe.pack_quantity??0)*(De((ee==null?void 0:ee.unit)||Pe.unit)??1)+(Pe.loose_quantity??0),pricePerLooseUnit:(ee?Number(ee.price):Number(Pe.price)||0)/(De((ee==null?void 0:ee.unit)||Pe.unit)||1),unit:(ee==null?void 0:ee.unit)||Pe.unit})}}),d(Pe=>[...Pe,...Fe]),_e.prescriptionForUnavailableDrugs&&(!T||!T.includes(_e.prescriptionForUnavailableDrugs))&&P(Pe=>Pe?`${Pe}

-- From Order ${_e.id.substring(0,8)} --
${_e.prescriptionForUnavailableDrugs}`:_e.prescriptionForUnavailableDrugs),v("Medications from previous order added to current order."),setTimeout(()=>v(null),3e3)},at=async _e=>{if(_e.preventDefault(),v(null),k(!0),!t){v("No patient selected for the order."),k(!1);return}if(l.length===0&&!(T!=null&&T.trim())){v("Please add at least one medication or provide a prescription for unavailable drugs."),k(!1);return}const Fe=l.filter(Ue=>{const ve=Ue.looseQuantity??0;return ve<=0||Ue.stock!==void 0&&ve>Ue.stock});if(Fe.length>0){v(`Invalid quantity or insufficient stock for: ${Fe.map(Ue=>Ue.name).join(", ")}`),k(!1);return}const Pe={patient_id:t.id,items:l.map(Ue=>{const ve=Ue.price??0,ee=Ue.pricePerLooseUnit??0,fe=ee*(Ue.looseQuantity??0);return{drug_id:Ue.drug_id===void 0?null:Ue.drug_id,name:Ue.name,pack_quantity:Ue.loosePacks??0,loose_quantity:Ue.looseUnits??0,pack_price:ve,loose_price:ee,total_price:fe,price:Ue.originalPrice??0,directions_to_use:Ue.directions_to_use===void 0?null:Ue.directions_to_use,tabletsPerDay:Ue.tabletsPerDay??1,numberOfDays:Ue.numberOfDays??1}}),order_total:qt,prescription_for_unavailable_drugs:T};try{const Ue=await me("/api/pharmacy-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Pe)});if(!Ue.ok){const ve=await Ue.json();throw new Error(ve.message||`Failed to create order: ${Ue.statusText}`)}alert(`Pharmacy order created successfully for ${t.name}!`),e(-1)}catch(Ue){console.error("Failed to create pharmacy order:",Ue),v(Ue.message||"Failed to create order. Please try again.")}finally{k(!1)}},qt=w.useMemo(()=>l.reduce((_e,Fe)=>{const Pe=Fe.isLoose?Fe.pricePerLooseUnit??0:Fe.price??0,Ue=Fe.isLoose?Fe.looseQuantity??0:Fe.quantity??0;return _e+Pe*Ue},0),[l]),jt=(Number(qt)||0).toFixed(2);return r.jsxs("div",{className:"add-pharmacy-order-page p-4 md:p-6 max-w-5xl mx-auto",children:[" ",r.jsxs("div",{className:"page-header flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 pb-4",children:[" ",r.jsxs("div",{className:"flex items-center mb-2 sm:mb-0",children:[r.jsxs("button",{onClick:()=>e(-1),className:"back-button p-2 rounded-full mr-3",title:"Go Back",children:[r.jsx(rn,{size:20})," "]}),r.jsx("h2",{className:"text-2xl",children:"Create New Pharmacy Order"})," "]})]}),M&&r.jsxs("div",{className:"content-section",children:[" ",r.jsx("h3",{className:"section-title",children:"Select Patient"})," ",r.jsxs("div",{className:"mb-3 relative",children:[r.jsx("label",{htmlFor:"patient-search",className:"form-label",children:"Search Patient (Name, Token, or Phone)"})," ",r.jsx("input",{type:"text",id:"patient-search",placeholder:"Search by Name, Token No, or Phone No (min 2 chars)...",value:U,onChange:ue,className:"custom-text-input mt-1",autoFocus:!0}),F&&r.jsx("span",{className:"absolute right-3 top-9 text-xs text-gray-400",children:"Searching..."})]}),R&&r.jsx("div",{className:"ai-function-status error mb-3 p-3",children:R})," ",$.length>0&&r.jsxs("div",{className:"patient-search-results max-h-64 overflow-y-auto rounded-md shadow-sm mt-1 z-10",children:[" ",r.jsxs("ul",{children:[" ",$.map(_e=>r.jsxs("li",{onClick:()=>ae({id:_e.id,name:_e.name,token:_e.token,age:_e.age,gender:_e.gender,phone:_e.phone}),children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center",children:[r.jsxs("div",{className:"font-medium",children:[r.jsxs("span",{className:"patient-token mr-2",children:["#",_e.token]}),_e.name]}),r.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:mt-0",children:[_e.age?`${_e.age} yrs`:"Age N/A",_e.gender?` / ${_e.gender}`:" / Gender N/A",_e.phone&&r.jsxs("span",{className:"hidden sm:inline",children:[" / ",_e.phone]})]})]}),_e.phone&&r.jsxs("div",{className:"patient-details-text text-xs mt-1 sm:hidden",children:["Phone: ",_e.phone]})]},_e.id))]})]}),U.length>=2&&!F&&$.length===0&&!R&&r.jsxs(r.Fragment,{children:[r.jsxs("p",{className:"text-gray-400 mt-2 text-sm",children:['No patients found matching "',U,'".']}),Y&&r.jsx("button",{type:"button",onClick:()=>Re("phone"),className:"create-patient-button mt-3 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",disabled:F,children:'Create "direct pharmacy" Patient with this Phone'}),ne&&r.jsx("button",{type:"button",onClick:()=>Re("name"),className:"create-patient-button mt-3 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ml-2",disabled:F,children:"Create Patient with this Name"})]}),U.length<2&&!F&&r.jsx("p",{className:"text-gray-400 mt-2 text-sm",children:"Enter at least 2 characters to search."})]}),t&&!M&&r.jsxs("form",{onSubmit:at,children:[r.jsxs("div",{className:"selected-patient-info content-section flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[" ",r.jsxs("div",{children:[r.jsxs("h3",{className:"section-title",children:[" ","Patient: ",r.jsx("span",{className:"font-normal",children:t.name})]}),r.jsxs("p",{className:"text-sm mt-1",children:["Token: ",r.jsx("span",{className:"font-medium",children:t.token??"N/A"}),t.age&&`    Age: ${t.age}`,t.gender&&`    Gender: ${t.gender}`,t.phone&&`    Phone: ${t.phone}`]}),r.jsxs("p",{className:"text-xs mt-1",title:`Patient UUID: ${t.id}`,children:["ID: ",t.id.substring(0,12),"..."]})]}),r.jsx("button",{type:"button",onClick:Ae,className:"change-patient-button mt-2 sm:mt-0 px-3 py-1.5 border rounded-md text-sm font-medium focus:outline-none focus:ring-2",children:"Change Patient"})]}),b&&r.jsx("div",{className:"ai-function-status error mb-4 p-3",children:b})," ",J&&r.jsx("div",{className:"content-section text-center py-4",children:r.jsx("p",{className:"text-gray-500",children:"Loading previous orders..."})}),A&&r.jsx("div",{className:"ai-function-status error mb-4 p-3",children:A}),!J&&V.length>0&&r.jsxs("div",{className:"content-section mt-4",children:[r.jsx("h3",{className:"section-title",children:"Previous Orders"}),r.jsx("div",{className:"space-y-4",children:V.map(_e=>r.jsxs("div",{className:"previous-order-card p-4 border rounded-lg shadow-sm bg-gray-50",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsxs("p",{className:"font-semibold text-gray-800",children:["Order Date: ",new Date(_e.date).toLocaleDateString()]}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${_e.status==="dispensed"?"bg-green-100 text-green-800":_e.status==="pending"?"bg-yellow-100 text-yellow-800":_e.status==="cancelled"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:_e.status.charAt(0).toUpperCase()+_e.status.slice(1)})]}),r.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mb-3",children:_e.medications.map((Fe,Pe)=>r.jsxs("li",{children:[r.jsx("strong",{children:Fe.name}),": ",Fe.quantity," Qty",Fe.directions_to_use&&` - Directions: ${Fe.directions_to_use}`]},Pe))}),_e.prescriptionForUnavailableDrugs&&r.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:[r.jsx("span",{className:"font-semibold",children:"Prescription for Unavailable:"}),r.jsxs("div",{className:"prose prose-sm max-w-none",children:[" ",r.jsx(Yo,{remarkPlugins:[zs],children:_e.prescriptionForUnavailableDrugs})]})]}),r.jsxs("button",{type:"button",onClick:()=>ut(_e),className:"add-previous-meds-button mt-3 px-3 py-1.5 text-sm font-medium rounded-md flex items-center justify-center",children:[r.jsx(ou,{size:16,className:"mr-1"})," Add Medications to Current Order"]})]},_e.id))})]}),!J&&V.length===0&&t&&r.jsx("div",{className:"content-section text-center py-4 mt-4",children:r.jsx("p",{className:"text-gray-500",children:"No previous orders found for this patient."})}),r.jsxs("div",{className:"mb-4 content-section",children:[r.jsx("label",{htmlFor:"prescription-unavailable",className:"form-label",children:"Prescription for Unavailable Drugs (Optional)"}),r.jsx("textarea",{id:"prescription-unavailable",rows:3,value:T??"",onChange:_e=>P(_e.target.value||null),placeholder:"Enter prescription details for any drugs that are currently unavailable...",className:"custom-text-input mt-1 w-full"})]}),r.jsxs("div",{className:"mb-4 relative content-section",children:[" ",r.jsx("label",{htmlFor:"drug-search",className:"form-label",children:"Add Medication"})," ",r.jsx("input",{type:"text",id:"drug-search",placeholder:"Search for drug name or type to add custom...",value:f,onChange:_e=>u(_e.target.value),className:"custom-text-input mt-1"}),f&&r.jsxs("div",{className:"drug-search-dropdown mt-1 w-full max-h-60 rounded-md border shadow-lg overflow-auto focus:outline-none sm:text-sm z-20",children:[" ",p.length>0&&r.jsxs("ul",{children:[" ",p.map(_e=>r.jsxs("li",{onClick:()=>Ce(_e),className:"cursor-pointer select-none relative",children:[r.jsx("span",{className:"font-medium block truncate",children:_e.name||_e.brand_name}),r.jsxs("span",{className:"drug-stock-price text-xs",children:[" ","(Stock: ",_e.quantity_in_stock??"N/A",", Price: ",Number(_e.price||0).toFixed(2),")"]})]},_e.id))]}),f.trim()&&!a.some(_e=>_e.name&&_e.name.toLowerCase()===f.trim().toLowerCase()||_e.brand_name&&_e.brand_name.toLowerCase()===f.trim().toLowerCase())&&r.jsxs("div",{onClick:Se,className:"add-custom-drug-button cursor-pointer text-sm font-medium",role:"button",children:['Add "',f.trim(),'" as new item']}),f.trim()&&p.length===0&&a.some(_e=>_e.name&&_e.name.toLowerCase()===f.trim().toLowerCase()||_e.brand_name&&_e.brand_name.toLowerCase()===f.trim().toLowerCase())&&r.jsx("p",{className:"text-gray-400 py-2.5 px-4 text-sm",children:"Drug already selected or no new matches."})]})]}),r.jsxs("div",{className:"order-items-section content-section max-h-96 overflow-y-auto",children:[" ",r.jsx("h4",{className:"section-title",children:"Order Items"})," ",l.length===0&&r.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:"No medications added yet."}),l.length>0&&r.jsx("ul",{className:"space-y-4",children:l.map(_e=>{const Fe=_e.drug_id??_e.name,Pe=!_e.drug_id;return r.jsxs("li",{className:"order-item-card text-sm",children:[" ",r.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-3",children:[r.jsxs("div",{className:"flex-grow mb-2 md:mb-0",children:[r.jsxs("span",{className:`item-name block text-base ${Pe?"custom":""}`,children:[" ",_e.name,Pe?" (custom)":""]}),!Pe&&_e.pricePerLooseUnit!==void 0&&r.jsxs("span",{className:"item-details text-xs",children:[" ","@ ",(Number(_e.pricePerLooseUnit)||0).toFixed(2)," per loose unit"]}),_e.stock!==void 0&&r.jsxs("span",{className:`item-details text-xs ml-2 ${_e.stock<=10?"item-stock low":""}`,children:[" ","(Stock: ",_e.stock,")"]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-x-4 gap-y-2",children:[r.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[r.jsx("label",{htmlFor:`loose-packs-${Fe}`,className:"dosage-label",children:"Packs:"}),r.jsxs("div",{className:"quantity-control",children:[r.jsx("button",{type:"button",onClick:()=>et(Fe,(_e.loosePacks??0)-1),className:"quantity-btn",children:"-"}),r.jsx("input",{type:"number",id:`loose-packs-${Fe}`,min:"0",value:_e.loosePacks??0,onChange:Ue=>{const ve=parseInt(Ue.target.value,10);et(Fe,isNaN(ve)?0:ve)},onFocus:Ue=>Ue.target.select(),className:"dosage-input text-sm text-right"}),r.jsx("button",{type:"button",onClick:()=>et(Fe,(_e.loosePacks??0)+1),className:"quantity-btn",children:"+"})]})]}),r.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[r.jsx("label",{htmlFor:`loose-units-${Fe}`,className:"dosage-label",children:"Loose:"}),r.jsxs("div",{className:"quantity-control",children:[r.jsx("button",{type:"button",onClick:()=>ct(Fe,(_e.looseUnits??0)-1),className:"quantity-btn",children:"-"}),r.jsx("input",{type:"number",id:`loose-units-${Fe}`,min:"0",value:_e.looseUnits??0,onChange:Ue=>{const ve=parseInt(Ue.target.value,10);ct(Fe,isNaN(ve)?0:ve)},onFocus:Ue=>Ue.target.select(),className:"dosage-input text-sm text-right"}),r.jsx("button",{type:"button",onClick:()=>ct(Fe,(_e.looseUnits??0)+1),className:"quantity-btn",children:"+"})]}),_e.unit&&r.jsxs("span",{className:"ml-2 text-sm text-gray-400",children:["(",_e.unit.split("x")[1]||_e.unit," per pack)"]})]})]}),r.jsxs("div",{className:"flex items-center justify-between md:justify-end gap-3 mt-2 md:mt-0 md:flex-col md:items-end",children:[r.jsxs("div",{className:"w-28 text-right font-semibold",children:[" ","",(Number((_e.pricePerLooseUnit??0)*(_e.looseQuantity??0))||0).toFixed(2)]}),r.jsx("button",{type:"button",onClick:()=>Me(Fe),className:"remove-item-button p-1.5 -m-1.5 rounded-full",title:"Remove Item",children:r.jsx(or,{size:18})})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-x-4 gap-y-2 mt-2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("label",{htmlFor:`tablets-per-day-${Fe}`,className:"dosage-label",children:"Per Day:"}),r.jsxs("div",{className:"quantity-control",children:[r.jsx("button",{type:"button",onClick:()=>d(Ue=>Ue.map(ve=>ve.drug_id===Fe?{...ve,tabletsPerDay:Math.max(1,(ve.tabletsPerDay??1)-1)}:ve)),className:"quantity-btn",children:"-"}),r.jsx("input",{type:"number",id:`tablets-per-day-${Fe}`,min:"1",value:_e.tabletsPerDay??1,onChange:Ue=>{const ve=parseInt(Ue.target.value,10);d(ee=>ee.map(fe=>fe.drug_id===Fe?{...fe,tabletsPerDay:isNaN(ve)?1:Math.max(1,ve)}:fe))},onFocus:Ue=>Ue.target.select(),className:"dosage-input text-sm text-right"}),r.jsx("button",{type:"button",onClick:()=>d(Ue=>Ue.map(ve=>ve.drug_id===Fe?{...ve,tabletsPerDay:(ve.tabletsPerDay??1)+1}:ve)),className:"quantity-btn",children:"+"})]})]}),r.jsxs("div",{className:"flex items-center mt-1 sm:mt-0",children:[r.jsx("label",{htmlFor:`number-of-days-${Fe}`,className:"dosage-label",children:"No. Days:"}),r.jsxs("div",{className:"quantity-control",children:[r.jsx("button",{type:"button",onClick:()=>d(Ue=>Ue.map(ve=>ve.drug_id===Fe?{...ve,numberOfDays:Math.max(1,(ve.numberOfDays??1)-1)}:ve)),className:"quantity-btn",children:"-"}),r.jsx("input",{type:"number",id:`number-of-days-${Fe}`,min:"1",value:_e.numberOfDays??1,onChange:Ue=>{const ve=parseInt(Ue.target.value,10);d(ee=>ee.map(fe=>fe.drug_id===Fe?{...fe,numberOfDays:isNaN(ve)?1:Math.max(1,ve)}:fe))},onFocus:Ue=>Ue.target.select(),className:"dosage-input text-sm text-right"}),r.jsx("button",{type:"button",onClick:()=>d(Ue=>Ue.map(ve=>ve.drug_id===Fe?{...ve,numberOfDays:(ve.numberOfDays??1)+1}:ve)),className:"quantity-btn",children:"+"})]})]})]}),r.jsx("div",{className:"flex items-center mt-2",children:_e.unit&&De(_e.unit)&&r.jsx("span",{className:"ml-4 text-sm text-gray-400",children:(()=>{const Ue=De(_e.unit),ve=_e.looseQuantity??0;if(Ue&&Ue>0){const ee=Math.floor(ve/Ue),fe=ve%Ue;return`(Subtract: ${ee} packs, ${fe} loose)`}return""})()})}),r.jsxs("div",{className:"mt-2",children:[r.jsx("label",{htmlFor:`directions-${Fe}`,className:"dosage-label",children:"Directions:"}),r.jsx("input",{type:"text",id:`directions-${Fe}`,placeholder:"e.g., 'After food', 'Twice a day'",value:_e.directions_to_use??"",onChange:Ue=>{const ve=Ue.target.value;d(ee=>ee.map(fe=>(fe.drug_id??fe.name)===Fe?{...fe,directions_to_use:ve}:fe))},className:"dosage-input text-sm w-full mt-1"})]})]},Fe)})})]}),l.length>0&&r.jsx("div",{className:"mt-6 text-right pr-4",children:r.jsxs("span",{className:"grand-total font-bold",children:[" ","Grand Total: ",jt]})}),r.jsx("div",{className:"mt-8 flex justify-end",children:r.jsx("button",{type:"submit",disabled:S||l.length===0&&!(T!=null&&T.trim()),className:`submit-order-button inline-flex items-center justify-center text-base shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 ${S||l.length===0&&!(T!=null&&T.trim())?"":"hover:opacity-90"}`,children:S?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"spinner animate-spin rounded-full h-5 w-5 border-2 mr-3"})," ","Creating Order..."]}):"Create Order"})})]})]})},hA=()=>{const{orderId:e}=Br(),n=_t(),[t,i]=w.useState(null),[a,o]=w.useState(null),[l,d]=w.useState([]),[f,u]=w.useState([]),[p,g]=w.useState(""),[b,v]=w.useState([]),[S,k]=w.useState(null),[T,P]=w.useState(!1),[M,I]=w.useState(null),[U,L]=w.useState(!0),$=w.useCallback(async()=>{L(!0);try{const G=await me(`/api/pharmacy-orders/${e}`);if(!G.ok)throw new Error("Failed to fetch order details");const V=await G.json();i(V),o({id:V.patientId,name:V.patientName||"N/A",token:V.patientTokenNumber}),I(V.prescriptionForUnavailableDrugs);const W=V.medications.map(J=>{const he=F(J.unit),A=J.pack_quantity*(he??1)+J.loose_quantity;return{...J,isLoose:!0,loosePacks:J.pack_quantity,looseUnits:J.loose_quantity,looseQuantity:A,pack_price:J.pack_price,loose_price:J.loose_price,total_price:J.total_price,pricePerLooseUnit:J.loose_price,originalPrice:J.pack_price,box_number:J.box_number,unit:J.unit,batch:J.batch,expiry_date:J.expiry_date,discount_percentage:J.discount_percentage}});u(W)}catch(G){k("Could not load order details. "+G.message)}finally{L(!1)}},[e]),z=w.useCallback(async()=>{try{const G=await me("/api/drugs");if(!G.ok)throw new Error("Failed to fetch drugs");const V=await G.json();d(V)}catch(G){k("Could not load drug list. "+G.message)}},[]);w.useEffect(()=>{$(),z()},[$,z]),w.useEffect(()=>{if(!p){v([]);return}const G=p.toLowerCase();v(l.filter(V=>{const W=V.name&&V.name.toLowerCase().includes(G),J=V.brand_name&&V.brand_name.toLowerCase().includes(G);return W||J}).slice(0,10))},[p,l]);const F=G=>{if(!G)return null;const V=G.match(/(?:\d+x)?(\d+)/);return V?parseInt(V[1],10):null},Q=G=>{if(f.some(V=>V.drug_id===G.id)){k(`${G.name||G.brand_name} is already in the order.`),setTimeout(()=>k(null),3e3),g(""),v([]);return}u(V=>[...V,{drug_id:G.id,name:G.name||G.brand_name||"Unnamed Drug",pack_quantity:0,loose_quantity:1,pack_price:Number(G.price)||0,loose_price:(Number(G.price)||0)/(F(G.unit)||1),total_price:(Number(G.price)||0)/(F(G.unit)||1),discount_percentage:0,directions_to_use:"",tabletsPerDay:1,numberOfDays:1,stock:G.quantity_in_stock,isLoose:!0,looseQuantity:1,loosePacks:0,looseUnits:1,pricePerLooseUnit:(Number(G.price)||0)/(F(G.unit)||1),originalPrice:Number(G.price)||0,unit:G.unit}]),g(""),v([])},R=G=>{u(V=>V.filter(W=>(W.drug_id??W.name)!==G))},B=(G,V)=>{u(W=>W.map(J=>{if((J.drug_id??J.name)===G&&J.isLoose){const he=F(J.unit),A=Math.max(0,V),ce=A*(he??1)+(J.looseUnits??0);return{...J,loosePacks:A,looseQuantity:ce,pack_quantity:A}}return J}))},Y=(G,V)=>{u(W=>W.map(J=>{if((J.drug_id??J.name)===G&&J.isLoose){const he=F(J.unit),A=Math.max(0,V),ce=(J.loosePacks??0)*(he??1)+A;return{...J,looseUnits:A,looseQuantity:ce,loose_quantity:A}}return J}))},re=async G=>{if(G.preventDefault(),k(null),P(!0),f.length===0&&!(M!=null&&M.trim())){k("Please add at least one medication or provide a prescription."),P(!1);return}const V=f.filter(J=>{const he=J.looseQuantity??0;return he<=0||J.stock!==void 0&&he>J.stock});if(V.length>0){k(`Invalid quantity or insufficient stock for: ${V.map(J=>J.name).join(", ")}`),P(!1);return}const W={items:f.map(J=>({drug_id:J.drug_id??null,name:J.name,pack_quantity:J.loosePacks??0,loose_quantity:J.looseUnits??0,pack_price:J.pack_price??0,loose_price:J.loose_price??0,total_price:(J.loose_price??0)*(J.looseQuantity??0),discount_percentage:J.discount_percentage??0,directions_to_use:J.directions_to_use??null,tabletsPerDay:J.tabletsPerDay??1,numberOfDays:J.numberOfDays??1})),prescription_for_unavailable_drugs:M,order_total:ne};try{const J=await me(`/api/pharmacy-orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(W)});if(!J.ok){const he=await J.json();throw new Error(he.message||"Failed to update order")}alert("Pharmacy order updated successfully!"),n(-1)}catch(J){k(J.message||"Failed to update order. Please try again.")}finally{P(!1)}},ne=w.useMemo(()=>f.reduce((G,V)=>{const W=V.loose_price??0,J=V.looseQuantity??0;return G+W*J},0),[f]);return U?r.jsx("div",{className:"p-6 flex justify-center items-center h-screen text-gray-500",children:"Loading order details..."}):t?r.jsxs("div",{className:"edit-pharmacy-order-container",children:[r.jsxs("div",{className:"page-header",children:[r.jsxs("div",{className:"header-left",children:[r.jsx("button",{onClick:()=>n(-1),className:"back-button",title:"Go Back",children:r.jsx(rn,{size:20})}),r.jsxs("h2",{className:"page-title",children:["EDIT ORDER ",r.jsxs("span",{className:"text-gray-500 text-lg font-normal ml-2",children:[a==null?void 0:a.name," #",t.id.substring(0,4)]})]})]}),r.jsx("div",{className:"header-right",children:r.jsx("span",{className:"status-badge",children:t.status.toUpperCase()})})]}),r.jsx("div",{className:"order-meta",children:r.jsxs("span",{className:"order-date",children:[" Order Date: ",new Date(t.date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})]})}),r.jsxs("form",{onSubmit:re,className:"main-layout",children:[r.jsxs("div",{className:"left-column",children:[r.jsxs("div",{className:"card search-section",children:[r.jsx("div",{className:"card-header",children:r.jsx("h3",{children:" Find & Add Medication"})}),r.jsxs("div",{className:"search-wrapper",children:[r.jsx("input",{type:"text",placeholder:"Search by name or brand...",value:p,onChange:G=>g(G.target.value),className:"search-input"}),p&&r.jsx("div",{className:"dropdown-results",children:b.length>0?r.jsx("ul",{children:b.map(G=>r.jsxs("li",{onClick:()=>Q(G),className:"dropdown-item",children:[r.jsx("span",{className:"drug-name",children:G.name||G.brand_name}),r.jsxs("span",{className:"drug-meta",children:["(Stock: ",G.quantity_in_stock??"N/A",", Price: ",Number(G.price||0).toFixed(2),")"]})]},G.id))}):r.jsxs("div",{className:"p-3 text-gray-500 text-sm",children:['No drugs found matching "',p,'"']})})]})]}),r.jsxs("div",{className:"card medications-list-section",children:[r.jsx("div",{className:"card-header",children:r.jsxs("h3",{children:[" Medications in Order ",r.jsxs("span",{className:"item-count",children:[f.length," items"]})]})}),f.length>0?r.jsxs("div",{className:"table-container",children:[r.jsxs("div",{className:"table-header-row",children:[r.jsx("div",{className:"col-medication",children:"MEDICATION"}),r.jsx("div",{className:"col-directions",children:"DIRECTIONS"}),r.jsx("div",{className:"col-quantity",children:"QUANTITY"}),r.jsx("div",{className:"col-subtotal",children:"SUBTOTAL"}),r.jsx("div",{className:"col-action"})]}),r.jsx("div",{className:"table-body",children:f.map(G=>{const V=G.drug_id??G.name;return r.jsxs("div",{className:"table-row",children:[r.jsxs("div",{className:"col-medication",children:[r.jsx("span",{className:"med-name",children:G.name}),G.unit&&r.jsx("span",{className:"med-unit text-xs text-gray-500 block",children:G.unit}),r.jsxs("div",{className:"stock-info",children:[" Stock: ",r.jsxs("span",{className:"stock-value",children:[" ",G.stock!==void 0?G.unit?`BOX OF ${F(G.unit)}`:G.stock:"N/A"]})]})]}),r.jsx("div",{className:"col-directions",children:r.jsx("input",{type:"text",placeholder:"1 tablet twice daily...",value:G.directions_to_use??"",onChange:W=>{const J=W.target.value;u(he=>he.map(A=>(A.drug_id??A.name)===V?{...A,directions_to_use:J}:A))},className:"directions-input"})}),r.jsx("div",{className:"col-quantity",children:r.jsxs("div",{style:{display:"flex",gap:"8px"},children:[r.jsxs("div",{style:{flex:1},children:[r.jsx("label",{style:{fontSize:"10px",fontWeight:"bold",color:"#9ca3af",display:"block",marginBottom:"2px"},children:"PACKS"}),r.jsx("input",{type:"number",min:"0",value:G.loosePacks??0,onChange:W=>B(V,parseInt(W.target.value)||0),className:"qty-input",style:{width:"100%",textAlign:"center"}})]}),r.jsxs("div",{style:{flex:1},children:[r.jsx("label",{style:{fontSize:"10px",fontWeight:"bold",color:"#9ca3af",display:"block",marginBottom:"2px"},children:"LOOSE"}),r.jsx("input",{type:"number",min:"0",value:G.looseUnits??0,onChange:W=>Y(V,parseInt(W.target.value)||0),className:"qty-input",style:{width:"100%",textAlign:"center"}})]})]})}),r.jsxs("div",{className:"col-subtotal",children:["",(Number((G.pricePerLooseUnit??0)*(G.looseQuantity??0))||0).toFixed(2)]}),r.jsx("div",{className:"col-action",children:r.jsx("button",{type:"button",onClick:()=>R(V),className:"delete-btn",children:r.jsx(or,{size:16})})})]},V)})})]}):r.jsx("div",{className:"empty-state",children:"No medications added. Search above to add."})]})]}),r.jsxs("div",{className:"right-column",children:[r.jsxs("div",{className:"card notes-card",children:[r.jsx("div",{className:"card-header border-b-0 pb-2",children:r.jsx("h3",{children:" Prescription Notes"})}),r.jsx("textarea",{rows:3,value:M??"",onChange:G=>I(G.target.value||null),placeholder:"Add notes about unavailable drugs...",className:"notes-input"})]}),r.jsxs("button",{type:"submit",disabled:T,className:"confirm-btn",style:{width:"100%",margin:"20px 0 0 0"},children:[r.jsx("span",{className:"check-icon",children:""})," ",T?"Updating...":"Confirm Changes"]}),S&&r.jsx("div",{className:"error-alert mt-4",children:S})]})]})]}):r.jsx("div",{className:"p-6 text-red-500 flex justify-center items-center h-screen",children:"Order not found or failed to load."})},Pee=(e,n,t,i="non-black")=>{if(isNaN(e)||isNaN(n)||e<=0||n<=0)return null;let a;return t==="female"?e<=.7?a=141*Math.pow(e/.7,-.329)*Math.pow(.993,n):a=141*Math.pow(e/.7,-1.209)*Math.pow(.993,n):e<=.9?a=141*Math.pow(e/.9,-.411)*Math.pow(.993,n):a=141*Math.pow(e/.9,-1.209)*Math.pow(.993,n),i==="black"&&(a*=1.018),parseFloat(a.toFixed(2))},Dee=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0||t>=400)return null;const i=e-n-t/5;return parseFloat(i.toFixed(2))},Iee=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},Ree=(e,n)=>{if(isNaN(e)||isNaN(n)||e<0||n<0)return null;const t=e-n;return parseFloat(t.toFixed(2))},Mee=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const i=e-(n+t);return parseFloat(i.toFixed(2))},Oee=(e,n,t)=>{if(isNaN(e)||isNaN(n)||isNaN(t)||e<0||n<0||t<0)return null;const i=2*e+n/18+t/2.8;return parseFloat(i.toFixed(2))},E_=e=>["eGFR","LDL Cholesterol","Indirect Bilirubin","Globulin","Anion Gap","Osmolality"].includes(e),A_=()=>{var oe,xe;const{orderId:e}=Br(),n=_t(),[t,i]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!0),[f,u]=w.useState(!1),[p,g]=w.useState(null),[b,v]=w.useState(null),[S,k]=w.useState(null),[T,P]=w.useState({}),[M,I]=w.useState(null),[U,L]=w.useState(!1),[$,z]=w.useState(""),[F,Q]=w.useState(!1),[R,B]=w.useState(""),Y=w.useCallback(async Z=>{var ue;try{const ae=await me(`/api/patients/${Z}`);if(!ae.ok)throw new Error(`Failed to fetch patient details: ${ae.status}`);const Re=await ae.json();v(Re.age),k(((ue=Re.sex)==null?void 0:ue.toLowerCase())==="female"?"female":"male"),Re.phone&&i(Ae=>Ae?{...Ae,Patient:{...Ae.Patient,phone:Re.phone}}:null)}catch(ae){console.error("Error fetching patient details:",ae),v(null),k(null)}},[]),re=w.useCallback(async()=>{if(e){d(!0),g(null);try{const Z=await me(`/api/lab/${e}`);if(!Z.ok){const Re=await Z.json().catch(()=>({message:`HTTP error! status: ${Z.status}`}));throw new Error(Re.message||`HTTP error! status: ${Z.status}`)}const ue=await Z.json();if(i(ue),ue.createdAt)try{const Re=new Date(ue.createdAt),Ae=new Date(Re.getTime()-Re.getTimezoneOffset()*6e4).toISOString().slice(0,16);z(Ae)}catch(Re){console.error("Error formatting date for edit:",Re)}if(ue.report_date)try{const Re=new Date(ue.report_date),Ae=new Date(Re.getTime()-Re.getTimezoneOffset()*6e4).toISOString().slice(0,16);B(Ae)}catch(Re){console.error("Error formatting report date for edit:",Re)}else{const Re=new Date,Ae=new Date(Re.getTime()-Re.getTimezoneOffset()*6e4).toISOString().slice(0,16);B(Ae)}ue.patient_id&&Y(ue.patient_id);const ae={};if(ue.tests&&ue.tests.forEach(Re=>{ae[Re.id]={},Re.default_parameters&&Re.default_parameters.length>0?Re.default_parameters.forEach(Ae=>{ae[Re.id][Ae.name]=Ae.defaultValue}):ae[Re.id].report_content=""}),ue.report_content)try{const Re=JSON.parse(ue.report_content);typeof Re=="object"&&Re!==null&&!Array.isArray(Re)?o(Re):(console.warn("Legacy or unexpected report content format detected. Initializing with defaults."),o(ae))}catch{console.warn("Legacy report content detected (not JSON). Initializing with defaults."),o(ae)}else o({})}catch(Z){console.error("Failed to fetch lab order details:",Z),g(Z instanceof Error?Z.message:"An unknown error occurred while fetching order details.")}finally{d(!1)}}},[e,Y]);w.useEffect(()=>{e?re():(g("No Order ID provided in the URL."),d(!1))},[e,re]);const ne=(Z,ue,ae)=>{o(Re=>{var ee,fe,qe,nt,lt,wt,Ve,be,ye,Oe,He,tt,rt,Ft,Kn,Pn,Et,Vt,hi;const Ae={...Re,[Z]:{...Re[Z],[ue]:ae}},Ce=parseFloat((ee=Ae[Z])==null?void 0:ee.Creatinine),Se=b,De=S;if(ue==="Creatinine"&&!isNaN(Ce)&&Se!==null&&De!==null){const gn=Pee(Ce,Se,De);gn!==null&&((fe=t==null?void 0:t.tests.find(Bt=>Bt.id===Z))!=null&&fe.default_parameters.find(Bt=>Bt.name==="eGFR"))&&(Ae[Z].eGFR=gn)}const Me=parseFloat((qe=Ae[Z])==null?void 0:qe["Total Cholesterol"]),et=parseFloat((nt=Ae[Z])==null?void 0:nt["HDL Cholesterol"]),ct=parseFloat((lt=Ae[Z])==null?void 0:lt.Triglycerides);if((ue==="Total Cholesterol"||ue==="HDL Cholesterol"||ue==="Triglycerides")&&!isNaN(Me)&&!isNaN(et)&&!isNaN(ct)){const gn=Dee(Me,et,ct);gn!==null&&((wt=t==null?void 0:t.tests.find(Bt=>Bt.id===Z))!=null&&wt.default_parameters.find(Bt=>Bt.name==="LDL Cholesterol"))&&(Ae[Z]["LDL Cholesterol"]=gn)}const ut=parseFloat((Ve=Ae[Z])==null?void 0:Ve["Total Bilirubin"]),at=parseFloat((be=Ae[Z])==null?void 0:be["Direct Bilirubin"]);if((ue==="Total Bilirubin"||ue==="Direct Bilirubin")&&!isNaN(ut)&&!isNaN(at)){const gn=Iee(ut,at);gn!==null&&((ye=t==null?void 0:t.tests.find(Bt=>Bt.id===Z))!=null&&ye.default_parameters.find(Bt=>Bt.name==="Indirect Bilirubin"))&&(Ae[Z]["Indirect Bilirubin"]=gn)}const qt=parseFloat((Oe=Ae[Z])==null?void 0:Oe["Total Protein"]),jt=parseFloat((He=Ae[Z])==null?void 0:He.Albumin);if((ue==="Total Protein"||ue==="Albumin")&&!isNaN(qt)&&!isNaN(jt)){const gn=Ree(qt,jt);gn!==null&&((tt=t==null?void 0:t.tests.find(Bt=>Bt.id===Z))!=null&&tt.default_parameters.find(Bt=>Bt.name==="Globulin"))&&(Ae[Z].Globulin=gn)}const _e=parseFloat((rt=Ae[Z])==null?void 0:rt.Sodium),Fe=parseFloat((Ft=Ae[Z])==null?void 0:Ft.Chloride),Pe=parseFloat((Kn=Ae[Z])==null?void 0:Kn.Bicarbonate);if((ue==="Sodium"||ue==="Chloride"||ue==="Bicarbonate")&&!isNaN(_e)&&!isNaN(Fe)&&!isNaN(Pe)){const gn=Mee(_e,Fe,Pe);gn!==null&&((Pn=t==null?void 0:t.tests.find(Bt=>Bt.id===Z))!=null&&Pn.default_parameters.find(Bt=>Bt.name==="Anion Gap"))&&(Ae[Z]["Anion Gap"]=gn)}const Ue=parseFloat((Et=Ae[Z])==null?void 0:Et.Glucose),ve=parseFloat((Vt=Ae[Z])==null?void 0:Vt.BUN);if((ue==="Sodium"||ue==="Glucose"||ue==="BUN")&&!isNaN(_e)&&!isNaN(Ue)&&!isNaN(ve)){const gn=Oee(_e,Ue,ve);gn!==null&&((hi=t==null?void 0:t.tests.find(Bt=>Bt.id===Z))!=null&&hi.default_parameters.find(Bt=>Bt.name==="Osmolality"))&&(Ae[Z].Osmolality=gn)}return Ae})},G=async Z=>{const ue=a[Z]||{},ae=t==null?void 0:t.tests.find(Se=>Se.id===Z);if(!ae)return;const Re={};ae.default_parameters&&ae.default_parameters.forEach(Se=>{Re[Se.name]=Se.defaultValue});const Ae={...Re,...ue},Ce={...a,[Z]:Ae};o(Ce),u(!0),g(null);try{const Se=await me(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(Ce),isPartial:!0})});if(!Se.ok)throw new Error(`Save failed: ${Se.status}`);alert(`Report for ${ae.name} saved successfully!`)}catch(Se){console.error("Error saving test report:",Se),alert("Failed to save test report.")}finally{u(!1)}},V=(Z=null)=>{I(Z),setTimeout(()=>{window.print()},100)},W=()=>{t&&_w(t)},J=async()=>{if(!t||!t.tests){alert("Order details not loaded.");return}if(!e){alert("Cannot submit report without an Order ID.");return}const Z={};if(t.tests.forEach(ue=>{const ae=a[ue.id]||{},Re={};ue.default_parameters&&ue.default_parameters.forEach(Ae=>{Ae.defaultValue!==void 0&&Ae.defaultValue!==null&&(Re[Ae.name]=Ae.defaultValue)}),Z[ue.id]={...Re,...ae},(!ue.default_parameters||ue.default_parameters.length===0)&&!Z[ue.id].report_content&&(Z[ue.id].report_content="")}),Object.keys(Z).length===0){alert("Report content cannot be empty.");return}o(Z),u(!0),g(null);try{const ue=await me(`/api/lab/${e}/report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_content:JSON.stringify(Z)})});if(!ue.ok){const ae=await ue.json().catch(()=>({message:`Submission failed: ${ue.status}`}));throw new Error(ae.message||`Submission failed: ${ue.status}`)}alert("Report submitted successfully!"),n(-1)}catch(ue){console.error("Error submitting report:",ue),g(ue instanceof Error?ue.message:"An unknown error occurred during submission.")}finally{u(!1)}},he=async()=>{if(!(!e||!$))try{const Z=await me(`/api/lab/orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:new Date($).toISOString()})});if(!Z.ok)throw new Error("Failed to update date");const ue=await Z.json();ue.order&&i(ae=>ae?{...ae,createdAt:ue.order.createdAt}:null),L(!1)}catch(Z){console.error("Failed to update date:",Z),alert("Failed to update date")}},A=async()=>{if(!(!e||!R))try{const Z=await me(`/api/lab/orders/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({reportDate:new Date(R).toISOString()})});if(!Z.ok)throw new Error("Failed to update report date");const ue=await Z.json();ue.order&&i(ae=>ae?{...ae,report_date:ue.order.report_date}:null),Q(!1)}catch(Z){console.error("Failed to update report date:",Z),alert("Failed to update report date")}};if(l)return r.jsx("div",{className:"lab-inventory-container",children:r.jsxs("div",{className:"lab-inventory-card",style:{textAlign:"center",padding:"50px"},children:[" ",r.jsxs("div",{className:"loading-text",children:[r.jsx(Ah,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading details..."]})]})});if(p&&!t)return r.jsx("div",{className:"lab-inventory-container",children:r.jsxs("div",{className:"lab-inventory-card error-message-container",style:{textAlign:"center",padding:"30px"},children:[r.jsx(Hi,{size:48,className:"mb-3",style:{margin:"0 auto"}}),r.jsx("h3",{className:"error-title",style:{borderBottom:"none"},children:"Error Loading Details"}),r.jsx("p",{className:"error-text",children:p}),r.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"20px"},children:[r.jsx(rn,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});if(!t)return r.jsx("div",{className:"lab-inventory-container",children:r.jsxs("div",{className:"lab-inventory-card no-data-message",style:{textAlign:"center",padding:"30px"},children:[r.jsx(Qo,{size:48,className:"mb-3",style:{margin:"0 auto"}}),r.jsx("p",{className:"no-data-message",style:{fontSize:"1.1em"},children:`Lab order not found for ID: ${e}.`}),r.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",style:{marginTop:"15px"},children:[r.jsx(rn,{size:16,style:{marginRight:"5px"}}),"Back"]})]})});const ce=(oe=t==null?void 0:t.Patient)==null?void 0:oe.name,se=(xe=t==null?void 0:t.Patient)==null?void 0:xe.patient_token_number;return r.jsx("div",{className:"lab-inventory-container",children:r.jsxs("div",{className:"lab-inventory-card",children:[r.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"none",paddingBottom:0,marginBottom:0},children:[" ",r.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:"Enter Lab Report"})," ",r.jsxs("button",{onClick:()=>n(e?"/lab":-1),className:"lab-inventory-button lab-inventory-button-secondary",disabled:f,children:[r.jsx(rn,{size:16,style:{marginRight:"5px"}}),e?"Back to Lab Panel":"Back"]}),r.jsxs("div",{style:{display:"flex",gap:"8px",marginLeft:"10px"},children:[r.jsxs("button",{onClick:()=>V(null),className:"lab-inventory-button",title:"Print Full Report",children:[r.jsx(Go,{size:16,style:{marginRight:"5px"}})," Print All"]}),r.jsxs("button",{onClick:W,className:"lab-inventory-button",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},title:"Share via WhatsApp",children:[r.jsx(sk,{size:16,style:{marginRight:"5px"}})," WhatsApp"]})]})]}),t&&r.jsxs("div",{className:"lab-inventory-card no-print",style:{marginTop:"20px"},children:[r.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:[r.jsx(Qo,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}})," Order Summary"]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"10px",fontSize:"0.95em"},children:[r.jsxs("div",{children:[r.jsx(cu,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),r.jsx("strong",{children:"Patient:"})," ",ce??"N/A"," (Token: ",se??"N/A",")"]}),r.jsxs("div",{children:[r.jsx(IS,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),r.jsx("strong",{children:"Order Date:"})," ",U?r.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"5px"},children:[r.jsx("input",{type:"datetime-local",value:$,onChange:Z=>z(Z.target.value),className:"lab-inventory-input",style:{padding:"2px 5px",fontSize:"0.9em",width:"auto"}}),r.jsx("button",{onClick:he,className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Save Date",children:r.jsx(Qx,{size:16,color:"green"})}),r.jsx("button",{onClick:()=>{if(L(!1),t.createdAt){const Z=new Date(t.createdAt),ue=new Date(Z.getTime()-Z.getTimezoneOffset()*6e4).toISOString().slice(0,16);z(ue)}},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Cancel",children:r.jsx(Qn,{size:16,color:"red"})})]}):r.jsxs(r.Fragment,{children:[Rd(new Date(t.createdAt),"PPpp"),r.jsx("button",{onClick:()=>L(!0),className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"0 4px",minWidth:"auto",marginLeft:"8px",verticalAlign:"middle",border:"none"},title:"Edit Date",children:r.jsx(Yv,{size:14})})]})]}),r.jsxs("div",{children:[r.jsx(IS,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),r.jsx("strong",{children:"Report Date:"})," ",F?r.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"5px"},children:[r.jsx("input",{type:"datetime-local",value:R,onChange:Z=>B(Z.target.value),className:"lab-inventory-input",style:{padding:"2px 5px",fontSize:"0.9em",width:"auto"}}),r.jsx("button",{onClick:A,className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Save Report Date",children:r.jsx(Qx,{size:16,color:"green"})}),r.jsx("button",{onClick:()=>{if(Q(!1),t.report_date){const Z=new Date(t.report_date),ue=new Date(Z.getTime()-Z.getTimezoneOffset()*6e4).toISOString().slice(0,16);B(ue)}else{const Z=new Date,ue=new Date(Z.getTime()-Z.getTimezoneOffset()*6e4).toISOString().slice(0,16);B(ue)}},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"2px",minWidth:"auto"},title:"Cancel",children:r.jsx(Qn,{size:16,color:"red"})})]}):r.jsxs(r.Fragment,{children:[t.report_date?Rd(new Date(t.report_date),"PPpp"):"Not Reported",r.jsx("button",{onClick:()=>Q(!0),className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"0 4px",minWidth:"auto",marginLeft:"8px",verticalAlign:"middle",border:"none"},title:"Edit Report Date",children:r.jsx(Yv,{size:14})})]})]}),r.jsxs("div",{style:{gridColumn:"1 / -1"},children:[r.jsx(KI,{size:15,style:{marginRight:"5px",verticalAlign:"middle"}}),r.jsx("strong",{children:"Tests:"})," ",(t.tests||[]).map(Z=>Z.name).join(", ")]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Status:"})," ",r.jsx("span",{className:Fee(t.status),children:Lee(t.status)})]})]})]}),r.jsxs("div",{className:"lab-inventory-form-group no-print",style:{marginTop:"20px"},children:[r.jsx("h3",{className:"lab-inventory-header",style:{fontSize:"1.2em",marginBottom:"10px"},children:"Report Parameters"}),t==null?void 0:t.tests.map(Z=>{var ue;return r.jsxs("div",{className:"lab-inventory-card",style:{marginBottom:"15px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"10px"},children:[r.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em",margin:0},children:Z.name}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[r.jsxs("button",{type:"button",onClick:ae=>{ae.stopPropagation(),G(Z.id)},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"4px 8px",fontSize:"0.8em"},disabled:f,children:[r.jsx(Od,{size:14,style:{marginRight:"4px"}})," Save"]}),r.jsx("button",{type:"button",onClick:ae=>{ae.stopPropagation(),V(Z.id)},className:"lab-inventory-button lab-inventory-button-tertiary",style:{padding:"4px 8px",fontSize:"0.8em",marginLeft:"5px"},title:"Print This Test Only",children:r.jsx(Go,{size:14})})]})]}),r.jsx("div",{className:"test-parameters-body",style:{display:"block"},children:Z.default_parameters&&Z.default_parameters.length>0?r.jsx(r.Fragment,{children:r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{className:"lab-inventory-table",style:{marginTop:"10px",width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{backgroundColor:"#f9fafb"},children:[r.jsx("th",{style:{width:"25%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Parameter"}),r.jsx("th",{style:{width:"35%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Result"}),r.jsx("th",{style:{width:"15%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Units"}),r.jsx("th",{style:{width:"25%",padding:"10px",textAlign:"left",borderBottom:"1px solid #e5e7eb",color:"#6b7280",fontWeight:"600"},children:"Normal Range"})]})}),r.jsx("tbody",{children:Z.default_parameters.map(ae=>{var Re,Ae,Ce,Se,De,Me,et,ct,ut;return r.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[r.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#374151",fontWeight:"500"},children:r.jsx("label",{htmlFor:`${Z.id}-${ae.name}`,style:{cursor:"pointer"},children:ae.name})}),r.jsx("td",{style:{padding:"10px",verticalAlign:"middle"},children:ae.type==="boolean"?r.jsxs("select",{id:`${Z.id}-${ae.name}`,value:((Ae=(Re=a[Z.id])==null?void 0:Re[ae.name])==null?void 0:Ae.toString())??"false",onChange:at=>ne(Z.id,ae.name,at.target.value==="true"),className:"lab-inventory-input",disabled:f,style:{margin:0,width:"100%"},children:[r.jsx("option",{value:"true",children:"Reactive"}),r.jsx("option",{value:"false",children:"Non-Reactive"})]}):r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[r.jsx("input",{id:`${Z.id}-${ae.name}`,type:ae.type==="number"?"number":"text",value:((Ce=a[Z.id])==null?void 0:Ce[ae.name])!==void 0?(Se=a[Z.id])==null?void 0:Se[ae.name]:ae.defaultValue??"",onChange:at=>{const qt=ae.type==="number"&&at.target.value===""?"":at.target.value;ne(Z.id,ae.name,qt)},className:`lab-inventory-input ${ae.type==="number"&&((De=a[Z.id])==null?void 0:De[ae.name])!==""&&(ae.lower_limit!=null&&parseFloat((Me=a[Z.id])==null?void 0:Me[ae.name])<ae.lower_limit||ae.upper_limit!=null&&parseFloat((et=a[Z.id])==null?void 0:et[ae.name])>ae.upper_limit)?"abnormal-result":""}`,disabled:f||E_(ae.name)&&!((ct=T[Z.id])!=null&&ct[ae.name]),style:{margin:0,width:"100%"}}),E_(ae.name)&&r.jsx("button",{type:"button",onClick:()=>P(at=>{var qt;return{...at,[Z.id]:{...at[Z.id]||{},[ae.name]:!((qt=at[Z.id])!=null&&qt[ae.name])}}}),className:"lab-inventory-button lab-inventory-button-tertiary",style:{fontSize:"0.7em",padding:"4px 6px",height:"fit-content",whiteSpace:"nowrap"},disabled:f,title:(ut=T[Z.id])!=null&&ut[ae.name]?"Disable Manual Edit":"Edit Calculated Field",children:r.jsx(Yv,{size:12})})]})}),r.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#6b7280"},children:ae.unit||"-"}),r.jsx("td",{style:{padding:"10px",verticalAlign:"middle",color:"#6b7280",fontSize:"0.9em"},children:ae.type==="number"&&(ae.lower_limit!==null||ae.upper_limit!==null)?r.jsxs(r.Fragment,{children:[ae.lower_limit!==null&&ae.lower_limit!==void 0&&`> ${ae.lower_limit}`,ae.lower_limit!==null&&ae.lower_limit!==void 0&&ae.upper_limit!==null&&ae.upper_limit!==void 0&&" - ",ae.upper_limit!==null&&ae.upper_limit!==void 0&&`< ${ae.upper_limit}`]}):"-"})]},ae.name)})})]})})}):r.jsxs("div",{className:"lab-inventory-form-group",children:[r.jsx("label",{htmlFor:`${Z.id}-report_content`,children:"Report Content"}),r.jsx("textarea",{id:`${Z.id}-report_content`,value:((ue=a[Z.id])==null?void 0:ue.report_content)??"",onChange:ae=>ne(Z.id,"report_content",ae.target.value),className:"lab-inventory-input",rows:5,placeholder:`Enter report for ${Z.name}...`,disabled:f})]})})]},Z.id)}),p&&r.jsxs("p",{className:"error-text",style:{marginTop:"10px"},children:[r.jsx(Hi,{size:15,className:"inline mr-1"}),p]})]}),r.jsxs("div",{className:"no-print",style:{marginTop:"20px",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[" ",r.jsx("button",{type:"button",onClick:()=>n(-1),disabled:f,className:"lab-inventory-button lab-inventory-button-secondary",children:"Cancel"}),r.jsx("button",{type:"button",onClick:J,disabled:f,className:"lab-inventory-button",children:f?r.jsxs(r.Fragment,{children:[r.jsx(Ah,{className:"animate-spin mr-2",size:16})," Submitting..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Od,{size:16,style:{marginRight:"5px"}})," Submit Full Report"]})})]}),r.jsxs("div",{className:"printable-only",children:[t&&t.Patient&&r.jsxs("div",{style:{marginBottom:"20px",borderBottom:"1px solid #ccc",paddingBottom:"10px"},children:[r.jsx("h2",{style:{textAlign:"center",marginBottom:"15px"},children:"Lab Report"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",fontSize:"12px"},children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Patient Name:"})," ",t.Patient.name]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Age/Sex:"})," ",b??"N/A"," / ",S??"N/A"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Ref. Doctor:"})," ",t.uploaded_by||"N/A"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Date:"})," ",Rd(new Date,"PPpp")]})]})]}),t==null?void 0:t.tests.filter(Z=>M===null||Z.id===M).map(Z=>{var ue;return r.jsxs("div",{style:{marginBottom:"20px",pageBreakInside:"avoid"},children:[r.jsx("h3",{style:{borderBottom:"1px solid #eee",paddingBottom:"5px"},children:Z.name}),Z.default_parameters&&Z.default_parameters.length>0?r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{backgroundColor:"#f9f9f9"},children:[r.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Parameter"}),r.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Result"}),r.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Units"}),r.jsx("th",{style:{textAlign:"left",padding:"5px",borderBottom:"1px solid #ddd"},children:"Normal Range"})]})}),r.jsx("tbody",{children:Z.default_parameters.map(ae=>{var Me;const Re=(Me=a[Z.id])==null?void 0:Me[ae.name],Ae=typeof Re=="string"?parseFloat(Re):typeof Re=="number"?Re:NaN,Ce=ae.type==="number"&&!isNaN(Ae)&&Re!==""&&(ae.lower_limit!=null&&Ae<ae.lower_limit||ae.upper_limit!=null&&Ae>ae.upper_limit),Se=ae.type==="boolean"&&(Re===!0||Re==="true"),De=ae.type==="boolean"?Re===!0||Re==="true"?"Reactive":"Non-Reactive":Re??"";return r.jsxs("tr",{children:[r.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:ae.name}),r.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee",fontWeight:Ce||Se?"bold":"normal",color:Ce?"red":Se?"green":"inherit"},children:De}),r.jsx("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:ae.unit??""}),r.jsxs("td",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:[ae.lower_limit!==null&&ae.lower_limit!==void 0&&`> ${ae.lower_limit}`,ae.lower_limit!==null&&ae.lower_limit!==void 0&&ae.upper_limit!==null&&ae.upper_limit!==void 0&&" - ",ae.upper_limit!==null&&ae.upper_limit!==void 0&&`< ${ae.upper_limit}`]})]},ae.name)})})]}):r.jsx("div",{style:{whiteSpace:"pre-wrap",fontSize:"12px",padding:"10px"},children:((ue=a[Z.id])==null?void 0:ue.report_content)||"No report content entered."})]},Z.id)})]})]})})},Lee=e=>e?e.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()):"Unknown",Fee=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},$ee=()=>{const{orderId:e}=Br(),n=_t(),[t,i]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),f=w.useCallback(async p=>{if(!p){d("No Order ID specified in the URL."),o(!1),i(null);return}o(!0),d(null),i(null);try{console.log(`Fetching order details for ID: ${p}`);const g=await me(`/api/lab/orders/${p}/report`);if(!g.ok){let v;try{v=await g.json()}catch{v={message:`Server returned status ${g.status}`}}throw console.error("Fetch order details error response:",v),new Error(v.message||`Failed to fetch order details: ${g.status}`)}const b=await g.json();if(console.log("Received order data:",b),!b)throw console.error("Invalid order data structure:",b),new Error("Invalid order data received from server.");i(b)}catch(g){console.error("Error fetching order details:",g),d(g instanceof Error?g.message:"An unknown error occurred while fetching the order details")}finally{o(!1)}},[me]);w.useEffect(()=>{f(e)},[e,f]);const u=()=>{t&&_w(t)};return r.jsx("div",{className:"lab-inventory-container",children:r.jsxs("div",{className:"lab-inventory-card",children:[r.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:0,paddingBottom:0,borderBottom:"none"},children:[r.jsx("h2",{style:{margin:0,fontSize:"1.5em"},children:"Lab Report Viewer"})," ",r.jsxs("div",{style:{display:"flex",gap:"10px"},children:[r.jsxs(ls,{to:"/lab/search-report",className:"lab-inventory-button","aria-label":"Search for other reports",children:[r.jsx(os,{size:16,style:{marginRight:"5px"}}),"Search Reports"]}),r.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[r.jsx(rn,{size:16,style:{marginRight:"5px"}}),"Back"]}),r.jsxs("button",{onClick:()=>window.print(),className:"lab-inventory-button","aria-label":"Print report",children:[r.jsx(Go,{size:16,style:{marginRight:"5px"}}),"Print"]}),r.jsxs("button",{onClick:u,className:"lab-inventory-button","aria-label":"Share report via WhatsApp",style:{backgroundColor:"#25D366",borderColor:"#25D366",color:"white"},children:[r.jsx(sk,{size:16,style:{marginRight:"5px"}}),"WhatsApp"]})]})]}),r.jsxs("div",{style:{marginTop:"20px"},children:[r.jsxs("h3",{className:"lab-inventory-header",children:["Report Details (Order ID: ",e||"None Specified",")"]}),a&&r.jsx("div",{className:"loading-text",children:"Loading report..."}),l&&!a&&r.jsxs("div",{className:"error-message-container",style:{textAlign:"center"},children:[r.jsx(Hi,{size:48}),r.jsx("h3",{className:"error-title",children:"Error Loading Report"}),r.jsx("p",{children:l}),e&&r.jsx("button",{onClick:()=>f(e),className:"retry-button",children:"Retry"})]}),r.jsxs("div",{className:"printable-section",children:[!a&&!l&&(t==null?void 0:t.Patient)&&r.jsxs("div",{className:"lab-inventory-card",style:{marginBottom:"20px"},children:[r.jsxs("h3",{className:"lab-inventory-header",children:[r.jsx(cu,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Patient Information"]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"10px",fontSize:"0.9em"},children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Name:"})," ",t.Patient.name||"N/A"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Age:"})," ",t.Patient.age??"N/A"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Gender:"})," ",t.Patient.gender||"N/A"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Token No:"})," ",t.Patient.patient_token_number||"N/A"]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Patient ID:"})," ",t.Patient.id]}),t.Patient.phone&&r.jsxs("div",{children:[r.jsx("strong",{children:"Phone:"})," ",t.Patient.phone]})]})]}),!a&&!l&&(t==null?void 0:t.report_content)&&r.jsxs("div",{className:"lab-inventory-card",children:[r.jsxs("h3",{className:"lab-inventory-header",children:[r.jsx(su,{size:16,style:{marginRight:"8px",verticalAlign:"middle"}})," Report Findings"]}),r.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6"},children:(()=>{try{const p=JSON.parse(t.report_content||"{}");return typeof p=="object"&&p!==null&&t.tests?t.tests.map(g=>r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsx("h4",{className:"lab-inventory-header",style:{fontSize:"1.1em"},children:g.name}),p[g.id]?r.jsxs("table",{className:"lab-inventory-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Parameter"}),r.jsx("th",{children:"Value"}),r.jsx("th",{children:"Normal Range"})]})}),r.jsx("tbody",{children:Object.entries(p[g.id]).map(([b,v])=>{var I;const S=(I=g.default_parameters)==null?void 0:I.find(U=>U.name===b),k=typeof v=="string"?parseFloat(v):typeof v=="number"?v:NaN,T=(S==null?void 0:S.type)==="number"&&!isNaN(k)&&(S.lower_limit!=null&&k<S.lower_limit||S.upper_limit!=null&&k>S.upper_limit),P=(S==null?void 0:S.type)==="boolean"?v===!0||v==="true"?"Reactive":"Non-Reactive":String(v),M=(S==null?void 0:S.type)==="boolean"&&(v===!0||v==="true");return r.jsxs("tr",{children:[r.jsx("td",{children:b}),r.jsxs("td",{className:`${T?"abnormal-result":""} ${M?"reactive-result":""}`,children:[P," ",S==null?void 0:S.unit]}),r.jsx("td",{children:S&&S.type==="number"&&(S.lower_limit!==null||S.upper_limit!==null)?r.jsxs(r.Fragment,{children:[S.lower_limit!=null&&` > ${S.lower_limit}`,S.lower_limit!=null&&S.upper_limit!=null&&" - ",S.upper_limit!=null&&` < ${S.upper_limit}`,S.unit&&` ${S.unit}`]}):((S==null?void 0:S.type)==="boolean","N/A")})]},b)})})]}):r.jsx("p",{children:"No parameters reported for this test."})]},g.id)):r.jsx(Yo,{remarkPlugins:[zs],children:t.report_content})}catch{return r.jsx(Yo,{remarkPlugins:[zs],children:t.report_content||"*No findings recorded.*"})}})()})]})]}),!a&&!l&&!(t!=null&&t.report_content)&&!(t!=null&&t.Patient)&&e&&r.jsxs("div",{className:"no-data-message",children:["No report content or patient details found for Order ID: ",e,". The order might be processing, does not exist, or the ID is incorrect."]}),!e&&!a&&!l&&r.jsxs("div",{className:"no-data-message",children:["No order ID specified in the URL.",r.jsx(ls,{to:"/lab/search-report",className:"lab-inventory-link",style:{display:"block",marginTop:"10px"},children:"Go to Search Page"})]})]})]})})},zee=()=>{const e=_t(),[n,t]=w.useState(""),[i,a]=w.useState(!1),[o,l]=w.useState([]),[d,f]=w.useState(null),[u,p]=w.useState(n);w.useEffect(()=>{const k=setTimeout(()=>{p(n)},500);return()=>{clearTimeout(k)}},[n]),w.useEffect(()=>{g()},[u]);const g=async()=>{const k=n.trim();if(!k){l([]),f(null);return}a(!0),f(null),l([]),console.log(`Searching for: ${k}`);try{const T=await me("/api/lab");if(!T.ok){let $;try{$=await T.json()}catch{$={message:`Server returned status ${T.status}`}}throw console.error("Search fetch error response:",$),new Error($.message||`HTTP error! status: ${T.status}`)}const{orders:P}=await T.json();console.log("Received lab orders for search:",P);const I=P.filter($=>!!$.report_content).map($=>{var z,F;return{id:$.id,labTokenNumber:String($.lab_token_number??"N/A"),patientName:((z=$.Patient)==null?void 0:z.name)||"N/A",patientId:$.patient_id,patientTokenNumber:String(((F=$.Patient)==null?void 0:F.patient_token_number)??"N/A"),tests:($.tests||[]).map(Q=>Q.name||"Unknown Test"),date:Rd(new Date($.createdAt),"yyyy-MM-dd"),status:$.status}}),U=n.toLowerCase(),L=I.filter($=>{var Q,R,B,Y,re;const z=String($.labTokenNumber).toLowerCase(),F=String($.patientTokenNumber).toLowerCase();return(((Q=$.patientName)==null?void 0:Q.toLowerCase())||"").includes(U)||z.includes(U)||F.includes(U)||(((B=(R=$.tests)==null?void 0:R.join(" "))==null?void 0:B.toLowerCase())||"").includes(U)||(((Y=$.id)==null?void 0:Y.toLowerCase())||"").includes(U)||(((re=$.patientId)==null?void 0:re.toLowerCase())||"").includes(U)});console.log("Filtered search results:",L),l(L),L.length===0&&k?f(`No matching reports found for "${k}".`):f(null)}catch(T){console.error("Failed to search lab reports:",T),f(T instanceof Error?T.message:"An unknown error occurred during search")}finally{a(!1)}},b=k=>{console.log(`Result clicked, navigating to view report for order ID: ${k}`),e(`/lab/view-report/${k}`)},v=k=>{switch(k){case"pending":return{text:"Sample Pending",color:"text-red-600 bg-red-100"};case"collected":return{text:"Sample Collected",color:"text-yellow-600 bg-yellow-100"};case"processing":return{text:"Processing",color:"text-blue-600 bg-blue-100"};case"completed":return{text:"Completed",color:"text-green-600 bg-green-100"};case"cancelled":return{text:"Cancelled",color:"text-gray-600 bg-gray-100 line-through"};case"reported":return{text:"Reported",color:"text-purple-600 bg-purple-100"};default:return{text:k,color:"text-gray-600 bg-gray-100"}}},S=k=>{switch(k){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}};return r.jsx("div",{className:"lab-inventory-container",children:r.jsxs("div",{className:"lab-inventory-card",children:[r.jsxs("div",{className:"lab-inventory-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h2",{style:{margin:0},children:"Search Lab Reports"}),r.jsxs("button",{onClick:()=>e(-1),className:"lab-inventory-button lab-inventory-button-secondary","aria-label":"Go back",children:[r.jsx(rn,{size:16,style:{marginRight:"5px"}}),"Back"]})]}),r.jsxs("div",{className:"lab-inventory-form-group",style:{marginTop:"20px",position:"relative"},children:[r.jsx("label",{htmlFor:"report-search",children:"Enter Search Term"}),r.jsxs("div",{style:{display:"flex",alignItems:"center",position:"relative"},children:[r.jsx(os,{size:20,style:{position:"absolute",left:"10px",color:"#777"}}),r.jsx("input",{id:"report-search",type:"text",placeholder:"Patient name, ID, token, report ID, test name...",value:n,onChange:k=>t(k.target.value),className:"lab-inventory-input",style:{paddingLeft:"40px",marginBottom:"0"}})]})]}),r.jsxs("div",{style:{marginTop:"20px"},children:[i&&r.jsx("div",{className:"loading-text",children:"Searching..."}),d&&!i&&r.jsxs("div",{className:"error-text",children:[r.jsx(Hi,{size:20,className:"inline mr-2"})," ",d]}),o.length>0&&!i&&r.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:o.map(k=>r.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(k.id),style:{marginBottom:"15px",cursor:"pointer",padding:"15px"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[r.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:[r.jsx(AI,{size:18,style:{marginRight:"8px",verticalAlign:"middle"}}),k.patientName," (Token: ",k.patientTokenNumber,")"]}),r.jsx("span",{className:S(k.status),children:v(k.status).text})]}),r.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:[r.jsxs("div",{style:{marginBottom:"5px"},children:[r.jsx(su,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Order ID: ",k.id]}),r.jsxs("div",{style:{marginBottom:"5px"},children:[r.jsx(BR,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Tests: ",k.tests.join(", ")]}),r.jsxs("div",{children:[r.jsx(yI,{size:16,style:{marginRight:"5px",verticalAlign:"middle"}}),"Date: ",k.date]})]})]},k.id))}),!i&&o.length===0&&!d&&n.trim()&&r.jsxs("div",{className:"no-data-message",children:['No results found for "',n,'".']}),!i&&o.length===0&&!d&&!n.trim()&&r.jsx("div",{className:"no-data-message",style:{backgroundColor:"transparent",border:"none",textAlign:"left",padding:"5px 0"},children:"Enter a search term above to find lab reports."})]})]})})},Uee=()=>{const{patientId:e}=Br(),n=_t(),[t,i]=w.useState([]),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(null),[p,g]=w.useState(null);w.useEffect(()=>{(async()=>{if(!e){d("Patient ID is missing from the URL."),o(!1);return}o(!0),d(null),i([]),g(null);try{const S=await me(`/api/patients/${e}`);if(S.ok){const P=await S.json();g(P.name||`Patient ID: ${e}`)}else console.warn(`Failed to fetch patient name for ID ${e}`),g(`Patient ID: ${e}`);const k=await me(`/api/lab/patient/${e}`);if(!k.ok){const P=await k.json().catch(()=>({}));throw new Error(P.message||`HTTP error! status: ${k.status}`)}const T=await k.json();i(T||[])}catch(S){console.error("Error fetching data:",S),d(`Failed to load data: ${S.message}`)}finally{o(!1)}})()},[e]);const b=v=>{v.report_content?n(`/lab/view-report/${v.id}`):n(`/lab/enter-report/${v.id}`)};return r.jsx("div",{className:"lab-inventory-container",children:r.jsxs("div",{className:"lab-inventory-card",children:[r.jsxs("div",{className:"lab-inventory-header no-print",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("h2",{style:{margin:0},children:["Lab Reports ",p?`for ${p}`:`for Patient ID: ${e}`]}),r.jsxs("div",{style:{display:"flex",gap:"10px"},children:[r.jsxs("button",{onClick:async()=>{if(!e){alert("Patient ID is missing. Cannot create a new report.");return}try{const v=await me("/api/lab/create-empty-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:e})});if(!v.ok){const k=await v.json().catch(()=>({message:`Failed to create new lab order: ${v.status}`}));throw new Error(k.message||`Failed to create new lab order: ${v.status}`)}const S=await v.json();n(`/lab/enter-report/${S.newOrderId}`)}catch(v){console.error("Error creating new lab order:",v),alert(`Error creating new lab order: ${v.message}`)}},className:"lab-inventory-button",disabled:!e,title:e?"Enter a new lab report for this patient":"Patient ID missing",children:[r.jsx(ss,{size:16,style:{marginRight:"5px"}}),"Enter New Report"]}),r.jsxs("button",{onClick:()=>n(-1),className:"lab-inventory-button lab-inventory-button-secondary",children:[r.jsx(rn,{size:16,style:{marginRight:"5px"}}),"Back"]})]})]}),r.jsx("div",{style:{marginTop:"20px"},children:a?r.jsxs("div",{className:"loading-text",children:[r.jsx(Ah,{className:"animate-spin h-8 w-8 inline mr-2"}),"Loading reports..."]}):l?r.jsxs("div",{className:"error-text",style:{textAlign:"center",padding:"20px"},children:[r.jsx(HR,{size:40,style:{marginBottom:"10px",color:"#721c24"}}),r.jsx("h3",{style:{fontSize:"1.2em",color:"#721c24",margin:"10px 0"},children:"Error Loading Reports"}),r.jsx("p",{children:l})]}):t.length===0?r.jsxs("div",{className:"no-data-message",style:{textAlign:"center",padding:"30px"},children:[r.jsx(su,{size:48,className:"mb-3",style:{margin:"0 auto 15px auto",display:"block"}}),r.jsx("p",{children:"No lab reports found for this patient."}),r.jsxs("p",{children:["You can ",r.jsx(ls,{to:`/lab/create-order/${e}`,className:"lab-inventory-link",children:"create a new lab order"}),"."]})]}):f?r.jsxs("div",{className:"lab-inventory-card",style:{backgroundColor:"#fdfdfd"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[r.jsxs("h3",{className:"lab-inventory-header",style:{fontSize:"1.3em",borderBottom:"none",margin:0},children:["Report from: ",f.report_date?Rd(new Date(f.report_date),"PPP p"):"N/A"]}),r.jsxs("button",{onClick:()=>u(null),className:"lab-inventory-button lab-inventory-button-secondary",style:{fontSize:"0.9em",padding:"8px 12px"},children:[r.jsx(rn,{size:16,style:{marginRight:"5px"}})," Back to List"]})]}),r.jsxs("p",{style:{marginBottom:"15px",fontSize:"1em"},children:[r.jsx("strong",{children:"Tests Ordered:"})," ",(f.tests||[]).map(v=>v.name).join(", ")]}),r.jsx("div",{className:"report-markdown-content",style:{fontSize:"1em",lineHeight:"1.6",border:"1px solid #eee",padding:"15px",borderRadius:"4px",background:"#fff"},children:r.jsx(Yo,{remarkPlugins:[zs],children:f.report_content||"*No findings recorded.*"})})]}):r.jsx("ul",{style:{listStyle:"none",padding:"0",margin:"0"},children:t.map(v=>r.jsxs("li",{className:"lab-inventory-card",onClick:()=>b(v),tabIndex:0,onKeyPress:S=>S.key==="Enter"&&b(v),style:{marginBottom:"15px",cursor:"pointer",padding:"15px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[r.jsx(su,{size:24,style:{marginRight:"15px",color:"#007bff"}}),r.jsxs("div",{children:[r.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1em"},children:["Order Date: ",Rd(new Date(v.createdAt),"PPP")]}),r.jsxs("div",{style:{fontSize:"0.9em",color:"#555"},children:["Tests: ",v.tests&&v.tests.length>0?v.tests.map(S=>S.name).join(", "):"N/A"]})]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[v.status&&r.jsx("span",{className:qee(v.status),children:Bee(v.status)}),r.jsx($h,{size:20,style:{color:"#6c757d"}})]})]},v.id))})})]})})},Bee=e=>{if(!e)return"Unknown";switch(e.toLowerCase()){case"pending":return"Pending Sample";case"collected":return"Sample Collected";case"processing":return"Processing";case"report_ready":return"Report Ready";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return e.charAt(0).toUpperCase()+e.slice(1)}},qee=e=>{if(!e)return"status-badge";switch(e.toLowerCase()){case"pending":return"status-badge status-pending";case"collected":return"status-badge status-collected";case"processing":return"status-badge status-processing";case"completed":return"status-badge status-completed";case"cancelled":return"status-badge status-cancelled";case"reported":return"status-badge status-reported";default:return"status-badge"}},pA=()=>{const e=_t(),[n,t]=w.useState("pharmacy");return r.jsxs("div",{className:"inventory-management-container",style:{padding:"20px",backgroundColor:"var(--background-color)",minHeight:"100vh"},children:[r.jsxs("div",{className:"inventory-header",style:{marginBottom:"20px",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"15px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[r.jsx("button",{onClick:()=>e(-1),className:"action-icon-button",title:"Go Back",style:{background:"none",border:"none",cursor:"pointer",color:"var(--text-primary)"},children:r.jsx(rn,{size:24})}),r.jsx("h1",{style:{margin:0,fontSize:"1.8rem",fontWeight:"700",color:"var(--text-primary)"},children:"Inventory Management"})]}),r.jsxs("div",{className:"inventory-tabs",style:{display:"flex",gap:"5px",backgroundColor:"var(--card-bg, #f3f4f6)",padding:"5px",borderRadius:"12px",border:"1px solid var(--border-color, #e5e7eb)"},children:[r.jsxs("button",{onClick:()=>t("pharmacy"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 24px",border:"1px solid",borderColor:n==="pharmacy"?"var(--primary-color-20, #e0e7ff)":"transparent",borderRadius:"8px",backgroundColor:n==="pharmacy"?"var(--card-bg-active, #fff)":"transparent",boxShadow:n==="pharmacy"?"0 2px 4px rgba(0,0,0,0.05)":"none",color:n==="pharmacy"?"var(--primary-color)":"var(--text-secondary, #6b7280)",fontWeight:n==="pharmacy"?"600":"500",cursor:"pointer",transition:"all 0.2s ease",fontSize:"0.95rem"},children:[r.jsx(ig,{size:18}),"Pharmacy Stock"]}),r.jsxs("button",{onClick:()=>t("lab"),style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 24px",border:"1px solid",borderColor:n==="lab"?"var(--primary-color-20, #e0e7ff)":"transparent",borderRadius:"8px",backgroundColor:n==="lab"?"var(--card-bg-active, #fff)":"transparent",boxShadow:n==="lab"?"0 2px 4px rgba(0,0,0,0.05)":"none",color:n==="lab"?"var(--primary-color)":"var(--text-secondary, #6b7280)",fontWeight:n==="lab"?"600":"500",cursor:"pointer",transition:"all 0.2s ease",fontSize:"0.95rem"},children:[r.jsx(Yl,{size:18}),"Lab Stock"]})]})]}),r.jsx("div",{className:"inventory-content",style:{backgroundColor:"var(--card-bg, #fff)",borderRadius:"16px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",overflow:"hidden"},children:n==="pharmacy"?r.jsx(iT,{isEmbedded:!0}):r.jsx(jw,{isEmbedded:!0})})]})},Vee=({fetchWithAuth:e})=>{const n=_t(),[t,i]=w.useState(!0),[a,o]=w.useState([]),[l,d]=w.useState(null),[f,u]=w.useState(null),p=w.useCallback(async()=>{i(!0),d(null);try{const S=await(await e("/staff")).json();o(S.map(k=>({...k,id:k._id||k.id})))}catch(v){d(`Failed to load staff data: ${v.message}`),o([])}finally{i(!1)}},[e]);w.useEffect(()=>{p()},[p]),w.useEffect(()=>{if(f){const v=setTimeout(()=>u(null),5e3);return()=>clearTimeout(v)}},[f]);const g=v=>{switch(v){case"doctor":return"admin-pill-info";case"receptionist":return"admin-pill-success";case"pharmacy":return"admin-pill-primary";case"lab":return"admin-pill-warning";case"admin":return"admin-pill-neutral";default:return"admin-pill-neutral"}},b=v=>{switch(v){case"doctor":return r.jsx(ok,{size:16,className:"mr-2 text-blue-600"});case"receptionist":return r.jsx(ow,{size:16,className:"mr-2 text-green-600"});case"pharmacy":return r.jsx(ig,{size:16,className:"mr-2 text-purple-600"});case"lab":return r.jsx(Yl,{size:16,className:"mr-2 text-yellow-600"});case"admin":return r.jsx(Sb,{size:16,className:"mr-2 text-teal-600"});default:return r.jsx(zh,{size:16,className:"mr-2 text-gray-500"})}};return t?r.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsxs("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:[" ",r.jsx("div",{className:"breathing-ball",style:{width:"30px",height:"30px"}})," "]}),r.jsx("div",{className:"mt-4 text-teal-600 text-xl font-medium",children:"Loading Staff..."})]})}):r.jsxs("div",{className:"staff-page-container",children:[f&&r.jsxs("div",{className:`mb-4 p-3 rounded-md flex items-center ${f.type==="success"?"bg-green-100 border border-green-400 text-green-700":"bg-red-100 border border-red-400 text-red-700"}`,role:"alert",children:[f.type==="success"?r.jsx(cs,{size:18,className:"mr-2"}):r.jsx(Hi,{size:18,className:"mr-2"}),r.jsx("span",{children:f.message}),r.jsx("button",{onClick:()=>u(null),className:"ml-auto text-xl font-bold",children:""})]}),l&&r.jsxs("div",{className:"error-message mb-4 p-3 bg-red-100 border border-red-400 rounded-md flex items-center",role:"alert",children:[r.jsx(Hi,{size:18,className:"mr-2 text-red-500"}),l,r.jsx("button",{onClick:()=>d(null),className:"ml-auto text-red-600 hover:text-red-800 text-xl font-bold",children:""})]}),r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("button",{onClick:()=>n(-1),className:"p-2 rounded-md hover:bg-gray-200",children:r.jsx(rn,{size:20})}),r.jsx("h1",{className:"text-2xl font-bold",children:"Manage Staff"})]}),r.jsxs("button",{onClick:()=>n("/dashboard/staff/add"),className:"bg-teal-600 text-white px-4 py-2 rounded-md hover:bg-teal-700 flex items-center",children:[r.jsx(ou,{size:16,className:"mr-2"})," Add New Staff"]})]}),r.jsx("div",{className:"staff-table-container",children:r.jsxs("table",{className:"staff-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Name"}),r.jsx("th",{className:"hidden md:table-cell",children:"Email"}),r.jsx("th",{children:"Role"}),r.jsx("th",{className:"hidden md:table-cell",children:"OPD Fee ()"}),r.jsx("th",{className:"hidden md:table-cell",children:"Status"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:a.length===0&&!t?r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"text-center py-4",children:"No staff members found."})}):a.map(v=>r.jsxs("tr",{children:[r.jsx("td",{children:v.name}),r.jsx("td",{className:"hidden md:table-cell",children:v.email}),r.jsx("td",{children:r.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g(v.role)}`,children:[b(v.role),v.role.charAt(0).toUpperCase()+v.role.slice(1)]})}),r.jsx("td",{className:"hidden md:table-cell",children:v.role==="doctor"?v.opd_fee?parseFloat(String(v.opd_fee)).toFixed(2):"Not Set":"N/A"}),r.jsx("td",{className:"hidden md:table-cell",children:r.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${v.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.status==="active"?"Active":"Inactive"})}),r.jsx("td",{className:"actions",children:r.jsxs("button",{onClick:()=>n(`/dashboard/staff/edit/${v.id}`),className:"edit-link",disabled:v.role==="admin",title:"Edit Staff",children:[r.jsx(lu,{size:16})," Edit"]})})]},v.id))})]})})]})},Hee=()=>{var k,T,P,M,I,U,L,$,z,F,Q,R,B,Y;const{patientId:e,billId:n}=Br(),t=_t(),[i,a]=w.useState(null),[o,l]=w.useState(!0),[d,f]=w.useState(null),[u,p]=w.useState(""),[g,b]=w.useState("cash"),v=((k=i==null?void 0:i.patient)==null?void 0:k.insurance_type)==="no_cash_insurance";w.useEffect(()=>{b(v?"no_cash_insurance":"cash")},[v]),w.useEffect(()=>{n?(async()=>{l(!0),f(null);try{const ne=await me(`/api/bills/${n}`);if(!ne.ok)throw new Error(`HTTP error! status: ${ne.status}`);const G=await ne.json();if(!G||!G.bill||!G.calculated)throw new Error("Incomplete data structure received from backend (missing bill or calculated fields).");if(G.bill.type!=="admission")throw console.error("Fetched bill is not an admission bill. Bill Type:",G.bill.type),new Error(`Unexpected bill type received: ${G.bill.type}. Expected 'admission'.`);console.log("Raw API data received:",JSON.stringify(G,null,2));const V=Array.isArray(G.admissionPayments)?G.admissionPayments:[];console.log("Processed admissionPaymentsData:",V);const W={...G.bill,amount:G.bill.amount,AdmissionPayments:V,calculated:G.calculated,patient:G.bill.Patient?{id:G.bill.Patient.id,name:G.bill.Patient.name,admission_date:G.bill.Patient.admission_date,discharge_date:G.bill.Patient.discharge_date}:void 0};console.log("Setting billDetails state to:",JSON.stringify(W,null,2)),a(W)}catch(ne){console.error("Failed to fetch admission bill details:",ne),f(ne instanceof Error?ne.message:"An unknown error occurred")}finally{l(!1)}})():(f("Bill ID is missing."),l(!1))},[n,e]);const S=async re=>{var ne;if(re.preventDefault(),!e||!u||isNaN(parseFloat(u))||parseFloat(u)<=0||parseFloat(u)>(((ne=i==null?void 0:i.calculated)==null?void 0:ne.balance)??0)){f("Please enter a valid payment amount within the balance due. Patient ID must be present.");return}f(null);try{const G=await me(`/api/patients/${e}/admission-payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount_paid:parseFloat(u),payment_mode:g})});if(!G.ok){const J=await G.json();throw new Error(J.message||`HTTP error! status: ${G.status}`)}const W=await(await me(`/api/bills/${n}`)).json();if(W&&W.bill&&W.calculated&&W.admissionPayments)a({...W.bill,amount:parseFloat(W.bill.amount),AdmissionPayments:W.admissionPayments,calculated:W.calculated,patient:W.bill.Patient?{id:W.bill.Patient.id,name:W.bill.Patient.name,admission_date:W.bill.Patient.admission_date,discharge_date:W.bill.Patient.discharge_date}:void 0});else throw new Error("Invalid data structure received after payment submission.");p("")}catch(G){console.error("Failed to submit payment:",G),f(G instanceof Error?G.message:"Failed to record payment")}};return o?r.jsx("div",{className:"p-4",children:"Loading admission bill details..."}):d?r.jsxs("div",{className:"p-4 text-red-600",children:["Error: ",d]}):!i||!i.calculated?r.jsx("div",{className:"p-4",children:"No bill details found or data is incomplete."}):r.jsx("div",{className:"admission-page-container",children:r.jsxs("div",{className:"admission-section",children:[" ",r.jsxs("div",{className:"p-4 border-b",children:[" ",r.jsxs("h2",{className:"admission-header",children:["Admission Billing Details (Bill #",i.id,")"]}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Patient: ",((T=i.patient)==null?void 0:T.name)??"N/A"," (ID: ",i.patient_id,")"]})," ",r.jsxs("p",{className:"text-sm text-gray-600",children:["Admission Date: ",(P=i.patient)!=null&&P.admission_date?new Date(i.patient.admission_date).toLocaleDateString():"N/A"]}),((M=i.patient)==null?void 0:M.discharge_date)&&r.jsxs("p",{className:"text-sm text-gray-600",children:["Discharge Date: ",new Date(i.patient.discharge_date).toLocaleDateString()]}),r.jsxs("p",{className:"text-sm",children:["Status: ",r.jsx("span",{className:`font-semibold ${i.status==="paid"?"text-green-600":"text-orange-600"}`,children:((I=i.status)==null?void 0:I.toUpperCase())??"UNKNOWN"})]})]}),r.jsxs("div",{className:"p-4",children:[" ",r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[r.jsxs("div",{className:"admission-card",children:[r.jsx("h3",{className:"admission-card-title",children:"Billing Summary"}),r.jsxs("div",{className:"admission-card-content",children:[r.jsxs("p",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Initial Charges:"})," ",r.jsxs("span",{children:["",(parseFloat((i==null?void 0:i.amount)||"0")||0).toFixed(2)]})]}),r.jsxs("p",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Days Stayed:"})," ",r.jsx("span",{children:((U=i==null?void 0:i.calculated)==null?void 0:U.daysStayed)??0})]}),r.jsxs("p",{className:"flex justify-between text-sm font-semibold mt-2 pt-2 border-t",children:[r.jsx("span",{children:"Total Due:"})," ",r.jsxs("span",{children:["",(Number((L=i==null?void 0:i.calculated)==null?void 0:L.totalDue)||0).toFixed(2)]})]}),r.jsxs("p",{className:"flex justify-between text-sm text-green-700",children:[r.jsx("span",{children:"Total Paid:"})," ",r.jsxs("span",{children:["",(Number(($=i==null?void 0:i.calculated)==null?void 0:$.totalPaid)||0).toFixed(2)]})]}),r.jsxs("p",{className:"flex justify-between text-lg font-bold mt-1 text-red-600",children:[r.jsx("span",{children:"Balance Due:"})," ",r.jsxs("span",{children:["",(Number((z=i==null?void 0:i.calculated)==null?void 0:z.balance)||0).toFixed(2)]})]})]})]}),(i==null?void 0:i.status)!=="paid"&&(Number((F=i==null?void 0:i.calculated)==null?void 0:F.balance)||0)>0&&r.jsxs("div",{className:"admission-card",children:[r.jsx("h3",{className:"admission-card-title text-blue-800",children:"Record New Payment"}),r.jsxs("form",{onSubmit:S,className:"space-y-4",children:[r.jsxs("div",{className:"admission-form-group",children:[r.jsx("label",{htmlFor:"paymentAmount",className:"admission-label",children:"Amount Paid ()"}),r.jsx("input",{id:"paymentAmount",type:"number",value:u,onChange:re=>p(re.target.value),placeholder:`Max ${(Number((Q=i==null?void 0:i.calculated)==null?void 0:Q.balance)||0).toFixed(2)}`,required:!0,min:"0.01",step:"0.01",max:Number((R=i==null?void 0:i.calculated)==null?void 0:R.balance)||0,className:"admission-input"})]}),r.jsxs("div",{className:"admission-form-group",children:[r.jsx("label",{htmlFor:"paymentMode",className:"admission-label",children:"Payment Mode"}),r.jsxs("select",{id:"paymentMode",value:g,onChange:re=>b(re.target.value),className:"admission-select",children:[r.jsx("option",{value:"cash",children:"Cash"}),r.jsx("option",{value:"card",children:"Card"}),r.jsx("option",{value:"upi",children:"UPI"}),v&&r.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"})]})]}),r.jsx("button",{type:"submit",className:"admission-button",disabled:o||!u||parseFloat(u)<=0||parseFloat(u)>(Number((B=i==null?void 0:i.calculated)==null?void 0:B.balance)||0)||v&&g!=="no_cash_insurance",children:"Record Payment"})]})]})]}),r.jsx("h3",{className:"admission-section-title mt-6 border-t pt-4",children:"Admission Payment History"}),Array.isArray(i==null?void 0:i.AdmissionPayments)&&i.AdmissionPayments.length>0?r.jsxs("div",{className:"overflow-x-auto",children:[" ",r.jsxs("table",{className:"admission-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Payment ID"}),r.jsx("th",{children:"Date"}),r.jsx("th",{children:"Amount Paid"}),r.jsx("th",{children:"Mode"})]})}),r.jsx("tbody",{children:(Y=i==null?void 0:i.AdmissionPayments)==null?void 0:Y.map(re=>{if(!re||typeof re!="object")return null;let ne="Invalid Date";try{re.payment_date&&!isNaN(new Date(re.payment_date).getTime())&&(ne=new Date(re.payment_date).toLocaleString())}catch(G){console.error("Error formatting payment date:",re.payment_date,G)}return r.jsxs("tr",{children:[" ",r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:re.id??"N/A"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:ne}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["",(Number(re.amount_paid)||0).toFixed(2)]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:re.payment_mode??"N/A"})]},re.id??Math.random())})})]})]}):r.jsx("p",{className:"text-gray-500 text-sm",children:"No payments recorded yet."})]}),r.jsxs("div",{className:"p-4 border-t bg-gray-50 text-right",children:[" ",r.jsx("button",{type:"button",onClick:()=>t(-1),className:"admission-button admission-button-secondary",children:"Back"})]})]})})};var Gee=Object.defineProperty,xb=Object.getOwnPropertySymbols,mA=Object.prototype.hasOwnProperty,gA=Object.prototype.propertyIsEnumerable,P_=(e,n,t)=>n in e?Gee(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,J1=(e,n)=>{for(var t in n||(n={}))mA.call(n,t)&&P_(e,t,n[t]);if(xb)for(var t of xb(n))gA.call(n,t)&&P_(e,t,n[t]);return e},K1=(e,n)=>{var t={};for(var i in e)mA.call(e,i)&&n.indexOf(i)<0&&(t[i]=e[i]);if(e!=null&&xb)for(var i of xb(e))n.indexOf(i)<0&&gA.call(e,i)&&(t[i]=e[i]);return t};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var zd;(e=>{const n=class dn{constructor(f,u,p,g){if(this.version=f,this.errorCorrectionLevel=u,this.modules=[],this.isFunction=[],f<dn.MIN_VERSION||f>dn.MAX_VERSION)throw new RangeError("Version value out of range");if(g<-1||g>7)throw new RangeError("Mask value out of range");this.size=f*4+17;let b=[];for(let S=0;S<this.size;S++)b.push(!1);for(let S=0;S<this.size;S++)this.modules.push(b.slice()),this.isFunction.push(b.slice());this.drawFunctionPatterns();const v=this.addEccAndInterleave(p);if(this.drawCodewords(v),g==-1){let S=1e9;for(let k=0;k<8;k++){this.applyMask(k),this.drawFormatBits(k);const T=this.getPenaltyScore();T<S&&(g=k,S=T),this.applyMask(k)}}a(0<=g&&g<=7),this.mask=g,this.applyMask(g),this.drawFormatBits(g),this.isFunction=[]}static encodeText(f,u){const p=e.QrSegment.makeSegments(f);return dn.encodeSegments(p,u)}static encodeBinary(f,u){const p=e.QrSegment.makeBytes(f);return dn.encodeSegments([p],u)}static encodeSegments(f,u,p=1,g=40,b=-1,v=!0){if(!(dn.MIN_VERSION<=p&&p<=g&&g<=dn.MAX_VERSION)||b<-1||b>7)throw new RangeError("Invalid value");let S,k;for(S=p;;S++){const I=dn.getNumDataCodewords(S,u)*8,U=l.getTotalBits(f,S);if(U<=I){k=U;break}if(S>=g)throw new RangeError("Data too long")}for(const I of[dn.Ecc.MEDIUM,dn.Ecc.QUARTILE,dn.Ecc.HIGH])v&&k<=dn.getNumDataCodewords(S,I)*8&&(u=I);let T=[];for(const I of f){t(I.mode.modeBits,4,T),t(I.numChars,I.mode.numCharCountBits(S),T);for(const U of I.getData())T.push(U)}a(T.length==k);const P=dn.getNumDataCodewords(S,u)*8;a(T.length<=P),t(0,Math.min(4,P-T.length),T),t(0,(8-T.length%8)%8,T),a(T.length%8==0);for(let I=236;T.length<P;I^=253)t(I,8,T);let M=[];for(;M.length*8<T.length;)M.push(0);return T.forEach((I,U)=>M[U>>>3]|=I<<7-(U&7)),new dn(S,u,M,b)}getModule(f,u){return 0<=f&&f<this.size&&0<=u&&u<this.size&&this.modules[u][f]}getModules(){return this.modules}drawFunctionPatterns(){for(let p=0;p<this.size;p++)this.setFunctionModule(6,p,p%2==0),this.setFunctionModule(p,6,p%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const f=this.getAlignmentPatternPositions(),u=f.length;for(let p=0;p<u;p++)for(let g=0;g<u;g++)p==0&&g==0||p==0&&g==u-1||p==u-1&&g==0||this.drawAlignmentPattern(f[p],f[g]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(f){const u=this.errorCorrectionLevel.formatBits<<3|f;let p=u;for(let b=0;b<10;b++)p=p<<1^(p>>>9)*1335;const g=(u<<10|p)^21522;a(g>>>15==0);for(let b=0;b<=5;b++)this.setFunctionModule(8,b,i(g,b));this.setFunctionModule(8,7,i(g,6)),this.setFunctionModule(8,8,i(g,7)),this.setFunctionModule(7,8,i(g,8));for(let b=9;b<15;b++)this.setFunctionModule(14-b,8,i(g,b));for(let b=0;b<8;b++)this.setFunctionModule(this.size-1-b,8,i(g,b));for(let b=8;b<15;b++)this.setFunctionModule(8,this.size-15+b,i(g,b));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let f=this.version;for(let p=0;p<12;p++)f=f<<1^(f>>>11)*7973;const u=this.version<<12|f;a(u>>>18==0);for(let p=0;p<18;p++){const g=i(u,p),b=this.size-11+p%3,v=Math.floor(p/3);this.setFunctionModule(b,v,g),this.setFunctionModule(v,b,g)}}drawFinderPattern(f,u){for(let p=-4;p<=4;p++)for(let g=-4;g<=4;g++){const b=Math.max(Math.abs(g),Math.abs(p)),v=f+g,S=u+p;0<=v&&v<this.size&&0<=S&&S<this.size&&this.setFunctionModule(v,S,b!=2&&b!=4)}}drawAlignmentPattern(f,u){for(let p=-2;p<=2;p++)for(let g=-2;g<=2;g++)this.setFunctionModule(f+g,u+p,Math.max(Math.abs(g),Math.abs(p))!=1)}setFunctionModule(f,u,p){this.modules[u][f]=p,this.isFunction[u][f]=!0}addEccAndInterleave(f){const u=this.version,p=this.errorCorrectionLevel;if(f.length!=dn.getNumDataCodewords(u,p))throw new RangeError("Invalid argument");const g=dn.NUM_ERROR_CORRECTION_BLOCKS[p.ordinal][u],b=dn.ECC_CODEWORDS_PER_BLOCK[p.ordinal][u],v=Math.floor(dn.getNumRawDataModules(u)/8),S=g-v%g,k=Math.floor(v/g);let T=[];const P=dn.reedSolomonComputeDivisor(b);for(let I=0,U=0;I<g;I++){let L=f.slice(U,U+k-b+(I<S?0:1));U+=L.length;const $=dn.reedSolomonComputeRemainder(L,P);I<S&&L.push(0),T.push(L.concat($))}let M=[];for(let I=0;I<T[0].length;I++)T.forEach((U,L)=>{(I!=k-b||L>=S)&&M.push(U[I])});return a(M.length==v),M}drawCodewords(f){if(f.length!=Math.floor(dn.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let u=0;for(let p=this.size-1;p>=1;p-=2){p==6&&(p=5);for(let g=0;g<this.size;g++)for(let b=0;b<2;b++){const v=p-b,k=(p+1&2)==0?this.size-1-g:g;!this.isFunction[k][v]&&u<f.length*8&&(this.modules[k][v]=i(f[u>>>3],7-(u&7)),u++)}}a(u==f.length*8)}applyMask(f){if(f<0||f>7)throw new RangeError("Mask value out of range");for(let u=0;u<this.size;u++)for(let p=0;p<this.size;p++){let g;switch(f){case 0:g=(p+u)%2==0;break;case 1:g=u%2==0;break;case 2:g=p%3==0;break;case 3:g=(p+u)%3==0;break;case 4:g=(Math.floor(p/3)+Math.floor(u/2))%2==0;break;case 5:g=p*u%2+p*u%3==0;break;case 6:g=(p*u%2+p*u%3)%2==0;break;case 7:g=((p+u)%2+p*u%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[u][p]&&g&&(this.modules[u][p]=!this.modules[u][p])}}getPenaltyScore(){let f=0;for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[b][T]==v?(S++,S==5?f+=dn.PENALTY_N1:S>5&&f++):(this.finderPenaltyAddHistory(S,k),v||(f+=this.finderPenaltyCountPatterns(k)*dn.PENALTY_N3),v=this.modules[b][T],S=1);f+=this.finderPenaltyTerminateAndCount(v,S,k)*dn.PENALTY_N3}for(let b=0;b<this.size;b++){let v=!1,S=0,k=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[T][b]==v?(S++,S==5?f+=dn.PENALTY_N1:S>5&&f++):(this.finderPenaltyAddHistory(S,k),v||(f+=this.finderPenaltyCountPatterns(k)*dn.PENALTY_N3),v=this.modules[T][b],S=1);f+=this.finderPenaltyTerminateAndCount(v,S,k)*dn.PENALTY_N3}for(let b=0;b<this.size-1;b++)for(let v=0;v<this.size-1;v++){const S=this.modules[b][v];S==this.modules[b][v+1]&&S==this.modules[b+1][v]&&S==this.modules[b+1][v+1]&&(f+=dn.PENALTY_N2)}let u=0;for(const b of this.modules)u=b.reduce((v,S)=>v+(S?1:0),u);const p=this.size*this.size,g=Math.ceil(Math.abs(u*20-p*10)/p)-1;return a(0<=g&&g<=9),f+=g*dn.PENALTY_N4,a(0<=f&&f<=2568888),f}getAlignmentPatternPositions(){if(this.version==1)return[];{const f=Math.floor(this.version/7)+2,u=this.version==32?26:Math.ceil((this.version*4+4)/(f*2-2))*2;let p=[6];for(let g=this.size-7;p.length<f;g-=u)p.splice(1,0,g);return p}}static getNumRawDataModules(f){if(f<dn.MIN_VERSION||f>dn.MAX_VERSION)throw new RangeError("Version number out of range");let u=(16*f+128)*f+64;if(f>=2){const p=Math.floor(f/7)+2;u-=(25*p-10)*p-55,f>=7&&(u-=36)}return a(208<=u&&u<=29648),u}static getNumDataCodewords(f,u){return Math.floor(dn.getNumRawDataModules(f)/8)-dn.ECC_CODEWORDS_PER_BLOCK[u.ordinal][f]*dn.NUM_ERROR_CORRECTION_BLOCKS[u.ordinal][f]}static reedSolomonComputeDivisor(f){if(f<1||f>255)throw new RangeError("Degree out of range");let u=[];for(let g=0;g<f-1;g++)u.push(0);u.push(1);let p=1;for(let g=0;g<f;g++){for(let b=0;b<u.length;b++)u[b]=dn.reedSolomonMultiply(u[b],p),b+1<u.length&&(u[b]^=u[b+1]);p=dn.reedSolomonMultiply(p,2)}return u}static reedSolomonComputeRemainder(f,u){let p=u.map(g=>0);for(const g of f){const b=g^p.shift();p.push(0),u.forEach((v,S)=>p[S]^=dn.reedSolomonMultiply(v,b))}return p}static reedSolomonMultiply(f,u){if(f>>>8||u>>>8)throw new RangeError("Byte out of range");let p=0;for(let g=7;g>=0;g--)p=p<<1^(p>>>7)*285,p^=(u>>>g&1)*f;return a(p>>>8==0),p}finderPenaltyCountPatterns(f){const u=f[1];a(u<=this.size*3);const p=u>0&&f[2]==u&&f[3]==u*3&&f[4]==u&&f[5]==u;return(p&&f[0]>=u*4&&f[6]>=u?1:0)+(p&&f[6]>=u*4&&f[0]>=u?1:0)}finderPenaltyTerminateAndCount(f,u,p){return f&&(this.finderPenaltyAddHistory(u,p),u=0),u+=this.size,this.finderPenaltyAddHistory(u,p),this.finderPenaltyCountPatterns(p)}finderPenaltyAddHistory(f,u){u[0]==0&&(f+=this.size),u.pop(),u.unshift(f)}};n.MIN_VERSION=1,n.MAX_VERSION=40,n.PENALTY_N1=3,n.PENALTY_N2=3,n.PENALTY_N3=40,n.PENALTY_N4=10,n.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],n.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=n;function t(d,f,u){if(f<0||f>31||d>>>f)throw new RangeError("Value out of range");for(let p=f-1;p>=0;p--)u.push(d>>>p&1)}function i(d,f){return(d>>>f&1)!=0}function a(d){if(!d)throw new Error("Assertion error")}const o=class gi{constructor(f,u,p){if(this.mode=f,this.numChars=u,this.bitData=p,u<0)throw new RangeError("Invalid argument");this.bitData=p.slice()}static makeBytes(f){let u=[];for(const p of f)t(p,8,u);return new gi(gi.Mode.BYTE,f.length,u)}static makeNumeric(f){if(!gi.isNumeric(f))throw new RangeError("String contains non-numeric characters");let u=[];for(let p=0;p<f.length;){const g=Math.min(f.length-p,3);t(parseInt(f.substring(p,p+g),10),g*3+1,u),p+=g}return new gi(gi.Mode.NUMERIC,f.length,u)}static makeAlphanumeric(f){if(!gi.isAlphanumeric(f))throw new RangeError("String contains unencodable characters in alphanumeric mode");let u=[],p;for(p=0;p+2<=f.length;p+=2){let g=gi.ALPHANUMERIC_CHARSET.indexOf(f.charAt(p))*45;g+=gi.ALPHANUMERIC_CHARSET.indexOf(f.charAt(p+1)),t(g,11,u)}return p<f.length&&t(gi.ALPHANUMERIC_CHARSET.indexOf(f.charAt(p)),6,u),new gi(gi.Mode.ALPHANUMERIC,f.length,u)}static makeSegments(f){return f==""?[]:gi.isNumeric(f)?[gi.makeNumeric(f)]:gi.isAlphanumeric(f)?[gi.makeAlphanumeric(f)]:[gi.makeBytes(gi.toUtf8ByteArray(f))]}static makeEci(f){let u=[];if(f<0)throw new RangeError("ECI assignment value out of range");if(f<128)t(f,8,u);else if(f<16384)t(2,2,u),t(f,14,u);else if(f<1e6)t(6,3,u),t(f,21,u);else throw new RangeError("ECI assignment value out of range");return new gi(gi.Mode.ECI,0,u)}static isNumeric(f){return gi.NUMERIC_REGEX.test(f)}static isAlphanumeric(f){return gi.ALPHANUMERIC_REGEX.test(f)}getData(){return this.bitData.slice()}static getTotalBits(f,u){let p=0;for(const g of f){const b=g.mode.numCharCountBits(u);if(g.numChars>=1<<b)return 1/0;p+=4+b+g.bitData.length}return p}static toUtf8ByteArray(f){f=encodeURI(f);let u=[];for(let p=0;p<f.length;p++)f.charAt(p)!="%"?u.push(f.charCodeAt(p)):(u.push(parseInt(f.substring(p+1,p+3),16)),p+=2);return u}};o.NUMERIC_REGEX=/^[0-9]*$/,o.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,o.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let l=o;e.QrSegment=o})(zd||(zd={}));(e=>{(n=>{const t=class{constructor(a,o){this.ordinal=a,this.formatBits=o}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),n.Ecc=t})(e.QrCode||(e.QrCode={}))})(zd||(zd={}));(e=>{(n=>{const t=class{constructor(a,o){this.modeBits=a,this.numBitsCharCount=o}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),n.Mode=t})(e.QrSegment||(e.QrSegment={}))})(zd||(zd={}));var Nh=zd;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Yee={L:Nh.QrCode.Ecc.LOW,M:Nh.QrCode.Ecc.MEDIUM,Q:Nh.QrCode.Ecc.QUARTILE,H:Nh.QrCode.Ecc.HIGH},yA=128,xA="L",bA="#FFFFFF",vA="#000000",wA=!1,SA=1,Wee=4,Qee=0,Jee=.1;function NA(e,n=0){const t=[];return e.forEach(function(i,a){let o=null;i.forEach(function(l,d){if(!l&&o!==null){t.push(`M${o+n} ${a+n}h${d-o}v1H${o+n}z`),o=null;return}if(d===i.length-1){if(!l)return;o===null?t.push(`M${d+n},${a+n} h1v1H${d+n}z`):t.push(`M${o+n},${a+n} h${d+1-o}v1H${o+n}z`);return}l&&o===null&&(o=d)})}),t.join("")}function CA(e,n){return e.slice().map((t,i)=>i<n.y||i>=n.y+n.h?t:t.map((a,o)=>o<n.x||o>=n.x+n.w?a:!1))}function Kee(e,n,t,i){if(i==null)return null;const a=e.length+t*2,o=Math.floor(n*Jee),l=a/n,d=(i.width||o)*l,f=(i.height||o)*l,u=i.x==null?e.length/2-d/2:i.x*l,p=i.y==null?e.length/2-f/2:i.y*l,g=i.opacity==null?1:i.opacity;let b=null;if(i.excavate){let S=Math.floor(u),k=Math.floor(p),T=Math.ceil(d+u-S),P=Math.ceil(f+p-k);b={x:S,y:k,w:T,h:P}}const v=i.crossOrigin;return{x:u,y:p,h:f,w:d,excavation:b,opacity:g,crossOrigin:v}}function Xee(e,n){return n!=null?Math.max(Math.floor(n),0):e?Wee:Qee}function jA({value:e,level:n,minVersion:t,includeMargin:i,marginSize:a,imageSettings:o,size:l,boostLevel:d}){let f=vn.useMemo(()=>{const S=(Array.isArray(e)?e:[e]).reduce((k,T)=>(k.push(...Nh.QrSegment.makeSegments(T)),k),[]);return Nh.QrCode.encodeSegments(S,Yee[n],t,void 0,void 0,d)},[e,n,t,d]);const{cells:u,margin:p,numCells:g,calculatedImageSettings:b}=vn.useMemo(()=>{let v=f.getModules();const S=Xee(i,a),k=v.length+S*2,T=Kee(v,l,S,o);return{cells:v,margin:S,numCells:k,calculatedImageSettings:T}},[f,l,o,i,a]);return{qrcode:f,margin:p,cells:u,numCells:g,calculatedImageSettings:b}}var Zee=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),Mh=vn.forwardRef(function(n,t){const i=n,{value:a,size:o=yA,level:l=xA,bgColor:d=bA,fgColor:f=vA,includeMargin:u=wA,minVersion:p=SA,boostLevel:g,marginSize:b,imageSettings:v}=i,k=K1(i,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:T}=k,P=K1(k,["style"]),M=v==null?void 0:v.src,I=vn.useRef(null),U=vn.useRef(null),L=vn.useCallback(ne=>{I.current=ne,typeof t=="function"?t(ne):t&&(t.current=ne)},[t]),[$,z]=vn.useState(!1),{margin:F,cells:Q,numCells:R,calculatedImageSettings:B}=jA({value:a,level:l,minVersion:p,boostLevel:g,includeMargin:u,marginSize:b,imageSettings:v,size:o});vn.useEffect(()=>{if(I.current!=null){const ne=I.current,G=ne.getContext("2d");if(!G)return;let V=Q;const W=U.current,J=B!=null&&W!==null&&W.complete&&W.naturalHeight!==0&&W.naturalWidth!==0;J&&B.excavation!=null&&(V=CA(Q,B.excavation));const he=window.devicePixelRatio||1;ne.height=ne.width=o*he;const A=o/R*he;G.scale(A,A),G.fillStyle=d,G.fillRect(0,0,R,R),G.fillStyle=f,Zee?G.fill(new Path2D(NA(V,F))):Q.forEach(function(ce,se){ce.forEach(function(D,oe){D&&G.fillRect(oe+F,se+F,1,1)})}),B&&(G.globalAlpha=B.opacity),J&&G.drawImage(W,B.x+F,B.y+F,B.w,B.h)}}),vn.useEffect(()=>{z(!1)},[M]);const Y=J1({height:o,width:o},T);let re=null;return M!=null&&(re=vn.createElement("img",{src:M,key:M,style:{display:"none"},onLoad:()=>{z(!0)},ref:U,crossOrigin:B==null?void 0:B.crossOrigin})),vn.createElement(vn.Fragment,null,vn.createElement("canvas",J1({style:Y,height:o,width:o,ref:L,role:"img"},P)),re)});Mh.displayName="QRCodeCanvas";var ete=vn.forwardRef(function(n,t){const i=n,{value:a,size:o=yA,level:l=xA,bgColor:d=bA,fgColor:f=vA,includeMargin:u=wA,minVersion:p=SA,boostLevel:g,title:b,marginSize:v,imageSettings:S}=i,k=K1(i,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:T,cells:P,numCells:M,calculatedImageSettings:I}=jA({value:a,level:l,minVersion:p,boostLevel:g,includeMargin:u,marginSize:v,imageSettings:S,size:o});let U=P,L=null;S!=null&&I!=null&&(I.excavation!=null&&(U=CA(P,I.excavation)),L=vn.createElement("image",{href:S.src,height:I.h,width:I.w,x:I.x+T,y:I.y+T,preserveAspectRatio:"none",opacity:I.opacity,crossOrigin:I.crossOrigin}));const $=NA(U,T);return vn.createElement("svg",J1({height:o,width:o,viewBox:`0 0 ${M} ${M}`,ref:t,role:"img"},k),!!b&&vn.createElement("title",null,b),vn.createElement("path",{fill:d,d:`M0,0 h${M}v${M}H0z`,shapeRendering:"crispEdges"}),vn.createElement("path",{fill:f,d:$,shapeRendering:"crispEdges"}),L)});ete.displayName="QRCodeSVG";const tte=e=>{switch(e){case"pending":return{text:"text-orange-700",bg:"bg-orange-100"};case"billed":return{text:"text-blue-700",bg:"bg-blue-100"};case"dispensed":return{text:"text-green-700",bg:"bg-green-100"};case"cancelled":return{text:"text-red-700",bg:"bg-red-100"};default:return{text:"text-gray-600",bg:"bg-gray-100"}}},nte=()=>{const{orderId:e}=Br(),n=_t(),[t,i]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),[p,g]=w.useState({}),[b,v]=w.useState(""),[S,k]=w.useState(""),[T,P]=w.useState("cash"),M=w.useMemo(()=>(t==null?void 0:t.medications.reduce((B,Y)=>{const re=Y.total_price??0,ne=re*(Y.discount_percentage??0)/100;return B+re-ne},0))??0,[t==null?void 0:t.medications]),I=5,U=w.useMemo(()=>!t||!t.medications?0:t.medications.reduce((B,Y,re)=>{var he,A;const ne=Y.drug_id??`index-${re}`,G=((he=p[ne])==null?void 0:he.pack)||0,V=((A=p[ne])==null?void 0:A.loose)||0,W=Y.pack_price??0,J=Y.loose_price??0;return B+G*W+V*J},0),[t,p]),L=w.useCallback(async()=>{if(!e){d("Order ID is missing."),o(!1);return}o(!0),d(null);try{const B=await me(`/api/pharmacy-orders/${e}`);if(!B.ok)throw B.status===404?new Error(`Order with ID ${e} not found.`):new Error(`Failed to fetch order details: ${B.statusText} (${B.status})`);const Y=await B.json();console.log("Fetched order data after return:",Y);const ne=Y.medications.map(V=>V.pack_price&&V.loose_price&&V.loose_price>0?{...V,unitsPerPack:Math.round(V.pack_price/V.loose_price)}:{...V,unitsPerPack:0}).map(V=>({...V,discount_percentage:V.discount_percentage??0}));i({...Y,medications:ne});const G={};ne.forEach((V,W)=>{const J=V.drug_id??`index-${W}`;G[J]={pack:0,loose:0}}),g(G)}catch(B){console.error("Failed to fetch order details:",B),d(B.message||"Failed to load order details.")}finally{o(!1)}},[e]);w.useEffect(()=>{L()},[L]),w.useEffect(()=>{(async()=>{try{const Y=await me("/api/clinics/settings");if(!Y.ok)throw new Error("Failed to fetch clinic settings");const re=await Y.json();console.log("Fetched clinic settings:",re),v(re.upi_id||"")}catch(Y){console.error("Error fetching clinic settings:",Y)}})()},[]),w.useEffect(()=>{if((t==null?void 0:t.order_total)!==void 0&&t.order_total>0&&b){const B=`upi://pay?pa=${b}&pn=ClinicName&am=${t.order_total.toFixed(2)}&cu=INR`;k(B)}else k("")},[t==null?void 0:t.order_total,b]);const $=(B,Y)=>{i(re=>{if(!re)return null;const ne=re.medications.map((V,W)=>(V.drug_id??`index-${W}`)===B?{...V,discount_percentage:isNaN(Y)?0:Y}:V),G=ne.reduce((V,W)=>{const J=W.total_price??0,he=J*(W.discount_percentage??0)/100;return V+J-he},0);return{...re,medications:ne,order_total:G}})},z=(B,Y,re)=>{g(ne=>{const G=re.unitsPerPack||0,W=re.pack_quantity*G+re.loose_quantity,J=Math.max(0,Math.min(Y,W));let he=0,A=J;return G>0&&(he=Math.floor(J/G),A=J%G),{...ne,[B]:{pack:he,loose:A}}})},F=async()=>{const B=t==null?void 0:t.medications.map((Y,re)=>{var W,J;const ne=Y.drug_id??`index-${re}`,G=((W=p[ne])==null?void 0:W.pack)||0,V=((J=p[ne])==null?void 0:J.loose)||0;return G>0||V>0?{drug_id:Y.drug_id,name:Y.name,pack_quantity:Y.pack_quantity,loose_quantity:Y.loose_quantity,returnPackQuantity:G,returnLooseQuantity:V}:null}).filter(Y=>Y!==null);if(!B||B.length===0){alert("Please select a quantity greater than 0 for at least one item to return.");return}if(!e){alert("Order ID is missing. Cannot process return.");return}if(!B){alert("Could not prepare items for return.");return}u(!0),d(null);try{const Y=await me(`/api/pharmacy-orders/${e}/return`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemsToReturn:B})}),re=await Y.json();if(!Y.ok)throw new Error(re.message||`Failed to process return: ${Y.statusText}`);alert("Return processed successfully! Stock has been updated.");const ne={};t==null||t.medications.forEach((G,V)=>{const W=G.drug_id??`index-${V}`;ne[W]={pack:0,loose:0}}),g(ne),L()}catch(Y){console.error("Failed to process return:",Y),d(Y.message||"An error occurred while processing the return."),alert(`Error processing return: ${Y.message||"Unknown error"}`)}finally{u(!1)}};if(a)return r.jsx("div",{className:"text-center p-6 text-gray-500 animate-pulse",children:"Loading Order Details..."});if(l)return r.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[r.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[r.jsx(rn,{size:14,className:"mr-1.5"})," Back"]}),r.jsxs("div",{className:"bg-red-50 border border-red-300 text-red-700 rounded p-4",children:["Error: ",l]})]});if(!t)return r.jsxs("div",{className:"p-6 max-w-2xl mx-auto",children:[r.jsxs("button",{onClick:()=>n(-1),className:"mb-4 inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[r.jsx(rn,{size:14,className:"mr-1.5"})," Back"]}),r.jsx("div",{className:"text-center py-10 px-4 text-gray-500 bg-white rounded-lg shadow",children:"Order details could not be loaded."})]});const Q=()=>{window.print()},R=tte(t.status);return r.jsx("div",{className:"pharmacy-order-details-page",children:r.jsxs("div",{className:"order-details-container printable-section",children:[r.jsxs("div",{className:"order-details-header no-print",children:[r.jsx("h1",{children:"Pharmacy Order Details"}),r.jsxs("div",{className:"actions",children:[r.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:[r.jsx(rn,{size:18})," Back to Queue"]}),r.jsxs("button",{onClick:Q,className:"print-button",children:[r.jsx(Go,{size:18})," Print Bill"]})]})]}),r.jsxs("div",{className:"billing-header print-only",children:[r.jsx("div",{className:"clinic-header-left",children:r.jsx("div",{className:"clinic-info-print",children:r.jsxs("div",{className:"clinic-name-and-details-print",children:[r.jsx("h1",{children:"Mahajan Pharmacy"}),r.jsxs("div",{className:"clinic-details-print",children:[r.jsx("span",{className:"small-text clinic-address",children:"D.No: 3-1-289, Plot No. 101, Kabela Center, RR Nagar, Vijayawada  520012."}),r.jsx("span",{className:"small-text clinic-notes",children:"Phone: 93919 44733"}),r.jsx("span",{className:"small-text clinic-license",children:"Licence No:RLF20AP2025003328"})]})]})})}),r.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[r.jsxs("div",{className:"info-item",children:[r.jsx("strong",{children:"Patient Name:"})," RESHMA"]}),r.jsxs("div",{className:"info-item",children:[r.jsx("strong",{children:"Token:"})," 12"]}),r.jsxs("div",{className:"info-item",children:[r.jsx("strong",{children:"Order Date:"})," 31/10/2025"]})]})]}),r.jsxs("div",{className:"order-info-section no-print",children:[r.jsxs("div",{className:"order-info-item",children:[r.jsx("strong",{children:"Order ID:"})," ",t.id]}),r.jsxs("div",{className:"order-info-item",children:[r.jsx("strong",{children:"Patient:"})," ",t.patientName||"N/A"," (",t.patientTokenNumber||"N/A",")"]}),r.jsxs("div",{className:"order-info-item",children:[r.jsx("strong",{children:"Date:"})," ",new Date(t.date).toLocaleString()]}),r.jsxs("div",{className:"order-info-item",children:[r.jsx("strong",{children:"Prescribed By:"})," ",t.prescribedBy||"N/A"]}),r.jsxs("div",{className:"order-info-item",children:[r.jsx("strong",{children:"Status:"})," ",r.jsx("span",{className:`status-pill ${R.text} ${R.bg}`,children:t.status})]})]}),r.jsxs("div",{className:"medications-section",children:[r.jsx("h2",{children:"Medications Ordered"}),t.medications.length>0?r.jsxs("table",{className:"medications-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"DESCRIPTION"}),r.jsx("th",{children:"PACK QTY"}),r.jsx("th",{children:"PACK PRICE"}),r.jsx("th",{children:"LOOSE QTY"}),r.jsx("th",{children:"LOOSE PRICE"}),r.jsx("th",{children:"MRP"}),r.jsx("th",{children:"RATE"}),r.jsx("th",{children:"DIS %"}),r.jsx("th",{children:"GST%"}),r.jsx("th",{children:"AMT"}),(t.status==="dispensed"||t.status==="billed")&&r.jsxs(r.Fragment,{children:[r.jsx("th",{className:"no-print",children:"RETURN PACK QTY"}),r.jsx("th",{className:"no-print",children:"RETURN LOOSE QTY"})]})]})}),r.jsx("tbody",{children:t.medications.map((B,Y)=>{var he,A,ce,se,D,oe;const re=B.drug_id??`index-${Y}`,ne=B.total_price??0,G=ne*(B.discount_percentage??0)/100,V=ne-G,W=((he=p[re])==null?void 0:he.pack)||0,J=((A=p[re])==null?void 0:A.loose)||0;return r.jsxs("tr",{children:[r.jsx("td",{children:B.name}),r.jsx("td",{children:B.pack_quantity??0}),r.jsx("td",{children:((ce=B.pack_price)==null?void 0:ce.toFixed(2))??"N/A"}),r.jsx("td",{children:B.loose_quantity??0}),r.jsx("td",{children:((se=B.loose_price)==null?void 0:se.toFixed(2))??"N/A"}),r.jsx("td",{children:((D=B.price)==null?void 0:D.toFixed(2))??"N/A"})," ",r.jsx("td",{children:((oe=B.price)==null?void 0:oe.toFixed(2))??"N/A"})," ",r.jsxs("td",{children:[r.jsx("input",{type:"number",value:B.discount_percentage??0,onChange:xe=>$(re,parseFloat(xe.target.value)),min:"0",max:"100",className:"discount-input-table no-print"}),r.jsxs("span",{className:"print-only",children:[B.discount_percentage??0,"%"]})]}),r.jsxs("td",{children:[I.toFixed(1),"%"]}),r.jsx("td",{children:V.toFixed(2)}),(t.status==="dispensed"||t.status==="billed")&&r.jsxs(r.Fragment,{children:[r.jsx("td",{className:"no-print",children:r.jsx("input",{type:"number",min:"0",max:B.pack_quantity,value:W,onChange:xe=>{const ue=(parseInt(xe.target.value,10)||0)*(B.unitsPerPack||0)+J;z(re,ue,B)},className:"return-quantity-input"})}),r.jsx("td",{className:"no-print",children:r.jsx("input",{type:"number",min:"0",max:B.loose_quantity+B.pack_quantity*(B.unitsPerPack||0)-W*(B.unitsPerPack||0),value:J,onChange:xe=>{const Z=parseInt(xe.target.value,10)||0,ue=W*(B.unitsPerPack||0)+Z;z(re,ue,B)},className:"return-quantity-input"})})]})]},re)})})]}):r.jsx("p",{className:"text-sm text-gray-500 italic",children:"No medications listed for this order."})]}),r.jsx("div",{className:"print-only-total",children:r.jsxs("strong",{children:["Grand Total: ",M.toFixed(2)]})}),r.jsxs("div",{className:"order-total-section no-print",children:[r.jsx("span",{className:"total-label",children:"Order Total:"}),r.jsxs("span",{className:"total-amount",children:["",M.toFixed(2)]})]}),r.jsxs("div",{className:"payment-section no-print",children:[r.jsxs("div",{className:"payment-mode-group",children:[r.jsx("label",{htmlFor:"paymentMode",children:"Payment Mode:"}),r.jsxs("select",{id:"paymentMode",value:T,onChange:B=>P(B.target.value),className:"payment-mode-select",children:[r.jsx("option",{value:"cash",children:"Cash"}),r.jsx("option",{value:"upi",children:"UPI"}),r.jsx("option",{value:"card",children:"Card"}),r.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),r.jsx("option",{value:"credit",children:"Credit"})]})]}),S&&r.jsxs("div",{className:"qr-code-container",children:[r.jsx(Mh,{value:S,size:128}),r.jsx("p",{children:"Scan to pay using UPI"})]})]}),(t.status==="dispensed"||t.status==="billed")&&t.medications.length>0&&r.jsxs("div",{className:"return-action-section no-print",children:[U>0&&r.jsxs("div",{className:"total-refund-display",children:["Total Refund: ",U.toFixed(2)]}),r.jsx("button",{onClick:F,disabled:Object.values(p).every(B=>B.pack===0&&B.loose===0)||f,className:"process-return-button",children:f?r.jsxs(r.Fragment,{children:[r.jsx(Kx,{size:16,className:"mr-2 animate-spin"})," Processing..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Kx,{size:16,className:"mr-2"})," Process Return"]})})]})]})})},ite=async()=>{const e=await me("/subscriptions");if(!e.ok)throw new Error("Failed to fetch subscription plans");return await e.json()},rte=async e=>{const n=await me(`/subscriptions/${e}`);if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to fetch subscription plan details"}));throw new Error(t.message||"Failed to fetch subscription plan details")}return await n.json()},ate=async e=>{const n=await me("/subscriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to create subscription plan"}));throw new Error(t.message||"Failed to create subscription plan")}return await n.json()},ste=async(e,n)=>{const t=await me(`/subscriptions/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const i=await t.json().catch(()=>({message:"Failed to update subscription plan"}));throw new Error(i.message||"Failed to update subscription plan")}return await t.json()},ote=async e=>{const n=await me(`/subscriptions/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json().catch(()=>({message:"Failed to deactivate subscription plan"}));throw new Error(t.message||"Failed to deactivate subscription plan")}return await n.json()},lte=async(e,n)=>{const t=await me("/api/payment/razorpay-subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:e,planId:n})});if(!t.ok){const i=await t.json().catch(()=>({message:"Failed to initiate Razorpay subscription"}));throw new Error(i.message||"Failed to initiate Razorpay subscription")}return await t.json()},cte=()=>{const e=_t(),[n,t]=w.useState([]),[i,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),u=w.useCallback(async()=>{a(!0),l(null);try{const g=await ite();t(g)}catch(g){l(g.message||"Failed to fetch subscription plans."),f({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{u()},[u]),w.useEffect(()=>{if(d){const g=setTimeout(()=>f(null),5e3);return()=>clearTimeout(g)}},[d]);const p=async g=>{if(f(null),l(null),window.confirm("Are you sure you want to deactivate this plan? This action cannot be undone directly.")){a(!0),l(null),f(null);try{await ote(g),f({type:"success",message:"Plan deactivated successfully!"}),u()}catch(b){l(b.message||"Failed to deactivate plan."),f({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return r.jsxs("div",{className:"subscription-page-container",children:[d&&r.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[r.jsxs("div",{className:"flex items-center",children:[d.type==="success"?r.jsx(cs,{size:18,className:"mr-2 text-green-500"}):r.jsx(Hi,{size:18,className:"mr-2 text-red-500"}),r.jsx("span",{children:d.message})]}),r.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:r.jsx(Qn,{size:16})})]}),r.jsxs("div",{children:[" ",r.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[r.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[r.jsx(rn,{size:16}),"Back"]}),r.jsx("h1",{children:"Manage Subscription Plans"}),r.jsxs("button",{onClick:()=>e("/dashboard/subscriptions/add"),className:"subscription-btn",children:[r.jsx(ou,{size:16,className:"mr-1 inline-block"})," Add New Plan"]})]}),i&&n.length===0&&r.jsx("div",{className:"flex items-center justify-center p-8",children:r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:r.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),r.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading plans..."})]})}),!i&&o&&n.length===0&&r.jsx("p",{className:"text-center text-red-500",children:o}),n.length>0&&r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"subscription-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Name"}),r.jsx("th",{children:"Price"}),r.jsx("th",{children:"Billing Cycle"}),r.jsx("th",{children:"Status"}),r.jsx("th",{className:"text-right",children:"Actions"})]})}),r.jsx("tbody",{children:n.map(g=>r.jsxs("tr",{children:[r.jsx("td",{children:g.name}),r.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),r.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),r.jsx("td",{children:r.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),r.jsxs("td",{className:"actions-cell text-right",children:[r.jsx("button",{onClick:()=>e(`/dashboard/subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:r.jsx(lu,{size:16,className:"inline-block"})}),g.status==="active"&&r.jsx("button",{onClick:()=>p(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:i,children:r.jsx(or,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!i&&n.length===0&&!o&&r.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No subscription plans found. Add one to get started!"})]})]})},ute=()=>{const e=_t(),[n,t]=w.useState({name:"",description:"",price:"",period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[i,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null);w.useEffect(()=>{if(d){const b=setTimeout(()=>f(null),5e3);return()=>clearTimeout(b)}},[d]);const u=b=>{const{name:v,value:S}=b.target;t(k=>({...k,[v]:S}))},p=async b=>{if(b.preventDefault(),a(!0),l(null),f(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){l("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await ate(n),f({type:"success",message:"Plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create plan.";l(S),f({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return r.jsxs("div",{className:"subscription-page-container",children:[d&&r.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[r.jsxs("div",{className:"flex items-center",children:[d.type==="success"?r.jsx(cs,{size:18,className:"mr-2 text-green-500"}):r.jsx(Hi,{size:18,className:"mr-2 text-red-500"}),r.jsx("span",{children:d.message})]}),r.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:r.jsx(Qn,{size:16})})]}),r.jsxs("div",{className:"subscription-form",children:[r.jsx("h1",{children:"Add New Subscription Plan"}),o&&r.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:o}),r.jsxs("form",{onSubmit:p,children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"name",children:["Plan Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:u,required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",children:"Description"}),r.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:u})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"price",children:["Price (INR) ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:u,required:!0})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"period",children:["Billing Period ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:u,required:!0,children:[r.jsx("option",{value:"daily",children:"Daily"}),r.jsx("option",{value:"weekly",children:"Weekly"}),r.jsx("option",{value:"monthly",children:"Monthly"}),r.jsx("option",{value:"yearly",children:"Yearly"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"interval",children:["Interval ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:u,required:!0})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),r.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:u})]}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),r.jsxs("button",{type:"submit",disabled:i,className:"subscription-btn",children:[i?r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,i?"Creating...":"Create Plan"]})]})]})]})]})},dte=()=>{const{id:e}=Br(),n=_t(),[t,i]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!1),[f,u]=w.useState(!0),[p,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),u(!1);return}u(!0),g(null);try{const M=await rte(e);i(M),o({name:M.name,description:M.description||"",price:M.price,period:M.period,interval:M.interval,razorpay_plan_id:M.razorpay_plan_id||"",status:M.status})}catch(M){g(M.message||"Failed to fetch plan details."),v({type:"error",message:M.message||"Failed to fetch plan details."})}finally{u(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const M=setTimeout(()=>v(null),5e3);return()=>clearTimeout(M)}},[b]);const k=M=>{const{name:I,value:U}=M.target;o(L=>({...L,[I]:U}))},T=async M=>{if(M.preventDefault(),!e){g("Plan ID is missing.");return}if(d(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),d(!1);return}try{await ste(e,a),v({type:"success",message:"Plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(I){const U=I.message||"Failed to update plan.";g(U),v({type:"error",message:U})}finally{d(!1)}},P=()=>{n(-1)};return f?r.jsx("div",{className:"p-6 text-center",children:"Loading plan details..."}):p&&!t?r.jsx("div",{className:"p-6 text-center text-red-500",children:p}):t?r.jsxs("div",{className:"subscription-page-container",children:[b&&r.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[r.jsxs("div",{className:"flex items-center",children:[b.type==="success"?r.jsx(cs,{size:18,className:"mr-2"}):r.jsx(Hi,{size:18,className:"mr-2"}),r.jsx("span",{children:b.message})]}),r.jsx("button",{onClick:()=>v(null),className:"ml-4",children:r.jsx(Qn,{size:16})})]}),r.jsxs("div",{className:"subscription-form",children:[r.jsx("h1",{children:"Edit Subscription Plan"}),p&&r.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:p}),r.jsxs("form",{onSubmit:T,children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"name",children:["Plan Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",children:"Description"}),r.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"price",children:["Price (INR) ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price||"",onChange:k,required:!0})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"period",children:["Billing Period ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[r.jsx("option",{value:"daily",children:"Daily"}),r.jsx("option",{value:"weekly",children:"Weekly"}),r.jsx("option",{value:"monthly",children:"Monthly"}),r.jsx("option",{value:"yearly",children:"Yearly"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"interval",children:["Interval ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval||1,onChange:k,required:!0})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),r.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",children:"Status"}),r.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[r.jsx("option",{value:"active",children:"Active"}),r.jsx("option",{value:"inactive",children:"Inactive"})]})]}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:P,className:"subscription-btn subscription-btn-secondary",children:"Back"}),r.jsxs("button",{type:"submit",disabled:l,className:"subscription-btn",children:[l?r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,l?"Saving...":"Save Changes"]})]})]})]})]}):r.jsx("div",{className:"p-6 text-center text-gray-500",children:"Plan not found."})},fte=()=>{const{patientId:e}=Br(),n=_t(),[t,i]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState(""),[f,u]=w.useState(!0),[p,g]=w.useState(null),[b,v]=w.useState("manual"),[S,k]=w.useState(!1),[T,P]=w.useState(null),M=w.useCallback(async()=>{u(!0),g(null);try{const L=await me(`/api/patients/${e}`);if(!L.ok){const Q=await L.json();throw new Error(Q.message||"Failed to fetch patient details")}const $=await L.json();i($);const z=await me("/api/subscriptions");if(!z.ok){const Q=await z.json();throw new Error(Q.message||"Failed to fetch subscription plans")}const F=await z.json();o(F.filter(Q=>Q.status==="active"))}catch(L){console.error("Error fetching data:",L),g(`Failed to load data: ${L.message}`)}finally{u(!1)}},[e]);w.useEffect(()=>{e?M():(g("Patient ID is missing."),u(!1))},[e,M]);const I=(L,$)=>{const z=new Date(L),F=$.interval||1;switch($.period){case"daily":z.setDate(L.getDate()+F);break;case"weekly":z.setDate(L.getDate()+F*7);break;case"monthly":z.setMonth(L.getMonth()+F);break;case"yearly":z.setFullYear(L.getFullYear()+F);break;default:console.warn(`Unknown subscription period: ${$.period}. Defaulting to 1 month.`),z.setMonth(L.getMonth()+1)}return z},U=async()=>{if(!e||!l){P("Please select a subscription plan.");return}const L=a.find($=>$.id===l);if(!L){P("Selected plan details not found.");return}k(!0),P(null);try{const $=new Date,z=I($,L);if(b==="manual"){const F={subscription_plan_id:l,subscription_status:"active",subscription_start_date:$.toISOString(),subscription_end_date:z.toISOString(),subscription_payment_method:"manual"},Q=await me(`/api/patients/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(F)});if(!Q.ok){const R=await Q.json();throw new Error(R.message||"Failed to start subscription manually")}alert(`Subscription started successfully for ${t==null?void 0:t.name} (Manual Payment)!`),n("/all-patients")}else if(b==="razorpay"){console.log("Initiating Razorpay subscription for plan:",L);const F=await lte(e,l);if(F&&F.short_url)window.location.href=F.short_url;else throw new Error("Failed to get Razorpay subscription link from backend.")}}catch($){console.error("Error starting subscription:",$),P(`Failed to start subscription: ${$.message}`),k(!1)}};return f?r.jsx("div",{className:"loading-state-subscription",children:"Loading patient and plans..."}):p?r.jsxs("div",{className:"subscription-page-container",children:[r.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[r.jsx("strong",{children:"Error: "}),r.jsx("span",{children:p})]}),r.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[r.jsx(rn,{size:16})," ","Back"]})]}):t?r.jsxs("div",{className:"subscription-page-container",children:[r.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[r.jsx(rn,{size:16})," ","Back"]}),r.jsxs("h1",{children:[r.jsx(cu,{size:28})," ","Start Subscription for ",t.name]}),T&&r.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[" ",r.jsx("span",{children:T})]}),r.jsxs("div",{className:"subscription-form",children:[" ",r.jsx("h2",{children:"Available Subscription Plans"}),a.length===0?r.jsx("p",{className:"empty-state",children:"No active subscription plans found."}):r.jsx("div",{className:"subscription-plan-list",children:a.map(L=>r.jsxs("div",{className:`subscription-plan-card ${l===L.id?"selected-plan":""}`,onClick:()=>d(L.id),children:[r.jsx("h3",{children:L.name}),r.jsxs("p",{className:"price",children:["",L.price]}),r.jsxs("p",{className:"duration",children:["Every ",L.interval," ",L.period,L.interval>1?"s":""]}),L.description&&r.jsx("p",{children:L.description})]},L.id))})]}),r.jsxs("div",{className:"subscription-form mb-6",children:[" ",r.jsx("h2",{children:"Select Payment Method"}),r.jsx("div",{className:"form-group",children:r.jsxs("label",{className:"inline-flex items-center",children:[r.jsx("input",{type:"radio",name:"paymentMethod",value:"manual",checked:b==="manual",onChange:()=>v("manual"),className:"mr-2"}),r.jsx("span",{children:"Cash (Manual)"})]})}),r.jsx("div",{className:"form-group",children:r.jsxs("label",{className:"inline-flex items-center",children:[r.jsx("input",{type:"radio",name:"paymentMethod",value:"razorpay",checked:b==="razorpay",onChange:()=>v("razorpay"),className:"mr-2"}),r.jsx("span",{children:"Razorpay"})]})})]}),r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{onClick:U,disabled:!l||S||a.length===0,className:"subscription-btn",children:[S&&r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),S?"Starting...":"Start Subscription"]})})]}):r.jsxs("div",{className:"subscription-page-container",children:[r.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[r.jsx("strong",{children:"Warning: "}),r.jsx("span",{children:"Patient not found."})]}),r.jsxs("button",{onClick:()=>n(-1),className:"all-patients-back-button",children:[r.jsx(rn,{size:16}),"Back"]})]})},aS=async()=>{const e=await me("/api/clinic-subscriptions/plans",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription plans")}return e.json()},hte=async e=>{const n=await me(`/api/clinic-subscriptions/cancel/${e}`,{method:"PUT"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to cancel clinic subscription")}return n.json()},pte=async e=>{const n=await me(`/api/clinics/${e}/subscription-status`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||`Failed to fetch subscription status for clinic ${e}`)}return n.json()},mte=async e=>{const n=await me(`/api/clinic-subscriptions/plans/${e}`,{method:"GET"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to fetch clinic subscription plan")}return n.json()},gte=async e=>{const n=await me("/api/clinic-subscriptions/plans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to create clinic subscription plan")}return n.json()},yte=async(e,n)=>{const t=await me(`/api/clinic-subscriptions/plans/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const i=await t.json();throw new Error(i.message||"Failed to update clinic subscription plan")}return t.json()},xte=async e=>{const n=await me(`/api/clinic-subscriptions/plans/${e}`,{method:"DELETE"});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to deactivate clinic subscription plan")}return n.json()},bte=async e=>{const n=await me("/api/clinic-subscriptions/initiate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({planId:e})});if(!n.ok){const t=await n.json();throw new Error(t.message||"Failed to initiate clinic subscription")}return n.json()},vte=async()=>{try{const e=await me("/api/clinic-subscriptions/pending",{method:"GET"});return e.ok?e.json():null}catch(e){return console.error("Error checking for pending subscription:",e),null}},wte=async()=>{const e=await me("/api/clinics/subscription-status",{method:"GET"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to fetch clinic subscription status")}return e.json()},Ste=()=>{const e=_t(),[n,t]=w.useState([]),[i,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null),u=w.useCallback(async()=>{a(!0),l(null);try{const g=await aS();t(g)}catch(g){l(g.message||"Failed to fetch clinic subscription plans."),f({type:"error",message:g.message||"Failed to fetch plans."})}finally{a(!1)}},[]);w.useEffect(()=>{u()},[u]),w.useEffect(()=>{if(d){const g=setTimeout(()=>f(null),5e3);return()=>clearTimeout(g)}},[d]);const p=async g=>{if(f(null),l(null),window.confirm("Are you sure you want to deactivate this clinic plan? This action cannot be undone directly.")){a(!0),l(null),f(null);try{await xte(g),f({type:"success",message:"Clinic plan deactivated successfully!"}),u()}catch(b){l(b.message||"Failed to deactivate clinic plan."),f({type:"error",message:b.message||"Failed to deactivate plan."})}finally{a(!1)}}};return r.jsxs("div",{className:"subscription-page-container",children:[d&&r.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"} 
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[r.jsxs("div",{className:"flex items-center",children:[d.type==="success"?r.jsx(cs,{size:18,className:"mr-2 text-green-500"}):r.jsx(Hi,{size:18,className:"mr-2 text-red-500"}),r.jsx("span",{children:d.message})]}),r.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:r.jsx(Qn,{size:16})})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("button",{onClick:()=>e(-1),className:"p-2 rounded-md hover:bg-gray-200",children:r.jsx(rn,{size:20})}),r.jsx("h1",{className:"text-2xl font-bold",children:"Manage Clinic Subscription Plans"})]}),r.jsxs("button",{onClick:()=>e("/dashboard/clinic-subscriptions/add"),className:"subscription-btn",children:[r.jsx(ou,{size:16,className:"mr-1 inline-block"})," Add New Clinic Plan"]})]}),i&&n.length===0&&r.jsx("div",{className:"flex items-center justify-center p-8",children:r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("div",{className:"loading-animation-container",style:{height:"auto",margin:"20px 0"},children:r.jsx("div",{className:"breathing-ball",style:{width:"25px",height:"25px"}})}),r.jsx("div",{className:"mt-2 text-gray-600 text-md font-medium",children:"Loading clinic plans..."})]})}),!i&&o&&n.length===0&&r.jsx("p",{className:"text-center text-red-500",children:o}),n.length>0&&r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"subscription-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Name"}),r.jsx("th",{children:"Price"}),r.jsx("th",{children:"Billing Cycle"}),r.jsx("th",{children:"Status"}),r.jsx("th",{className:"text-right",children:"Actions"})]})}),r.jsx("tbody",{children:n.map(g=>r.jsxs("tr",{children:[r.jsx("td",{children:g.name}),r.jsxs("td",{children:["",Number(g.price).toFixed(2)]}),r.jsxs("td",{children:["Every ",g.interval>1?g.interval:""," ",g.period,g.interval>1?"s":""]}),r.jsx("td",{children:r.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${g.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.status})}),r.jsxs("td",{className:"actions-cell text-right",children:[r.jsx("button",{onClick:()=>e(`/dashboard/clinic-subscriptions/edit/${g.id}`),className:"subscription-btn subscription-btn-secondary",title:"Edit Plan",children:r.jsx(lu,{size:16,className:"inline-block"})}),g.status==="active"&&r.jsx("button",{onClick:()=>p(g.id),className:"subscription-btn subscription-btn-danger",title:"Deactivate Plan",disabled:i,children:r.jsx(or,{size:16,className:"inline-block"})})]})]},g.id))})]})}),!i&&n.length===0&&!o&&r.jsx("p",{className:"text-center text-gray-500 mt-6",children:"No clinic subscription plans found. Add one to get started!"})]})]})},Nte=()=>{const e=_t(),[n,t]=w.useState({name:"",description:"",price:0,period:"monthly",interval:1,razorpay_plan_id:"",status:"active"}),[i,a]=w.useState(!1),[o,l]=w.useState(null),[d,f]=w.useState(null);w.useEffect(()=>{if(d){const b=setTimeout(()=>f(null),5e3);return()=>clearTimeout(b)}},[d]);const u=b=>{const{name:v,value:S,type:k}=b.target;t(T=>({...T,[v]:k==="number"?parseFloat(S):S}))},p=async b=>{if(b.preventDefault(),a(!0),l(null),f(null),!n.name||!n.price||!n.period||n.interval===void 0||n.interval<=0){l("Please fill in all required fields (Name, Price, Period, Interval > 0)."),a(!1);return}try{await gte(n),f({type:"success",message:"Clinic plan created successfully! Redirecting..."}),setTimeout(()=>{e("/dashboard/clinic-subscriptions")},2e3)}catch(v){const S=v.message||"Failed to create clinic plan.";l(S),f({type:"error",message:S})}finally{a(!1)}},g=()=>{e(-1)};return r.jsxs("div",{className:"subscription-page-container",children:[d&&r.jsxs("div",{className:`${d.type==="success"?"bg-green-50 border-green-400 text-green-700":"bg-red-50 border-red-400 text-red-700"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[r.jsxs("div",{className:"flex items-center",children:[d.type==="success"?r.jsx(cs,{size:18,className:"mr-2 text-green-500"}):r.jsx(Hi,{size:18,className:"mr-2 text-red-500"}),r.jsx("span",{children:d.message})]}),r.jsx("button",{onClick:()=>f(null),className:`${d.type==="success"?"text-green-600 hover:text-green-800":"text-red-600 hover:text-red-800"} ml-4`,children:r.jsx(Qn,{size:16})})]}),r.jsxs("div",{className:"subscription-form",children:[r.jsx("h1",{children:"Add New Clinic Subscription Plan"}),o&&r.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:o}),r.jsxs("form",{onSubmit:p,children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"name",children:["Plan Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:u,required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",children:"Description"}),r.jsx("textarea",{id:"description",name:"description",rows:3,value:n.description||"",onChange:u})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"price",children:["Price (INR) ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:n.price||"",onChange:u,required:!0})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"period",children:["Billing Period ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{id:"period",name:"period",value:n.period||"monthly",onChange:u,required:!0,children:[r.jsx("option",{value:"daily",children:"Daily"}),r.jsx("option",{value:"weekly",children:"Weekly"}),r.jsx("option",{value:"monthly",children:"Monthly"}),r.jsx("option",{value:"yearly",children:"Yearly"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"interval",children:["Interval ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:n.interval||1,onChange:u,required:!0})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),r.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:n.razorpay_plan_id||"",onChange:u})]}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:g,className:"subscription-btn subscription-btn-secondary",children:"Back"}),r.jsxs("button",{type:"submit",disabled:i,className:"subscription-btn",children:[i?r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,i?"Creating...":"Create Plan"]})]})]})]})]})},Cte=()=>{const{id:e}=Br(),n=_t(),[t,i]=w.useState(null),[a,o]=w.useState({}),[l,d]=w.useState(!1),[f,u]=w.useState(!0),[p,g]=w.useState(null),[b,v]=w.useState(null),S=w.useCallback(async()=>{if(!e){g("Plan ID is missing."),u(!1);return}u(!0),g(null);try{const M=await mte(e);i(M),o({name:M.name,description:M.description||"",price:Number(M.price),period:M.period,interval:Number(M.interval),razorpay_plan_id:M.razorpay_plan_id||"",status:M.status})}catch(M){g(M.message||"Failed to fetch clinic plan details."),v({type:"error",message:M.message||"Failed to fetch plan details."})}finally{u(!1)}},[e]);w.useEffect(()=>{S()},[S]),w.useEffect(()=>{if(b){const M=setTimeout(()=>v(null),5e3);return()=>clearTimeout(M)}},[b]);const k=M=>{const{name:I,value:U,type:L}=M.target;o($=>({...$,[I]:L==="number"?parseFloat(U):U}))},T=async M=>{if(M.preventDefault(),!e){g("Plan ID is missing.");return}if(d(!0),g(null),v(null),!a.name||!a.price||!a.period||a.interval===void 0||a.interval<=0){g("Please fill in all required fields (Name, Price, Period, Interval > 0)."),d(!1);return}try{await yte(e,a),v({type:"success",message:"Clinic plan updated successfully! Redirecting..."}),setTimeout(()=>{n(-1)},2e3)}catch(I){const U=I.message||"Failed to update clinic plan.";g(U),v({type:"error",message:U})}finally{d(!1)}},P=()=>{n(-1)};return f?r.jsx("div",{className:"p-6 text-center",children:"Loading clinic plan details..."}):p&&!t?r.jsx("div",{className:"p-6 text-center text-red-500",children:p}):t?r.jsxs("div",{className:"subscription-page-container",children:[b&&r.jsxs("div",{className:`${b.type==="success"?"bg-green-100 border-green-400 text-green-800":"bg-red-100 border-red-400 text-red-800"}
                  px-4 py-3 rounded-md border mb-4 flex items-center justify-between shadow-sm fixed top-20 right-4 z-[100]`,role:"alert",children:[r.jsxs("div",{className:"flex items-center",children:[b.type==="success"?r.jsx(cs,{size:18,className:"mr-2"}):r.jsx(Hi,{size:18,className:"mr-2"}),r.jsx("span",{children:b.message})]}),r.jsx("button",{onClick:()=>v(null),className:"ml-4",children:r.jsx(Qn,{size:16})})]}),r.jsxs("div",{className:"subscription-form",children:[r.jsx("h1",{children:"Edit Clinic Subscription Plan"}),p&&r.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-md mb-4 text-sm",role:"alert",children:p}),r.jsxs("form",{onSubmit:T,children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"name",children:["Plan Name ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",id:"name",name:"name",value:a.name||"",onChange:k,required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",children:"Description"}),r.jsx("textarea",{id:"description",name:"description",rows:3,value:a.description||"",onChange:k})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"price",children:["Price (INR) ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",id:"price",name:"price",step:"0.01",min:"0",value:a.price!==void 0?a.price:"",onChange:k,required:!0})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"period",children:["Billing Period ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("select",{id:"period",name:"period",value:a.period||"monthly",onChange:k,required:!0,children:[r.jsx("option",{value:"daily",children:"Daily"}),r.jsx("option",{value:"weekly",children:"Weekly"}),r.jsx("option",{value:"monthly",children:"Monthly"}),r.jsx("option",{value:"yearly",children:"Yearly"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"interval",children:["Interval ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"number",id:"interval",name:"interval",min:"1",value:a.interval!==void 0?a.interval:"",onChange:k,required:!0})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"razorpay_plan_id",children:"Razorpay Plan ID (Optional)"}),r.jsx("input",{type:"text",id:"razorpay_plan_id",name:"razorpay_plan_id",value:a.razorpay_plan_id||"",onChange:k})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"status",children:"Status"}),r.jsxs("select",{id:"status",name:"status",value:a.status||"active",onChange:k,children:[r.jsx("option",{value:"active",children:"Active"}),r.jsx("option",{value:"inactive",children:"Inactive"})]})]}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:P,className:"subscription-btn subscription-btn-secondary",children:"Back"}),r.jsxs("button",{type:"submit",disabled:l,className:"subscription-btn",children:[l?r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}):null,l?"Saving...":"Save Changes"]})]})]})]})]}):r.jsx("div",{className:"p-6 text-center text-gray-500",children:"Clinic plan not found."})},jte=()=>{const e=_t(),[n,t]=w.useState([]),[i,a]=w.useState(""),[o,l]=w.useState(!0),[d,f]=w.useState(null),[u,p]=w.useState(!1),[g,b]=w.useState(null),v=w.useCallback(async()=>{f(null);try{const T=(await aS()).filter(P=>P.status==="active");t(T),T.length>0&&!i&&a(T[0].id)}catch(k){console.error("Error fetching plans:",k),f(`Failed to load subscription plans: ${k.message}`)}},[]);w.useEffect(()=>{(async()=>{l(!0);try{const T=await vte();if(T&&T.short_url){window.location.href=T.short_url,f("You have a pending subscription. Redirecting to payment...");return}await v()}catch(T){console.error("Error during initial page load:",T),f(`An unexpected error occurred: ${T.message}`)}finally{l(!1)}})()},[v]);const S=async()=>{if(!i){b("Please select a clinic subscription plan.");return}const k=n.find(T=>T.id===i);if(!k){b("Selected plan details not found.");return}p(!0),b(null);try{console.log("Initiating Razorpay clinic subscription for plan:",k);const T=await bte(i);if(T&&T.short_url)window.location.href=T.short_url;else throw new Error("Failed to get Razorpay clinic subscription link from backend.")}catch(T){console.error("Error starting clinic subscription:",T),b(`Failed to start clinic subscription: ${T.message}`),p(!1)}};return o?r.jsx("div",{className:"loading-state-subscription",children:"Loading clinic plans..."}):d?r.jsxs("div",{className:"subscription-page-container",children:[r.jsxs("div",{className:"error-alert-subscription",role:"alert",children:[r.jsx("strong",{children:"Error: "}),r.jsx("span",{children:d})]}),r.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[r.jsx(rn,{size:16}),"Back"]})]}):r.jsxs("div",{className:"subscription-page-container",children:[r.jsxs("button",{onClick:()=>e(-1),className:"all-patients-back-button",children:[r.jsx(rn,{size:16}),"Back"]}),r.jsxs("h1",{children:[r.jsx(pI,{size:28}),"Buy Pro Plan for Clinic"]}),g&&r.jsx("div",{className:"error-alert-subscription",role:"alert",children:r.jsx("span",{children:g})}),r.jsxs("div",{className:"subscription-form",children:[r.jsx("h2",{children:"Available Pro Plans"}),n.length===0?r.jsx("p",{className:"empty-state",children:"No active clinic subscription plans found."}):r.jsx("div",{className:"subscription-plan-list",children:n.map(k=>r.jsxs("div",{className:`subscription-plan-card ${i===k.id?"selected-plan":""}`,onClick:()=>a(k.id),children:[r.jsx("h3",{children:k.name}),r.jsxs("p",{className:"price",children:["",Number(k.price).toFixed(2)]}),r.jsxs("p",{className:"duration",children:["Every ",k.interval," ",k.period,k.interval>1?"s":""]}),k.description&&r.jsx("p",{children:k.description})]},k.id))})]}),r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{onClick:S,disabled:!i||u||n.length===0,className:"subscription-btn",children:[u&&r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2 inline-block"}),u?"Initiating Payment...":"Buy Pro Plan"]})})]})},_te=()=>{const e=_t(),[n,t]=w.useState([]),[i,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,p]=w.useState(!1),[g,b]=w.useState(null),[v,S]=w.useState({name:"",email:"",password:"",role:"user"}),[k,T]=w.useState({name:"",email:"",role:"",password:"",confirmPassword:""}),[P,M]=w.useState(""),[I,U]=w.useState(""),[L,$]=w.useState({}),[z,F]=w.useState(!1),[Q,R]=w.useState(null),[B,Y]=w.useState([]),[re,ne]=w.useState(""),[G,V]=w.useState(!1),[W,J]=w.useState(null);w.useEffect(()=>{const ae=setTimeout(()=>{U(P)},500);return()=>{clearTimeout(ae)}},[P]),w.useEffect(()=>{he(I)},[I]);const he=async(ae="")=>{a(!0);try{const Re=ae?`/api/users?search=${encodeURIComponent(ae)}`:"/api/users",Ce=await(await me(Re)).json();if(t(Ce),Ce.length>0){const Se=[...new Set(Ce.map(Me=>Me.clinic_id).filter(Me=>!!Me))],De={};await Promise.all(Se.map(async Me=>{try{const et=await pte(Me);De[Me]=et}catch(et){console.error(`Failed to fetch subscription status for clinic ${Me}`,et),De[Me]={hasProPlan:!1}}})),$(De)}l(null)}catch(Re){l("Failed to fetch users."),console.error(Re)}finally{a(!1)}},A=async ae=>{ae.preventDefault();try{await me("/users",{method:"POST",body:JSON.stringify(v)}),f(!1),S({name:"",email:"",password:"",role:"user"}),he()}catch(Re){l("Failed to add user."),console.error(Re)}},ce=async ae=>{if(ae.preventDefault(),!g)return;const{password:Re,confirmPassword:Ae,...Ce}=k,Se={...Ce};if(Re){if(Re.length<6){l("Password must be at least 6 characters long.");return}if(Re!==Ae){l("Passwords do not match.");return}Se.password=Re}try{await me(`/users/${g.id}`,{method:"PUT",body:JSON.stringify(Se)}),p(!1),b(null),T({...k,password:"",confirmPassword:""}),he()}catch(De){l("Failed to update user."),console.error(De)}},se=async ae=>{if(window.confirm("Are you sure you want to delete this user?"))try{await me(`/users/${ae}`,{method:"DELETE"}),he()}catch(Re){l("Failed to delete user."),console.error(Re)}},D=ae=>{b(ae),T({name:ae.name,email:ae.email,role:ae.role,password:"",confirmPassword:""}),p(!0)},oe=async()=>{V(!0);try{const ae=await aS();Y(ae),ae.length>0&&ne(ae[0].id),J(null)}catch(ae){J("Failed to fetch subscription plans."),console.error(ae)}finally{V(!1)}},xe=ae=>{R(ae),F(!0),oe()},Z=async ae=>{if(ae.preventDefault(),!Q||!re){l("Please select a clinic and a plan.");return}try{await me("/clinic-subscriptions/manual-activate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clinicId:Q,planId:re})}),F(!1),R(null),ne(""),he(),l(null)}catch(Re){l("Failed to manually activate clinic subscription."),console.error(Re)}},ue=async ae=>{if(window.confirm("Are you sure you want to cancel this clinic's subscription? This action cannot be undone."))try{await hte(ae),he(),l(null)}catch(Re){l("Failed to cancel subscription."),console.error(Re)}};return i?r.jsx("div",{children:"Loading users..."}):o?r.jsx("div",{className:"error-message",children:o}):r.jsxs("div",{className:"user-management-page",children:[r.jsxs("div",{className:"user-management-header",children:[r.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[r.jsx(rn,{size:16}),"Back"]}),r.jsx("h1",{children:"User Management"})]}),r.jsxs("div",{className:"controls-container",children:[r.jsx("input",{type:"text",placeholder:"Search by name or email...",value:P,onChange:ae=>M(ae.target.value),className:"search-input"}),r.jsx("button",{onClick:()=>f(!0),className:"add-user-button",children:"Add New User"})]}),d&&r.jsx("div",{className:"modal",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("span",{className:"close-button",onClick:()=>f(!1),children:""}),r.jsx("h2",{children:"Add New User"}),r.jsxs("form",{onSubmit:A,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Name:"}),r.jsx("input",{type:"text",value:v.name,onChange:ae=>S({...v,name:ae.target.value}),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Email:"}),r.jsx("input",{type:"email",value:v.email,onChange:ae=>S({...v,email:ae.target.value}),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Password:"}),r.jsx("input",{type:"password",value:v.password,onChange:ae=>S({...v,password:ae.target.value}),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Role:"}),r.jsxs("select",{value:v.role,onChange:ae=>S({...v,role:ae.target.value}),children:[r.jsx("option",{value:"user",children:"User"}),r.jsx("option",{value:"admin",children:"Admin"}),r.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),r.jsx("button",{type:"submit",children:"Add User"})]})]})}),u&&g&&r.jsx("div",{className:"modal",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("span",{className:"close-button",onClick:()=>p(!1),children:""}),r.jsx("h2",{children:"Edit User"}),r.jsxs("form",{onSubmit:ce,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Name:"}),r.jsx("input",{type:"text",value:k.name,onChange:ae=>T({...k,name:ae.target.value}),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Email:"}),r.jsx("input",{type:"email",value:k.email,onChange:ae=>T({...k,email:ae.target.value}),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Role:"}),r.jsxs("select",{value:k.role,onChange:ae=>T({...k,role:ae.target.value}),children:[r.jsx("option",{value:"user",children:"User"}),r.jsx("option",{value:"admin",children:"Admin"}),r.jsx("option",{value:"super_admin",children:"Super Admin"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"New Password (optional):"}),r.jsx("input",{type:"password",value:k.password,onChange:ae=>T({...k,password:ae.target.value})})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Confirm New Password:"}),r.jsx("input",{type:"password",value:k.confirmPassword,onChange:ae=>T({...k,confirmPassword:ae.target.value})})]}),r.jsx("button",{type:"submit",children:"Update User"})]})]})}),z&&r.jsx("div",{className:"modal",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("span",{className:"close-button",onClick:()=>F(!1),children:""}),r.jsx("h2",{children:"Select Subscription Plan for Clinic"}),G&&r.jsx("div",{children:"Loading plans..."}),W&&r.jsx("div",{className:"error-message",children:W}),!G&&!W&&B.length===0&&r.jsx("div",{children:"No active subscription plans available."}),!G&&!W&&B.length>0&&r.jsxs("form",{onSubmit:Z,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Select Plan:"}),r.jsx("select",{value:re,onChange:ae=>ne(ae.target.value),required:!0,children:B.map(ae=>r.jsxs("option",{value:ae.id,children:[ae.name," - $",ae.price,"/",ae.interval," ",ae.period]},ae.id))})]}),r.jsx("button",{type:"submit",children:"Activate Selected Plan"})]})]})}),r.jsxs("table",{className:"user-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Name"}),r.jsx("th",{children:"Email"}),r.jsx("th",{children:"Role"}),r.jsx("th",{children:"Clinic ID"}),r.jsx("th",{children:"Subscription Status"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:n.map(ae=>{const Re=ae.clinic_id||"N/A",Ae=Re!=="N/A"?L[Re]:null,Ce=(Ae==null?void 0:Ae.hasProPlan)??!1,Se=Ce?"PRO":"Standard";return r.jsxs("tr",{children:[r.jsx("td",{children:ae.name}),r.jsx("td",{children:ae.email}),r.jsx("td",{children:ae.role}),r.jsx("td",{children:Re}),r.jsx("td",{children:Re!=="N/A"?r.jsx("span",{className:Ce?"pro-badge":"standard-badge",children:Se}):"N/A"}),r.jsxs("td",{children:[r.jsx("button",{onClick:()=>D(ae),className:"edit-button",children:"Edit"}),r.jsx("button",{onClick:()=>se(ae.id),className:"delete-button",children:"Delete"}),ae.clinic_id&&!Ce&&r.jsx("button",{onClick:()=>xe(ae.clinic_id),className:"start-subscription-button",children:"Start Subscription"}),ae.clinic_id&&Ce&&r.jsx("button",{onClick:()=>ue(ae.clinic_id),className:"cancel-subscription-button",children:"Cancel Subscription"})]})]},ae.id)})})]})]})},kte="_modalOverlay_1spz3_3",Tte="_modalContent_1spz3_29",Ete="_modalHeader_1spz3_53",Ate="_modalTitle_1spz3_71",Pte="_modalCloseButton_1spz3_83",Dte="_modalBody_1spz3_111",Ite="_formGroup_1spz3_119",Rte="_inputField_1spz3_141",Mte="_errorText_1spz3_175",Ote="_successText_1spz3_193",Lte="_modalFooter_1spz3_211",Fte="_button_1spz3_227",$te="_buttonPrimary_1spz3_247",zte="_buttonSecondary_1spz3_265",zr={modalOverlay:kte,modalContent:Tte,modalHeader:Ete,modalTitle:Ate,modalCloseButton:Pte,modalBody:Dte,formGroup:Ite,inputField:Rte,errorText:Mte,successText:Ote,modalFooter:Lte,button:Fte,buttonPrimary:$te,buttonSecondary:zte},Ute=({isOpen:e,onClose:n})=>{const[t,i]=w.useState(""),[a,o]=w.useState(!1),[l,d]=w.useState(!1),[f,u]=w.useState(null),[p,g]=w.useState(null);w.useEffect(()=>{e&&b()},[e]);const b=async()=>{o(!0),u(null);try{const S=await me("/api/global-settings/app_gemini_api_key");if(S.ok){const k=await S.json();i(k.value||"")}else S.status}catch(S){console.warn("Could not fetch existing key:",S)}finally{o(!1)}},v=async()=>{d(!0),u(null),g(null);try{if(!(await me("/api/global-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:"app_gemini_api_key",value:t})})).ok)throw new Error("Failed to save API Key");g("API Key updated successfully!"),setTimeout(()=>{n(),g(null)},1500)}catch(S){u(S.message||"Error saving key")}finally{d(!1)}};return e?r.jsx("div",{className:zr.modalOverlay,children:r.jsxs("div",{className:zr.modalContent,children:[r.jsxs("div",{className:zr.modalHeader,children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[r.jsx(ik,{size:24}),r.jsx("h3",{className:zr.modalTitle,children:"App Gemini API Key"})]}),r.jsx("button",{onClick:n,className:zr.modalCloseButton,children:r.jsx(Qn,{size:20})})]}),r.jsxs("div",{className:zr.modalBody,children:[f&&r.jsx("div",{className:zr.errorText,children:f}),p&&r.jsx("div",{className:zr.successText,children:p}),r.jsxs("div",{className:zr.formGroup,children:[r.jsx("label",{htmlFor:"gemini-key",children:"Gemini API Key"}),r.jsx("input",{type:"text",id:"gemini-key",value:t,onChange:S=>i(S.target.value),className:zr.inputField,placeholder:"Enter Gemini API Key (AIza...)",disabled:a||l})]}),r.jsx("p",{style:{fontSize:"0.9em",color:"var(--secondary-text-color, #666)"},children:"This key will be used as a fallback for all clinics if their specific Gemini API key is not configured."})]}),r.jsxs("div",{className:zr.modalFooter,children:[r.jsx("button",{onClick:n,className:`${zr.button} ${zr.buttonSecondary}`,disabled:l,children:"Cancel"}),r.jsx("button",{onClick:v,className:`${zr.button} ${zr.buttonPrimary}`,disabled:l,children:l?"Saving...":"Save Key"})]})]})}):null},Bte=()=>{const[e,n]=w.useState(!1);return r.jsxs("div",{className:"admin-panel-container",children:[r.jsxs("h1",{className:"admin-panel-title",children:[r.jsx(Sb,{size:32,className:"icon-margin"}),"Super Admin Dashboard"]}),r.jsxs("div",{className:"admin-panel-grid",children:[r.jsxs(ls,{to:"/dashboard/clinic-subscriptions",className:"admin-panel-card",children:[r.jsx(Eh,{size:48,className:"card-icon"}),r.jsx("h2",{children:"Manage Clinic Subscription Plans"}),r.jsx("p",{children:"Add, edit, and view clinic subscription plans."})]}),r.jsxs(ls,{to:"/dashboard/users",className:"admin-panel-card",children:[r.jsx(zh,{size:48,className:"card-icon"}),r.jsx("h2",{children:"User Management"}),r.jsx("p",{children:"Add, edit, and delete users; manage user roles."})]}),r.jsxs("div",{className:"admin-panel-card",onClick:()=>n(!0),style:{cursor:"pointer"},children:[r.jsx(ik,{size:48,className:"card-icon"}),r.jsx("h2",{children:"Manage App Gemini API Key"}),r.jsx("p",{children:"Update the fallback Gemini API key used by the application."})]})]}),r.jsx(Ute,{isOpen:e,onClose:()=>n(!1)})]})},Y0="tutorialCurrentStep",qte=({onActionComplete:e,onStaffAdded:n,requiredRole:t})=>{const[i,a]=w.useState(""),[o,l]=w.useState(""),[d,f]=w.useState(""),[u,p]=w.useState(!1),g=t||"receptionist";w.useEffect(()=>{a(t==="lab"?"Lab":t==="pharmacy"?"Pharmacy":"")},[t]);const b=async()=>{if(!i||!o||!d){e(!1,"Please fill all fields.");return}p(!0);try{const v=await me("/api/staff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:i,email:o,role:g,password:d})});if(v.ok)e(!0,`Successfully added "${i}" as a ${g}!`),a(""),l(""),f(""),n&&n(g);else{const S=await v.json();e(!1,`Failed: ${S.message||v.statusText}`)}}catch(v){e(!1,`Error: ${v instanceof Error?v.message:String(v)}`)}finally{p(!1)}};return r.jsxs("div",{className:"tutorial-interactive-component",children:[r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"text",placeholder:"Name",value:i,onChange:v=>a(v.target.value),disabled:u,className:"tutorial-input"}),r.jsx("input",{type:"email",placeholder:"Email",value:o,onChange:v=>l(v.target.value),disabled:u,className:"tutorial-input"})]}),r.jsxs("div",{className:"input-group",children:[r.jsx("input",{type:"password",placeholder:"Password",value:d,onChange:v=>f(v.target.value),disabled:u,className:"tutorial-input"}),r.jsx("div",{className:"role-badge",children:g==="lab"?"Lab Tech":g==="pharmacy"?"Pharmacist":"Receptionist"})]}),r.jsx("button",{onClick:b,className:"tutorial-button primary small",disabled:u,children:u?"Adding...":"Add Staff"})]})},Vte=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[i,a]=w.useState(!1),o=async()=>{t(!0);try{(await me("/api/drugs/import-defaults",{method:"POST"})).ok?(a(!0),e(!0,"Default medications imported successfully!","pharmacyImport")):e(!1,"Failed to import medications.")}catch{e(!1,"Error importing medications.")}finally{t(!1)}};return r.jsxs("div",{className:"tutorial-interactive-component center-content",children:[r.jsx("p",{className:"action-hint",children:"One click to populate your inventory."}),i?r.jsxs("div",{className:"success-badge",children:[r.jsx(Qx,{size:16})," Imported"]}):r.jsx("button",{onClick:o,className:"tutorial-button primary",disabled:n,children:n?"Importing...":r.jsxs(r.Fragment,{children:[r.jsx(Jx,{size:18})," Import Drugs"]})})]})},Hte=({onActionComplete:e})=>{const[n,t]=w.useState(!1),[i,a]=w.useState(!1),o=async()=>{t(!0);try{(await me("/api/lab-tests/import-defaults",{method:"POST"})).ok?(a(!0),e(!0,"Default lab tests imported successfully!","labImport")):e(!1,"Failed to import lab tests.")}catch{e(!1,"Error importing lab tests.")}finally{t(!1)}};return r.jsxs("div",{className:"tutorial-interactive-component center-content",children:[r.jsx("p",{className:"action-hint",children:"Setup your lab with common tests."}),i?r.jsxs("div",{className:"success-badge",children:[r.jsx(Qx,{size:16})," Imported"]}):r.jsx("button",{onClick:o,className:"tutorial-button primary",disabled:n,children:n?"Importing...":r.jsxs(r.Fragment,{children:[r.jsx(Yl,{size:18})," Import Tests"]})})]})},Gte=[{icon:"",title:"Fever & Cold",description:"Rajesh Kumar, 35M, fever 2 days, body pain.",text:"Rajesh Kumar, 35 year old male, fever since 2 days, cold, body pain, no cough"},{icon:"",title:"Stomach Ache",description:"Priya Sharma, 28F, acidity, bloating 3 days.",text:"Priya Sharma, 28 year old female, stomach pain after eating, acidity, bloating since 3 days"}],Yte=({onSelectExample:e})=>r.jsxs("div",{className:"tutorial-interactive-component",children:[r.jsx("p",{className:"action-hint",children:"Click an example to try the AI:"}),r.jsx("div",{className:"example-cards-grid",children:Gte.map((n,t)=>r.jsxs("div",{className:"tutorial-example-card",onClick:()=>e(n.text),children:[r.jsx("div",{className:"example-icon",children:n.icon}),r.jsxs("div",{className:"example-info",children:[r.jsx("h4",{children:n.title}),r.jsx("p",{children:n.description})]}),r.jsx($h,{size:16,className:"arrow-icon"})]},t))})]}),W0=[{title:"Welcome to OPD Zero",description:"Your all-in-one clinic management solution. Let's get your clinic ready in less than 2 minutes.",icon:r.jsx(OR,{size:48,className:"step-icon welcome"}),component:null,actionText:"Get Started"},{title:"Pharmacy Setup",description:"Start by populating your pharmacy. We can import a standard list of medicines for you.",icon:r.jsx(Jx,{size:48,className:"step-icon pharmacy"}),component:Vte,actionText:"Next",showSkip:!0},{title:"Lab Configuration",description:"Next, let's set up your lab. Import common lab tests to start generating reports immediately.",icon:r.jsx(Yl,{size:48,className:"step-icon lab"}),component:Hte,actionText:"Next",showSkip:!0},{title:"Add Your Team",description:"Invite your staff. Create accounts for receptionists, pharmacists, and lab technicians.",icon:r.jsx(zh,{size:48,className:"step-icon staff"}),component:qte,actionText:"Next",showSkip:!0},{title:"Experience the AI",description:"The magic happens here. Select an example case below to see how our AI creates patient records instantly.",icon:r.jsx(dI,{size:48,className:"step-icon ai"}),component:Yte,actionText:null,isLast:!0}],Wte=({onClose:e,onMarkAsSeen:n})=>{const[t,i]=w.useState(()=>{const T=localStorage.getItem(Y0);return T?parseInt(T,10):0}),[a,o]=w.useState(!1),[l,d]=w.useState(null),[f,u]=w.useState(null),p=_t();w.useEffect(()=>{localStorage.setItem(Y0,t.toString()),d(null)},[t]);const g=()=>{o(!0),setTimeout(()=>{i(T=>Math.min(T+1,W0.length-1)),o(!1)},300)},b=(T,P,M)=>{u(T),d(P),T&&(M==="pharmacyImport"||M==="labImport")&&setTimeout(g,1e3)},v=()=>{n(),e(),localStorage.removeItem(Y0)},S=T=>{const P=encodeURIComponent(T);p(`/dashboard?tab=newtons-ai&caseDetails=${P}`),v()},k=W0[t];return r.jsx("div",{className:"tutorial-overlay",children:r.jsxs("div",{className:`tutorial-card ${a?"fade-out":"fade-in"}`,children:[r.jsxs("div",{className:"tutorial-visual",children:[r.jsx("div",{className:"icon-circle",children:k.icon}),r.jsx("div",{className:"step-indicators",children:W0.map((T,P)=>r.jsx("div",{className:`step-dot ${P===t?"active":""} ${P<t?"completed":""}`},P))})]}),r.jsxs("div",{className:"tutorial-content",children:[r.jsx("button",{className:"close-button",onClick:v,title:"Close Tutorial",children:r.jsx(Qn,{size:20})}),r.jsxs("div",{className:"text-content",children:[r.jsx("h2",{children:k.title}),r.jsx("p",{className:"description",children:k.description})]}),r.jsxs("div",{className:"interactive-area",children:[k.component?r.jsx(k.component,{onActionComplete:b,onSelectExample:S}):null,l&&r.jsx("div",{className:`status-message ${f?"success":"error"}`,children:l})]}),r.jsxs("div",{className:"action-footer",children:[k.showSkip&&r.jsx("button",{onClick:g,className:"tutorial-button text-only",children:"Skip for now"}),k.actionText&&r.jsxs("button",{onClick:g,className:"tutorial-button primary",children:[k.actionText," ",r.jsx($h,{size:16})]})]})]})]})})},Qte=(e,n,t)=>{const i=Math.abs(e.getTime()-n.getTime());return Math.ceil(i/(1e3*60*60*24))<=t},Jte=()=>{const[e,n]=w.useState([]),[t,i]=w.useState(!0),[a,o]=w.useState(null),[l,d]=w.useState(""),[f,u]=w.useState(""),[p,g]=w.useState(1),[b]=w.useState(10),v=new Date,S=_t();w.useEffect(()=>{(async()=>{i(!0);try{const R=await me("/api/pharmacy-orders/refill-reminders");if(R.ok){const B=await R.json();n(B)}else o("Failed to fetch refill reminders.")}catch{o("An error occurred while fetching data.")}finally{i(!1)}})()},[]);const k=F=>{d(F.target.value),g(1)},T=F=>{u(F.target.value),g(1)},P=e.filter(F=>{const Q=l?F.medicationRefillDates.some(B=>new Date(B.refillDate).toLocaleDateString()===new Date(l).toLocaleDateString()):!0,R=f?F.patientName.toLowerCase().includes(f.toLowerCase())||F.patientPhoneNumber.includes(f)||F.items.some(B=>B.name.toLowerCase().includes(f.toLowerCase())):!0;return Q&&R}),M=p*b,I=M-b,U=P.slice(I,M),L=Math.ceil(P.length/b),$=F=>g(F),z=async F=>{try{const Q=await me(`/api/queue/patient/${F}/latest`);if(Q.ok){const R=await Q.json();if(R!=null&&R._id)S(`/dashboard/edit-complaint/${R._id}`);else{const B=await me("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:F})});if(B.ok){const Y=await B.json();Y!=null&&Y.id&&S(`/dashboard/edit-complaint/${Y.id}`)}}}}catch(Q){console.error("Error handling row click:",Q),o("Failed to navigate to patient complaint.")}};return t?r.jsx("div",{children:"Loading..."}):a?r.jsx("div",{children:a}):r.jsxs("div",{className:"refill-reminders-container",children:[r.jsx("h1",{children:"Refill Reminders"}),r.jsxs("div",{className:"controls-container",children:[r.jsxs("div",{className:"filter-container",children:[r.jsx("label",{htmlFor:"refillDate",children:"Filter by Refill Date: "}),r.jsx("input",{type:"date",id:"refillDate",value:l,onChange:k})]}),r.jsxs("div",{className:"search-container",children:[r.jsx("label",{htmlFor:"search",children:"Search: "}),r.jsx("input",{type:"text",id:"search",placeholder:"Search by patient name, phone, or medication",value:f,onChange:T})]})]}),r.jsxs("table",{children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Patient Name"}),r.jsx("th",{children:"Patient Phone Number"}),r.jsx("th",{children:"Medications"}),r.jsx("th",{children:"Refill Dates"})]})}),r.jsx("tbody",{children:U.length>0?U.map(F=>r.jsxs("tr",{onClick:()=>z(F.patientId),style:{cursor:"pointer"},children:[r.jsx("td",{children:F.patientName}),r.jsx("td",{children:F.patientPhoneNumber}),r.jsxs("td",{children:[r.jsx("ul",{children:F.items.map((Q,R)=>r.jsxs("li",{children:[Q.name," (Qty: ",Q.quantity,")",Q.tabletsPerDay&&r.jsxs("span",{children:[" - ",Q.tabletsPerDay," / day"]}),Q.numberOfDays&&r.jsxs("span",{children:[" for ",Q.numberOfDays," days"]})]},R))}),r.jsxs("div",{children:["Last Updated: ",new Date(F.updatedAt).toLocaleDateString()]}),F.prescription_for_unavailable_drugs&&r.jsxs("div",{className:"unavailable-prescription",children:[r.jsx("strong",{children:"Unavailable:"})," ",F.prescription_for_unavailable_drugs]}),F.billStatus&&r.jsxs("div",{className:`bill-status ${F.billStatus}`,children:["Bill Status: ",F.billStatus]})]}),r.jsx("td",{children:r.jsx("ul",{children:F.medicationRefillDates.map((Q,R)=>{const B=new Date(Q.refillDate),Y=Qte(B,v,2);return r.jsxs("li",{className:Y?"highlight-refill-date":"",children:[Q.name,": ",B.toLocaleDateString()]},R)})})})]},F.id)):r.jsx("tr",{children:r.jsx("td",{colSpan:4,children:"No refill reminders found."})})})]}),r.jsxs("div",{className:"pagination-container",children:[r.jsx("button",{onClick:()=>$(p-1),disabled:p===1,children:"Previous"}),Array.from({length:L},(F,Q)=>r.jsx("button",{onClick:()=>$(Q+1),className:p===Q+1?"active":"",children:Q+1},Q+1)),r.jsx("button",{onClick:()=>$(p+1),disabled:p===L,children:"Next"})]})]})},Kte=()=>{const e=_t(),n=Gi();return w.useEffect(()=>{const t=new URLSearchParams(n.search),i=t.get("token"),a=t.get("caseDetails");i?(async()=>{try{const l=await me(`/api/patients?search=${i}&limit=1`);if(!l.ok)throw new Error("Failed to fetch patient by token");const f=(await l.json()).patients[0];if(!f)throw new Error("Patient with the given token not found");const u=await me(`/api/queue/patient/${f.id}/latest`);if(u.ok){const b=await u.json();if(b!=null&&b._id){e(`/dashboard/edit-complaint/${b._id}`,{state:{initialComplaint:a}});return}}const p=await me("/api/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:f.id,complaint:a})});if(!p.ok)throw new Error("Failed to create queue entry");const g=await p.json();if(g!=null&&g.id)e(`/dashboard/edit-complaint/${g.id}`,{state:{initialComplaint:a}});else throw new Error("Failed to get ID from new queue entry.")}catch(l){console.error("Error handling complaint URL:",l),e("/dashboard/search-patient")}})():e("/dashboard/search-patient")},[n,e]),r.jsx("div",{children:"Loading..."})},Xte=()=>{const[e,n]=w.useState([]),[t,i]=w.useState(!0),[a,o]=w.useState(null),l=w.useCallback(async()=>{i(!0),o(null);try{const u=await me("/api/notifications?all=true");if(u.ok){const g=(await u.json()).sort((b,v)=>{const S={expired_drug:1,near_expiry_drug:2,low_stock:3},k=S[b.type]||99,T=S[v.type]||99;return k!==T?k-T:new Date(v.created_at).getTime()-new Date(b.created_at).getTime()});n(g)}else o("Failed to fetch notifications."),console.error("Failed to fetch notifications:",u.statusText)}catch(u){o("Error fetching notifications."),console.error("Error fetching notifications:",u)}finally{i(!1)}},[]);w.useEffect(()=>{l()},[l]);const d=async u=>{try{const p=await me(`/api/notifications/${u}/read`,{method:"PUT"});p.ok?n(g=>g.map(b=>b.id===u?{...b,is_read:!0}:b)):console.error("Failed to mark notification as read:",p.statusText)}catch(p){console.error("Error marking notification as read:",p)}},f=async()=>{try{const u=e.filter(g=>!g.is_read).map(g=>g.id);if(u.length===0)return;const p=await me("/api/notifications/mark-all-read",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationIds:u})});p.ok?n(g=>g.map(b=>({...b,is_read:!0}))):console.error("Failed to mark all notifications as read:",p.statusText)}catch(u){console.error("Error marking all notifications as read:",u)}};return t?r.jsx("div",{className:"notifications-page-container",children:"Loading notifications..."}):a?r.jsx("div",{className:"notifications-page-container error-message",children:a}):r.jsxs("div",{className:"notifications-page-container",children:[r.jsx("h2",{className:"notifications-page-title",children:"All Notifications"}),r.jsx("div",{className:"notifications-actions",children:r.jsx("button",{onClick:f,disabled:e.every(u=>u.is_read),className:"mark-all-read-button",children:"Mark All As Read"})}),e.length===0?r.jsx("p",{className:"no-notifications-message",children:"No notifications to display."}):r.jsx("ul",{className:"notifications-list",children:e.map(u=>r.jsxs("li",{className:`notification-item ${u.is_read?"read":"unread"}`,children:[r.jsxs("div",{className:"notification-content",children:[r.jsxs("span",{className:"notification-type",children:[u.type.replace(/_/g," "),": "]}),u.message]}),r.jsxs("div",{className:"notification-meta",children:[r.jsx("span",{className:"notification-timestamp",children:new Date(u.created_at).toLocaleString()}),!u.is_read&&r.jsx("button",{onClick:()=>d(u.id),className:"mark-read-button",children:"Mark as Read"})]})]},u.id))})]})},D_=()=>{const e=_t(),[n,t]=w.useState([]),[i,a]=w.useState(!0),[o,l]=w.useState(null),[d,f]=w.useState(!1),[u,p]=w.useState(!1),[g,b]=w.useState(!1),[v,S]=w.useState(!1),[k,T]=w.useState(!1),[P,M]=w.useState(null),[I,U]=w.useState([]),[L,$]=w.useState(null),[z,F]=w.useState(""),[Q,R]=w.useState(""),[B,Y]=w.useState(""),[re,ne]=w.useState(""),[G,V]=w.useState(""),[W,J]=w.useState(""),[he,A]=w.useState(""),[ce,se]=w.useState(""),[D,oe]=w.useState(""),[xe,Z]=w.useState(""),[ue,ae]=w.useState(""),Re=w.useCallback(async()=>{a(!0),l(null);try{const ve=await me("/api/distributors");if(!ve.ok)throw new Error(`Failed to fetch distributors: ${ve.statusText}`);const ee=await ve.json();t(ee)}catch(ve){console.error("Failed to fetch distributors:",ve),l(ve.message||"Failed to load distributors.")}finally{a(!1)}},[]);w.useEffect(()=>{Re()},[Re]);const Ae=async ve=>{ve.preventDefault(),l(null);try{const ee=await me("/api/distributors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:z,contact_person:Q,phone:B,email:re,address:G,gst_number:W,drug_license_number:he})});if(!ee.ok){const fe=await ee.json();throw new Error(fe.message||"Failed to add distributor.")}alert("Distributor added successfully!"),ct(),Re()}catch(ee){console.error("Error adding distributor:",ee),l(ee.message||"Failed to add distributor.")}},Ce=async ve=>{if(ve.preventDefault(),l(null),!!P)try{const ee=await me(`/api/distributors/${P.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:z,contact_person:Q,phone:B,email:re,address:G,gst_number:W,drug_license_number:he})});if(!ee.ok){const fe=await ee.json();throw new Error(fe.message||"Failed to update distributor.")}alert("Distributor updated successfully!"),at(),Re()}catch(ee){console.error("Error updating distributor:",ee),l(ee.message||"Failed to update distributor.")}},Se=async()=>{if(l(null),!!P)try{const ve=await me(`/api/distributors/${P.id}`,{method:"DELETE"});if(!ve.ok){const ee=await ve.json();throw new Error(ee.message||"Failed to delete distributor.")}alert("Distributor deleted successfully!"),jt(),Re()}catch(ve){console.error("Error deleting distributor:",ve),l(ve.message||"Failed to delete distributor.")}},De=w.useCallback(async ve=>{l(null);try{const ee=await me(`/api/distributors/${ve}/payments`);if(!ee.ok)throw new Error(`Failed to fetch payments: ${ee.statusText}`);const qe=(await ee.json()).map(wt=>({...wt,order_value:parseFloat(wt.order_value),amount_paid:parseFloat(wt.amount_paid),balance_remaining:parseFloat(wt.balance_remaining)}));U(qe);const nt=await me(`/api/distributors/${ve}/balance`);if(!nt.ok)throw new Error(`Failed to fetch balance: ${nt.statusText}`);const lt=await nt.json();$({totalOrderValue:parseFloat(lt.totalOrderValue),totalAmountPaid:parseFloat(lt.totalAmountPaid),remainingBalance:parseFloat(lt.remainingBalance)})}catch(ee){console.error("Error fetching payments/balance:",ee),l(ee.message||"Failed to load payments or balance.")}},[]),Me=async ve=>{if(ve.preventDefault(),l(null),!!P)try{const ee=await me(`/api/distributors/${P.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:ce,order_value:parseFloat(D||"0"),amount_paid:parseFloat(xe||"0"),notes:ue})});if(!ee.ok){const fe=await ee.json();throw new Error(fe.message||"Failed to add payment.")}alert("Payment added successfully!"),Ue(),De(P.id)}catch(ee){console.error("Error adding payment:",ee),l(ee.message||"Failed to add payment.")}},et=()=>{F(""),R(""),Y(""),ne(""),V(""),J(""),A(""),l(null),f(!0)},ct=()=>{f(!1)},ut=ve=>{M(ve),F(ve.name),R(ve.contact_person||""),Y(ve.phone||""),ne(ve.email||""),V(ve.address||""),J(ve.gst_number||""),A(ve.drug_license_number||""),l(null),p(!0)},at=()=>{p(!1),M(null)},qt=ve=>{M(ve),l(null),b(!0)},jt=()=>{b(!1),M(null)},_e=ve=>{M(ve),De(ve.id),l(null),S(!0)},Fe=()=>{S(!1),M(null),U([]),$(null)},Pe=ve=>{M(ve),se(new Date().toISOString().split("T")[0]),oe("0"),Z("0"),ae(""),l(null),T(!0)},Ue=()=>{T(!1),M(null)};return i?r.jsx("div",{className:"loading-indicator",children:"Loading Distributors..."}):o?r.jsxs("div",{className:"error-indicator",children:["Error: ",o]}):r.jsxs("div",{className:"distributor-management-page",children:[r.jsxs("div",{className:"distributor-management-header",children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[r.jsxs("button",{onClick:()=>e(-1),className:"back-button",title:"Go Back",children:[r.jsx(rn,{size:24})," Back"]}),r.jsx("h2",{children:"Distributor Management"})]}),(()=>{const ve=n.reduce((fe,qe)=>fe+parseFloat(qe.remainingBalance||"0"),0),ee=ve>=0?"balance-positive":"balance-negative";return r.jsxs("div",{className:`total-balance-display ${ee}`,children:[r.jsx("strong",{children:"Total Combined Balance:"})," ",ve.toFixed(2)]})})(),r.jsxs("button",{onClick:et,className:"add-distributor-button",children:[r.jsx(ss,{size:18}),"Add New Distributor"]})]}),r.jsx("div",{className:"distributor-table-container",children:r.jsxs("table",{className:"distributor-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Name"}),r.jsx("th",{children:"Contact Person"}),r.jsx("th",{children:"Phone"}),r.jsx("th",{children:"Email"}),r.jsx("th",{children:"Address"}),r.jsx("th",{children:"GST Number"})," ",r.jsx("th",{children:"Drug License Number"})," ",r.jsx("th",{children:"Remaining Balance"})," ",r.jsx("th",{className:"actions-cell",children:"Actions"})]})}),r.jsx("tbody",{children:n.length===0?r.jsxs("tr",{children:[r.jsx("td",{colSpan:9,className:"no-results-message",children:"No distributors found."})," "]}):n.map(ve=>r.jsxs("tr",{children:[r.jsx("td",{children:ve.name}),r.jsx("td",{children:ve.contact_person||"-"}),r.jsx("td",{children:ve.phone||"-"}),r.jsx("td",{children:ve.email||"-"}),r.jsx("td",{children:ve.address||"-"}),r.jsx("td",{children:ve.gst_number||"-"})," ",r.jsx("td",{children:ve.drug_license_number||"-"})," ",r.jsxs("td",{className:parseFloat(ve.remainingBalance||"0")>0?"balance-positive":"balance-negative",children:["",ve.remainingBalance||"0.00"]})," ",r.jsx("td",{className:"actions-cell",children:r.jsxs("div",{className:"actions-buttons-group",children:[r.jsxs("button",{onClick:()=>_e(ve),className:"action-text-button view-button",title:"View Payments & Balance",children:[r.jsx($I,{size:16})," View Payments"]}),r.jsxs("button",{onClick:()=>Pe(ve),className:"action-text-button add-payment-button",title:"Add Payment",children:[r.jsx(ss,{size:16})," Add Payment"]}),r.jsx("button",{onClick:()=>ut(ve),className:"action-icon-button edit-button",title:"Edit Distributor",children:r.jsx(lu,{size:16})}),r.jsx("button",{onClick:()=>qt(ve),className:"action-icon-button delete-button",title:"Delete Distributor",children:r.jsx(or,{size:16})})]})})]},ve.id))})]})}),d&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:ct,className:"modal-close-button",children:""}),r.jsx("h3",{className:"modal-title",children:"Add New Distributor"}),o&&r.jsx("div",{className:"modal-error-message",children:o}),r.jsxs("form",{onSubmit:Ae,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"name",children:"Name:"}),r.jsx("input",{type:"text",id:"name",value:z,onChange:ve=>F(ve.target.value),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"contact_person",children:"Contact Person:"}),r.jsx("input",{type:"text",id:"contact_person",value:Q,onChange:ve=>R(ve.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"phone",children:"Phone:"}),r.jsx("input",{type:"text",id:"phone",value:B,onChange:ve=>Y(ve.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email:"}),r.jsx("input",{type:"email",id:"email",value:re,onChange:ve=>ne(ve.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"address",children:"Address:"}),r.jsx("textarea",{id:"address",value:G,onChange:ve=>V(ve.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"gst_number",children:"GST Number:"}),r.jsx("input",{type:"text",id:"gst_number",value:W,onChange:ve=>J(ve.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"drug_license_number",children:"Drug License Number:"}),r.jsx("input",{type:"text",id:"drug_license_number",value:he,onChange:ve=>A(ve.target.value)})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:ct,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"submit",className:"button-submit",children:"Add Distributor"})]})]})]})}),u&&P&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:at,className:"modal-close-button",children:""}),r.jsx("h3",{className:"modal-title",children:"Edit Distributor"}),o&&r.jsx("div",{className:"modal-error-message",children:o}),r.jsxs("form",{onSubmit:Ce,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"edit-name",children:"Name:"}),r.jsx("input",{type:"text",id:"edit-name",value:z,onChange:ve=>F(ve.target.value),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"edit-contact_person",children:"Contact Person:"}),r.jsx("input",{type:"text",id:"edit-contact_person",value:Q,onChange:ve=>R(ve.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"edit-phone",children:"Phone:"}),r.jsx("input",{type:"text",id:"edit-phone",value:B,onChange:ve=>Y(ve.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"edit-email",children:"Email:"}),r.jsx("input",{type:"email",id:"edit-email",value:re,onChange:ve=>ne(ve.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"edit-address",children:"Address:"}),r.jsx("textarea",{id:"edit-address",value:G,onChange:ve=>V(ve.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"edit-gst_number",children:"GST Number:"}),r.jsx("input",{type:"text",id:"edit-gst_number",value:W,onChange:ve=>J(ve.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"edit-drug_license_number",children:"Drug License Number:"}),r.jsx("input",{type:"text",id:"edit-drug_license_number",value:he,onChange:ve=>A(ve.target.value)})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:at,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"submit",className:"button-submit",children:"Save Changes"})]})]})]})}),g&&P&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:jt,className:"modal-close-button",children:""}),r.jsx("h3",{className:"modal-title",children:"Confirm Delete"}),r.jsxs("p",{children:['Are you sure you want to delete distributor "',P.name,'"?']}),o&&r.jsx("div",{className:"modal-error-message",children:o}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:jt,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"button",onClick:Se,className:"button-delete",children:"Delete"})]})]})}),v&&P&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content large-modal",children:[r.jsx("button",{onClick:Fe,className:"modal-close-button",children:""}),r.jsxs("h3",{className:"modal-title",children:["Payments & Balance for ",P.name]}),o&&r.jsx("div",{className:"modal-error-message",children:o}),L&&r.jsxs("div",{className:"balance-summary",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Total Order Value:"})," ",L.totalOrderValue.toFixed(2)]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Total Amount Paid:"})," ",L.totalAmountPaid.toFixed(2)]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Remaining Balance:"})," ",L.remainingBalance.toFixed(2)]})]}),r.jsx("h4",{children:"Payment History"}),I.length===0?r.jsx("p",{children:"No payments recorded for this distributor."}):r.jsx("div",{className:"table-responsive",children:r.jsxs("table",{className:"distributor-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Date"}),r.jsx("th",{children:"Order Value"}),r.jsx("th",{children:"Amount Paid"}),r.jsx("th",{children:"Balance Remaining"}),r.jsx("th",{children:"Notes"})]})}),r.jsx("tbody",{children:I.map(ve=>r.jsxs("tr",{children:[r.jsx("td",{children:new Date(ve.payment_date).toLocaleDateString()}),r.jsxs("td",{children:["",ve.order_value.toFixed(2)]}),r.jsxs("td",{children:["",ve.amount_paid.toFixed(2)]}),r.jsxs("td",{children:["",ve.balance_remaining.toFixed(2)]}),r.jsx("td",{children:ve.notes||"-"})]},ve.id))})]})}),r.jsx("div",{className:"modal-actions",children:r.jsx("button",{type:"button",onClick:Fe,className:"button-cancel",children:"Close"})})]})}),k&&P&&r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:Ue,className:"modal-close-button",children:""}),r.jsxs("h3",{className:"modal-title",children:["Add Payment for ",P.name]}),o&&r.jsx("div",{className:"modal-error-message",children:o}),r.jsxs("form",{onSubmit:Me,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"payment_date",children:"Payment Date:"}),r.jsx("input",{type:"date",id:"payment_date",value:ce,onChange:ve=>se(ve.target.value),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"order_value",children:"Order Value:"}),r.jsx("input",{type:"number",id:"order_value",value:D,onChange:ve=>oe(ve.target.value),step:"0.01"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"amount_paid",children:"Amount Paid:"}),r.jsx("input",{type:"number",id:"amount_paid",value:xe,onChange:ve=>Z(ve.target.value),step:"0.01"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"payment_notes",children:"Notes:"}),r.jsx("textarea",{id:"payment_notes",value:ue,onChange:ve=>ae(ve.target.value)})]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:Ue,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"submit",className:"button-submit",children:"Add Payment"})]})]})]})})]})},Zte=({isOpen:e,onClose:n,excelHeaders:t,onConfirm:i,availableFields:a})=>{const[o,l]=w.useState({});if(w.useEffect(()=>{e&&f()},[e,t,a]),!e)return null;const d=(p,g)=>{l(b=>({...b,[p]:g}))},f=()=>{const p={};t.forEach(g=>{const b=a.map(S=>({name:S})),v=qx(g,b);v&&(p[g]=v.name)}),l(p)},u=()=>{const p={};for(const g in o)o[g]&&o[g]!=="none"&&(p[g]=o[g]);i(p),n()};return r.jsx("div",{className:"modal-overlay",children:r.jsxs("div",{className:"modal-content",children:[r.jsx("button",{onClick:n,className:"modal-close-button",children:r.jsx(Qn,{size:20})}),r.jsx("h3",{className:"modal-title",children:"Match File Columns"}),r.jsx("p",{className:"modal-description",children:'Please match the columns from your uploaded file to the corresponding fields in the drug inventory. You can use the "Auto Match" button for suggestions.'}),r.jsx("div",{className:"modal-actions-top",children:r.jsx("button",{type:"button",onClick:f,className:"button-auto-match",children:"Auto Match"})}),r.jsxs("div",{className:"column-mapping-grid",children:[r.jsx("div",{className:"grid-header",children:"Excel Column"}),r.jsx("div",{className:"grid-header",children:"App Field"}),t.map((p,g)=>r.jsxs(vn.Fragment,{children:[r.jsx("div",{className:"excel-header-cell",children:p}),r.jsx("div",{className:"app-field-cell",children:r.jsxs("select",{value:o[p]||"",onChange:b=>d(p,b.target.value),className:"app-field-select",children:[r.jsx("option",{value:"",children:"-- Select Field --"}),r.jsx("option",{value:"none",children:"None (Ignore Column)"}),a.map((b,v)=>r.jsxs("option",{value:b,children:[b==="name"?"Composition Name":b==="brand_name"?"Brand Name":b==="price"?"MRP":b==="buying_price"?"Rate":b==="unit"?"Pack":b==="batch"?"Batch":b==="hsn_code"?"HSN Code":b==="mfg"?"MFG":b==="loose_quantity"?"Loose":b.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase())," "]},v))]})})]},g))]}),r.jsxs("div",{className:"modal-actions",children:[r.jsx("button",{type:"button",onClick:n,className:"button-cancel",children:"Cancel"}),r.jsx("button",{type:"button",onClick:u,className:"button-submit",children:"Confirm Mapping"})]})]})})},ene=({purchaseRows:e,onCellChange:n,onRemoveDrug:t,onAddEmptyRow:i})=>{const a=w.useRef(new Map),o=["name","price","quantity_in_stock","unit","expiry_date","buying_price","brand_name","box_number","gst","discount","batch","hsn_code","mfg","loose"],l=(d,f,u)=>{if(d.key==="Tab"){d.preventDefault();const p=o.indexOf(u);if(p!==-1){const g=(p+1)%o.length,b=o[g],v=a.current.get(`${f}-${b}`);v==null||v.focus()}}};return e.length===0?r.jsxs("div",{className:"no-drugs-message",children:[r.jsx("p",{children:"No drugs added to the purchase list yet."}),r.jsxs("button",{onClick:i,className:"action-button add-drug-to-table-button",children:[r.jsx(ss,{size:18,className:"button-icon"}),"Add the first drug"]})]}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"purchase-drugs-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Composition Name"}),r.jsx("th",{children:"MRP ()"}),r.jsx("th",{children:"Qty"}),r.jsx("th",{children:"Pack"}),r.jsx("th",{children:"Supplier"}),r.jsx("th",{children:"Expiry Date"}),r.jsx("th",{children:"Rate ()"}),r.jsx("th",{children:"Brand Name"}),r.jsx("th",{children:"Box Number"}),r.jsx("th",{children:"GST (%)"}),r.jsx("th",{children:"Discount (%)"}),r.jsx("th",{children:"Margin (%)"}),r.jsx("th",{children:"Batch"}),r.jsx("th",{children:"HSN Code"}),r.jsx("th",{children:"MFG"}),r.jsx("th",{children:"Loose"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:e.map((d,f)=>r.jsxs("tr",{children:[r.jsx("td",{children:r.jsx("input",{type:"text",value:d.name||"",onChange:u=>n(u,d.id,"name"),onKeyDown:u=>l(u,d.id,"name"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-name`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"number",value:d.price,onChange:u=>n(u,d.id,"price"),onKeyDown:u=>l(u,d.id,"price"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-price`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"number",value:d.quantity_in_stock,onChange:u=>n(u,d.id,"quantity_in_stock"),onKeyDown:u=>l(u,d.id,"quantity_in_stock"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-quantity_in_stock`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"text",value:d.unit||"",onChange:u=>n(u,d.id,"unit"),onKeyDown:u=>l(u,d.id,"unit"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-unit`,u)}})}),r.jsx("td",{children:d.supplier||"N/A"}),r.jsx("td",{children:r.jsx("input",{type:"date",value:d.expiry_date||"",onChange:u=>n(u,d.id,"expiry_date"),onKeyDown:u=>l(u,d.id,"expiry_date"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-expiry_date`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"number",value:d.buying_price||"",onChange:u=>n(u,d.id,"buying_price"),onKeyDown:u=>l(u,d.id,"buying_price"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-buying_price`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"text",value:d.brand_name||"",onChange:u=>n(u,d.id,"brand_name"),onKeyDown:u=>l(u,d.id,"brand_name"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-brand_name`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"text",value:d.box_number||"",onChange:u=>n(u,d.id,"box_number"),onKeyDown:u=>l(u,d.id,"box_number"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-box_number`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"number",value:d.gst||"",onChange:u=>n(u,d.id,"gst"),onKeyDown:u=>l(u,d.id,"gst"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-gst`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"number",value:d.discount||"",onChange:u=>n(u,d.id,"discount"),onKeyDown:u=>l(u,d.id,"discount"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-discount`,u)}})}),r.jsx("td",{children:(()=>{const u=d.price||0,p=d.buying_price||0,g=d.gst!==null&&d.gst!==void 0?d.gst/100*p:0,b=d.discount!==null&&d.discount!==void 0?d.discount/100*u:0,v=u-(p+g)-b;return`${(u>0?v/u*100:0).toFixed(2)}%`})()}),r.jsx("td",{children:r.jsx("input",{type:"text",value:d.batch||"",onChange:u=>n(u,d.id,"batch"),onKeyDown:u=>l(u,d.id,"batch"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-batch`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"text",value:d.hsn_code||"",onChange:u=>n(u,d.id,"hsn_code"),onKeyDown:u=>l(u,d.id,"hsn_code"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-hsn_code`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"text",value:d.mfg||"",onChange:u=>n(u,d.id,"mfg"),onKeyDown:u=>l(u,d.id,"mfg"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-mfg`,u)}})}),r.jsx("td",{children:r.jsx("input",{type:"number",value:d.loose||"",onChange:u=>n(u,d.id,"loose"),onKeyDown:u=>l(u,d.id,"loose"),className:"editable-cell-input",ref:u=>{d.id&&a.current.set(`${d.id}-loose`,u)}})}),r.jsx("td",{children:r.jsx("button",{onClick:()=>t(d.id),className:"text-red-600 hover:text-red-800 text-sm",children:"Remove"})})]},d.id||f))})]})})},I_=()=>{const e=_t(),[n,t]=w.useState(!1),i=w.useRef(null),a=w.useRef(null),[o,l]=w.useState(""),[d,f]=w.useState([]),[u,p]=w.useState(null),[g,b]=w.useState(!1),v=w.useRef(null),[S,k]=w.useState(!1),[T,P]=w.useState([]),[M,I]=w.useState(null),[U,L]=w.useState(null),[$,z]=w.useState(0),[F,Q]=w.useState(!1),[R,B]=w.useState([]),Y=["name","description","price","quantity_in_stock","unit","supplier","expiry_date","buying_price","box_number","gst","margin","discount","brand_name","batch","hsn_code","mfg","loose"],re=()=>{const Se={id:Date.now().toString()+Math.random().toString(36).substring(2,9),name:"",composition:"",description:"",price:0,quantity_in_stock:0,unit:"",supplier:u?u.name:"",expiry_date:"",buying_price:0,box_number:"",gst:0,margin:0,discount:0,brand_name:"",batch:"",hsn_code:"",mfg:"",loose:0,last_updated:"",created_at:""};B(De=>[...De,Se])},ne=async(Ce,Se)=>{if(!Ce){L("No file provided for import.");return}if(!u){L("Please select a distributor before importing.");return}t(!0),L(null);const De=new FormData;De.append("inventoryFile",Ce),De.append("columnMapping",JSON.stringify(Se));try{const Me=await me("/api/drugs/parse-excel",{method:"POST",body:De});if(!Me.ok){const ct=await Me.json();throw new Error(ct.message||`Failed to parse Excel file: ${Me.statusText}`)}const et=await Me.json();B(ct=>[...ct,...et.map(ut=>({...ut,id:Date.now().toString()+Math.random().toString(36).substring(2,9),supplier:u?u.name:ut.supplier}))]),alert(`Successfully parsed ${et.length} drugs from Excel. They have been added to the purchase list.`)}catch(Me){console.error("Failed to parse Excel file:",Me),L(Me.message||"Failed to parse Excel file. Please check the file format and try again."),alert(`Excel parsing failed: ${Me.message||"Please check the file format and try again."}`)}finally{i.current&&(i.current.value=""),t(!1),I(null)}},G=async Ce=>{if(Ce.target.files&&Ce.target.files[0]){const Se=Ce.target.files[0];I(Se),L(null),t(!0);const De=new FormData;De.append("inventoryFile",Se);try{const Me=await me("/api/drugs/get-file-headers",{method:"POST",body:De});if(!Me.ok){const ct=await Me.json();throw new Error(ct.message||`Failed to get file headers: ${Me.statusText}`)}const{headers:et}=await Me.json();P(et),k(!0)}catch(Me){console.error("Failed to get file headers:",Me),L(Me.message||"Failed to read file headers. Please check the file format and try again."),alert(`Error reading file headers: ${Me.message||"Please check the file format and try again."}`),I(null)}finally{t(!1)}}else I(null)},V=Ce=>{M?ne(M,Ce):L("No file selected for import after mapping."),k(!1)},W=()=>{k(!1),P([]),I(null),i.current&&(i.current.value="")},J=()=>{var Ce;(Ce=i.current)==null||Ce.click()},he=async Ce=>{if(Ce.target.files&&Ce.target.files[0]){const Se=Ce.target.files[0];L(null),t(!0);const De=new FormData;De.append("file",Se),De.append("output_type","csv");const et={Authorization:"Bearer 00841ac4-b279-11f0-ab55-0a3a41e3fad1"};try{const ct=await fetch("https://extraction-api.nanonets.com/extract",{method:"POST",headers:et,body:De});if(!ct.ok){const Ue=await ct.json();throw new Error(Ue.message||`Failed to extract data from image/PDF: ${ct.statusText}`)}const ut=await ct.json();if(!ut.success||!ut.content)throw new Error(ut.detail||"Nanonets API did not return expected content.");let at=ut.content;at=at.split(`
`).filter(Ue=>!Ue.startsWith("#")&&Ue.trim()!=="").join(`
`);const jt=new File([at],"extracted_data.csv",{type:"text/csv"}),_e=new FormData;_e.append("inventoryFile",jt);const Fe=await me("/api/drugs/get-file-headers",{method:"POST",body:_e});if(!Fe.ok){const Ue=await Fe.json();throw new Error(Ue.message||`Failed to get headers from extracted CSV: ${Fe.statusText}`)}const{headers:Pe}=await Fe.json();P(Pe),I(jt),k(!0),alert("Successfully extracted data from image/PDF as CSV. Please map the columns.")}catch(ct){console.error("Failed to extract data from image/PDF:",ct),L(ct.message||"Failed to extract data from image/PDF. Please check the file and try again."),alert(`Image/PDF extraction failed: ${ct.message||"Please check the file and try again."}`)}finally{a.current&&(a.current.value=""),t(!1)}}},A=()=>{var Ce;(Ce=a.current)==null||Ce.click()},ce=()=>{if(!u){L("Please select a distributor before adding a drug manually.");return}Q(!0)},se=()=>{Q(!1),L(null)},D=Ce=>{B(Se=>[...Se,{...Ce,id:Date.now().toString(),supplier:u?u.name:Ce.supplier}]),se()},oe=Ce=>{B(Se=>Se.filter(De=>De.id!==Ce))},xe=(Ce,Se,De)=>{const{value:Me}=Ce.target;B(et=>et.map(ct=>{if(ct.id===Se){let ut=Me;De==="expiry_date"?ut=Me.trim()===""?null:Me:["price","quantity_in_stock","buying_price","gst","margin","discount","loose"].includes(De)&&(ut=parseFloat(Me),isNaN(ut)&&(ut=null));const at={...ct,[De]:ut};return De==="name"&&u&&!at.supplier&&(at.supplier=u.name),at}return ct}))},Z=w.useCallback(()=>R.reduce((Ce,Se)=>{const De=Se.quantity_in_stock||0,Me=Se.buying_price||0,et=Se.gst||0,ct=Se.discount||0;let ut=Me*(1-ct/100),at=De*ut;return at+=at*(et/100),Ce+at},0),[R]),ue=async()=>{if(!u){L("Please select a distributor before submitting the purchase.");return}const Ce=R.filter(Se=>Object.values(Se).some(De=>typeof De=="string"&&De.trim()!==""||typeof De=="number"&&De!==0||De!=null&&typeof De!="string"&&typeof De!="number"));if(Ce.length===0){L("No valid drugs to submit. Please fill in at least one field for a row, or remove empty rows."),t(!1);return}t(!0),L(null);try{for(const et of Ce){const ct={...et,expiry_date:et.expiry_date===""?null:et.expiry_date,distributorId:u.id},ut=await me("/api/drugs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ct)});if(!ut.ok){const at=await ut.json();throw new Error(at.message||`Failed to add drug ${et.name}: ${ut.statusText}`)}}const Se=Z(),De=new Date().toISOString().split("T")[0],Me=await me(`/api/distributors/${u.id}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_date:De,order_value:Se,amount_paid:$,notes:"Payment from purchase page."})});if(!Me.ok){const et=await Me.json();throw new Error(et.message||`Failed to record distributor payment: ${Me.statusText}`)}alert("All valid drugs added to inventory and distributor payment recorded successfully!"),B([]),p(null),l(""),z(0),e("/dashboard/inventory")}catch(Se){console.error("Failed to submit purchase:",Se),L(Se.message||"Failed to submit purchase. Please try again."),alert(`Purchase submission failed: ${Se.message||"Please try again."}`)}finally{t(!1)}},ae=w.useCallback(async Ce=>{if(Ce.trim()===""){f([]);return}try{const Se=await me(`/api/distributors?search=${encodeURIComponent(Ce)}`);if(!Se.ok)throw new Error(`Failed to fetch distributors: ${Se.statusText}`);const De=await Se.json();f(De)}catch(Se){console.error("Failed to fetch distributors:",Se),L(Se.message||"Failed to load distributors.")}},[]),Re=Ce=>{const Se=Ce.target.value;l(Se),p(null),v.current&&clearTimeout(v.current),Se.trim()!==""?v.current=setTimeout(()=>{ae(Se),b(!0)},300):(f([]),b(!1))},Ae=Ce=>{p(Ce),l(Ce.name),b(!1),f([])};return w.useEffect(()=>{const Ce=Se=>{Se.target instanceof HTMLElement&&!Se.target.closest(".distributor-search-container")&&b(!1)};return document.addEventListener("mousedown",Ce),()=>{document.removeEventListener("mousedown",Ce),v.current&&clearTimeout(v.current)}},[]),r.jsxs("div",{className:"purchase-page",children:[r.jsxs("div",{className:"purchase-header",children:[r.jsx("button",{onClick:()=>e(-1),className:"action-icon-button",title:"Go Back",children:r.jsx(rn,{size:24})}),r.jsx("h2",{className:"purchase-page-title",children:"Purchase Inventory"})]}),U&&r.jsx("div",{className:"error-message",children:U}),r.jsxs("div",{className:"purchase-controls-header",children:[r.jsxs("div",{className:"distributor-selection-section",children:[r.jsxs("h3",{children:[r.jsx(YR,{size:24,className:"icon-left"})," Select Distributor"]}),r.jsxs("div",{className:"distributor-search-container",children:[r.jsxs("div",{className:"search-input-wrapper",children:[r.jsx(os,{size:20,className:"search-icon"}),r.jsx("input",{type:"text",placeholder:"Search distributor by name...",value:o,onChange:Re,onFocus:()=>o.trim()!==""&&b(!0),className:"distributor-search-input"})]}),g&&d.length>0&&r.jsx("ul",{className:"distributor-search-results",children:d.map(Ce=>r.jsx("li",{onClick:()=>Ae(Ce),children:Ce.name},Ce.id))}),u&&r.jsxs("div",{className:"selected-distributor-info",children:["Selected: ",r.jsx("strong",{children:u.name}),u.contact_person&&r.jsxs("span",{children:[" (",u.contact_person,")"]})]})]})]}),r.jsxs("div",{className:"import-section",children:[r.jsxs("h3",{children:[r.jsx($S,{size:24,className:"icon-left"})," Import Drugs"]}),r.jsx("p",{children:"Upload an Excel (.xlsx, .xls), CSV, PDF, or Image file to import drug data."}),r.jsxs("div",{className:"import-controls",children:[r.jsx("input",{ref:i,id:"excel-file-upload",name:"excel-file-upload",type:"file",className:"sr-only",accept:".xlsx, .xls, .csv",onChange:G}),r.jsxs("button",{onClick:J,disabled:n||!u,className:`action-button import-button ${n?"importing":""}`,title:u?"":"Please select a distributor",children:[r.jsx($S,{size:18,className:"button-icon"}),n?"Reading Headers...":"Import XL or CSV"]}),r.jsx("input",{ref:a,id:"image-pdf-file-upload",name:"image-pdf-file-upload",type:"file",className:"sr-only",accept:".pdf, .png, .jpg, .jpeg",onChange:he}),r.jsxs("button",{onClick:A,disabled:n||!u,className:"action-button import-button",title:u?"":"Please select a distributor",children:[r.jsx(su,{size:18,className:"button-icon"}),"Import from PDF/Image"]}),r.jsxs("button",{onClick:ce,className:"action-button add-drug-manual-button",disabled:!u,title:u?"":"Select a distributor to add drugs manually",children:[r.jsx(ss,{size:18,className:"button-icon"}),"Add Drug"]})]})]})]}),r.jsx(Zte,{isOpen:S,onClose:W,excelHeaders:T,onConfirm:V,availableFields:Y}),F&&r.jsx(aT,{isOpen:F,onClose:se,onDrugAddedToPurchase:D}),r.jsxs("div",{className:"purchase-summary-section",children:[r.jsxs("h3",{children:[r.jsx(zR,{size:24,className:"icon-left"})," Drugs to be Purchased (",R.length,")"]}),r.jsx(ene,{purchaseRows:R,onCellChange:xe,onRemoveDrug:oe,onAddEmptyRow:re}),r.jsxs("div",{className:"purchase-summary-actions",children:[r.jsxs("button",{onClick:re,className:"action-button add-drug-to-table-button",children:[r.jsx(ss,{size:18,className:"button-icon"}),"Add Row"]}),r.jsxs("div",{className:"summary-details",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"amount-paid-to-distributor",children:"Amount Paid ():"}),r.jsx("input",{type:"number",id:"amount-paid-to-distributor",value:$,onChange:Ce=>z(parseFloat(Ce.target.value)||0),placeholder:"0.00",className:"amount-paid-input",step:"0.01",disabled:!u,title:u?"":"Please select a distributor first"})]}),r.jsxs("div",{className:"total-purchase-value",children:[r.jsx("strong",{children:"Total Purchase Value:"})," ",Z().toFixed(2)]})]}),r.jsx("button",{onClick:ue,disabled:n||R.length===0||!u,className:"action-button submit-purchase-button",children:n?"Submitting...":"Submit Purchase"})]})]})]})},tne=e=>{if(!e)return 1;const n=e.match(/(?:\d+x)?(\d+)/);return n&&n[1]?parseInt(n[1],10):1},nne=()=>{const e=_t(),n=Gi(),[t,i]=w.useState(null),[a,o]=w.useState([]),[l,d]=w.useState(!0),[f,u]=w.useState(null),[p,g]=w.useState(!1),[b,v]=w.useState("cash"),[S,k]=w.useState(""),[T,P]=w.useState(""),[M,I]=w.useState(""),[U,L]=w.useState(""),[$,z]=w.useState(""),[F,Q]=w.useState(0),R=w.useRef(!1),B=he=>{const A=Math.max(0,Math.min(100,isNaN(he)?0:he));R.current=!0,Q(A);const ce=a.map(se=>({...se,discount_percentage:A}));o(ce)},Y=(he,A)=>{const ce=[...a];ce[he].discount_percentage=isNaN(A)?0:A,o(ce)};w.useEffect(()=>{if(R.current){R.current=!1;return}const he=a.reduce((se,D)=>se+(D.total_price??0),0);if(he===0){Q(0);return}const ce=a.reduce((se,D)=>{const xe=(D.total_price??0)*((D.discount_percentage??0)/100);return se+xe},0)/he*100;Q(se=>Math.abs(se-ce)>.01?ce:se)},[a]);const re=async()=>{if(!t)return u("No order data available to bill."),null;if(a.length===0)return u("Cannot bill an empty order."),null;g(!0),u(null);try{const he=a.map(oe=>{const xe=(oe.pricePerLooseUnit??0)*(oe.looseQuantity??0),Z=xe*((oe.discount_percentage??0)/100),ue=xe-Z;return{name:oe.name,pack_quantity:oe.loosePacks??0,loose_quantity:oe.looseUnits??0,price:oe.originalPrice??0,pack_price:oe.originalPrice??0,loose_price:oe.pricePerLooseUnit??0,total:ue,drug_id:oe.drug_id,discount_percentage:oe.discount_percentage??0,batch:oe.batch,expiry_date:oe.expiry_date}}),A={patientId:t.patientId,queueId:t.id,items:he,amount:J,paymentMode:b,type:"pharmacy",related_id:t.id,status:"paid",discountPercentage:F},ce=await me("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)}),se=await ce.json();if(!ce.ok||!se.id)throw new Error(se.message||"Failed to create bill.");const D=await me(`/api/pharmacy-orders/${t.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"billed",bill_id:se.id,medications:a})});if(!D.ok){const oe=await D.text();throw new Error(`Failed to update pharmacy order status: ${D.statusText} - ${oe}`)}return i(oe=>oe?{...oe,status:"billed",bill_id:se.id}:null),alert(`Order ${t.patientName}'s bill created (ID: ${se.id}) and marked as billed.`),e(`/dashboard/pharmacy-billing/${t.id}`,{replace:!0,state:{order:{...t,status:"billed",bill_id:se.id},initialItems:a}}),se.id}catch(he){return console.error("Billing process failed:",he),u(he.message||"Failed to mark order as billed. Please try again."),null}finally{g(!1)}},ne=()=>{window.print()},G=async()=>{await re()&&(window.print(),e(-1))};w.useEffect(()=>{const he=n.pathname.split("/"),A=he[he.length-1];A?(async()=>{try{const se=await me(`/api/pharmacy-orders/${A}`);if(!se.ok)throw new Error("Failed to fetch pharmacy order details");const D=await se.json();i(D);const oe=D.medications.map(xe=>{const Z=tne(xe.unit),ue=(xe.pack_quantity??0)*Z+(xe.loose_quantity??0);return{...xe,isLoose:!0,loosePacks:xe.pack_quantity??0,looseUnits:xe.loose_quantity??0,looseQuantity:ue,pack_price:Number(xe.pack_price)||0,loose_price:Number(xe.loose_price)||0,total_price:Number(xe.total_price)||0,pricePerLooseUnit:Number(xe.loose_price)||0,originalPrice:Number(xe.pack_price)||0,discount_percentage:Number(xe.discount_percentage)??0,directions_to_use:xe.directions_to_use,tabletsPerDay:xe.tabletsPerDay,numberOfDays:xe.numberOfDays,batch:xe.batch,expiry_date:xe.expiry_date}});o(oe)}catch(se){console.error("Failed to fetch order:",se),u(se.message||"Failed to load order details.")}finally{d(!1)}})():(u("No pharmacy order ID provided."),d(!1))},[n.pathname]),w.useEffect(()=>{(async()=>{try{const A=await me("/api/clinics/settings");if(!A.ok)throw new Error("Failed to fetch clinic settings");const ce=await A.json();P(ce.upi_id||""),I(ce.name||""),L(ce.address||""),z(ce.notes||"")}catch(A){console.error("Error fetching clinic settings:",A)}})()},[]);const V=w.useMemo(()=>a.reduce((he,A)=>he+(A.total_price??0),0),[a]),W=w.useMemo(()=>a.reduce((he,A)=>{const se=(A.total_price??0)*(A.discount_percentage??0)/100;return he+se},0),[a]),J=w.useMemo(()=>V-W,[V,W]);return w.useEffect(()=>{if(J>0&&T){const he=`upi://pay?pa=${T}&pn=ClinicName&am=${J.toFixed(2)}&cu=INR`;k(he)}else k("")},[J,T]),l?r.jsx("div",{className:"loading-pulse",children:"Loading Bill..."}):f?r.jsxs("div",{className:"error-message-box",children:["Error: ",f]}):t?r.jsx("div",{className:"pharmacy-billing-page",children:r.jsxs("div",{className:"billing-container printable-section",children:[r.jsxs("div",{className:"billing-header print-only",children:[r.jsx("div",{className:"clinic-header-left",children:r.jsx("div",{className:"clinic-info-print",children:r.jsxs("div",{className:"clinic-name-and-details-print",children:[r.jsx("h1",{className:"bill-title",children:"TAX INVOICE"}),r.jsx("h2",{className:"clinic-name-print",children:M?`${M} Pharmacy`:"Pharmacy Bill"}),(U||$)&&r.jsxs("div",{className:"clinic-details-print",children:[U&&r.jsx("span",{className:"small-text clinic-address",children:U}),$&&r.jsx("span",{className:"small-text clinic-notes",children:$})]})]})})}),r.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(cu,{size:16})," Patient Name"]})," ",t.patientName]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(Gm,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(Wx,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),r.jsxs("header",{className:"billing-header no-print",children:[r.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[r.jsx(rn,{size:20}),r.jsx("span",{children:"Back"})]}),r.jsx("h1",{children:"Pharmacy Bill"})]}),r.jsxs("div",{className:"billing-layout",children:[r.jsxs("main",{className:"order-content",children:[r.jsxs("section",{className:"order-details-card no-print",children:[r.jsx("div",{className:"card-header",children:r.jsx("h2",{children:"Patient Information"})}),r.jsxs("div",{className:"patient-info-grid",children:[r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(cu,{size:16})," Patient Name"]})," ",t.patientName]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(Gm,{size:16})," Token"]})," ",t.patientTokenNumber??"N/A"]}),r.jsxs("div",{className:"info-item no-print",children:[r.jsxs("strong",{children:[r.jsx(ig,{size:16})," Order ID"]})," ",t.id]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(Wx,{size:16})," Order Date"]})," ",new Date(t.date).toLocaleDateString()]})]})]}),r.jsxs("section",{className:"medications-card",children:[r.jsx("div",{className:"card-header no-print",children:r.jsx("h2",{children:"Medications"})}),a.length>0?r.jsxs("table",{className:"medications-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"S.No."}),r.jsx("th",{children:"DESCRIPTION"}),r.jsx("th",{children:"BATCH"}),r.jsx("th",{children:"EXPIRY"}),r.jsx("th",{children:"QUANTITY"}),r.jsx("th",{children:"MRP"}),r.jsx("th",{children:"RATE"}),r.jsx("th",{children:"DIS %"}),r.jsx("th",{children:"GST%"}),r.jsx("th",{children:"AMT"})]})}),r.jsx("tbody",{children:a.map((he,A)=>{var xe,Z;const ce=he.total_price??0,se=ce*(he.discount_percentage??0)/100,D=ce-se;return r.jsxs("tr",{children:[r.jsx("td",{children:A+1}),r.jsx("td",{children:he.name}),r.jsx("td",{children:he.batch||"N/A"}),r.jsx("td",{children:he.expiry_date?new Date(he.expiry_date).toLocaleDateString():"N/A"}),r.jsxs("td",{children:[r.jsxs("div",{children:["Packs: ",he.loosePacks??0]}),r.jsxs("div",{children:["Loose: ",he.looseUnits??0]})]}),r.jsx("td",{children:((xe=he.originalPrice)==null?void 0:xe.toFixed(2))??"N/A"}),r.jsx("td",{children:((Z=he.pricePerLooseUnit)==null?void 0:Z.toFixed(2))??"N/A"}),r.jsxs("td",{children:[r.jsx("input",{type:"number",value:he.discount_percentage??0,onChange:ue=>Y(A,parseFloat(ue.target.value)),min:"0",max:"100",className:"discount-input-table"}),"%"]}),r.jsxs("td",{children:[5 .toFixed(1),"%"]}),r.jsx("td",{children:D.toFixed(2)})]},A)})})]}):r.jsx("p",{children:"No medications in this order."})]}),r.jsxs("div",{className:"bill-summary-print print-only",children:[S&&r.jsxs("div",{className:`qr-code-container qr-code-printable-section ${b!=="upi"?"hide-on-screen":""}`,children:[r.jsx(Mh,{value:S,size:100}),r.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),r.jsxs("div",{className:"bill-summary-details",children:[r.jsxs("div",{className:"summary-row-print",children:[r.jsx("span",{children:"Subtotal"}),r.jsxs("span",{children:["",V.toFixed(2)]})]}),r.jsxs("div",{className:"summary-row-print",children:[r.jsxs("span",{children:["Total Discount (",F.toFixed(2),"%)"]}),r.jsxs("span",{children:["- ",W.toFixed(2)]})]}),r.jsxs("div",{className:"summary-row-print",children:[r.jsx("span",{children:"GST (Included)"}),r.jsxs("span",{children:["",(J*.05).toFixed(2)]})]}),r.jsx("div",{className:"print-only-total",children:r.jsxs("strong",{children:["Grand Total: ",J.toFixed(2)]})})]})]})]}),r.jsx("aside",{className:"billing-sidebar no-print",children:r.jsxs("div",{className:"billing-summary-card",children:[r.jsx("div",{className:"card-header",children:r.jsx("h2",{children:"Billing Summary"})}),r.jsxs("div",{className:"summary-row",children:[r.jsx("span",{children:"Subtotal"}),r.jsxs("span",{children:["",V.toFixed(2)]})]}),r.jsxs("div",{className:"summary-row",children:[r.jsx("span",{children:"Total Discount"}),r.jsxs("span",{children:["- ",W.toFixed(2)]})]}),r.jsxs("div",{className:"summary-row",children:[r.jsx("span",{children:"Discount Percentage"}),r.jsxs("div",{className:"discount-input-wrapper",children:[r.jsx("input",{type:"number",value:F,onChange:he=>B(parseFloat(he.target.value)),min:"0",max:"100",className:"discount-input-total",disabled:p||t.status==="billed"}),"%"]})]}),r.jsxs("div",{className:"summary-row grand-total-row",children:[r.jsx("strong",{children:"Grand Total"}),r.jsxs("strong",{children:["",J.toFixed(2)]})]}),r.jsx("div",{className:"qr-code-container",children:S?r.jsxs(r.Fragment,{children:[r.jsx(Mh,{value:S,size:128}),r.jsx("p",{children:"Scan to pay using UPI"})]}):r.jsx("p",{children:"UPI QR code not available. Please ensure UPI ID is configured."})}),r.jsxs("div",{className:"payment-mode-section",children:[r.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:r.jsx("strong",{children:"Payment Mode"})}),r.jsxs("select",{id:"paymentMode",value:b,onChange:he=>v(he.target.value),className:"payment-mode-select",disabled:p||t.status==="billed",children:[r.jsx("option",{value:"cash",children:"Cash"}),r.jsx("option",{value:"upi",children:"UPI"}),r.jsx("option",{value:"card",children:"Card"}),r.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),r.jsx("option",{value:"credit",children:"Credit"})]})]}),r.jsxs("div",{className:"bill-actions",children:[t.status==="pending"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:ne,className:"secondary-button print-preview-button no-print",disabled:p||a.length===0,children:"Print Preview"}),r.jsx("button",{onClick:G,className:"primary-button",disabled:p||a.length===0,children:p?"Processing...":"Finalise and Bill"})]}),t.status==="billed"&&r.jsx("button",{onClick:()=>e(`/dashboard/bills/${t.bill_id}`),className:"secondary-button",children:"View Bill"})]})]})})]}),r.jsxs("footer",{className:"billing-footer print-only",children:[r.jsx("p",{children:"Thank you for your business!"}),r.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})}):r.jsx("div",{className:"error-message-box",children:"No order data available."})},ine=()=>{const e=_t(),n=Gi(),[t,i]=w.useState(null),[a,o]=w.useState(""),[l,d]=w.useState(""),[f,u]=w.useState([]),[p,g]=w.useState(!0),[b,v]=w.useState(null),[S,k]=w.useState(!1),[T,P]=w.useState("cash"),[M,I]=w.useState(""),[U,L]=w.useState(""),[$,z]=w.useState(""),[F,Q]=w.useState(""),[R,B]=w.useState(""),[Y,re]=w.useState(0),ne=w.useRef(!1),G=D=>{const oe=Math.max(0,Math.min(100,isNaN(D)?0:D));ne.current=!0,re(oe);const xe=f.map(Z=>({...Z,discount_percentage:oe}));u(xe)},V=(D,oe)=>{const xe=[...f];xe[D].discount_percentage=isNaN(oe)?0:oe,u(xe)};w.useEffect(()=>{if(ne.current){ne.current=!1;return}const D=f.reduce((Z,ue)=>Z+(ue.price??0),0);if(D===0){re(0);return}const xe=f.reduce((Z,ue)=>{const Re=(ue.price??0)*((ue.discount_percentage??0)/100);return Z+Re},0)/D*100;re(Z=>Math.abs(Z-xe)>.01?xe:Z)},[f]);const W=async()=>{if(!t)return v("No order data available to bill."),null;if(f.length===0)return v("Cannot bill an empty order."),null;k(!0),v(null);try{const D=f.map(ae=>{const Re=ae.price,Ae=Re*((ae.discount_percentage??0)/100),Ce=Re-Ae;return{name:ae.name,price:ae.price,quantity:1,total:Ce,item_id:ae.id,type:"lab_test",discount_percentage:ae.discount_percentage??0}}),oe={patientId:t.patient_id,items:D,amount:se,paymentMode:T,type:"lab",related_id:t.id,status:"paid",discountPercentage:Y},xe=await me("/api/bills",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(oe)}),Z=await xe.json();if(!xe.ok||!Z.id)throw new Error(Z.message||"Failed to create bill.");const ue=await me(`/api/lab/${t.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"billed",bill_id:Z.id})});if(!ue.ok){const ae=await ue.text();throw new Error(`Failed to update lab order status: ${ue.statusText} - ${ae}`)}return i(ae=>ae?{...ae,status:"billed",bill_id:Z.id}:null),alert(`Lab Order bill created (ID: ${Z.id}) and marked as billed.`),e(`/dashboard/lab-billing/${t.id}`,{replace:!0,state:{...n.state,order:{...t,status:"billed",bill_id:Z.id}}}),Z.id}catch(D){return console.error("Billing process failed:",D),v(D.message||"Failed to mark order as billed. Please try again."),null}finally{k(!1)}},J=()=>{window.print()},he=async()=>{await W()&&(window.print(),e(-1))};w.useEffect(()=>{const D=n.pathname.split("/"),oe=D[D.length-1];oe?(async()=>{try{const Z=await me(`/api/lab/${oe}`);if(!Z.ok)throw new Error("Failed to fetch lab order details");const ue=await Z.json();if(i(ue),ue.patient_id){const Re=await me(`/api/patients/${ue.patient_id}`);if(Re.ok){const Ae=await Re.json();o(Ae.name),d(Ae.patient_token_number)}}const ae=ue.tests.map(Re=>({...Re,price:typeof Re.price=="string"?parseFloat(Re.price):Number(Re.price)||0,discount_percentage:0,total_price:typeof Re.price=="string"?parseFloat(Re.price):Number(Re.price)||0}));u(ae)}catch(Z){console.error("Failed to fetch order:",Z),v(Z.message||"Failed to load order details.")}finally{g(!1)}})():(v("No lab order ID provided."),g(!1))},[n.pathname]),w.useEffect(()=>{(async()=>{try{const oe=await me("/api/clinics/settings");if(!oe.ok)throw new Error("Failed to fetch clinic settings");const xe=await oe.json();L(xe.upi_id||""),z(xe.name||""),Q(xe.address||""),B(xe.notes||"")}catch(oe){console.error("Error fetching clinic settings:",oe)}})()},[]);const A=w.useMemo(()=>f.reduce((D,oe)=>D+(oe.price??0),0),[f]),ce=w.useMemo(()=>f.reduce((D,oe)=>{const Z=(oe.price??0)*(oe.discount_percentage??0)/100;return D+Z},0),[f]),se=w.useMemo(()=>A-ce,[A,ce]);return w.useEffect(()=>{if(se>0&&U){const D=`upi://pay?pa=${U}&pn=ClinicName&am=${se.toFixed(2)}&cu=INR`;I(D)}else I("")},[se,U]),p?r.jsx("div",{className:"loading-pulse",children:"Loading Lab Bill..."}):b?r.jsxs("div",{className:"error-message-box",children:["Error: ",b]}):t?r.jsxs("div",{className:"pharmacy-billing-page",children:[" ",r.jsxs("div",{className:"billing-container printable-section",children:[r.jsxs("div",{className:"billing-header print-only",children:[r.jsx("div",{className:"clinic-header-left",children:r.jsx("div",{className:"clinic-info-print",children:r.jsxs("div",{className:"clinic-name-and-details-print",children:[r.jsx("h1",{className:"bill-title",children:"LAB INVOICE"}),r.jsx("h2",{className:"clinic-name-print",children:$?`${$} Lab`:"Lab Bill"}),(F||R)&&r.jsxs("div",{className:"clinic-details-print",children:[F&&r.jsx("span",{className:"small-text clinic-address",children:F}),R&&r.jsx("span",{className:"small-text clinic-notes",children:R})]})]})})}),r.jsxs("div",{className:"patient-info-grid print-only-patient-details",children:[r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(cu,{size:16})," Patient Name"]})," ",a]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(Gm,{size:16})," Token"]})," ",l??"N/A"]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(Wx,{size:16})," Order Date"]})," ",new Date(t.createdAt).toLocaleDateString()]})]})]}),r.jsxs("header",{className:"billing-header no-print",children:[r.jsxs("button",{onClick:()=>e(-1),className:"back-button",children:[r.jsx(rn,{size:20}),r.jsx("span",{children:"Back"})]}),r.jsx("h1",{children:"Lab Bill"})]}),r.jsxs("div",{className:"billing-layout",children:[r.jsxs("main",{className:"order-content",children:[r.jsxs("section",{className:"order-details-card no-print",children:[r.jsx("div",{className:"card-header",children:r.jsx("h2",{children:"Patient Information"})}),r.jsxs("div",{className:"patient-info-grid",children:[r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(cu,{size:16})," Patient Name"]})," ",a]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(Gm,{size:16})," Token"]})," ",l??"N/A"]}),r.jsxs("div",{className:"info-item no-print",children:[r.jsxs("strong",{children:[r.jsx(Yl,{size:16})," Order ID"]})," ",t.id]}),r.jsxs("div",{className:"info-item",children:[r.jsxs("strong",{children:[r.jsx(Wx,{size:16})," Order Date"]})," ",new Date(t.createdAt).toLocaleDateString()]})]})]}),r.jsxs("section",{className:"medications-card",children:[r.jsx("div",{className:"card-header no-print",children:r.jsx("h2",{children:"Lab Tests"})}),f.length>0?r.jsxs("table",{className:"medications-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"S.No."}),r.jsx("th",{children:"TEST DESCRIPTION"}),r.jsx("th",{children:"PRICE"}),r.jsx("th",{children:"DIS %"}),r.jsx("th",{children:"AMT"})]})}),r.jsx("tbody",{children:f.map((D,oe)=>{const xe=D.price??0,Z=xe*(D.discount_percentage??0)/100,ue=xe-Z;return r.jsxs("tr",{children:[r.jsx("td",{children:oe+1}),r.jsx("td",{children:D.name}),r.jsx("td",{children:typeof D.price=="number"?D.price.toFixed(2):Number(D.price||0).toFixed(2)}),r.jsxs("td",{children:[r.jsx("input",{type:"number",value:D.discount_percentage??0,onChange:ae=>V(oe,parseFloat(ae.target.value)),min:"0",max:"100",className:"discount-input-table"}),"%"]}),r.jsx("td",{children:ue.toFixed(2)})]},oe)})})]}):r.jsx("p",{children:"No tests in this order."})]}),r.jsxs("div",{className:"bill-summary-print print-only",children:[M&&r.jsxs("div",{className:`qr-code-container qr-code-printable-section ${T!=="upi"?"hide-on-screen":""}`,children:[r.jsx(Mh,{value:M,size:100}),r.jsx("p",{className:"print-only-upi-text",children:"Scan to pay using UPI"})]}),r.jsxs("div",{className:"bill-summary-details",children:[r.jsxs("div",{className:"summary-row-print",children:[r.jsx("span",{children:"Subtotal"}),r.jsxs("span",{children:["",A.toFixed(2)]})]}),r.jsxs("div",{className:"summary-row-print",children:[r.jsxs("span",{children:["Total Discount (",Y.toFixed(2),"%)"]}),r.jsxs("span",{children:["- ",ce.toFixed(2)]})]}),r.jsx("div",{className:"print-only-total",children:r.jsxs("strong",{children:["Grand Total: ",se.toFixed(2)]})})]})]})]}),r.jsx("aside",{className:"billing-sidebar no-print",children:r.jsxs("div",{className:"billing-summary-card",children:[r.jsx("div",{className:"card-header",children:r.jsx("h2",{children:"Billing Summary"})}),r.jsxs("div",{className:"summary-row",children:[r.jsx("span",{children:"Subtotal"}),r.jsxs("span",{children:["",A.toFixed(2)]})]}),r.jsxs("div",{className:"summary-row",children:[r.jsx("span",{children:"Total Discount"}),r.jsxs("span",{children:["- ",ce.toFixed(2)]})]}),r.jsxs("div",{className:"summary-row",children:[r.jsx("span",{children:"Discount Percentage"}),r.jsxs("div",{className:"discount-input-wrapper",children:[r.jsx("input",{type:"number",value:Y,onChange:D=>G(parseFloat(D.target.value)),min:"0",max:"100",className:"discount-input-total",disabled:S||t.status==="billed"}),"%"]})]}),r.jsxs("div",{className:"summary-row grand-total-row",children:[r.jsx("strong",{children:"Grand Total"}),r.jsxs("strong",{children:["",se.toFixed(2)]})]}),r.jsx("div",{className:"qr-code-container",children:M?r.jsxs(r.Fragment,{children:[r.jsx(Mh,{value:M,size:128}),r.jsx("p",{children:"Scan to pay using UPI"})]}):r.jsx("p",{children:"UPI QR code not available. Please ensure UPI ID is configured."})}),r.jsxs("div",{className:"payment-mode-section",children:[r.jsx("label",{htmlFor:"paymentMode",className:"info-item",children:r.jsx("strong",{children:"Payment Mode"})}),r.jsxs("select",{id:"paymentMode",value:T,onChange:D=>P(D.target.value),className:"payment-mode-select",disabled:S||t.status==="billed",children:[r.jsx("option",{value:"cash",children:"Cash"}),r.jsx("option",{value:"upi",children:"UPI"}),r.jsx("option",{value:"card",children:"Card"}),r.jsx("option",{value:"no_cash_insurance",children:"No Cash Insurance"}),r.jsx("option",{value:"credit",children:"Credit"})]})]}),r.jsxs("div",{className:"bill-actions",children:[t.status!=="billed"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:J,className:"secondary-button print-preview-button no-print",disabled:S||f.length===0,children:"Print Preview"}),r.jsx("button",{onClick:he,className:"primary-button",disabled:S||f.length===0,children:S?"Processing...":"Finalise and Bill"})]}),t.status==="billed"&&r.jsx("button",{onClick:()=>e("/billing",{state:{billId:t.bill_id}}),className:"secondary-button",children:"View Bill"})]})]})})]}),r.jsxs("footer",{className:"billing-footer print-only",children:[r.jsx("p",{children:"Thank you for your business!"}),r.jsx("p",{children:"This is a computer generated bill and does not require a signature."})]})]})]}):r.jsx("div",{className:"error-message-box",children:"No order data available."})},rne=()=>{const e=_t(),[n,t]=w.useState(!0),[i,a]=w.useState([]),[o,l]=w.useState(""),[d,f]=w.useState(!0),[u,p]=w.useState(!1),[g,b]=w.useState({admissionCharge:"0.00",perDayCharge:"0.00",otherCharges:"0.00",aiMemory:"",clinicWideSystemPrompt:"",gemini_api_key:"",low_stock_threshold:"10",name:"",logoUrl:"",upi_id:"",address:"",notes:""}),[v,S]=w.useState(null),k=(z,F)=>{S({type:z,message:F}),setTimeout(()=>S(null),3e3)},T=z=>{switch(z){case"doctor":return r.jsx(ok,{size:14,className:"text-blue-600"});case"receptionist":return r.jsx(ow,{size:14,className:"text-green-600"});case"pharmacy":return r.jsx(ig,{size:14,className:"text-purple-600"});case"lab":return r.jsx(Yl,{size:14,className:"text-yellow-600"});default:return r.jsx(Sb,{size:14,className:"text-gray-500"})}},P=z=>{switch(z){case"doctor":return"avatar-blue";case"receptionist":return"avatar-green";case"pharmacy":return"avatar-purple";case"lab":return"avatar-yellow";default:return"avatar-gray"}},M=w.useCallback(async()=>{t(!0);try{const z=await me("/staff");if(z.ok){const F=await z.json();a(F.map(Q=>({...Q,id:Q._id||Q.id})))}}catch(z){console.error("Error fetching staff:",z),k("error","Failed to load staff list")}finally{t(!1)}},[]),I=w.useCallback(async()=>{f(!0);try{const z=await me("/api/clinics/settings");if(z.ok){const F=await z.json();b({admissionCharge:parseFloat(F.admissionCharge||0).toFixed(2),perDayCharge:parseFloat(F.perDayCharge||0).toFixed(2),otherCharges:parseFloat(F.otherCharges||0).toFixed(2),aiMemory:F.aiMemory||"",clinicWideSystemPrompt:F.clinicWideSystemPrompt||"",gemini_api_key:F.gemini_api_key||"",low_stock_threshold:F.low_stock_threshold!==void 0&&F.low_stock_threshold!==null?String(F.low_stock_threshold):"10",name:F.name||"",logoUrl:F.logoUrl||"",upi_id:F.upi_id||"",address:F.address||"",notes:F.notes||""})}}catch(z){console.error("Error fetching settings:",z),k("error","Failed to load settings")}finally{f(!1)}},[]);w.useEffect(()=>{M(),I()},[M,I]);const U=z=>{const{name:F,value:Q}=z.target;b(R=>({...R,[F]:Q}))},L=async()=>{p(!0);try{const z=parseFloat(g.admissionCharge),F=parseFloat(g.perDayCharge),Q=parseFloat(g.otherCharges),R=parseInt(g.low_stock_threshold);if((await me("/api/clinics/settings",{method:"PUT",body:JSON.stringify({name:g.name,admissionCharge:z,perDayCharge:F,otherCharges:Q,aiMemory:g.aiMemory,clinicWideSystemPrompt:g.clinicWideSystemPrompt,gemini_api_key:g.gemini_api_key,low_stock_threshold:R,logoUrl:g.logoUrl,upi_id:g.upi_id,address:g.address,notes:g.notes})})).ok)k("success","Changes saved successfully");else throw new Error("Failed to save")}catch(z){console.error("Error saving settings:",z),k("error","Failed to save settings")}finally{p(!1)}},$=i.filter(z=>z.name.toLowerCase().includes(o.toLowerCase())||z.role.toLowerCase().includes(o.toLowerCase()));return r.jsxs("div",{className:"clinic-hub-container",children:[r.jsxs("header",{className:"clinic-hub-header",children:[r.jsxs("div",{className:"clinic-hub-title",children:[r.jsx("h1",{children:"Clinic Hub"}),r.jsx("p",{className:"clinic-hub-subtitle",children:"Manage your ecosystem"})]}),r.jsxs("div",{className:"clinic-hub-actions",children:[v&&r.jsx("div",{className:`px-4 py-2 rounded-md text-sm font-medium ${v.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.message}),r.jsxs("button",{className:"btn-add-staff",onClick:()=>e("/dashboard/staff/add"),children:[r.jsx(ou,{size:16})," Add Staff"]}),r.jsxs("button",{className:"btn-save-changes",onClick:L,disabled:u,children:[r.jsx(Od,{size:16})," ",u?"Saving...":"Save Changes"]})]})]}),r.jsxs("main",{className:"clinic-hub-content",children:[r.jsxs("div",{className:"team-directory-panel",children:[r.jsxs("div",{className:"panel-header",children:[r.jsx(zh,{size:18,className:"text-gray-500"}),r.jsxs("span",{className:"panel-title",children:["Team Directory (",i.length,")"]})]}),r.jsx("div",{className:"search-container",children:r.jsxs("div",{className:"search-input-wrapper",children:[r.jsx(os,{size:16,className:"search-icon"}),r.jsx("input",{type:"text",placeholder:"Find member...",className:"search-input",value:o,onChange:z=>l(z.target.value)})]})}),r.jsx("div",{className:"team-list",children:n?r.jsx("div",{className:"p-4 text-center text-gray-500",children:"Loading staff..."}):$.length===0?r.jsx("div",{className:"empty-state",children:"No staff found."}):$.map(z=>r.jsxs("div",{className:"team-member-item",children:[r.jsx("div",{className:`member-avatar ${P(z.role)}`,children:z.name.charAt(0).toUpperCase()}),r.jsxs("div",{className:"member-info",children:[r.jsx("div",{className:"member-name",children:z.name}),r.jsxs("div",{className:"member-role",children:[T(z.role),z.role]})]}),r.jsx("span",{className:`member-status ${z.active?"status-active":"status-inactive"}`,children:z.active?"Active":"Inactive"}),r.jsx("button",{className:"btn-edit-member",onClick:()=>e(`/dashboard/staff/edit/${z.id}`),children:r.jsx(lu,{size:16})})]},z.id))})]}),r.jsxs("div",{className:"config-console-panel",children:[r.jsxs("div",{className:"panel-header",children:[r.jsx(rk,{size:18,className:"text-gray-500"}),r.jsx("span",{className:"panel-title",children:"Configuration Console"})]}),d?r.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading settings..."}):r.jsxs("div",{className:"config-content",children:[r.jsxs("div",{className:"config-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx(iR,{size:16})," CLINIC IDENTITY & LOCATION"]}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Clinic Name"}),r.jsx("input",{type:"text",className:"form-input",name:"name",value:g.name,onChange:U})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Logo URL"}),r.jsx("input",{type:"url",className:"form-input",placeholder:"https://",name:"logoUrl",value:g.logoUrl,onChange:U})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{className:"form-label",children:"Address"}),r.jsx("textarea",{className:"form-textarea",placeholder:"Full physical address",name:"address",value:g.address,onChange:U})]})]})]}),r.jsxs("div",{className:"config-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx(Eh,{size:16})," FINANCIAL OPERATIONS"]}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Admission Charge ()"}),r.jsx("input",{type:"number",className:"form-input",name:"admissionCharge",value:g.admissionCharge,onChange:U})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Per Day Charge ()"}),r.jsx("input",{type:"number",className:"form-input",name:"perDayCharge",value:g.perDayCharge,onChange:U})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Other Charges ()"}),r.jsx("input",{type:"number",className:"form-input",name:"otherCharges",value:g.otherCharges,onChange:U})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"UPI ID"}),r.jsx("input",{type:"text",className:"form-input",name:"upi_id",value:g.upi_id,onChange:U})]})]})]}),r.jsxs("div",{className:"config-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx(tk,{size:16})," INVENTORY & AI"]}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Low Stock Threshold"}),r.jsx("input",{type:"number",className:"form-input",name:"low_stock_threshold",value:g.low_stock_threshold,onChange:U})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Gemini API Key"}),r.jsx("input",{type:"password",className:"form-input",name:"gemini_api_key",value:g.gemini_api_key,onChange:U,placeholder:"******************"})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{className:"form-label",children:"Clinic-Wide System Prompt"}),r.jsx("textarea",{className:"form-textarea",name:"clinicWideSystemPrompt",value:g.clinicWideSystemPrompt,onChange:U,placeholder:"Instructions for the AI..."})]}),r.jsxs("div",{className:"form-group full-width",children:[r.jsx("label",{className:"form-label",children:"AI Memory (Context)"}),r.jsx("textarea",{className:"form-textarea",name:"aiMemory",value:g.aiMemory,onChange:U,placeholder:"Shared context for the AI..."})]})]})]})]})]})]})]})},ane="_container_nftcg_1",sne="_header_nftcg_15",one="_title_nftcg_37",lne="_controls_nftcg_51",cne="_dateInputGroup_nftcg_63",une="_dateInputLabel_nftcg_75",dne="_dateInput_nftcg_63",fne="_fetchButton_nftcg_117",hne="_section_nftcg_159",pne="_sectionTitle_nftcg_175",mne="_statsGrid_nftcg_195",gne="_statCard_nftcg_209",yne="_statTitle_nftcg_235",xne="_statValue_nftcg_251",bne="_statSubtitle_nftcg_263",vne="_revenueGrid_nftcg_277",wne="_revenueCard_nftcg_291",Sne="_revenueCardTitle_nftcg_305",Nne="_revenueCardList_nftcg_319",Cne="_revenueCardListItem_nftcg_331",jne="_tableContainer_nftcg_359",_ne="_table_nftcg_359",kne="_textGreen_nftcg_433",Tne="_textRed_nftcg_441",Ene="_loadingContainer_nftcg_459",Ane="_errorAlert_nftcg_477",Gt={container:ane,header:sne,title:one,controls:lne,dateInputGroup:cne,dateInputLabel:une,dateInput:dne,fetchButton:fne,section:hne,sectionTitle:pne,statsGrid:mne,statCard:gne,statTitle:yne,statValue:xne,statSubtitle:bne,revenueGrid:vne,revenueCard:wne,revenueCardTitle:Sne,revenueCardList:Nne,revenueCardListItem:Cne,tableContainer:jne,table:_ne,textGreen:kne,textRed:Tne,loadingContainer:Ene,errorAlert:Ane},Pne=()=>{const e=_t(),n=new Date().toISOString().split("T")[0],[t,i]=w.useState(n),[a,o]=w.useState(n),[l,d]=w.useState(!1),[f,u]=w.useState(null),[p,g]=w.useState(0),[b,v]=w.useState(0),[S,k]=w.useState(null),[T,P]=w.useState(null),[M,I]=w.useState({reception:{},pharmacy:{},lab:{}}),[U,L]=w.useState(null),$=async()=>{if(d(!0),u(null),g(0),v(0),k(null),P(null),I({reception:{},pharmacy:{},lab:{}}),L(null),!t||!a){u("Please select both start and end dates."),d(!1);return}try{const F=T8(),[Q,R,B,Y]=await Promise.all([me(`/api/bills?startDate=${t}&endDate=${a}`),me(`/api/payment/admission?startDate=${t}&endDate=${a}`),me(`/api/subscriptions/transactions/manual?startDate=${t}&endDate=${a}`),F?me(`/api/inventory/comprehensive-analysis?startDate=${t}&endDate=${a}&clinicId=${F}`):Promise.resolve(null)]);if(Q.ok&&R.ok&&B.ok){const re=await Q.json(),ne=await R.json(),G=await B.json(),V=re.bills||[],W=ne.admissionPayments||[],J=G||[];let he=0,A=0;const ce={},se={consultation:0,pharmacy:0,lab:0,other:0},D={reception:{},pharmacy:{},lab:{}};V.forEach(oe=>{if(oe.status==="paid"||oe.type==="pharmacy_return"){const xe=parseFloat(oe.amount.toString()),Z=oe.payment_mode||"Unknown";let ue=oe.type||"other";ue==="pharmacy_return"&&(A+=xe,ue="pharmacy"),he+=xe,ce[Z]=(ce[Z]||0)+xe,se.hasOwnProperty(ue)?se[ue]=(se[ue]||0)+xe:se.other=(se.other||0)+xe,ue==="pharmacy"?D.pharmacy[Z]=(D.pharmacy[Z]||0)+xe:ue==="lab"?D.lab[Z]=(D.lab[Z]||0)+xe:D.reception[Z]=(D.reception[Z]||0)+xe}}),W.forEach(oe=>{const xe=parseFloat(oe.amount_paid.toString()),Z=oe.payment_mode||"Unknown";he+=xe,ce[Z]=(ce[Z]||0)+xe,D.reception[Z]=(D.reception[Z]||0)+xe}),J.forEach(oe=>{var ue,ae;const xe=parseFloat(((ae=(ue=oe.subscriptionPlan)==null?void 0:ue.price)==null?void 0:ae.toString())??"0"),Z=oe.subscription_payment_method||"manual";he+=xe,ce[Z]=(ce[Z]||0)+xe,D.reception[Z]=(D.reception[Z]||0)+xe}),g(he),v(A),k(ce),P(se),I(D)}if(Y&&Y.ok){const re=await Y.json();L(re)}}catch(F){console.error("Analysis Fetch Error:",F),u("Failed to fetch analysis data. Please try again.")}finally{d(!1)}},z=F=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(F);return r.jsxs("div",{className:Gt.container,children:[r.jsxs("div",{className:Gt.header,children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("button",{onClick:()=>e(-1),className:"p-2 hover:bg-gray-100 rounded-full",children:r.jsx(rn,{size:20,className:"text-gray-600"})}),r.jsx("h1",{className:Gt.title,children:"Analysis Dashboard"})]}),r.jsxs("div",{className:Gt.controls,children:[r.jsxs("div",{className:Gt.dateInputGroup,children:[r.jsx("label",{className:Gt.dateInputLabel,children:"From:"}),r.jsx("input",{type:"date",className:Gt.dateInput,value:t,onChange:F=>i(F.target.value)})]}),r.jsxs("div",{className:Gt.dateInputGroup,children:[r.jsx("label",{className:Gt.dateInputLabel,children:"To:"}),r.jsx("input",{type:"date",className:Gt.dateInput,value:a,onChange:F=>o(F.target.value)})]}),r.jsx("button",{className:Gt.fetchButton,onClick:$,disabled:l,children:l?"Refreshing...":r.jsxs(r.Fragment,{children:[r.jsx(Kx,{size:16,className:"inline mr-2"})," Refresh Analysis"]})})]})]}),f&&r.jsxs("div",{className:Gt.errorAlert,children:[r.jsx(Hi,{size:20}),r.jsx("span",{children:f})]}),!l&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("section",{className:Gt.section,children:[r.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[r.jsx(Eh,{className:"text-blue-600"}),r.jsx("h2",{className:Gt.sectionTitle,children:"Financial Performance"})]}),r.jsxs("div",{className:Gt.statsGrid,children:[r.jsxs("div",{className:Gt.statCard,children:[r.jsx("div",{className:Gt.statTitle,children:"Total Revenue Collected"}),r.jsx("div",{className:`${Gt.statValue} text-blue-600`,children:z(p)}),r.jsx("div",{className:Gt.statSubtitle,children:"All payment modes"})]}),S&&Object.entries(S).map(([F,Q])=>r.jsxs("div",{className:Gt.statCard,children:[r.jsxs("div",{className:Gt.statTitle,children:[F," Collections"]}),r.jsx("div",{className:Gt.statValue,children:z(Q)})]},F))]}),M&&r.jsxs("div",{className:Gt.revenueGrid,children:[r.jsxs("div",{className:Gt.revenueCard,children:[r.jsx("h3",{className:Gt.revenueCardTitle,children:"Reception / Clinic"}),r.jsx("div",{className:"text-2xl font-bold mb-2",children:z(((T==null?void 0:T.consultation)||0)+((T==null?void 0:T.other)||0))}),r.jsx("ul",{className:Gt.revenueCardList,children:Object.entries(M.reception).map(([F,Q])=>r.jsxs("li",{className:Gt.revenueCardListItem,children:[r.jsx("span",{children:F}),r.jsx("span",{className:"font-medium text-gray-900",children:z(Q)})]},F))})]}),r.jsxs("div",{className:Gt.revenueCard,children:[r.jsx("h3",{className:Gt.revenueCardTitle,children:"Pharmacy"}),r.jsx("div",{className:"text-2xl font-bold mb-2",children:z((T==null?void 0:T.pharmacy)||0)}),b<0&&r.jsxs("div",{className:"text-sm text-red-500 mb-2",children:["Returns: ",z(b)]}),r.jsx("ul",{className:Gt.revenueCardList,children:Object.entries(M.pharmacy).map(([F,Q])=>r.jsxs("li",{className:Gt.revenueCardListItem,children:[r.jsx("span",{children:F}),r.jsx("span",{className:"font-medium text-gray-900",children:z(Q)})]},F))})]}),r.jsxs("div",{className:Gt.revenueCard,children:[r.jsx("h3",{className:Gt.revenueCardTitle,children:"Laboratory"}),r.jsx("div",{className:"text-2xl font-bold mb-2",children:z((T==null?void 0:T.lab)||0)}),r.jsx("ul",{className:Gt.revenueCardList,children:Object.entries(M.lab).map(([F,Q])=>r.jsxs("li",{className:Gt.revenueCardListItem,children:[r.jsx("span",{children:F}),r.jsx("span",{className:"font-medium text-gray-900",children:z(Q)})]},F))})]})]})]}),r.jsxs("section",{className:Gt.section,children:[r.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[r.jsx(Md,{className:"text-emerald-600"}),r.jsx("h2",{className:Gt.sectionTitle,children:"Inventory Movement"})]}),U&&U.pharmacyAnalysis.length>0?r.jsx("div",{className:Gt.tableContainer,children:r.jsxs("table",{className:Gt.table,children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Item Name"}),r.jsx("th",{children:"Stock In"}),r.jsx("th",{children:"Stock Out"}),r.jsx("th",{children:"Net Change"}),r.jsx("th",{className:"text-right",children:"Est. Revenue"}),r.jsx("th",{className:"text-right",children:"Est. Profit"})]})}),r.jsx("tbody",{children:U.pharmacyAnalysis.map(F=>r.jsxs("tr",{children:[r.jsxs("td",{children:[r.jsx("div",{className:"font-medium text-gray-900",children:F.name}),r.jsx("div",{className:"text-xs text-gray-500",children:F.supplier})]}),r.jsxs("td",{className:Gt.textGreen,children:["+",F.quantity_in,Object.entries(F.quantity_in_by_reason).map(([Q,R])=>r.jsxs("div",{className:"text-xs opacity-75",children:[Q,": ",R]},Q))]}),r.jsxs("td",{className:Gt.textRed,children:["-",F.quantity_out,Object.entries(F.quantity_out_by_reason).map(([Q,R])=>r.jsxs("div",{className:"text-xs opacity-75",children:[Q,": ",R]},Q))]}),r.jsx("td",{children:r.jsxs("span",{className:`font-semibold ${F.net_change>=0?"text-green-600":"text-red-600"}`,children:[F.net_change>0?"+":"",F.net_change]})}),r.jsx("td",{className:"text-right font-medium",children:z(F.revenue)}),r.jsx("td",{className:`text-right font-medium ${F.profit>=0?"text-green-600":"text-red-600"}`,children:z(F.profit)})]},F.drug_id))})]})}):r.jsx("div",{className:"text-center py-8 text-gray-500 mb-4 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:"No inventory movement recorded for this period."})]})]}),l&&r.jsxs("div",{className:Gt.loadingContainer,children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mb-4"}),r.jsx("div",{children:"Analyzing Financial & Inventory Data..."})]})]})};function Dne(){const[e,n]=w.useState(!1),[t,i]=w.useState(null),[a,o]=w.useState(!0),[l,d]=w.useState(null),[f,u]=w.useState(!1),p=I=>{i(I),n(!0),I.role==="admin"&&!I.has_seen_tutorial&&u(!0)},g=()=>{n(!1),i(null),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")};w.useEffect(()=>{const I=localStorage.getItem("authToken"),U=localStorage.getItem("currentUser");if(I&&U)try{const L=JSON.parse(U);i(L),n(!0),L.role==="admin"&&!L.has_seen_tutorial&&u(!0)}catch(L){console.error("Error parsing stored user data:",L),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser")}o(!1)},[]),w.useEffect(()=>{(async()=>{if(e&&t)try{const U=await wte();d(U)}catch(U){console.error("Error fetching clinic pro plan status:",U),d({hasProPlan:!1})}else d(null)})()},[e,t]);const[b,v]=w.useState(null),[S,k]=w.useState(!1);w.useEffect(()=>{const I=U=>{U.preventDefault(),v(U),k(!0),console.log("beforeinstallprompt event fired")};return window.addEventListener("beforeinstallprompt",I),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&(console.log("App is already installed (standalone)."),k(!1)),()=>{window.removeEventListener("beforeinstallprompt",I)}},[]),w.useEffect(()=>{const I=window.matchMedia("(prefers-color-scheme: dark)"),U=()=>{I.matches?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")};return U(),I.addEventListener("change",U),()=>{I.removeEventListener("change",U),document.body.classList.remove("dark-mode")}},[]);const T=w.useCallback(async()=>{if(!b){console.log("Install prompt event not available.");return}const I=b;I.prompt();const{outcome:U}=await I.userChoice;console.log(`User response to the install prompt: ${U}`),v(null),k(!1)},[b]),P=async()=>{if(t)try{(await me(`/api/users/${t.id}/tutorial-seen`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({has_seen_tutorial:!0})})).ok?(i(U=>U?{...U,has_seen_tutorial:!0}:null),localStorage.setItem("currentUser",JSON.stringify({...t,has_seen_tutorial:!0})),u(!1)):console.error("Failed to update tutorial status on backend.")}catch(I){console.error("Error marking tutorial as seen:",I)}};return a?r.jsx("div",{children:"Loading..."}):r.jsx(oP,{clientId:"277898779560-33obduhn8r758rini4qagetdrupvisri.apps.googleusercontent.com",children:r.jsxs(jD,{children:[r.jsx(OD,{children:r.jsxs(xh,{children:[r.jsx(pt,{path:"/login",element:e?r.jsx(mn,{to:"/dashboard"}):r.jsx(zD,{onLoginSuccess:p})}),r.jsx(pt,{path:"/register",element:e?r.jsx(mn,{to:"/dashboard"}):r.jsx(UD,{})}),r.jsx(pt,{path:"/handle-complaint-url",element:e?r.jsx(Kte,{}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/live-api",element:e?r.jsx($8,{}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/create-lab-order",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(Q2,{currentUser:t})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/manage-admission",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(Y2,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/lab/report/:orderId",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(A_,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/lab/enter-report/:orderId",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(A_,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/add-patient",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(_1,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/billing",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(Tee,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/edit-complaint/:recordId",element:e&&t?r.jsx(k_,{}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/edit-complaint/patient/:patientId",element:e&&t?r.jsx(k_,{}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/edit-pharmacy-order/:orderId",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(hA,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/*",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:Ine(t.role,t,me)}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/lab/view-report/:orderId",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx($ee,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/lab/search-report",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(zee,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/patient/:patientId/lab-reports",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(Uee,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/patient/:patientId/pharmacy-orders",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(Eee,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/inventory",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(pA,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/inventory/add",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(N9,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/inventory/edit/:id",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(rT,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/lab-inventory",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(jw,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/patient/:patientId/complaints",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(_ee,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/patient/:patientId/admission-bill/:billId",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(Hee,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/start-subscription/:patientId",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(fte,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/start-clinic-subscription",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(jte,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/refill-reminders",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(Jte,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/notifications",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(Xte,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/create-custom-bill",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(W2,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/pharmacy-billing/:orderId",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(nne,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/lab-billing/:orderId",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(ine,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/analysis",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(Pne,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"/dashboard/clinic-hub",element:e&&t?r.jsx(Wn,{user:t,onLogout:g,showInstallPrompt:S,onInstallClick:T,clinicProPlanStatus:l,children:r.jsx(rne,{})}):r.jsx(mn,{to:"/login"})}),r.jsx(pt,{path:"*",element:r.jsx(mn,{to:e?"/dashboard":"/login"})})]})}),f&&r.jsx(Wte,{onClose:()=>u(!1),onMarkAsSeen:P})]})})}const Ine=(e,n,t)=>{switch(e){case"superadmin":return r.jsxs(xh,{children:[r.jsx(pt,{index:!0,element:r.jsx(Bte,{})}),r.jsx(pt,{path:"clinic-subscriptions",element:r.jsx(Ste,{})}),r.jsx(pt,{path:"clinic-subscriptions/add",element:r.jsx(Nte,{})}),r.jsx(pt,{path:"clinic-subscriptions/edit/:id",element:r.jsx(Cte,{})}),r.jsx(pt,{path:"users",element:r.jsx(_te,{})})," ",r.jsx(pt,{path:"*",element:r.jsx("div",{children:"Unknown Super Admin Section"})})]});case"admin":return r.jsxs(xh,{children:[r.jsx(pt,{index:!0,element:r.jsx(Y8,{fetchWithAuth:t})}),r.jsx(pt,{path:"staff",element:r.jsx(Vee,{fetchWithAuth:t})}),r.jsx(pt,{path:"staff/add",element:r.jsx(C9,{clinicId:n==null?void 0:n.clinic_id})}),r.jsx(pt,{path:"staff/edit/:id",element:r.jsx(j9,{})}),r.jsx(pt,{path:"patients/add",element:r.jsx(_1,{})}),r.jsx(pt,{path:"search-patient",element:r.jsx(Sh,{})}),r.jsx(pt,{path:"patients",element:r.jsx(C1,{})}),r.jsx(pt,{path:"inventory",element:r.jsx(iT,{})}),r.jsx(pt,{path:"inventory/edit/:id",element:r.jsx(rT,{})}),r.jsx(pt,{path:"distributors",element:r.jsx(D_,{})}),r.jsx(pt,{path:"purchase",element:r.jsx(I_,{})})," ",r.jsx(pt,{path:"queue",element:r.jsx(c0,{})}),r.jsx(pt,{path:"subscriptions",element:r.jsx(cte,{})}),r.jsx(pt,{path:"subscriptions/add",element:r.jsx(ute,{})}),r.jsx(pt,{path:"subscriptions/edit/:id",element:r.jsx(dte,{})}),r.jsx(pt,{path:"*",element:r.jsx("div",{children:"Unknown Admin Section"})})," "]});case"doctor":return r.jsxs(xh,{children:[r.jsx(pt,{index:!0,element:r.jsx(mn,{to:"search-patient",replace:!0})}),r.jsx(pt,{path:"search-patient",element:r.jsx(Sh,{})}),r.jsx(pt,{path:"queue",element:r.jsx(c0,{})}),r.jsx(pt,{path:":patientId",element:r.jsx(c0,{})}),r.jsx(pt,{path:"add-patient",element:r.jsx(_1,{})}),r.jsx(pt,{path:"*",element:r.jsx("div",{children:"Unknown Doctor Section"})})]});case"receptionist":return r.jsxs(xh,{children:[r.jsx(pt,{index:!0,element:r.jsx(Q8,{currentUser:n})}),r.jsx(pt,{path:"all-patients",element:r.jsx(C1,{})}),r.jsx(pt,{path:"search-patient",element:r.jsx(Sh,{})}),r.jsx(pt,{path:"*",element:r.jsx("div",{children:"Unknown Reception Section"})})," "]});case"lab":return r.jsx(b9,{});case"pharmacy":return r.jsxs(xh,{children:[r.jsx(pt,{index:!0,element:r.jsx(v9,{})}),r.jsx(pt,{path:"inventory",element:r.jsx(pA,{})}),r.jsx(pt,{path:"settings",element:r.jsx(S9,{})}),r.jsx(pt,{path:"add-order",element:r.jsx(Aee,{})}),r.jsx(pt,{path:"edit-pharmacy-order/:orderId",element:r.jsx(hA,{})}),r.jsx(pt,{path:"orders/:orderId",element:r.jsx(nte,{})}),r.jsx(pt,{path:"search-patient-records",element:r.jsx(Sh,{})}),r.jsx(pt,{path:"distributors",element:r.jsx(D_,{})}),r.jsx(pt,{path:"purchase",element:r.jsx(I_,{})})," ",r.jsx(pt,{path:"*",element:r.jsx(mn,{to:"/dashboard",replace:!0})})]});default:return r.jsxs("div",{children:["Unknown role (",e,") or dashboard not implemented."]},e)}},Wn=({user:e,onLogout:n,children:t,showInstallPrompt:i,onInstallClick:a,clinicProPlanStatus:o})=>{const l=_t(),[d,f]=w.useState(!1),[u,p]=w.useState(window.innerWidth<=768),[g,b]=w.useState(!1),[v,S]=w.useState([]),[k,T]=w.useState(0),[P,M]=w.useState(!1),[I,U]=w.useState("Newtons Ai"),[L,$]=w.useState(null),[z,F]=w.useState(!1);w.useEffect(()=>K0.subscribe(G=>{F(G)}),[]);const Q=w.useRef(null);w.useEffect(()=>{const G=()=>{p(window.innerWidth<=768)};return window.addEventListener("resize",G),()=>window.removeEventListener("resize",G)},[]);const R=w.useCallback(async()=>{try{const G=await me("/api/notifications");if(G.ok){const J=(await G.json()).reduce((he,A)=>{const ce=he.find(se=>se.message===A.message);return ce?new Date(A.created_at)>new Date(ce.created_at)?he.map(se=>se.message===A.message?A:se):he:[...he,A]},[]).sort((he,A)=>{const ce={expired_drug:1,near_expiry_drug:2,low_stock:3},se=ce[he.type]||99,D=ce[A.type]||99;return se!==D?se-D:new Date(A.created_at).getTime()-new Date(he.created_at).getTime()});S(J),T(J.filter(he=>!he.is_read).length)}else console.error("Failed to fetch notifications:",G.statusText)}catch(G){console.error("Error fetching notifications:",G)}},[]);w.useEffect(()=>{(async()=>{if(e!=null&&e.clinic_id)try{const V=await me("/api/clinics/settings");if(V.ok){const W=await V.json();W.name===""?U("Newtons Ai"):U(W.name),$(W.logoUrl)}else console.error("Failed to fetch clinic details for display:",V.statusText),U("Newtons Ai"),$(null)}catch(V){console.error("Error fetching clinic details for display:",V),U("Newtons Ai"),$(null)}else U("Newtons Ai"),$(null)})()},[e==null?void 0:e.clinic_id]),w.useEffect(()=>{if(e!=null&&e.clinic_id){R();const G=setInterval(R,5*60*1e3);return()=>clearInterval(G)}},[e==null?void 0:e.clinic_id,R]);const B=()=>{f(!d),d||b(!1)},Y=()=>{b(!g),g||f(!1)};w.useEffect(()=>{const G=V=>{Q.current&&!Q.current.contains(V.target)&&g&&b(!1)};return g&&document.addEventListener("mousedown",G),()=>{document.removeEventListener("mousedown",G)}},[g]);const re=async G=>{try{const V=await me(`/api/notifications/${G}/read`,{method:"PUT"});V.ok?R():console.error("Failed to mark notification as read:",V.statusText)}catch(V){console.error("Error marking notification as read:",V)}},ne=async()=>{M(!0);try{const G=await me("/api/notifications/trigger-all",{method:"POST"});G.ok?(console.log("Notification checks triggered successfully."),await R()):console.error("Failed to trigger notification checks:",G.statusText)}catch(G){console.error("Error triggering notification checks:",G)}finally{M(!1)}};return r.jsxs("div",{className:"dashboard-layout",children:[" ",r.jsxs("nav",{className:"app-header no-print",children:[r.jsxs("div",{className:"header-left",children:[r.jsx("a",{href:"#",onClick:G=>{G.preventDefault(),l("/dashboard")},className:"logo-container",children:r.jsx("img",{src:L||"/logo.png",alt:"App Logo",className:"logo-image"})}),r.jsxs("div",{className:"title-section",children:[r.jsx("span",{className:"app-title-link",children:I}),r.jsxs("span",{className:"user-role-panel",children:["(",e.role.charAt(0).toUpperCase()+e.role.slice(1)," Panel)"]})]})]}),r.jsxs("div",{className:"header-right",children:[i&&r.jsxs("button",{onClick:a,className:"install-button",title:"Install App",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),r.jsx("span",{children:"Install"})]}),o&&(o.hasProPlan?r.jsx("span",{className:"pro-badge",children:"PRO"}):r.jsx("button",{onClick:()=>l("/start-clinic-subscription"),className:"go-pro-button",children:"GoPro"})),r.jsxs("div",{className:"notifications-section",ref:Q,children:[" ",r.jsxs("button",{className:"notification-icon","aria-label":"Notifications",onClick:Y,children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),k>0&&r.jsx("span",{className:"notification-count",children:k})]}),g&&r.jsxs("div",{className:"notifications-dropdown",children:[r.jsx("div",{className:"dropdown-header",children:"Notifications"}),r.jsx("ul",{className:"dropdown-list",children:v.length>0?v.map(G=>r.jsxs("li",{className:`dropdown-item ${G.is_read?"read":"unread"}`,onClick:()=>re(G.id),children:[G.message,r.jsx("span",{className:"notification-timestamp",children:new Date(G.created_at).toLocaleString()})]},G.id)):r.jsx("li",{className:"dropdown-item",children:"No new notifications"})}),r.jsxs("div",{className:"dropdown-footer",children:[r.jsx("button",{onClick:()=>l("/dashboard/notifications"),children:"View All"}),(e.role==="admin"||e.role==="superadmin")&&r.jsx("button",{onClick:ne,className:"fetch-all-button",disabled:P,children:P?"Fetching...":"Fetch All"})]})]})]}),r.jsx("button",{className:"hamburger-icon",onClick:B,"aria-label":"Open navigation",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})})})]}),z&&r.jsx("div",{className:"global-loading-bar"})]}),r.jsx("main",{className:"main-content",children:t}),u?r.jsx(JD,{user:e,onLogout:n,userRole:e.role,isOpen:d,onClose:B,roleNavigation:Z_}):r.jsx(QD,{user:e,onLogout:n,userRole:e.role,isOpen:d,onClose:B}),!u&&d&&r.jsx("div",{className:"side-panel-overlay",onClick:B})]})};aP.createRoot(document.getElementById("root")).render(r.jsx(w.StrictMode,{children:r.jsx(Dne,{})}));
